<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>详细介绍利用GRACE1B多日数据计算LGD工作流程二_基于LRI1B多日数据</title>
    <link href="/2025/11/10/%E8%AF%A6%E7%BB%86%E4%BB%8B%E7%BB%8D%E5%88%A9%E7%94%A8GRACE1B%E5%A4%9A%E6%97%A5%E6%95%B0%E6%8D%AE%E8%AE%A1%E7%AE%97LGD%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B%E4%BA%8C-%E5%9F%BA%E4%BA%8ELRI1B%E5%A4%9A%E6%97%A5%E6%95%B0%E6%8D%AE/"/>
    <url>/2025/11/10/%E8%AF%A6%E7%BB%86%E4%BB%8B%E7%BB%8D%E5%88%A9%E7%94%A8GRACE1B%E5%A4%9A%E6%97%A5%E6%95%B0%E6%8D%AE%E8%AE%A1%E7%AE%97LGD%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B%E4%BA%8C-%E5%9F%BA%E4%BA%8ELRI1B%E5%A4%9A%E6%97%A5%E6%95%B0%E6%8D%AE/</url>
    
    <content type="html"><![CDATA[<h1 id="1-简介"><a href="#1-简介" class="headerlink" title="1. 简介"></a>1. 简介</h1><p>文章<a href="https://singyutang.github.io/2025/09/27/%E8%AF%A6%E7%BB%86%E4%BB%8B%E7%BB%8D%E5%88%A9%E7%94%A8GRACE1B%E5%8D%95%E6%97%A5%E6%95%B0%E6%8D%AE%E8%AE%A1%E7%AE%97LGD%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B%E4%BA%8C/">详细介绍利用GRACE1B单日数据计算LGD工作流程二(基于LRI1B单日数据)</a>介绍了如何基于GROOPS软件计算单日动力学轨道并结合单日的LRI数据计算单日RA和LGD，计算结果与PNAS论文<a href="https://www.pnas.org/doi/full/10.1073/pnas.2109086118">GRACE Follow-On revealed Bangladesh was flooded early in the 2020 monsoon season due to premature soil saturation</a>文末提供的LGD数据集基本吻合，但是与论文中Fig. 1结果不同，本文更新的代码对此进行了优化，能够与该篇论文的Fig. 1结果一致，并提供动力学轨道和LRI数据批量处理代码和工作流程。</p><h2 id="1-1-GOCO06s静态重力场模型与月度Level2-产品结合"><a href="#1-1-GOCO06s静态重力场模型与月度Level2-产品结合" class="headerlink" title="1.1. GOCO06s静态重力场模型与月度Level2 产品结合"></a>1.1. GOCO06s静态重力场模型与月度Level2 产品结合</h2><p>之前进行轨道积分使用的重力场模型为GOCO06s（0-200阶），对此进行更新，使用2019年GRACE-FO Level2月解产品计算的平均场作替换GOCO06s的前96阶，第97-200阶球协数据仍使用GOCO06s重力场模型。使用该方法计算的的重力场模型能够准确计算卫星动力学轨道，得出RA与LGD，详细代码与数据见附件代码中的程序A02~A04。</p><h2 id="1-2-利用GRACE-LRI1B多日数据批量计算LGD"><a href="#1-2-利用GRACE-LRI1B多日数据批量计算LGD" class="headerlink" title="1.2. 利用GRACE LRI1B多日数据批量计算LGD"></a>1.2. 利用GRACE LRI1B多日数据批量计算LGD</h2><p>本次更新的代码可基于GROOPS软件、Matlab代码及Python代码进行动力学轨道计算与LGD（或RA）的批量计算，所有代码与数据见附件，工作流程在<a href="https://singyutang.github.io/2025/09/23/%E8%AF%A6%E7%BB%86%E4%BB%8B%E7%BB%8D%E5%88%A9%E7%94%A8GRACE1B%E6%95%B0%E6%8D%AE%E8%AE%A1%E7%AE%97LGD%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B/">详细介绍利用GRACE1B单日数据计算LGD工作流程一(基于KBR1B单日数据)</a>一文中已有详细介绍，这里结合新增的功能再次进行介绍。</p><h1 id="2-工作流程"><a href="#2-工作流程" class="headerlink" title="2. 工作流程"></a>2. 工作流程</h1><p>工作目录（workdir）：<code>G:\GROOPS\PNAS2020Workspace</code><br>将下载附件中的代码拷贝到工作目录中即可运行代码。</p><h2 id="2-1-创建目录"><a href="#2-1-创建目录" class="headerlink" title="2.1 创建目录"></a>2.1 创建目录</h2><p>在工作目录下创建四个文件夹，分别命名为<code>input</code>、<code>output</code>、<code>image</code>、<code>gracefo_dataset</code>如下，包含GROOPS处理脚本，目录结构如下。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs Shell">workdir/<br>├── input/<br>├── output/<br>├── image/<br>├── gracefo_dataset/<br>├── A00check_orbit_coverage.py<br>├── A01get_lri_kbr_records_num.py<br>├── A02read_grace_fo_shc_file.py<br>├── A03read_goco06s_file.py<br>├── A04combine_earth_gravity_field.py<br>├── process_cwt_filter_signal_data.m<br>├── S00GroopsIntegrateOrbitLRI-202007.xml<br>├── S01SatelliteTrackingFromLRI-202007.xml<br>├── S02compute_grace_lgd.py<br>├── S02compute_grace_lgd_gapfilled.py<br>├── S03cwt_filter_lgd_ra.m<br>├── S04lgd_ra_ipsd.py<br>├── S05plot_lgd_ra_cwt_filter.py<br>├── S05plot_lgd_ra_cwt_filter_gapfilled.py<br>├── S06compare_pnas_data.py<br>├── S07plot_lgd_ra_spatial_map.py<br>├── S08convert_twsgrid_format_from_fengwei_toolbox.m<br>├── S09plot_GRACE_L2_monthly_tws_from_matlab.py<br>├── S10plot_lgd_ra_multi_time_series_cross_over_area.py<br>└── main_hybrid_pipeline.py<br><br></code></pre></td></tr></table></figure><h2 id="2-2-数据准备"><a href="#2-2-数据准备" class="headerlink" title="2.2 数据准备"></a>2.2 数据准备</h2><p>数据下载包含AOD1B RL06数据和GRACE-FO Level 1B RL04 .noLRI数据和.LRI数据。</p><p>AOD1B RL06：ftp://isdcftp.gfz.de/grace-fo/Level-1B/GFZ/AOD/RL06/2020/AOD1B_2020-06-02_X_06.asc.gz （通过filezilla软件下载）</p><p>GRACE-FO数据下载链接：<a href="https://podaac.jpl.nasa.gov/dataset/GRACEFO_L1B_ASCII_GRAV_JPL_RL04">https://podaac.jpl.nasa.gov/dataset/GRACEFO_L1B_ASCII_GRAV_JPL_RL04</a> 或 <a href="https://search.earthdata.nasa.gov/search/granules?p=C2036882118-POCLOUD&amp;pg[0][v]=f&amp;tl=1743148786.317!3!!">https://search.earthdata.nasa.gov/search/granules?p=C2036882118-POCLOUD&amp;pg[0][v]=f&amp;tl=1743148786.317!3!!</a></p><p>GRACE-FO数据数据下载完成后，解压后将<em>.noLRI 和 </em>gracefo_1B_2020-07-07_RL04.ascii*.LRI所有文件夹拷贝到<code>workdir/gracefo_dataset/</code>下。AOD1B数据下载完成后，解压后将文件拷贝到<code>workdir/gracefo_dataset/</code>下。</p><p>*注意：AOD1B数据要在实际处理日期上多添加一天的文件。</p><h2 id="2-3-程序运行"><a href="#2-3-程序运行" class="headerlink" title="2.3 程序运行"></a>2.3 程序运行</h2><ol><li>运行S00GroopsIntegrateOrbitLRI-202007.xml ，进行动力学轨道积分，<strong>参数修改</strong>如下</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs Shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">global 模块参数修改</span><br>workspace → "G:\GROOPS\PNAS2020Workspace"<br>resampleInterval → 2<br>instrument → lri<br>background → ggm05b<br>timeStart → 58970 (2020-05-01 00:00:00)<br>timeEnd → 59091+23/24+59/1440+59/86400 (2020-08-30 23:59:59)<br>timeIntervalsDaily(uniformSampling)<br>├── timeStart → 58970 (2020-05-01 00:00:00)<br>├── timeEnd → 59091+23/24+59/1440+59/86400 (2020-08-30 23:59:59)<br>└── sampling → 2/86400<br></code></pre></td></tr></table></figure><p>参数修改后在GROOPS运行<code>S00GroopsIntegrateOrbitLRI-202007.xml</code>脚本。</p><p>1.运行S01SatelliteTrackingFromLRI-202007.xml，进行LRI1B数据提取，<strong>参数修改</strong>如下</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">global 模块参数修改</span><br>workspace → "G:\GROOPS\PNAS2020Workspace"<br>instrument → lri<br>timeStart → 58970 (2020-05-01 00:00:00)<br>timeEnd → 59091+23/24+59/1440+59/86400 (2020-08-30 23:59:59)<br></code></pre></td></tr></table></figure><p>参数修改后在GROOPS运行<code>S01SatelliteTrackingFromLRI-202007.xml</code>脚本，运行后轨道结果保存在<code>workdir/output</code>路径下。</p><p>2.打开main_hybrid_pipeline.py，计算lgd和ra，先在main函数中初始化lgd处理器，lgd处理器初始化及计算lgd和ra的执行代码如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">"__main__"</span>:<br>    <span class="hljs-comment"># 创建处理器实例</span><br>    processor = LgdProcessor(<br>        start_date=<span class="hljs-string">'2020-08-01'</span>,    <span class="hljs-comment"># 计算的起始日期</span><br>        end_date=<span class="hljs-string">'2020-08-30'</span>,      <span class="hljs-comment"># 计算的终止日期</span><br>        groops_workspace=<span class="hljs-string">'G:\GROOPS\PNAS2020Workspace'</span>,     <span class="hljs-comment"># 工作目录，即上文中的workdir</span><br>        instrument=<span class="hljs-string">'LRI'</span>,           <span class="hljs-comment"># 传感器类型，'LRI' 或 'KBR'</span><br>        lon_range=(<span class="hljs-number">88</span>, <span class="hljs-number">92</span>),         <span class="hljs-comment"># 研究区经度范围，东经为正，西经为负</span><br>        lat_range=(<span class="hljs-number">22</span>, <span class="hljs-number">26</span>),         <span class="hljs-comment"># 研究区纬度范围，北纬为正，南纬为负</span><br>        lat_limit=(-<span class="hljs-number">80.0</span>, <span class="hljs-number">80.0</span>),    <span class="hljs-comment"># 绘制穿过研究区轨道时轨道的延申纬度</span><br>        direction=<span class="hljs-string">'asc'</span>             <span class="hljs-comment"># 限制穿过研究区范围的轨道类型，升轨（'asc'）、降轨（'desc'）和全部（'both'）</span><br>    )<br><br>    <span class="hljs-comment">#  计算lgd和ra</span><br>    processor.execute(<span class="hljs-number">2</span>)<br></code></pre></td></tr></table></figure><p>运行后lgd和ra结果保存在<code>workdir/results</code>路径下。</p><p>3.Matlab中运行S03cwt_fliter_lgd_ra.m，计算lgd和ra小波分析重构后的结果，若只计算一天，则执行代码中的单日计算，代码如下</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs matlab"><span class="hljs-comment">%% 单日计算</span><br>clear;clc;<br>date_str = <span class="hljs-string">'2020-06-15'</span>;<br>data_type = <span class="hljs-string">'lgd'</span>;  <span class="hljs-comment">% 'lgd' or 'ra'</span><br>freq = <span class="hljs-number">0.5</span>;     <span class="hljs-comment">% 采样频率</span><br>process_cwt_fliter_signal_data(date_str, data_type, fs=freq, show_plots=<span class="hljs-built_in">true</span>);<br><br></code></pre></td></tr></table></figure><p>若批量计算，则执行批量计算部分代码</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs matlab"><span class="hljs-comment">%% 批量计算</span><br>clear;clc;<br>freq = <span class="hljs-number">0.5</span>;     <span class="hljs-comment">% 采样频率</span><br><br>start_datenum = datenum(<span class="hljs-number">2020</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>);<br>end_datenum = datenum(<span class="hljs-number">2020</span>, <span class="hljs-number">8</span>, <span class="hljs-number">30</span>);<br><br>date_nums = start_datenum:end_datenum;<br><br>date_list = cellstr(datestr(date_nums, <span class="hljs-string">'yyyy-mm-dd'</span>));<br><br><span class="hljs-keyword">for</span> <span class="hljs-built_in">i</span>=<span class="hljs-number">1</span>: <span class="hljs-built_in">length</span>(date_list)<br>    process_cwt_fliter_signal_data(date_list{<span class="hljs-built_in">i</span>}, <span class="hljs-string">"ra"</span>, fs=freq, show_plots=<span class="hljs-built_in">false</span>);<br>    process_cwt_fliter_signal_data(date_list{<span class="hljs-built_in">i</span>}, <span class="hljs-string">"lgd"</span>, fs=freq, show_plots=<span class="hljs-built_in">false</span>);<br><span class="hljs-keyword">end</span><br><br></code></pre></td></tr></table></figure><p>运行后lgd和ra结果保存在<code>workdir/results</code>路径下。</p><p>4.打开main_hybrid_pipeline.py，计算lgd和ra的ASD曲线，在main函数中执行以下代码（这里不再展示初始化lgd处理器的代码）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#  计算lgd和ra的ASD图</span><br>processor.execute(<span class="hljs-number">4</span>)<br></code></pre></td></tr></table></figure><p>运行后lgd和ra结果保存在<code>workdir/results</code>路径下。</p><p>5.打开main_hybrid_pipeline.py，绘制lgd和ra的重构前后结果对比图，在main函数中执行以下代码（这里不再展示初始化lgd处理器的代码）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#  绘制lgd和ra的重构前后结果对比图</span><br>processor.execute(<span class="hljs-number">5</span>)<br></code></pre></td></tr></table></figure><p>运行后绘图结果保存在<code>workdir/results</code>路径下。</p><p>6.如果研究区域与上文介绍的PNAS论文一致，则可以进行对比，打开main_hybrid_pipeline.py，在main函数中执行以下代码即可（这里不再展示初始化lgd处理器的代码）。执行第该步骤必须更新PNAS数据目录（pnas_data_dir）。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 执行第6步前必须更新PNAS数据目录（pnas_data_dir）</span><br>processor.update_config(pnas_data_dir=<span class="hljs-string">'I:\LGD\GRACE-Follow-On-line-of-sight-gravity-processing-main\GRACE_data'</span>)<br>processor.execute(<span class="hljs-number">6</span>)<br></code></pre></td></tr></table></figure><p>运行后绘图结果保存在<code>workdir/results</code>路径下。</p><p>7.打开main_hybrid_pipeline.py，绘制lgd和ra的重构后的空间结果图，在main函数中执行以下代码（这里不再展示初始化lgd处理器的代码）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#  绘制lgd和ra的重构前后结果对比图</span><br>processor.execute(<span class="hljs-number">7</span>)<br></code></pre></td></tr></table></figure><p>运行后绘图结果保存在<code>workdir/results</code>路径下。</p><p>8.Matlab中运行S08convert_twsgrid_format_from_fengwei_toolbox.m，将fengwei工具包生成的月度tws结果转化成python能提取的格式，执行代码如下。</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs matlab"><br>clear;clc;<br><br>file_path = <span class="hljs-string">'G:\GRACE_processing2\GRACE_results\gird_025_GSM_GFZ_RL06_DUAN_flt300_2002_2024_leakagefree.mat'</span>;<br>output_dir = <span class="hljs-string">'grid_tws'</span>;<br><br><span class="hljs-keyword">if</span> ~exist(output_dir, <span class="hljs-string">'dir'</span>)<br>    mkdir(output_dir);<br><span class="hljs-keyword">end</span><br><br>load(file_path);<br>str_year = str2double(<span class="hljs-built_in">reshape</span>(str_year, <span class="hljs-number">233</span>, <span class="hljs-number">1</span>));<br>str_month = str2double(<span class="hljs-built_in">reshape</span>(str_month, <span class="hljs-number">233</span>, <span class="hljs-number">1</span>));<br><br>[path_str, name, ext] = fileparts(file_path);<br>output_file_name = [name, ext];<br><br>output_file_path = fullfile(output_dir, output_file_name);<br>save(output_file_path, <span class="hljs-string">'grid_data'</span>, <span class="hljs-string">'str_year'</span>, <span class="hljs-string">'str_month'</span>, <span class="hljs-string">'time'</span>, <span class="hljs-string">'-v7.3'</span>);<br><br>fprintf(<span class="hljs-string">'已保存文件: %s\n'</span>, output_file_path);<br><br></code></pre></td></tr></table></figure><p>运行后格式转换后的结果保存在<code>workdir/grid_tws/</code>路径下。</p><p>9.打开main_hybrid_pipeline.py，绘制grid tws空间分布图，在main函数中执行以下代码（这里不再展示初始化lgd处理器的代码）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-comment"># 执行第9步前必须更新TWS grid文件路径（tws_grid_filepath）、绘制的日期列表（date_spec)，同时可指定</span><br><span class="hljs-comment"># 绘图显示范围(tws_extent，不指定则使用self.lon_range和self.lat_range，指定None为全球)</span><br>processor.update_config(tws_grid_filepath=<span class="hljs-string">r'.\grid_tws\gird_025_GSM_GFZ_RL06_DUAN_flt300_2002_2024_leakagefree.mat'</span>)    <span class="hljs-comment"># 上一步骤生成的转化格式后的grid tws文件</span><br>processor.update_config(date_spec=[<span class="hljs-string">"2020-05"</span>, <span class="hljs-string">"2020-06"</span>, <span class="hljs-string">"2021-07"</span>, <span class="hljs-string">"2021-08"</span>])     <span class="hljs-comment"># 需要绘制的月份</span><br>processor.update_config(tws_extent=[<span class="hljs-number">80</span>, <span class="hljs-number">100</span>, <span class="hljs-number">10</span>, <span class="hljs-number">30</span>])   <span class="hljs-comment"># 绘图显示的范围</span><br><span class="hljs-comment"># processor.update_config(tws_extent=None)                # 绘图显示的范围，tws_extent=None为绘制全球</span><br>processor.execute(<span class="hljs-number">9</span>)<br><br></code></pre></td></tr></table></figure><p>注意：上面代码中指定的tws_grid_filepath需要经过第8步进行转换，相当于第8步转换后tws格网文件用于该步骤。<br>运行后绘图结果保存在<code>workdir/results/tws_grid_plots</code>路径下。</p><p>10.打开main_hybrid_pipeline.py，绘制穿过指定区域的多日lgd曲线图，在main函数中执行以下代码（这里不再展示初始化lgd处理器的代码）</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><br><span class="hljs-comment"># 执行第10步时必须更新日期列表(date_list)</span><br>date_list = [<br>    <span class="hljs-string">'2020-06-04'</span>, <span class="hljs-string">'2020-06-10'</span>, <span class="hljs-string">'2020-06-15'</span>, <span class="hljs-string">'2020-06-21'</span>, <span class="hljs-string">'2020-06-26'</span>,<br>    <span class="hljs-string">'2020-07-02'</span>, <span class="hljs-string">'2020-07-07'</span>, <span class="hljs-string">'2020-07-13'</span>, <span class="hljs-string">'2020-07-18'</span>, <span class="hljs-string">'2020-07-24'</span>, <span class="hljs-string">'2020-07-29'</span>,<br>    <span class="hljs-string">'2020-08-04'</span>, <span class="hljs-string">'2020-08-09'</span>, <span class="hljs-string">'2020-08-15'</span>, <span class="hljs-string">'2020-08-20'</span><br>]<br>processor.update_config(date_list=date_list)<br>processor.execute(<span class="hljs-number">10</span>)<br><br></code></pre></td></tr></table></figure><p>运行后绘图结果保存在<code>workdir/results</code>路径下。</p><h1 id="附件"><a href="#附件" class="headerlink" title="附件"></a>附件</h1><p>上述中涉及到的所有程序脚本都打包到压缩包中，解压后文件目录如下。</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs stylus">Scripts_grace_lri1b_lgd_20251110/<br>├── A00check_orbit_coverage<span class="hljs-selector-class">.py</span><br>├── A01get_lri_kbr_records_num<span class="hljs-selector-class">.py</span><br>├── A02read_grace_fo_shc_file<span class="hljs-selector-class">.py</span><br>├── A03read_goco06s_file<span class="hljs-selector-class">.py</span><br>├── A04combine_earth_gravity_field<span class="hljs-selector-class">.py</span><br>├── process_cwt_filter_signal_data<span class="hljs-selector-class">.m</span><br>├── S00GroopsIntegrateOrbitLRI-<span class="hljs-number">202007</span><span class="hljs-selector-class">.xml</span><br>├── S01SatelliteTrackingFromLRI-<span class="hljs-number">202007</span><span class="hljs-selector-class">.xml</span><br>├── S02compute_grace_lgd<span class="hljs-selector-class">.py</span><br>├── S02compute_grace_lgd_gapfilled<span class="hljs-selector-class">.py</span><br>├── S03cwt_filter_lgd_ra<span class="hljs-selector-class">.m</span><br>├── S04lgd_ra_ipsd<span class="hljs-selector-class">.py</span><br>├── S05plot_lgd_ra_cwt_filter<span class="hljs-selector-class">.py</span><br>├── S05plot_lgd_ra_cwt_filter_gapfilled<span class="hljs-selector-class">.py</span><br>├── S06compare_pnas_data<span class="hljs-selector-class">.py</span><br>├── S07plot_lgd_ra_spatial_map<span class="hljs-selector-class">.py</span><br>├── S08convert_twsgrid_format_from_fengwei_toolbox<span class="hljs-selector-class">.m</span><br>├── S09plot_GRACE_L2_monthly_tws_from_matlab<span class="hljs-selector-class">.py</span><br>├── S10plot_lgd_ra_multi_time_series_cross_over_area<span class="hljs-selector-class">.py</span><br>└── main_hybrid_pipeline.py<br></code></pre></td></tr></table></figure><p>下载链接：<a href="/downloads/Scripts_grace_lri1b_lgd_20251111.zip" download>GRACE-FO LRI1B多日数据反演LGD和RA脚本</a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GRACE</tag>
      
      <tag>GRACE-FO</tag>
      
      <tag>Python</tag>
      
      <tag>LGD</tag>
      
      <tag>ASD</tag>
      
      <tag>GROOPS</tag>
      
      <tag>LRI1B</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>详细介绍利用GRACE1B单日数据计算LGD工作流程二(基于LRI1B单日数据)</title>
    <link href="/2025/09/27/%E8%AF%A6%E7%BB%86%E4%BB%8B%E7%BB%8D%E5%88%A9%E7%94%A8GRACE1B%E5%8D%95%E6%97%A5%E6%95%B0%E6%8D%AE%E8%AE%A1%E7%AE%97LGD%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B%E4%BA%8C/"/>
    <url>/2025/09/27/%E8%AF%A6%E7%BB%86%E4%BB%8B%E7%BB%8D%E5%88%A9%E7%94%A8GRACE1B%E5%8D%95%E6%97%A5%E6%95%B0%E6%8D%AE%E8%AE%A1%E7%AE%97LGD%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B%E4%BA%8C/</url>
    
    <content type="html"><![CDATA[<h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>此前的文章<a href="https://singyutang.github.io/2025/09/23/%E8%AF%A6%E7%BB%86%E4%BB%8B%E7%BB%8D%E5%88%A9%E7%94%A8GRACE1B%E6%95%B0%E6%8D%AE%E8%AE%A1%E7%AE%97LGD%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B/">详细介绍利用GRACE1B单日数据计算LGD工作流程一(基于KBR1B单日数据)</a>已经介绍了如何利用KBR1B数据计算RA和LGD，详细计算流程可参照该文章。本文只是更新基于LRI1B数据计算RA和LGD的处理脚本，脚本可跳转附件进行下载。</p><h1 id="附件"><a href="#附件" class="headerlink" title="附件"></a>附件</h1><p>所有程序脚本都打包到压缩包中，解压后文件目录如下。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs Shell">Scripts_grace_lri1b_lgd_20250927/<br>├── process_cwt_fliter_signal_data.m<br>├── S00GroopsIntegrateOrbitLRI-20200707.xml<br>├── S01SatelliteTrackingFromLRI-20200707.xml<br>├── S02compute_grace_lgd.py<br>├── S03cwt_fliter_lgd_ra.m<br>├── S04lgd_ra_lpsd.py<br>└── S05plot_lgd_ra_cwt_filter.py<br><br></code></pre></td></tr></table></figure><p>下载链接：<a href="/downloads/Scripts_grace_lri1b_lgd_20250927.zip" download>GRACE-FO LRI1B单日数据反演LGD和RA脚本</a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GRACE</tag>
      
      <tag>GRACE-FO</tag>
      
      <tag>Python</tag>
      
      <tag>LGD</tag>
      
      <tag>ASD</tag>
      
      <tag>GROOPS</tag>
      
      <tag>LRI1B</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>信号处理中的一些概念</title>
    <link href="/2025/09/23/%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86%E4%B8%AD%E7%9A%84%E4%B8%80%E4%BA%9B%E6%A6%82%E5%BF%B5/"/>
    <url>/2025/09/23/%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86%E4%B8%AD%E7%9A%84%E4%B8%80%E4%BA%9B%E6%A6%82%E5%BF%B5/</url>
    
    <content type="html"><![CDATA[<h1 id="1-能量与功率的区别"><a href="#1-能量与功率的区别" class="headerlink" title="1. 能量与功率的区别"></a>1. 能量与功率的区别</h1><h2 id="1-1-定义"><a href="#1-1-定义" class="headerlink" title="1.1 定义"></a>1.1 定义</h2><p>能量(Energy)：信号在一段时间内包含的总“力度”，数学上是平方后积分。信号<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="3.871ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 1711 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mo" transform="translate(572,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(961,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(1322,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>的能量<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.729ex" height="1.538ex" role="img" focusable="false" viewBox="0 -680 764 680"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path></g></g></g></svg></mjx-container>为</p><p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -3.663ex;" xmlns="http://www.w3.org/2000/svg" width="17.778ex" height="8.128ex" role="img" focusable="false" viewBox="0 -1973.5 7857.9 3592.5"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mstyle"><g data-mml-node="mi"><path data-c="1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path></g><g data-mml-node="mo" transform="translate(1041.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="munderover" transform="translate(2097.6,0)"><g data-mml-node="mo" transform="translate(447.6,0) translate(0 1)"><path data-c="222B" d="M114 -798Q132 -824 165 -824H167Q195 -824 223 -764T275 -600T320 -391T362 -164Q365 -143 367 -133Q439 292 523 655T645 1127Q651 1145 655 1157T672 1201T699 1257T733 1306T777 1346T828 1360Q884 1360 912 1325T944 1245Q944 1220 932 1205T909 1186T887 1183Q866 1183 849 1198T832 1239Q832 1287 885 1296L882 1300Q879 1303 874 1307T866 1313Q851 1323 833 1323Q819 1323 807 1311T775 1255T736 1139T689 936T633 628Q574 293 510 -5T410 -437T355 -629Q278 -862 165 -862Q125 -862 92 -831T55 -746Q55 -711 74 -698T112 -685Q133 -685 150 -700T167 -741Q167 -789 114 -798Z"></path></g><g data-mml-node="TeXAtom" transform="translate(0,-1461) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mi" transform="translate(778,0)"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(857.1,1561) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g></g></g><g data-mml-node="mo" transform="translate(3828.4,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mi" transform="translate(4106.4,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mo" transform="translate(4678.4,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(5067.4,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(5428.4,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="msup" transform="translate(5817.4,0)"><g data-mml-node="mo" transform="translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="TeXAtom" transform="translate(311,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g><g data-mml-node="mstyle" transform="translate(6531.9,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(6698.9,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(7218.9,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(7579.9,0)"><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path></g></g></g></g></g></svg></mjx-container></p><p>功率(Power)：能量随时间的“速率”，即每单位时间平均能量。信号<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="3.871ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 1711 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mo" transform="translate(572,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(961,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(1322,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>的平均功率<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.699ex" height="1.545ex" role="img" focusable="false" viewBox="0 -683 751 683"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g></g></g></svg></mjx-container>（时域）为</p><p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -2.159ex;" xmlns="http://www.w3.org/2000/svg" width="25.568ex" height="5.704ex" role="img" focusable="false" viewBox="0 -1566.8 11301.1 2521.1"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mstyle"><g data-mml-node="mi"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mo" transform="translate(1028.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="munder" transform="translate(2084.6,0)"><g data-mml-node="mo" transform="translate(261.5,0)"><path data-c="6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124T104 167T104 217T104 272T104 329Q104 366 104 407T104 482T104 542T103 586T103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693T182 694H185V379Q185 62 186 60Q190 52 198 49Q219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3T107 3T57 1L34 0H26V46H42Z"></path><path data-c="69" d="M69 609Q69 637 87 653T131 669Q154 667 171 652T188 609Q188 579 171 564T129 549Q104 549 87 564T69 609ZM247 0Q232 3 143 3Q132 3 106 3T56 1L34 0H26V46H42Q70 46 91 49Q100 53 102 60T104 102V205V293Q104 345 102 359T88 378Q74 385 41 385H30V408Q30 431 32 431L42 432Q52 433 70 434T106 436Q123 437 142 438T171 441T182 442H185V62Q190 52 197 50T232 46H255V0H247Z" transform="translate(278,0)"></path><path data-c="6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z" transform="translate(556,0)"></path></g><g data-mml-node="TeXAtom" transform="translate(0,-645.7) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mo" transform="translate(704,0)"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g><g data-mml-node="mi" transform="translate(1704,0)"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g></g></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(4163.2,0)"><g data-mml-node="mfrac"><g data-mml-node="mn" transform="translate(572,676)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mrow" transform="translate(220,-686)"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(500,0)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g></g><rect width="1404" height="60" x="120" y="220"></rect></g></g><g data-mml-node="msubsup" transform="translate(5973.9,0)"><g data-mml-node="mo" transform="translate(0 1)"><path data-c="222B" d="M114 -798Q132 -824 165 -824H167Q195 -824 223 -764T275 -600T320 -391T362 -164Q365 -143 367 -133Q439 292 523 655T645 1127Q651 1145 655 1157T672 1201T699 1257T733 1306T777 1346T828 1360Q884 1360 912 1325T944 1245Q944 1220 932 1205T909 1186T887 1183Q866 1183 849 1198T832 1239Q832 1287 885 1296L882 1300Q879 1303 874 1307T866 1313Q851 1323 833 1323Q819 1323 807 1311T775 1255T736 1139T689 936T633 628Q574 293 510 -5T410 -437T355 -629Q278 -862 165 -862Q125 -862 92 -831T55 -746Q55 -711 74 -698T112 -685Q133 -685 150 -700T167 -741Q167 -789 114 -798Z"></path></g><g data-mml-node="TeXAtom" transform="translate(1046.4,1088.1) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(589,-896.4) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mi" transform="translate(778,0)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g></g></g><g data-mml-node="mi" transform="translate(7827.5,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mo" transform="translate(8399.5,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(8788.5,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="msup" transform="translate(9149.5,0)"><g data-mml-node="mo"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="TeXAtom" transform="translate(422,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g><g data-mml-node="mstyle" transform="translate(9975.1,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(10142.1,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(10662.1,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(11023.1,0)"><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path></g></g></g></g></g></svg></mjx-container></p><p>根据Parseval 定理，可以得出频域功率为：</p><p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.902ex;" xmlns="http://www.w3.org/2000/svg" width="30.435ex" height="2.814ex" role="img" focusable="false" viewBox="0 -845.1 13452.5 1243.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msubsup"><g data-mml-node="mo" transform="translate(0 0.5)"><path data-c="222B" d="M113 -244Q113 -246 119 -251T139 -263T167 -269Q186 -269 199 -260Q220 -247 232 -218T251 -133T262 -15T276 155T297 367Q300 390 305 438T314 512T325 580T340 647T361 703T390 751T428 784T479 804Q481 804 488 804T501 805Q552 802 581 769T610 695Q610 669 594 657T561 645Q542 645 527 658T512 694Q512 705 516 714T526 729T538 737T548 742L552 743Q552 745 545 751T525 762T498 768Q475 768 460 756T434 716T418 652T407 559T398 444T387 300T369 133Q349 -38 337 -102T303 -207Q256 -306 169 -306Q119 -306 87 -272T55 -196Q55 -170 71 -158T104 -146Q123 -146 138 -159T153 -195Q153 -206 149 -215T139 -230T127 -238T117 -242L113 -244Z"></path></g><g data-mml-node="TeXAtom" transform="translate(699.9,532.6) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(505,-340.9) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mi" transform="translate(778,0)"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g></g></g><g data-mml-node="mo" transform="translate(1978.9,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mi" transform="translate(2256.9,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mo" transform="translate(2828.9,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(3217.9,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(3578.9,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="msup" transform="translate(3967.9,0)"><g data-mml-node="mo" transform="translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mn" transform="translate(311,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mstyle" transform="translate(4682.5,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(4849.5,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(5369.5,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(6008.2,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msubsup" transform="translate(7064,0)"><g data-mml-node="mo" transform="translate(0 0.5)"><path data-c="222B" d="M113 -244Q113 -246 119 -251T139 -263T167 -269Q186 -269 199 -260Q220 -247 232 -218T251 -133T262 -15T276 155T297 367Q300 390 305 438T314 512T325 580T340 647T361 703T390 751T428 784T479 804Q481 804 488 804T501 805Q552 802 581 769T610 695Q610 669 594 657T561 645Q542 645 527 658T512 694Q512 705 516 714T526 729T538 737T548 742L552 743Q552 745 545 751T525 762T498 768Q475 768 460 756T434 716T418 652T407 559T398 444T387 300T369 133Q349 -38 337 -102T303 -207Q256 -306 169 -306Q119 -306 87 -272T55 -196Q55 -170 71 -158T104 -146Q123 -146 138 -159T153 -195Q153 -206 149 -215T139 -230T127 -238T117 -242L113 -244Z"></path></g><g data-mml-node="TeXAtom" transform="translate(699.9,532.6) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(505,-340.9) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mi" transform="translate(778,0)"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g></g></g><g data-mml-node="mo" transform="translate(9042.9,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mi" transform="translate(9320.9,0)"><path data-c="1D44B" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path></g><g data-mml-node="mo" transform="translate(10172.9,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(10561.9,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(11111.9,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="msup" transform="translate(11500.9,0)"><g data-mml-node="mo" transform="translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mn" transform="translate(311,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mstyle" transform="translate(12215.5,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(12382.5,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(12902.5,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g></g></g></svg></mjx-container>，其中<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="4.932ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 2180 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D44B" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path></g><g data-mml-node="mo" transform="translate(852,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1241,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(1791,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>是信号<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="3.871ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 1711 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mo" transform="translate(572,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(961,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(1322,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>的傅里叶变换。</p><p>换句话说，信号的能量（或功率）可以在时域和频域两种方式计算，结果相等。这就是“频谱中的功率”的核心。</p><p>能量信号（比如脉冲）：能量有限，但功率为0（因为时间趋近无穷，平均下来越来越小）。<br>功率信号（比如正弦波、噪声）：能量无限，但功率有限（因为每一秒里，能量是稳定的）。</p><h2 id="1-2-物理类比"><a href="#1-2-物理类比" class="headerlink" title="1.2 物理类比"></a>1.2 物理类比</h2><p>你可以类比电功率：</p><p>电压<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="3.674ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 1624 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"></path></g><g data-mml-node="mo" transform="translate(485,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(874,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(1235,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>，电流<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="3.357ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 1484 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(345,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(734,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(1095,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>。</p><p>瞬时功率：<br><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="13.764ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 6083.6 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mo" transform="translate(503,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(892,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(1253,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(1919.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(2975.6,0)"><path data-c="1D463" d="M173 380Q173 405 154 405Q130 405 104 376T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Q21 294 29 316T53 368T97 419T160 441Q202 441 225 417T249 361Q249 344 246 335Q246 329 231 291T200 202T182 113Q182 86 187 69Q200 26 250 26Q287 26 319 60T369 139T398 222T409 277Q409 300 401 317T383 343T365 361T357 383Q357 405 376 424T417 443Q436 443 451 425T467 367Q467 340 455 284T418 159T347 40T241 -11Q177 -11 139 22Q102 54 102 117Q102 148 110 181T151 298Q173 362 173 380Z"></path></g><g data-mml-node="mo" transform="translate(3460.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(3849.6,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(4210.6,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mi" transform="translate(4599.6,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(4944.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(5333.6,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(5694.6,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container></p><p>平均功率：<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.781ex;" xmlns="http://www.w3.org/2000/svg" width="9.964ex" height="2.737ex" role="img" focusable="false" viewBox="0 -864.9 4404.1 1209.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mfrac"><g data-mml-node="mn" transform="translate(292.1,394) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(220,-345) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><rect width="697.8" height="60" x="120" y="220"></rect></g><g data-mml-node="mo" transform="translate(1104.5,0) translate(0 0.5)"><path data-c="222B" d="M113 -244Q113 -246 119 -251T139 -263T167 -269Q186 -269 199 -260Q220 -247 232 -218T251 -133T262 -15T276 155T297 367Q300 390 305 438T314 512T325 580T340 647T361 703T390 751T428 784T479 804Q481 804 488 804T501 805Q552 802 581 769T610 695Q610 669 594 657T561 645Q542 645 527 658T512 694Q512 705 516 714T526 729T538 737T548 742L552 743Q552 745 545 751T525 762T498 768Q475 768 460 756T434 716T418 652T407 559T398 444T387 300T369 133Q349 -38 337 -102T303 -207Q256 -306 169 -306Q119 -306 87 -272T55 -196Q55 -170 71 -158T104 -146Q123 -146 138 -159T153 -195Q153 -206 149 -215T139 -230T127 -238T117 -242L113 -244Z"></path></g><g data-mml-node="mi" transform="translate(1881.1,0)"><path data-c="1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></g><g data-mml-node="mo" transform="translate(2384.1,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(2773.1,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(3134.1,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mi" transform="translate(3523.1,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(4043.1,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g></g></g></svg></mjx-container>。</p><p>同样地，信号的幅值平方<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="13.155ex" height="2.452ex" role="img" focusable="false" viewBox="0 -833.9 5814.7 1083.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><text data-variant="italic" transform="scale(1,-1)" font-size="884px" font-family="serif" font-style="italic">（</text></g><g data-mml-node="mo" transform="translate(1277.8,0)"><path data-c="2223" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mi" transform="translate(1833.6,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mo" transform="translate(2405.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(2794.6,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(3155.6,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="msup" transform="translate(3822.3,0)"><g data-mml-node="mo"><path data-c="2223" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mn" transform="translate(311,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mi" transform="translate(4814.7,0)"><text data-variant="italic" transform="scale(1,-1)" font-size="884px" font-family="serif" font-style="italic">）</text></g></g></g></svg></mjx-container>相当于“瞬时能量”，它的平均值就是“功率”。</p><h2 id="1-3-例子"><a href="#1-3-例子" class="headerlink" title="1.3 例子"></a>1.3 例子</h2><ul><li>有限脉冲信号（比如1 秒钟的矩形波）：</li></ul><p>总能量有限。</p><p>拉长时间去平均→ 功率为0。</p><ul><li>无限正弦波<br><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="17.965ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 7940.6 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mo" transform="translate(572,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(961,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(1322,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(1988.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mi" transform="translate(3044.6,0)"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mi" transform="translate(3794.6,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path></g><g data-mml-node="mi" transform="translate(4227.6,0)"><path data-c="1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path></g><g data-mml-node="mi" transform="translate(4712.6,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mo" transform="translate(5181.6,0)"><path data-c="2061" d=""></path></g><g data-mml-node="mo" transform="translate(5181.6,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mn" transform="translate(5570.6,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(6070.6,0)"><path data-c="1D70B" d="M132 -11Q98 -11 98 22V33L111 61Q186 219 220 334L228 358H196Q158 358 142 355T103 336Q92 329 81 318T62 297T53 285Q51 284 38 284Q19 284 19 294Q19 300 38 329T93 391T164 429Q171 431 389 431Q549 431 553 430Q573 423 573 402Q573 371 541 360Q535 358 472 358H408L405 341Q393 269 393 222Q393 170 402 129T421 65T431 37Q431 20 417 5T381 -10Q370 -10 363 -7T347 17T331 77Q330 86 330 121Q330 170 339 226T357 318T367 358H269L268 354Q268 351 249 275T206 114T175 17Q164 -11 132 -11Z"></path></g><g data-mml-node="mi" transform="translate(6640.6,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mi" transform="translate(7190.6,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(7551.6,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>：</li></ul><p>总能量无穷（因为它一直在震荡）。</p><p>平均功率有限：</p><p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -1.202ex;" xmlns="http://www.w3.org/2000/svg" width="42.764ex" height="3.607ex" role="img" focusable="false" viewBox="0 -1062.9 18901.8 1594.2"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mo" transform="translate(1028.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="munder" transform="translate(2084.6,0)"><g data-mml-node="mo"><path data-c="6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124T104 167T104 217T104 272T104 329Q104 366 104 407T104 482T104 542T103 586T103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693T182 694H185V379Q185 62 186 60Q190 52 198 49Q219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3T107 3T57 1L34 0H26V46H42Z"></path><path data-c="69" d="M69 609Q69 637 87 653T131 669Q154 667 171 652T188 609Q188 579 171 564T129 549Q104 549 87 564T69 609ZM247 0Q232 3 143 3Q132 3 106 3T56 1L34 0H26V46H42Q70 46 91 49Q100 53 102 60T104 102V205V293Q104 345 102 359T88 378Q74 385 41 385H30V408Q30 431 32 431L42 432Q52 433 70 434T106 436Q123 437 142 438T171 441T182 442H185V62Q190 52 197 50T232 46H255V0H247Z" transform="translate(278,0)"></path><path data-c="6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z" transform="translate(556,0)"></path></g><g data-mml-node="TeXAtom" transform="translate(1422,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mo" transform="translate(704,0)"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g><g data-mml-node="mi" transform="translate(1704,0)"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g></g></g><g data-mml-node="mfrac" transform="translate(5635.2,0)"><g data-mml-node="mn" transform="translate(292.1,394) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(220,-345) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><rect width="697.8" height="60" x="120" y="220"></rect></g><g data-mml-node="msubsup" transform="translate(6739.7,0)"><g data-mml-node="mo" transform="translate(0 0.5)"><path data-c="222B" d="M113 -244Q113 -246 119 -251T139 -263T167 -269Q186 -269 199 -260Q220 -247 232 -218T251 -133T262 -15T276 155T297 367Q300 390 305 438T314 512T325 580T340 647T361 703T390 751T428 784T479 804Q481 804 488 804T501 805Q552 802 581 769T610 695Q610 669 594 657T561 645Q542 645 527 658T512 694Q512 705 516 714T526 729T538 737T548 742L552 743Q552 745 545 751T525 762T498 768Q475 768 460 756T434 716T418 652T407 559T398 444T387 300T369 133Q349 -38 337 -102T303 -207Q256 -306 169 -306Q119 -306 87 -272T55 -196Q55 -170 71 -158T104 -146Q123 -146 138 -159T153 -195Q153 -206 149 -215T139 -230T127 -238T117 -242L113 -244Z"></path></g><g data-mml-node="TeXAtom" transform="translate(699.9,532.6) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(704,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"></path></g></g><g data-mml-node="mn" transform="translate(1204,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(505,-354.5) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mi" transform="translate(778,0)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(1482,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"></path></g></g><g data-mml-node="mn" transform="translate(1982,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g><g data-mml-node="msup" transform="translate(9216.4,0)"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mn" transform="translate(783,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="msup" transform="translate(10569.6,0)"><g data-mml-node="mi"><path data-c="63" d="M370 305T349 305T313 320T297 358Q297 381 312 396Q317 401 317 402T307 404Q281 408 258 408Q209 408 178 376Q131 329 131 219Q131 137 162 90Q203 29 272 29Q313 29 338 55T374 117Q376 125 379 127T395 129H409Q415 123 415 120Q415 116 411 104T395 71T366 33T318 2T249 -11Q163 -11 99 53T34 214Q34 318 99 383T250 448T370 421T404 357Q404 334 387 320Z"></path><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z" transform="translate(444,0)"></path><path data-c="73" d="M295 316Q295 356 268 385T190 414Q154 414 128 401Q98 382 98 349Q97 344 98 336T114 312T157 287Q175 282 201 278T245 269T277 256Q294 248 310 236T342 195T359 133Q359 71 321 31T198 -10H190Q138 -10 94 26L86 19L77 10Q71 4 65 -1L54 -11H46H42Q39 -11 33 -5V74V132Q33 153 35 157T45 162H54Q66 162 70 158T75 146T82 119T101 77Q136 26 198 26Q295 26 295 104Q295 133 277 151Q257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424T143 442T187 447H198Q238 447 268 432L283 424L292 431Q302 440 314 448H322H326Q329 448 335 442V310L329 304H301Q295 310 295 316Z" transform="translate(944,0)"></path></g><g data-mml-node="mn" transform="translate(1371,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(12344.2,0)"><path data-c="2061" d=""></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="OPEN" transform="translate(12344.2,0)"><g data-mml-node="mo" transform="translate(0 -0.5)"><path data-c="28" d="M152 251Q152 646 388 850H416Q422 844 422 841Q422 837 403 816T357 753T302 649T255 482T236 250Q236 124 255 19T301 -147T356 -251T403 -315T422 -340Q422 -343 416 -349H388Q359 -325 332 -296T271 -213T212 -97T170 56T152 251Z"></path></g></g><g data-mml-node="mn" transform="translate(12802.2,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(13302.2,0)"><path data-c="1D70B" d="M132 -11Q98 -11 98 22V33L111 61Q186 219 220 334L228 358H196Q158 358 142 355T103 336Q92 329 81 318T62 297T53 285Q51 284 38 284Q19 284 19 294Q19 300 38 329T93 391T164 429Q171 431 389 431Q549 431 553 430Q573 423 573 402Q573 371 541 360Q535 358 472 358H408L405 341Q393 269 393 222Q393 170 402 129T421 65T431 37Q431 20 417 5T381 -10Q370 -10 363 -7T347 17T331 77Q330 86 330 121Q330 170 339 226T357 318T367 358H269L268 354Q268 351 249 275T206 114T175 17Q164 -11 132 -11Z"></path></g><g data-mml-node="mi" transform="translate(13872.2,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mi" transform="translate(14422.2,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="CLOSE" transform="translate(14783.2,0)"><g data-mml-node="mo" transform="translate(0 -0.5)"><path data-c="29" d="M305 251Q305 -145 69 -349H56Q43 -349 39 -347T35 -338Q37 -333 60 -307T108 -239T160 -136T204 27T221 250T204 473T160 636T108 740T60 807T35 839Q35 850 50 850H56H69Q197 743 256 566Q305 425 305 251Z"></path></g></g><g data-mml-node="mstyle" transform="translate(15241.2,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(15408.2,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(15928.2,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(16567,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mfrac" transform="translate(17622.7,0)"><g data-mml-node="msup" transform="translate(220,394) scale(0.707)"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mn" transform="translate(783,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mn" transform="translate(462.7,-345) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><rect width="1039" height="60" x="120" y="220"></rect></g></g></g></svg></mjx-container></p><ul><li><p>白噪声</p><p>理论上能量无穷（因为它是无限长信号）。</p></li></ul><p>但功率可以用功率谱密度描述（比如<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="11.63ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 5140.6 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mn" transform="translate(836,-150) scale(0.707)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(1239.6,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"></path></g></g><g data-mml-node="mn" transform="translate(1739.6,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(2239.6,0)"><path data-c="1D44A" d="M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(3287.6,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"></path></g></g><g data-mml-node="mi" transform="translate(3787.6,0)"><path data-c="1D43B" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path></g><g data-mml-node="mi" transform="translate(4675.6,0)"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346T162 335T155 324L153 320Q150 317 138 317Q117 317 117 325Q117 330 120 339Q133 378 163 406T229 440Q241 442 246 442Q271 442 291 425T329 392T367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434Q468 430 463 420T449 399T432 377T418 358L411 349Q368 298 275 214T160 106L148 94L163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143Q443 138 442 134Q425 72 376 31T278 -11Q252 -11 232 6T193 40T155 57Q111 57 76 -3Q70 -11 59 -11H54H41Q35 -5 35 -2Q35 13 93 84Q132 129 225 214T340 322Q352 338 347 338Z"></path></g></g></g></svg></mjx-container>）。</p><h2 id="1-4-总结"><a href="#1-4-总结" class="headerlink" title="1.4 总结"></a>1.4 总结</h2><p>能量信号：能量有限，功率趋零。</p><p>功率信号：能量无限，但功率有限。</p><p>功率就是“信号平均每秒钟包含多少能量”，就像电学里的“瓦数”。</p><h1 id="2-能量谱密度与功率谱密度的区别"><a href="#2-能量谱密度与功率谱密度的区别" class="headerlink" title="2.能量谱密度与功率谱密度的区别"></a>2.能量谱密度与功率谱密度的区别</h1><h2 id="2-1-基本概念"><a href="#2-1-基本概念" class="headerlink" title="2.1 基本概念"></a>2.1 基本概念</h2><p>频谱：信号在频域中的分布，一般通过傅里叶变换得到。</p><p>频谱密度：在单位频率范围内的功率或能量分布情况。</p><p>时间序列 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="3.871ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 1711 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mo" transform="translate(572,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(961,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(1322,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container> 的功率谱 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="6.409ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 2832.9 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="TeXAtom" transform="translate(646,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mi" transform="translate(572,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g></g></g><g data-mml-node="mo" transform="translate(1504.9,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1893.9,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(2443.9,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container> 描述了信号功率在频域的分布状况。根据傅立叶分析，任何物理信号都可以分解成一些离散频率或连续范围的频谱。对特定信号或特定种类信号（包括噪声）频率内容的分析的统计平均，称作其频谱。</p><p>当信号的能量集中在一个有限时间区间的时候，尤其是总能量是有限的，就可以计算能量谱密度。更常用的是应用于在所有时间或很长一段时间都存在的信号的功率谱密度。由于此种持续存在的信号的总能量是无穷大，功率谱密度（英语：Power Spectral Density，缩写PSD）则是指<strong>单位时间的频谱能量分布</strong>。</p><h2 id="2-2-物理定义"><a href="#2-2-物理定义" class="headerlink" title="2.2 物理定义"></a>2.2 物理定义</h2><h3 id="2-2-1-能量谱密度（Energy-Spectral-Density，ESD）"><a href="#2-2-1-能量谱密度（Energy-Spectral-Density，ESD）" class="headerlink" title="2.2.1 能量谱密度（Energy Spectral Density，ESD）"></a>2.2.1 能量谱密度（Energy Spectral Density，ESD）</h3><p>信号<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="3.871ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 1711 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mo" transform="translate(572,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(961,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(1322,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>的能量谱密度定义为</p><p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="15.971ex" height="2.565ex" role="img" focusable="false" viewBox="0 -883.9 7059 1133.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mstyle"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="TeXAtom" transform="translate(646,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mi" transform="translate(572,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g></g></g><g data-mml-node="mo" transform="translate(1504.9,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1893.9,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(2443.9,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(3110.7,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mo" transform="translate(4166.5,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(4444.5,0)"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mover"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mo" transform="translate(313.8,16) translate(-250 0)"><path data-c="5E" d="M112 560L249 694L257 686Q387 562 387 560L361 531Q359 532 303 581L250 627L195 580Q182 569 169 557T148 538L140 532Q138 530 125 546L112 560Z"></path></g></g></g></g><g data-mml-node="mo" transform="translate(5016.5,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(5405.5,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(5955.5,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="msup" transform="translate(6344.5,0)"><g data-mml-node="mo" transform="translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="TeXAtom" transform="translate(311,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></g></g></g></g></svg></mjx-container></p><p>被积函数<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="6.544ex" height="2.565ex" role="img" focusable="false" viewBox="0 -883.9 2892.6 1133.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mstyle"><g data-mml-node="mo" transform="translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(278,0)"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mover"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mo" transform="translate(313.8,16) translate(-250 0)"><path data-c="5E" d="M112 560L249 694L257 686Q387 562 387 560L361 531Q359 532 303 581L250 627L195 580Q182 569 169 557T148 538L140 532Q138 530 125 546L112 560Z"></path></g></g></g></g><g data-mml-node="mo" transform="translate(850,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1239,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(1789,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="msup" transform="translate(2178,0)"><g data-mml-node="mo" transform="translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="TeXAtom" transform="translate(311,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></g></g></g></g></svg></mjx-container>可以理解为信号在频率<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.464ex;" xmlns="http://www.w3.org/2000/svg" width="1.244ex" height="2.059ex" role="img" focusable="false" viewBox="0 -705 550 910"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g></g></g></svg></mjx-container>处的“能量贡献”。</p><p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -3.663ex;" xmlns="http://www.w3.org/2000/svg" width="23.304ex" height="8.128ex" role="img" focusable="false" viewBox="0 -1973.5 10300.3 3592.5"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mstyle"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mover"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mo" transform="translate(313.8,16) translate(-250 0)"><path data-c="5E" d="M112 560L249 694L257 686Q387 562 387 560L361 531Q359 532 303 581L250 627L195 580Q182 569 169 557T148 538L140 532Q138 530 125 546L112 560Z"></path></g></g></g></g><g data-mml-node="mo" transform="translate(572,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(961,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(1511,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(2177.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="munderover" transform="translate(3233.6,0)"><g data-mml-node="mo" transform="translate(447.6,0) translate(0 1)"><path data-c="222B" d="M114 -798Q132 -824 165 -824H167Q195 -824 223 -764T275 -600T320 -391T362 -164Q365 -143 367 -133Q439 292 523 655T645 1127Q651 1145 655 1157T672 1201T699 1257T733 1306T777 1346T828 1360Q884 1360 912 1325T944 1245Q944 1220 932 1205T909 1186T887 1183Q866 1183 849 1198T832 1239Q832 1287 885 1296L882 1300Q879 1303 874 1307T866 1313Q851 1323 833 1323Q819 1323 807 1311T775 1255T736 1139T689 936T633 628Q574 293 510 -5T410 -437T355 -629Q278 -862 165 -862Q125 -862 92 -831T55 -746Q55 -711 74 -698T112 -685Q133 -685 150 -700T167 -741Q167 -789 114 -798Z"></path></g><g data-mml-node="TeXAtom" transform="translate(0,-1461) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mi" transform="translate(778,0)"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(857.1,1561) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g></g></g><g data-mml-node="msup" transform="translate(4964.4,0)"><g data-mml-node="mi"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="TeXAtom" transform="translate(499,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(778,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(1278,0)"><path data-c="1D70B" d="M132 -11Q98 -11 98 22V33L111 61Q186 219 220 334L228 358H196Q158 358 142 355T103 336Q92 329 81 318T62 297T53 285Q51 284 38 284Q19 284 19 294Q19 300 38 329T93 391T164 429Q171 431 389 431Q549 431 553 430Q573 423 573 402Q573 371 541 360Q535 358 472 358H408L405 341Q393 269 393 222Q393 170 402 129T421 65T431 37Q431 20 417 5T381 -10Q370 -10 363 -7T347 17T331 77Q330 86 330 121Q330 170 339 226T357 318T367 358H269L268 354Q268 351 249 275T206 114T175 17Q164 -11 132 -11Z"></path></g><g data-mml-node="mi" transform="translate(1848,0)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(2193,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mi" transform="translate(2743,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g></g></g><g data-mml-node="mi" transform="translate(7708.3,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mo" transform="translate(8280.3,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(8669.3,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(9030.3,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mi" transform="translate(9419.3,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(9939.3,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g></g></g></g></g></svg></mjx-container>是信号<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="3.871ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 1711 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mo" transform="translate(572,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(961,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(1322,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>的傅里叶变换，表示信号能量的形式。</p><p>能量谱密度描述的是信号或者时间序列的能量如何随频率分布。</p><h3 id="2-2-2-功率谱密度（Power-Spectral-Density，PSD）"><a href="#2-2-2-功率谱密度（Power-Spectral-Density，PSD）" class="headerlink" title="2.2.2 功率谱密度（Power Spectral Density，PSD）"></a>2.2.2 功率谱密度（Power Spectral Density，PSD）</h3><p>功率谱密度可以被定义为</p><p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -1.705ex;" xmlns="http://www.w3.org/2000/svg" width="26.917ex" height="3.705ex" role="img" focusable="false" viewBox="0 -883.9 11897.2 1637.4"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mstyle"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="TeXAtom" transform="translate(646,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mi" transform="translate(572,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g></g></g><g data-mml-node="mo" transform="translate(1504.9,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1893.9,0)"><path data-c="1D714" d="M495 384Q495 406 514 424T555 443Q574 443 589 425T604 364Q604 334 592 278T555 155T483 38T377 -11Q297 -11 267 66Q266 68 260 61Q201 -11 125 -11Q15 -11 15 139Q15 230 56 325T123 434Q135 441 147 436Q160 429 160 418Q160 406 140 379T94 306T62 208Q61 202 61 187Q61 124 85 100T143 76Q201 76 245 129L253 137V156Q258 297 317 297Q348 297 348 261Q348 243 338 213T318 158L308 135Q309 133 310 129T318 115T334 97T358 83T393 76Q456 76 501 148T546 274Q546 305 533 325T508 357T495 384Z"></path></g><g data-mml-node="mo" transform="translate(2515.9,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(3182.7,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="munder" transform="translate(4238.5,0)"><g data-mml-node="mo" transform="translate(261.5,0)"><path data-c="6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124T104 167T104 217T104 272T104 329Q104 366 104 407T104 482T104 542T103 586T103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693T182 694H185V379Q185 62 186 60Q190 52 198 49Q219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3T107 3T57 1L34 0H26V46H42Z"></path><path data-c="69" d="M69 609Q69 637 87 653T131 669Q154 667 171 652T188 609Q188 579 171 564T129 549Q104 549 87 564T69 609ZM247 0Q232 3 143 3Q132 3 106 3T56 1L34 0H26V46H42Q70 46 91 49Q100 53 102 60T104 102V205V293Q104 345 102 359T88 378Q74 385 41 385H30V408Q30 431 32 431L42 432Q52 433 70 434T106 436Q123 437 142 438T171 441T182 442H185V62Q190 52 197 50T232 46H255V0H247Z" transform="translate(278,0)"></path><path data-c="6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z" transform="translate(556,0)"></path></g><g data-mml-node="TeXAtom" transform="translate(0,-645.7) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mo" transform="translate(704,0)"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g><g data-mml-node="mi" transform="translate(1704,0)"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g></g></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(6317.2,0)"><g data-mml-node="mi"><path data-c="1D404" d="M723 286Q721 284 700 145T677 3V0H39V62H147V618H39V680H660V676Q662 670 675 552T691 428V424H629V428Q629 429 627 448T618 494T601 541Q574 593 527 605T382 618H374H304V384H336Q338 384 347 384T361 384T376 386T392 390T407 397T421 407T432 423Q442 444 443 482V501H505V205H443V224Q442 258 435 278T411 307T380 318T336 322H304V62H375H394Q429 62 449 62T497 66T541 76T577 95T609 126T632 170T651 232Q661 287 661 289H723V286Z"></path></g></g><g data-mml-node="mrow" transform="translate(7239.8,0)"><g data-mml-node="mo" transform="translate(0 -0.5)"><path data-c="5B" d="M202 -349V850H394V810H242V-309H394V-349H202Z"></path></g><g data-mml-node="mo" transform="translate(417,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="msub" transform="translate(695,0)"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mover"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mo" transform="translate(313.8,16) translate(-250 0)"><path data-c="5E" d="M112 560L249 694L257 686Q387 562 387 560L361 531Q359 532 303 581L250 627L195 580Q182 569 169 557T148 538L140 532Q138 530 125 546L112 560Z"></path></g></g></g></g><g data-mml-node="TeXAtom" transform="translate(605,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g></g></g><g data-mml-node="mo" transform="translate(1847.8,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(2236.8,0)"><path data-c="1D714" d="M495 384Q495 406 514 424T555 443Q574 443 589 425T604 364Q604 334 592 278T555 155T483 38T377 -11Q297 -11 267 66Q266 68 260 61Q201 -11 125 -11Q15 -11 15 139Q15 230 56 325T123 434Q135 441 147 436Q160 429 160 418Q160 406 140 379T94 306T62 208Q61 202 61 187Q61 124 85 100T143 76Q201 76 245 129L253 137V156Q258 297 317 297Q348 297 348 261Q348 243 338 213T318 158L308 135Q309 133 310 129T318 115T334 97T358 83T393 76Q456 76 501 148T546 274Q546 305 533 325T508 357T495 384Z"></path></g><g data-mml-node="mo" transform="translate(2858.8,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="msup" transform="translate(3247.8,0)"><g data-mml-node="mo" transform="translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="TeXAtom" transform="translate(311,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g><g data-mml-node="mo" transform="translate(3962.4,0) translate(0 -0.5)"><path data-c="5D" d="M22 810V850H214V-349H22V-309H174V810H22Z"></path></g></g><g data-mml-node="mo" transform="translate(11619.2,0)"><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path></g></g></g></g></g></svg></mjx-container></p><p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="4.462ex" height="2.398ex" role="img" focusable="false" viewBox="0 -810 1972 1060"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mstyle"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mover"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mo" transform="translate(313.8,16) translate(-250 0)"><path data-c="5E" d="M112 560L249 694L257 686Q387 562 387 560L361 531Q359 532 303 581L250 627L195 580Q182 569 169 557T148 538L140 532Q138 530 125 546L112 560Z"></path></g></g></g></g><g data-mml-node="mo" transform="translate(572,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(961,0)"><path data-c="1D714" d="M495 384Q495 406 514 424T555 443Q574 443 589 425T604 364Q604 334 592 278T555 155T483 38T377 -11Q297 -11 267 66Q266 68 260 61Q201 -11 125 -11Q15 -11 15 139Q15 230 56 325T123 434Q135 441 147 436Q160 429 160 418Q160 406 140 379T94 306T62 208Q61 202 61 187Q61 124 85 100T143 76Q201 76 245 129L253 137V156Q258 297 317 297Q348 297 348 261Q348 243 338 213T318 158L308 135Q309 133 310 129T318 115T334 97T358 83T393 76Q456 76 501 148T546 274Q546 305 533 325T508 357T495 384Z"></path></g><g data-mml-node="mo" transform="translate(1583,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></g></g></svg></mjx-container>为信号<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="3.871ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 1711 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mo" transform="translate(572,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(961,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(1322,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>有限区间<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="4.988ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 2204.7 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path></g><g data-mml-node="mn" transform="translate(278,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g><g data-mml-node="mo" transform="translate(778,0)"><path data-c="2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path></g><g data-mml-node="mi" transform="translate(1222.7,0)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mo" transform="translate(1926.7,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path></g></g></g></svg></mjx-container>内的傅里叶变换，<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.729ex" height="1.538ex" role="img" focusable="false" viewBox="0 -680 764 680"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D438" d="M492 213Q472 213 472 226Q472 230 477 250T482 285Q482 316 461 323T364 330H312Q311 328 277 192T243 52Q243 48 254 48T334 46Q428 46 458 48T518 61Q567 77 599 117T670 248Q680 270 683 272Q690 274 698 274Q718 274 718 261Q613 7 608 2Q605 0 322 0H133Q31 0 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H757Q764 676 764 669Q764 664 751 557T737 447Q735 440 717 440H705Q698 445 698 453L701 476Q704 500 704 528Q704 558 697 578T678 609T643 625T596 632T532 634H485Q397 633 392 631Q388 629 386 622Q385 619 355 499T324 377Q347 376 372 376H398Q464 376 489 391T534 472Q538 488 540 490T557 493Q562 493 565 493T570 492T572 491T574 487T577 483L544 351Q511 218 508 216Q505 213 492 213Z"></path></g></g></g></svg></mjx-container>为期望值。</p><p>对于有限能量的信号：功率集中在离散频率点上（如正弦波的频谱是若干尖锐谱线）。</p><p>对于随机噪声类信号：功率分布在整个频带，需用功率谱密度PSD描述。功率谱密度表示单位频率带宽内的平均功率。</p><p>举个例子：</p><p>单一正弦波信号：功率集中在它的频率点上→ 频谱上只有一根谱线，功率等于波形在时域中的功率。</p><p>白噪声信号：功率均匀分布在所有频率→ 频谱是平的，每个频率点功率一样。</p><p>纵坐标换为对数</p><p>正弦波在50 Hz 处的谱线变得更明</p><p>白噪声的谱线在对数坐标下表现为接近水平的直线，更容易看出功率分</p><h2 id="2-3-区别总结"><a href="#2-3-区别总结" class="headerlink" title="2.3 区别总结"></a>2.3 区别总结</h2><p>ESD：适用于能量有限的非周期信号。关注能量随频率分布，多用于有限时长的确定性信号。</p><p>PSD：适用于功率有限的随机过程（如噪声）。关注功率随频率分布，多用于随机信号和长期过程（如噪声分析）。</p><p>ESD：适合有限能量信号（如单次脉冲、有限长度信号）。</p><p>PSD：适合随机过程或无限长信号（如噪声、周期信号），描述的是功率随频率的分布。</p><p>ESD (上图，蓝色)：描述信号能量如何在不同频率上分布。因为这里的信号是有限时长的，所以ESD 在50 Hz 和120 Hz 处出现两个明显峰值，代表能量集中。</p><p>PSD (下图，红色)：描述单位带宽内的平均功率随频率分布情况。通过Welch 方法平滑估计，可以看到在50 Hz 和120 Hz 附近有两个清晰的尖峰，而且背景噪声部分也被展现出来。</p><h2 id="2-5-相关概念"><a href="#2-5-相关概念" class="headerlink" title="2.5 相关概念"></a>2.5 相关概念</h2><ul><li>傅立叶分析的结果之一就是帕塞瓦尔定理，这个定理表明<strong>能量谱密度曲线下的面积等于信号幅度平方下的面积</strong>，总的能量是：</li></ul><p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -2.159ex;" xmlns="http://www.w3.org/2000/svg" width="28.803ex" height="5.328ex" role="img" focusable="false" viewBox="0 -1400.6 12730.9 2354.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="TeXAtom" data-mjx-texclass="ORD"><g data-mml-node="mstyle"><g data-mml-node="msubsup"><g data-mml-node="mo" transform="translate(0 1)"><path data-c="222B" d="M114 -798Q132 -824 165 -824H167Q195 -824 223 -764T275 -600T320 -391T362 -164Q365 -143 367 -133Q439 292 523 655T645 1127Q651 1145 655 1157T672 1201T699 1257T733 1306T777 1346T828 1360Q884 1360 912 1325T944 1245Q944 1220 932 1205T909 1186T887 1183Q866 1183 849 1198T832 1239Q832 1287 885 1296L882 1300Q879 1303 874 1307T866 1313Q851 1323 833 1323Q819 1323 807 1311T775 1255T736 1139T689 936T633 628Q574 293 510 -5T410 -437T355 -629Q278 -862 165 -862Q125 -862 92 -831T55 -746Q55 -711 74 -698T112 -685Q133 -685 150 -700T167 -741Q167 -789 114 -798Z"></path></g><g data-mml-node="TeXAtom" transform="translate(1046.4,1088.1) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(589,-896.4) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mi" transform="translate(778,0)"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g></g></g><g data-mml-node="msup" transform="translate(2062.9,0)"><g data-mml-node="mrow"><g data-mml-node="mo" transform="translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(828,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1217,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(1578,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(1967,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(2278,477.1) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g><g data-mml-node="mi" transform="translate(4744.5,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(5264.5,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(5903.2,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msubsup" transform="translate(6959,0)"><g data-mml-node="mo" transform="translate(0 1)"><path data-c="222B" d="M114 -798Q132 -824 165 -824H167Q195 -824 223 -764T275 -600T320 -391T362 -164Q365 -143 367 -133Q439 292 523 655T645 1127Q651 1145 655 1157T672 1201T699 1257T733 1306T777 1346T828 1360Q884 1360 912 1325T944 1245Q944 1220 932 1205T909 1186T887 1183Q866 1183 849 1198T832 1239Q832 1287 885 1296L882 1300Q879 1303 874 1307T866 1313Q851 1323 833 1323Q819 1323 807 1311T775 1255T736 1139T689 936T633 628Q574 293 510 -5T410 -437T355 -629Q278 -862 165 -862Q125 -862 92 -831T55 -746Q55 -711 74 -698T112 -685Q133 -685 150 -700T167 -741Q167 -789 114 -798Z"></path></g><g data-mml-node="TeXAtom" transform="translate(1046.4,1088.1) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(589,-896.4) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mi" transform="translate(778,0)"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g></g></g><g data-mml-node="mi" transform="translate(9021.9,0)"><path data-c="3A6" d="M312 622Q310 623 307 625T303 629T297 631T286 634T270 635T246 636T211 637H184V683H196Q220 680 361 680T526 683H538V637H511Q468 637 447 635T422 631T411 622V533L425 531Q525 519 595 466T665 342Q665 301 642 267T583 209T506 172T425 152L411 150V61Q417 55 421 53T447 48T511 46H538V0H526Q502 3 361 3T196 0H184V46H211Q231 46 245 46T270 47T286 48T297 51T303 54T307 57T312 61V150H310Q309 151 289 153T232 166T160 195Q149 201 136 210T103 238T69 284T56 342Q56 414 128 467T294 530Q309 532 310 533H312V622ZM170 342Q170 207 307 188H312V495H309Q301 495 282 491T231 469T186 423Q170 389 170 342ZM415 188Q487 199 519 236T551 342Q551 384 539 414T507 459T470 481T434 491T415 495H410V188H415Z"></path></g><g data-mml-node="mo" transform="translate(9743.9,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(10132.9,0)"><path data-c="1D714" d="M495 384Q495 406 514 424T555 443Q574 443 589 425T604 364Q604 334 592 278T555 155T483 38T377 -11Q297 -11 267 66Q266 68 260 61Q201 -11 125 -11Q15 -11 15 139Q15 230 56 325T123 434Q135 441 147 436Q160 429 160 418Q160 406 140 379T94 306T62 208Q61 202 61 187Q61 124 85 100T143 76Q201 76 245 129L253 137V156Q258 297 317 297Q348 297 348 261Q348 243 338 213T318 158L308 135Q309 133 310 129T318 115T334 97T358 83T393 76Q456 76 501 148T546 274Q546 305 533 325T508 357T495 384Z"></path></g><g data-mml-node="mo" transform="translate(10754.9,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mstyle" transform="translate(11143.9,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(11310.9,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(11830.9,0)"><path data-c="1D714" d="M495 384Q495 406 514 424T555 443Q574 443 589 425T604 364Q604 334 592 278T555 155T483 38T377 -11Q297 -11 267 66Q266 68 260 61Q201 -11 125 -11Q15 -11 15 139Q15 230 56 325T123 434Q135 441 147 436Q160 429 160 418Q160 406 140 379T94 306T62 208Q61 202 61 187Q61 124 85 100T143 76Q201 76 245 129L253 137V156Q258 297 317 297Q348 297 348 261Q348 243 338 213T318 158L308 135Q309 133 310 129T318 115T334 97T358 83T393 76Q456 76 501 148T546 274Q546 305 533 325T508 357T495 384Z"></path></g><g data-mml-node="mo" transform="translate(12452.9,0)"><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z"></path></g></g></g></g></g></svg></mjx-container></p><p>上面的定理在离散情况下也是成立的。另外的一个结论是功率谱密度下总的功率与对应的总的平均信号功率相等，它是逐渐趋近于零的自我相关函数。</p><ul><li>谱密度是频率的函数，而不是时间的函数。但是，也可以计算一个较长信号上一小段「窗口」的谱密度，并且根据与事件相关的窗口进行绘图，这样的图形称为频谱图。这是短时傅立叶转换和小波等许多谱分析技术的基础。</li></ul><h1 id="3-振幅谱密度和功率谱密度的关系"><a href="#3-振幅谱密度和功率谱密度的关系" class="headerlink" title="3. 振幅谱密度和功率谱密度的关系"></a>3. 振幅谱密度和功率谱密度的关系</h1><h2 id="3-1-振幅谱密度（ASD-Amplitude-Spectral-Density）"><a href="#3-1-振幅谱密度（ASD-Amplitude-Spectral-Density）" class="headerlink" title="3.1 振幅谱密度（ASD, Amplitude Spectral Density）"></a>3.1 振幅谱密度（ASD, Amplitude Spectral Density）</h2><p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.639ex;" xmlns="http://www.w3.org/2000/svg" width="19.768ex" height="2.851ex" role="img" focusable="false" viewBox="0 -977.5 8737.5 1260"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mi" transform="translate(750,0)"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mi" transform="translate(1395,0)"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mo" transform="translate(2223,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(2612,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(3162,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(3828.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msqrt" transform="translate(4884.6,0)"><g transform="translate(1020,0)"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="TeXAtom" transform="translate(646,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mi" transform="translate(572,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g></g></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(1504.9,0)"><g data-mml-node="mo"><path data-c="200B" d=""></path></g></g><g data-mml-node="mo" transform="translate(1504.9,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1893.9,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(2443.9,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g><g data-mml-node="mo" transform="translate(0,67.5)"><path data-c="221A" d="M263 249Q264 249 315 130T417 -108T470 -228L725 302Q981 837 982 839Q989 850 1001 850Q1008 850 1013 844T1020 832V826L741 243Q645 43 540 -176Q479 -303 469 -324T453 -348Q449 -350 436 -350L424 -349L315 -96Q206 156 205 156L171 130Q138 104 137 104L111 130L263 249Z"></path></g><rect width="2832.9" height="60" x="1020" y="857.5"></rect></g></g></g></svg></mjx-container>​</p><p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.639ex;" xmlns="http://www.w3.org/2000/svg" width="21.395ex" height="2.851ex" role="img" focusable="false" viewBox="0 -977.5 9456.6 1260"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></g><g data-mml-node="mi" transform="translate(750,0)"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mi" transform="translate(1395,0)"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mo" transform="translate(2223,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(2612,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(3162,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(3828.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msqrt" transform="translate(4884.6,0)"><g transform="translate(1020,0)"><g data-mml-node="mi"><path data-c="1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path></g><g data-mml-node="mi" transform="translate(751,0)"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mi" transform="translate(1396,0)"><path data-c="1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path></g><g data-mml-node="mo" transform="translate(2224,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(2613,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(3163,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g><g data-mml-node="mo" transform="translate(0,67.5)"><path data-c="221A" d="M263 249Q264 249 315 130T417 -108T470 -228L725 302Q981 837 982 839Q989 850 1001 850Q1008 850 1013 844T1020 832V826L741 243Q645 43 540 -176Q479 -303 469 -324T453 -348Q449 -350 436 -350L424 -349L315 -96Q206 156 205 156L171 130Q138 104 137 104L111 130L263 249Z"></path></g><rect width="3552" height="60" x="1020" y="857.5"></rect></g></g></g></svg></mjx-container>​<br>PSD 告诉你每赫兹频率范围的功率有多少，ASD 则告诉你每赫兹频率范围对应的幅值大小。</p><h1 id="4-振幅谱密度与方差的关系"><a href="#4-振幅谱密度与方差的关系" class="headerlink" title="4. 振幅谱密度与方差的关系"></a>4. 振幅谱密度与方差的关系</h1><h2 id="4-1-基本概念"><a href="#4-1-基本概念" class="headerlink" title="4.1 基本概念"></a>4.1 基本概念</h2><ol><li>方差</li></ol><p>对于离散信号𝑥(𝑡)（假设零均值），方差表示信号的能量大小：</p><p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.806ex;" xmlns="http://www.w3.org/2000/svg" width="18.225ex" height="3.094ex" role="img" focusable="false" viewBox="0 -1011.3 8055.5 1367.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"></path></g><g data-mml-node="mn" transform="translate(604,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(1285.3,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mfrac" transform="translate(2341.1,0)"><g data-mml-node="mn" transform="translate(292.1,394) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(220,-345) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><rect width="697.8" height="60" x="120" y="220"></rect></g><g data-mml-node="msubsup" transform="translate(3445.6,0)"><g data-mml-node="mo" transform="translate(0 0.5)"><path data-c="222B" d="M113 -244Q113 -246 119 -251T139 -263T167 -269Q186 -269 199 -260Q220 -247 232 -218T251 -133T262 -15T276 155T297 367Q300 390 305 438T314 512T325 580T340 647T361 703T390 751T428 784T479 804Q481 804 488 804T501 805Q552 802 581 769T610 695Q610 669 594 657T561 645Q542 645 527 658T512 694Q512 705 516 714T526 729T538 737T548 742L552 743Q552 745 545 751T525 762T498 768Q475 768 460 756T434 716T418 652T407 559T398 444T387 300T369 133Q349 -38 337 -102T303 -207Q256 -306 169 -306Q119 -306 87 -272T55 -196Q55 -170 71 -158T104 -146Q123 -146 138 -159T153 -195Q153 -206 149 -215T139 -230T127 -238T117 -242L113 -244Z"></path></g><g data-mml-node="TeXAtom" transform="translate(699.9,532.6) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(505,-340.9) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g></g><g data-mml-node="msup" transform="translate(4859.9,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mn" transform="translate(605,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(5868.5,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(6257.5,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(6618.5,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mstyle" transform="translate(7007.5,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(7174.5,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(7694.5,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g></g></g></svg></mjx-container></p><p>如果是离散信号<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="3.91ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 1728 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mo" transform="translate(572,0)"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path></g><g data-mml-node="mi" transform="translate(850,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(1450,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path></g></g></g></svg></mjx-container>，方差就是</p><p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.781ex;" xmlns="http://www.w3.org/2000/svg" width="19.406ex" height="2.953ex" role="img" focusable="false" viewBox="0 -960 8577.5 1305"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"></path></g><g data-mml-node="mn" transform="translate(604,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(1285.3,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mfrac" transform="translate(2341.1,0)"><g data-mml-node="mn" transform="translate(357.2,394) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(220,-345) scale(0.707)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><rect width="827.9" height="60" x="120" y="220"></rect></g><g data-mml-node="munderover" transform="translate(3575.7,0)"><g data-mml-node="mo"><path data-c="2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z"></path></g><g data-mml-node="TeXAtom" transform="translate(1089,477.1) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path></g><g data-mml-node="mo" transform="translate(888,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(1666,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(1089,-285.4) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(600,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mn" transform="translate(1378,0)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g></g><g data-mml-node="msup" transform="translate(6412.9,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mn" transform="translate(605,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(7421.5,0)"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path></g><g data-mml-node="mi" transform="translate(7699.5,0)"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mo" transform="translate(8299.5,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path></g></g></g></svg></mjx-container></p><p>这就是信号在时域中的平均能量。</p><ol><li>PSD</li></ol><p>功率谱密度<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="5.494ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 2428.5 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mi" transform="translate(646,-150) scale(0.707)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g></g><g data-mml-node="mo" transform="translate(1100.5,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1489.5,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(2039.5,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>描述信号功率如何分布在频率上。</p><p>对于平稳随机信号，功率谱密度 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="5.494ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 2428.5 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mi" transform="translate(646,-150) scale(0.707)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g></g><g data-mml-node="mo" transform="translate(1100.5,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1489.5,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(2039.5,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>定义为：</p><p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.781ex;" xmlns="http://www.w3.org/2000/svg" width="27.104ex" height="2.737ex" role="img" focusable="false" viewBox="0 -864.9 11979.9 1209.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mi" transform="translate(646,-150) scale(0.707)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g></g><g data-mml-node="mo" transform="translate(1100.5,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1489.5,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(2039.5,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(2706.2,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="munder" transform="translate(3762,0)"><g data-mml-node="mo"><path data-c="6C" d="M42 46H56Q95 46 103 60V68Q103 77 103 91T103 124T104 167T104 217T104 272T104 329Q104 366 104 407T104 482T104 542T103 586T103 603Q100 622 89 628T44 637H26V660Q26 683 28 683L38 684Q48 685 67 686T104 688Q121 689 141 690T171 693T182 694H185V379Q185 62 186 60Q190 52 198 49Q219 46 247 46H263V0H255L232 1Q209 2 183 2T145 3T107 3T57 1L34 0H26V46H42Z"></path><path data-c="69" d="M69 609Q69 637 87 653T131 669Q154 667 171 652T188 609Q188 579 171 564T129 549Q104 549 87 564T69 609ZM247 0Q232 3 143 3Q132 3 106 3T56 1L34 0H26V46H42Q70 46 91 49Q100 53 102 60T104 102V205V293Q104 345 102 359T88 378Q74 385 41 385H30V408Q30 431 32 431L42 432Q52 433 70 434T106 436Q123 437 142 438T171 441T182 442H185V62Q190 52 197 50T232 46H255V0H247Z" transform="translate(278,0)"></path><path data-c="6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z" transform="translate(556,0)"></path></g><g data-mml-node="TeXAtom" transform="translate(1422,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><g data-mml-node="mo" transform="translate(704,0)"><path data-c="2192" d="M56 237T56 250T70 270H835Q719 357 692 493Q692 494 692 496T691 499Q691 511 708 511H711Q720 511 723 510T729 506T732 497T735 481T743 456Q765 389 816 336T935 261Q944 258 944 250Q944 244 939 241T915 231T877 212Q836 186 806 152T761 85T740 35T732 4Q730 -6 727 -8T711 -11Q691 -11 691 0Q691 7 696 25Q728 151 835 230H70Q56 237 56 250Z"></path></g><g data-mml-node="mi" transform="translate(1704,0)"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g></g></g><g data-mml-node="mfrac" transform="translate(7312.7,0)"><g data-mml-node="mn" transform="translate(292.1,394) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(220,-345) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><rect width="697.8" height="60" x="120" y="220"></rect></g><g data-mml-node="mo" transform="translate(8250.5,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="msub" transform="translate(8528.5,0)"><g data-mml-node="mi"><path data-c="1D44B" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path></g><g data-mml-node="mi" transform="translate(861,-150) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g></g><g data-mml-node="mo" transform="translate(9937.3,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(10326.3,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(10876.3,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="msup" transform="translate(11265.3,0)"><g data-mml-node="mo" transform="translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mn" transform="translate(311,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></g></svg></mjx-container></p><p>其中<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="6.192ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 2736.8 1000"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D44B" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path></g><g data-mml-node="mi" transform="translate(861,-150) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g></g><g data-mml-node="mo" transform="translate(1408.8,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1797.8,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(2347.8,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g></g></svg></mjx-container>是对长度𝑇信号做傅里叶变换得到的频谱。</p><ol><li>ASD</li></ol><p>振幅谱密度是功率谱密度的平方根：</p><p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.639ex;" xmlns="http://www.w3.org/2000/svg" width="18.507ex" height="2.851ex" role="img" focusable="false" viewBox="0 -977.5 8180 1260"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mtext"><path data-c="41" d="M255 0Q240 3 140 3Q48 3 39 0H32V46H47Q119 49 139 88Q140 91 192 245T295 553T348 708Q351 716 366 716H376Q396 715 400 709Q402 707 508 390L617 67Q624 54 636 51T687 46H717V0H708Q699 3 581 3Q458 3 437 0H427V46H440Q510 46 510 64Q510 66 486 138L462 209H229L209 150Q189 91 189 85Q189 72 209 59T259 46H264V0H255ZM447 255L345 557L244 256Q244 255 345 255H447Z"></path><path data-c="53" d="M55 507Q55 590 112 647T243 704H257Q342 704 405 641L426 672Q431 679 436 687T446 700L449 704Q450 704 453 704T459 705H463Q466 705 472 699V462L466 456H448Q437 456 435 459T430 479Q413 605 329 646Q292 662 254 662Q201 662 168 626T135 542Q135 508 152 480T200 435Q210 431 286 412T370 389Q427 367 463 314T500 191Q500 110 448 45T301 -21Q245 -21 201 -4T140 27L122 41Q118 36 107 21T87 -7T78 -21Q76 -22 68 -22H64Q61 -22 55 -16V101Q55 220 56 222Q58 227 76 227H89Q95 221 95 214Q95 182 105 151T139 90T205 42T305 24Q352 24 386 62T420 155Q420 198 398 233T340 281Q284 295 266 300Q261 301 239 306T206 314T174 325T141 343T112 367T85 402Q55 451 55 507Z" transform="translate(750,0)"></path><path data-c="44" d="M130 622Q123 629 119 631T103 634T60 637H27V683H228Q399 682 419 682T461 676Q504 667 546 641T626 573T685 470T708 336Q708 210 634 116T442 3Q429 1 228 0H27V46H60Q102 47 111 49T130 61V622ZM593 338Q593 439 571 501T493 602Q439 637 355 637H322H294Q238 637 234 628Q231 624 231 344Q231 62 232 59Q233 49 248 48T339 46H350Q456 46 515 95Q561 133 577 191T593 338Z" transform="translate(1306,0)"></path></g><g data-mml-node="mo" transform="translate(2070,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(2459,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(3009,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(3675.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msqrt" transform="translate(4731.6,0)"><g transform="translate(1020,0)"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mi" transform="translate(646,-150) scale(0.707)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g></g><g data-mml-node="mo" transform="translate(1100.5,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1489.5,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(2039.5,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g></g><g data-mml-node="mo" transform="translate(0,67.5)"><path data-c="221A" d="M263 249Q264 249 315 130T417 -108T470 -228L725 302Q981 837 982 839Q989 850 1001 850Q1008 850 1013 844T1020 832V826L741 243Q645 43 540 -176Q479 -303 469 -324T453 -348Q449 -350 436 -350L424 -349L315 -96Q206 156 205 156L171 130Q138 104 137 104L111 130L263 249Z"></path></g><rect width="2428.5" height="60" x="1020" y="857.5"></rect></g></g></g></svg></mjx-container></p><h2 id="4-2-功率谱密度与方差的关系"><a href="#4-2-功率谱密度与方差的关系" class="headerlink" title="4.2 功率谱密度与方差的关系"></a>4.2 功率谱密度与方差的关系</h2><p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.806ex;" xmlns="http://www.w3.org/2000/svg" width="18.71ex" height="3.211ex" role="img" focusable="false" viewBox="0 -1062.9 8269.9 1419.3"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"></path></g><g data-mml-node="mn" transform="translate(604,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(1285.3,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msubsup" transform="translate(2341.1,0)"><g data-mml-node="mo" transform="translate(0 0.5)"><path data-c="222B" d="M113 -244Q113 -246 119 -251T139 -263T167 -269Q186 -269 199 -260Q220 -247 232 -218T251 -133T262 -15T276 155T297 367Q300 390 305 438T314 512T325 580T340 647T361 703T390 751T428 784T479 804Q481 804 488 804T501 805Q552 802 581 769T610 695Q610 669 594 657T561 645Q542 645 527 658T512 694Q512 705 516 714T526 729T538 737T548 742L552 743Q552 745 545 751T525 762T498 768Q475 768 460 756T434 716T418 652T407 559T398 444T387 300T369 133Q349 -38 337 -102T303 -207Q256 -306 169 -306Q119 -306 87 -272T55 -196Q55 -170 71 -158T104 -146Q123 -146 138 -159T153 -195Q153 -206 149 -215T139 -230T127 -238T117 -242L113 -244Z"></path></g><g data-mml-node="TeXAtom" transform="translate(699.9,532.6) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mi" transform="translate(523,-150) scale(0.707)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(904.6,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"></path></g></g><g data-mml-node="mn" transform="translate(1404.6,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(505,-340.9) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g></g><g data-mml-node="msub" transform="translate(4604.5,0)"><g data-mml-node="mi"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mi" transform="translate(646,-150) scale(0.707)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g></g><g data-mml-node="mo" transform="translate(5704.9,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(6093.9,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(6643.9,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mstyle" transform="translate(7032.9,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(7199.9,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(7719.9,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g></g></g></svg></mjx-container>，<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.464ex;" xmlns="http://www.w3.org/2000/svg" width="2.096ex" height="2.059ex" role="img" focusable="false" viewBox="0 -705 926.6 910"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mn" transform="translate(523,-150) scale(0.707)"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g></g></g></svg></mjx-container>是采样率。</p><p>下面是推导过程：</p><p>Parseval 定理告诉我们，时域能量等于频域能量。对连续信号：</p><p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.902ex;" xmlns="http://www.w3.org/2000/svg" width="30.435ex" height="3.047ex" role="img" focusable="false" viewBox="0 -948 13452.5 1346.8"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msubsup"><g data-mml-node="mo" transform="translate(0 0.5)"><path data-c="222B" d="M113 -244Q113 -246 119 -251T139 -263T167 -269Q186 -269 199 -260Q220 -247 232 -218T251 -133T262 -15T276 155T297 367Q300 390 305 438T314 512T325 580T340 647T361 703T390 751T428 784T479 804Q481 804 488 804T501 805Q552 802 581 769T610 695Q610 669 594 657T561 645Q542 645 527 658T512 694Q512 705 516 714T526 729T538 737T548 742L552 743Q552 745 545 751T525 762T498 768Q475 768 460 756T434 716T418 652T407 559T398 444T387 300T369 133Q349 -38 337 -102T303 -207Q256 -306 169 -306Q119 -306 87 -272T55 -196Q55 -170 71 -158T104 -146Q123 -146 138 -159T153 -195Q153 -206 149 -215T139 -230T127 -238T117 -242L113 -244Z"></path></g><g data-mml-node="TeXAtom" transform="translate(699.9,532.6) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(505,-340.9) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mi" transform="translate(778,0)"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g></g></g><g data-mml-node="msup" transform="translate(1978.9,0)"><g data-mml-node="mrow"><g data-mml-node="mo" transform="translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mo" transform="translate(850,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1239,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(1600,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(1989,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g></g><g data-mml-node="mn" transform="translate(2300,477.1) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mstyle" transform="translate(4682.5,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(4849.5,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(5369.5,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(6008.2,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msubsup" transform="translate(7064,0)"><g data-mml-node="mo" transform="translate(0 0.5)"><path data-c="222B" d="M113 -244Q113 -246 119 -251T139 -263T167 -269Q186 -269 199 -260Q220 -247 232 -218T251 -133T262 -15T276 155T297 367Q300 390 305 438T314 512T325 580T340 647T361 703T390 751T428 784T479 804Q481 804 488 804T501 805Q552 802 581 769T610 695Q610 669 594 657T561 645Q542 645 527 658T512 694Q512 705 516 714T526 729T538 737T548 742L552 743Q552 745 545 751T525 762T498 768Q475 768 460 756T434 716T418 652T407 559T398 444T387 300T369 133Q349 -38 337 -102T303 -207Q256 -306 169 -306Q119 -306 87 -272T55 -196Q55 -170 71 -158T104 -146Q123 -146 138 -159T153 -195Q153 -206 149 -215T139 -230T127 -238T117 -242L113 -244Z"></path></g><g data-mml-node="TeXAtom" transform="translate(699.9,532.6) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(505,-340.9) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mi" transform="translate(778,0)"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g></g></g><g data-mml-node="msup" transform="translate(9042.9,0)"><g data-mml-node="mrow"><g data-mml-node="mo" transform="translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D44B" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path></g><g data-mml-node="mo" transform="translate(1130,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1519,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(2069,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(2458,0) translate(0 -0.5)"><path data-c="7C" d="M139 -249H137Q125 -249 119 -235V251L120 737Q130 750 139 750Q152 750 159 735V-235Q151 -249 141 -249H139Z"></path></g></g><g data-mml-node="mn" transform="translate(2769,477.1) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mstyle" transform="translate(12215.5,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(12382.5,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(12902.5,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g></g></g></svg></mjx-container>，其中𝑋(𝑓)是𝑥(𝑡)的傅里叶变换：</p><p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.902ex;" xmlns="http://www.w3.org/2000/svg" width="24.983ex" height="2.851ex" role="img" focusable="false" viewBox="0 -861.5 11042.7 1260.3"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D44B" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path></g><g data-mml-node="mo" transform="translate(852,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1241,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(1791,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(2457.8,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msubsup" transform="translate(3513.6,0)"><g data-mml-node="mo" transform="translate(0 0.5)"><path data-c="222B" d="M113 -244Q113 -246 119 -251T139 -263T167 -269Q186 -269 199 -260Q220 -247 232 -218T251 -133T262 -15T276 155T297 367Q300 390 305 438T314 512T325 580T340 647T361 703T390 751T428 784T479 804Q481 804 488 804T501 805Q552 802 581 769T610 695Q610 669 594 657T561 645Q542 645 527 658T512 694Q512 705 516 714T526 729T538 737T548 742L552 743Q552 745 545 751T525 762T498 768Q475 768 460 756T434 716T418 652T407 559T398 444T387 300T369 133Q349 -38 337 -102T303 -207Q256 -306 169 -306Q119 -306 87 -272T55 -196Q55 -170 71 -158T104 -146Q123 -146 138 -159T153 -195Q153 -206 149 -215T139 -230T127 -238T117 -242L113 -244Z"></path></g><g data-mml-node="TeXAtom" transform="translate(699.9,532.6) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(505,-340.9) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mi" transform="translate(778,0)"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g></g></g><g data-mml-node="mi" transform="translate(5492.5,0)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mo" transform="translate(6064.5,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(6453.5,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(6814.5,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="msup" transform="translate(7203.5,0)"><g data-mml-node="mi"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z"></path></g><g data-mml-node="TeXAtom" transform="translate(499,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mi" transform="translate(778,0)"><path data-c="1D457" d="M297 596Q297 627 318 644T361 661Q378 661 389 651T403 623Q403 595 384 576T340 557Q322 557 310 567T297 596ZM288 376Q288 405 262 405Q240 405 220 393T185 362T161 325T144 293L137 279Q135 278 121 278H107Q101 284 101 286T105 299Q126 348 164 391T252 441Q253 441 260 441T272 442Q296 441 316 432Q341 418 354 401T367 348V332L318 133Q267 -67 264 -75Q246 -125 194 -164T75 -204Q25 -204 7 -183T-12 -137Q-12 -110 7 -91T53 -71Q70 -71 82 -81T95 -112Q95 -148 63 -167Q69 -168 77 -168Q111 -168 139 -140T182 -74L193 -32Q204 11 219 72T251 197T278 308T289 365Q289 372 288 376Z"></path></g><g data-mml-node="mn" transform="translate(1190,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g><g data-mml-node="mi" transform="translate(1690,0)"><path data-c="1D70B" d="M132 -11Q98 -11 98 22V33L111 61Q186 219 220 334L228 358H196Q158 358 142 355T103 336Q92 329 81 318T62 297T53 285Q51 284 38 284Q19 284 19 294Q19 300 38 329T93 391T164 429Q171 431 389 431Q549 431 553 430Q573 423 573 402Q573 371 541 360Q535 358 472 358H408L405 341Q393 269 393 222Q393 170 402 129T421 65T431 37Q431 20 417 5T381 -10Q370 -10 363 -7T347 17T331 77Q330 86 330 121Q330 170 339 226T357 318T367 358H269L268 354Q268 351 249 275T206 114T175 17Q164 -11 132 -11Z"></path></g><g data-mml-node="mi" transform="translate(2260,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mi" transform="translate(2810,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g></g></g><g data-mml-node="mstyle" transform="translate(9994.7,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(10161.7,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(10681.7,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g></g></g></svg></mjx-container></p><p>根据Parseval 定理：</p><p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.806ex;" xmlns="http://www.w3.org/2000/svg" width="27.912ex" height="3.094ex" role="img" focusable="false" viewBox="0 -1011.3 12337.1 1367.7"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mfrac"><g data-mml-node="mn" transform="translate(292.1,394) scale(0.707)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g><g data-mml-node="mi" transform="translate(220,-345) scale(0.707)"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g><rect width="697.8" height="60" x="120" y="220"></rect></g><g data-mml-node="msubsup" transform="translate(1104.5,0)"><g data-mml-node="mo" transform="translate(0 0.5)"><path data-c="222B" d="M113 -244Q113 -246 119 -251T139 -263T167 -269Q186 -269 199 -260Q220 -247 232 -218T251 -133T262 -15T276 155T297 367Q300 390 305 438T314 512T325 580T340 647T361 703T390 751T428 784T479 804Q481 804 488 804T501 805Q552 802 581 769T610 695Q610 669 594 657T561 645Q542 645 527 658T512 694Q512 705 516 714T526 729T538 737T548 742L552 743Q552 745 545 751T525 762T498 768Q475 768 460 756T434 716T418 652T407 559T398 444T387 300T369 133Q349 -38 337 -102T303 -207Q256 -306 169 -306Q119 -306 87 -272T55 -196Q55 -170 71 -158T104 -146Q123 -146 138 -159T153 -195Q153 -206 149 -215T139 -230T127 -238T117 -242L113 -244Z"></path></g><g data-mml-node="TeXAtom" transform="translate(699.9,532.6) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D447" d="M40 437Q21 437 21 445Q21 450 37 501T71 602L88 651Q93 669 101 677H569H659Q691 677 697 676T704 667Q704 661 687 553T668 444Q668 437 649 437Q640 437 637 437T631 442L629 445Q629 451 635 490T641 551Q641 586 628 604T573 629Q568 630 515 631Q469 631 457 630T439 622Q438 621 368 343T298 60Q298 48 386 46Q418 46 427 45T436 36Q436 31 433 22Q429 4 424 1L422 0Q419 0 415 0Q410 0 363 1T228 2Q99 2 64 0H49Q43 6 43 9T45 27Q49 40 55 46H83H94Q174 46 189 55Q190 56 191 56Q196 59 201 76T241 233Q258 301 269 344Q339 619 339 625Q339 630 310 630H279Q212 630 191 624Q146 614 121 583T67 467Q60 445 57 441T43 437H40Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(505,-340.9) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g></g><g data-mml-node="msup" transform="translate(2518.8,0)"><g data-mml-node="mi"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g><g data-mml-node="mn" transform="translate(605,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(3527.4,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(3916.4,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(4277.4,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mstyle" transform="translate(4666.4,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(4833.4,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(5353.4,0)"><path data-c="1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path></g><g data-mml-node="mo" transform="translate(5992.2,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msubsup" transform="translate(7047.9,0)"><g data-mml-node="mo" transform="translate(0 0.5)"><path data-c="222B" d="M113 -244Q113 -246 119 -251T139 -263T167 -269Q186 -269 199 -260Q220 -247 232 -218T251 -133T262 -15T276 155T297 367Q300 390 305 438T314 512T325 580T340 647T361 703T390 751T428 784T479 804Q481 804 488 804T501 805Q552 802 581 769T610 695Q610 669 594 657T561 645Q542 645 527 658T512 694Q512 705 516 714T526 729T538 737T548 742L552 743Q552 745 545 751T525 762T498 768Q475 768 460 756T434 716T418 652T407 559T398 444T387 300T369 133Q349 -38 337 -102T303 -207Q256 -306 169 -306Q119 -306 87 -272T55 -196Q55 -170 71 -158T104 -146Q123 -146 138 -159T153 -195Q153 -206 149 -215T139 -230T127 -238T117 -242L113 -244Z"></path></g><g data-mml-node="TeXAtom" transform="translate(699.9,532.6) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(505,-340.9) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g></g><g data-mml-node="msub" transform="translate(8671.6,0)"><g data-mml-node="mi"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mi" transform="translate(646,-150) scale(0.707)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g></g><g data-mml-node="mo" transform="translate(9772.1,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(10161.1,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(10711.1,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mstyle" transform="translate(11100.1,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(11267.1,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(11787.1,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g></g></g></svg></mjx-container></p><p>所以方差就是PSD 对频率积分的结果：</p><p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.806ex;" xmlns="http://www.w3.org/2000/svg" width="18.71ex" height="3.211ex" role="img" focusable="false" viewBox="0 -1062.9 8269.9 1419.3"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"></path></g><g data-mml-node="mn" transform="translate(604,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(1285.3,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msubsup" transform="translate(2341.1,0)"><g data-mml-node="mo" transform="translate(0 0.5)"><path data-c="222B" d="M113 -244Q113 -246 119 -251T139 -263T167 -269Q186 -269 199 -260Q220 -247 232 -218T251 -133T262 -15T276 155T297 367Q300 390 305 438T314 512T325 580T340 647T361 703T390 751T428 784T479 804Q481 804 488 804T501 805Q552 802 581 769T610 695Q610 669 594 657T561 645Q542 645 527 658T512 694Q512 705 516 714T526 729T538 737T548 742L552 743Q552 745 545 751T525 762T498 768Q475 768 460 756T434 716T418 652T407 559T398 444T387 300T369 133Q349 -38 337 -102T303 -207Q256 -306 169 -306Q119 -306 87 -272T55 -196Q55 -170 71 -158T104 -146Q123 -146 138 -159T153 -195Q153 -206 149 -215T139 -230T127 -238T117 -242L113 -244Z"></path></g><g data-mml-node="TeXAtom" transform="translate(699.9,532.6) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mi" transform="translate(523,-150) scale(0.707)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(904.6,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"></path></g></g><g data-mml-node="mn" transform="translate(1404.6,0)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(505,-340.9) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g></g><g data-mml-node="msub" transform="translate(4604.5,0)"><g data-mml-node="mi"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mi" transform="translate(646,-150) scale(0.707)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g></g><g data-mml-node="mo" transform="translate(5704.9,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(6093.9,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(6643.9,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mstyle" transform="translate(7032.9,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(7199.9,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(7719.9,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g></g></g></svg></mjx-container></p><p>结论：</p><ul><li><p>方差= 信号总能量/ 平均时间</p></li><li><p>PSD 是频域能量密度</p></li><li><p>对PSD 积分→ 得到方差</p></li></ul><h2 id="4-3-振幅谱密度与方差的关系"><a href="#4-3-振幅谱密度与方差的关系" class="headerlink" title="4.3 振幅谱密度与方差的关系"></a>4.3 振幅谱密度与方差的关系</h2><p>因为</p><p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.806ex;" xmlns="http://www.w3.org/2000/svg" width="17.263ex" height="2.718ex" role="img" focusable="false" viewBox="0 -845.1 7630.2 1201.5"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"></path></g><g data-mml-node="mn" transform="translate(604,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(1285.3,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msubsup" transform="translate(2341.1,0)"><g data-mml-node="mo" transform="translate(0 0.5)"><path data-c="222B" d="M113 -244Q113 -246 119 -251T139 -263T167 -269Q186 -269 199 -260Q220 -247 232 -218T251 -133T262 -15T276 155T297 367Q300 390 305 438T314 512T325 580T340 647T361 703T390 751T428 784T479 804Q481 804 488 804T501 805Q552 802 581 769T610 695Q610 669 594 657T561 645Q542 645 527 658T512 694Q512 705 516 714T526 729T538 737T548 742L552 743Q552 745 545 751T525 762T498 768Q475 768 460 756T434 716T418 652T407 559T398 444T387 300T369 133Q349 -38 337 -102T303 -207Q256 -306 169 -306Q119 -306 87 -272T55 -196Q55 -170 71 -158T104 -146Q123 -146 138 -159T153 -195Q153 -206 149 -215T139 -230T127 -238T117 -242L113 -244Z"></path></g><g data-mml-node="TeXAtom" transform="translate(699.9,532.6) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(505,-340.9) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g></g><g data-mml-node="msub" transform="translate(3964.8,0)"><g data-mml-node="mi"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mi" transform="translate(646,-150) scale(0.707)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g></g><g data-mml-node="mo" transform="translate(5065.2,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(5454.2,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(6004.2,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mstyle" transform="translate(6393.2,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(6560.2,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(7080.2,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g></g></g></svg></mjx-container></p><p>代入 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="18.445ex" height="2.452ex" role="img" focusable="false" viewBox="0 -833.9 8152.6 1083.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><path data-c="1D446" d="M308 24Q367 24 416 76T466 197Q466 260 414 284Q308 311 278 321T236 341Q176 383 176 462Q176 523 208 573T273 648Q302 673 343 688T407 704H418H425Q521 704 564 640Q565 640 577 653T603 682T623 704Q624 704 627 704T632 705Q645 705 645 698T617 577T585 459T569 456Q549 456 549 465Q549 471 550 475Q550 478 551 494T553 520Q553 554 544 579T526 616T501 641Q465 662 419 662Q362 662 313 616T263 510Q263 480 278 458T319 427Q323 425 389 408T456 390Q490 379 522 342T554 242Q554 216 546 186Q541 164 528 137T492 78T426 18T332 -20Q320 -22 298 -22Q199 -22 144 33L134 44L106 13Q83 -14 78 -18T65 -22Q52 -22 52 -14Q52 -11 110 221Q112 227 130 227H143Q149 221 149 216Q149 214 148 207T144 186T142 153Q144 114 160 87T203 47T255 29T308 24Z"></path></g><g data-mml-node="mi" transform="translate(646,-150) scale(0.707)"><path data-c="1D465" d="M52 289Q59 331 106 386T222 442Q257 442 286 424T329 379Q371 442 430 442Q467 442 494 420T522 361Q522 332 508 314T481 292T458 288Q439 288 427 299T415 328Q415 374 465 391Q454 404 425 404Q412 404 406 402Q368 386 350 336Q290 115 290 78Q290 50 306 38T341 26Q378 26 414 59T463 140Q466 150 469 151T485 153H489Q504 153 504 145Q504 144 502 134Q486 77 440 33T333 -11Q263 -11 227 52Q186 -10 133 -10H127Q78 -10 57 16T35 71Q35 103 54 123T99 143Q142 143 142 101Q142 81 130 66T107 46T94 41L91 40Q91 39 97 36T113 29T132 26Q168 26 194 71Q203 87 217 139T245 247T261 313Q266 340 266 352Q266 380 251 392T217 404Q177 404 142 372T93 290Q91 281 88 280T72 278H58Q52 284 52 289Z"></path></g></g><g data-mml-node="mo" transform="translate(1100.5,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(1489.5,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(2039.5,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mo" transform="translate(2706.2,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="mo" transform="translate(3762,0)"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path></g><g data-mml-node="mtext" transform="translate(4040,0)"><path data-c="41" d="M255 0Q240 3 140 3Q48 3 39 0H32V46H47Q119 49 139 88Q140 91 192 245T295 553T348 708Q351 716 366 716H376Q396 715 400 709Q402 707 508 390L617 67Q624 54 636 51T687 46H717V0H708Q699 3 581 3Q458 3 437 0H427V46H440Q510 46 510 64Q510 66 486 138L462 209H229L209 150Q189 91 189 85Q189 72 209 59T259 46H264V0H255ZM447 255L345 557L244 256Q244 255 345 255H447Z"></path><path data-c="53" d="M55 507Q55 590 112 647T243 704H257Q342 704 405 641L426 672Q431 679 436 687T446 700L449 704Q450 704 453 704T459 705H463Q466 705 472 699V462L466 456H448Q437 456 435 459T430 479Q413 605 329 646Q292 662 254 662Q201 662 168 626T135 542Q135 508 152 480T200 435Q210 431 286 412T370 389Q427 367 463 314T500 191Q500 110 448 45T301 -21Q245 -21 201 -4T140 27L122 41Q118 36 107 21T87 -7T78 -21Q76 -22 68 -22H64Q61 -22 55 -16V101Q55 220 56 222Q58 227 76 227H89Q95 221 95 214Q95 182 105 151T139 90T205 42T305 24Q352 24 386 62T420 155Q420 198 398 233T340 281Q284 295 266 300Q261 301 239 306T206 314T174 325T141 343T112 367T85 402Q55 451 55 507Z" transform="translate(750,0)"></path><path data-c="44" d="M130 622Q123 629 119 631T103 634T60 637H27V683H228Q399 682 419 682T461 676Q504 667 546 641T626 573T685 470T708 336Q708 210 634 116T442 3Q429 1 228 0H27V46H60Q102 47 111 49T130 61V622ZM593 338Q593 439 571 501T493 602Q439 637 355 637H322H294Q238 637 234 628Q231 624 231 344Q231 62 232 59Q233 49 248 48T339 46H350Q456 46 515 95Q561 133 577 191T593 338Z" transform="translate(1306,0)"></path></g><g data-mml-node="mo" transform="translate(6110,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(6499,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(7049,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="msup" transform="translate(7438,0)"><g data-mml-node="mo"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path></g><g data-mml-node="mn" transform="translate(311,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></g></svg></mjx-container></p><p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.806ex;" xmlns="http://www.w3.org/2000/svg" width="20.444ex" height="2.874ex" role="img" focusable="false" viewBox="0 -914 9036.3 1270.4"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"></path></g><g data-mml-node="mn" transform="translate(604,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(1285.3,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msubsup" transform="translate(2341.1,0)"><g data-mml-node="mo" transform="translate(0 0.5)"><path data-c="222B" d="M113 -244Q113 -246 119 -251T139 -263T167 -269Q186 -269 199 -260Q220 -247 232 -218T251 -133T262 -15T276 155T297 367Q300 390 305 438T314 512T325 580T340 647T361 703T390 751T428 784T479 804Q481 804 488 804T501 805Q552 802 581 769T610 695Q610 669 594 657T561 645Q542 645 527 658T512 694Q512 705 516 714T526 729T538 737T548 742L552 743Q552 745 545 751T525 762T498 768Q475 768 460 756T434 716T418 652T407 559T398 444T387 300T369 133Q349 -38 337 -102T303 -207Q256 -306 169 -306Q119 -306 87 -272T55 -196Q55 -170 71 -158T104 -146Q123 -146 138 -159T153 -195Q153 -206 149 -215T139 -230T127 -238T117 -242L113 -244Z"></path></g><g data-mml-node="TeXAtom" transform="translate(699.9,532.6) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(505,-340.9) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g></g><g data-mml-node="msup" transform="translate(3964.8,0)"><g data-mml-node="mtext"><path data-c="41" d="M255 0Q240 3 140 3Q48 3 39 0H32V46H47Q119 49 139 88Q140 91 192 245T295 553T348 708Q351 716 366 716H376Q396 715 400 709Q402 707 508 390L617 67Q624 54 636 51T687 46H717V0H708Q699 3 581 3Q458 3 437 0H427V46H440Q510 46 510 64Q510 66 486 138L462 209H229L209 150Q189 91 189 85Q189 72 209 59T259 46H264V0H255ZM447 255L345 557L244 256Q244 255 345 255H447Z"></path><path data-c="53" d="M55 507Q55 590 112 647T243 704H257Q342 704 405 641L426 672Q431 679 436 687T446 700L449 704Q450 704 453 704T459 705H463Q466 705 472 699V462L466 456H448Q437 456 435 459T430 479Q413 605 329 646Q292 662 254 662Q201 662 168 626T135 542Q135 508 152 480T200 435Q210 431 286 412T370 389Q427 367 463 314T500 191Q500 110 448 45T301 -21Q245 -21 201 -4T140 27L122 41Q118 36 107 21T87 -7T78 -21Q76 -22 68 -22H64Q61 -22 55 -16V101Q55 220 56 222Q58 227 76 227H89Q95 221 95 214Q95 182 105 151T139 90T205 42T305 24Q352 24 386 62T420 155Q420 198 398 233T340 281Q284 295 266 300Q261 301 239 306T206 314T174 325T141 343T112 367T85 402Q55 451 55 507Z" transform="translate(750,0)"></path><path data-c="44" d="M130 622Q123 629 119 631T103 634T60 637H27V683H228Q399 682 419 682T461 676Q504 667 546 641T626 573T685 470T708 336Q708 210 634 116T442 3Q429 1 228 0H27V46H60Q102 47 111 49T130 61V622ZM593 338Q593 439 571 501T493 602Q439 637 355 637H322H294Q238 637 234 628Q231 624 231 344Q231 62 232 59Q233 49 248 48T339 46H350Q456 46 515 95Q561 133 577 191T593 338Z" transform="translate(1306,0)"></path></g><g data-mml-node="mn" transform="translate(2103,443.1) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(6471.3,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(6860.3,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(7410.3,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mstyle" transform="translate(7799.3,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(7966.3,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(8486.3,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g></g></g></svg></mjx-container></p><p>也就是说：</p><p>方差= ASD 的平方对频率积分</p><p>单位注意：如果ASD 单位是<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="8.948ex" height="2.758ex" role="img" focusable="false" viewBox="0 -969 3955 1219"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D44B" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path></g><g data-mml-node="mo" transform="translate(1130,0)"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(1408,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"></path></g></g><g data-mml-node="msqrt" transform="translate(1908,0)"><g transform="translate(853,0)"><g data-mml-node="mtext"><path data-c="48" d="M128 622Q121 629 117 631T101 634T58 637H25V683H36Q57 680 180 680Q315 680 324 683H335V637H302Q262 636 251 634T233 622L232 500V378H517V622Q510 629 506 631T490 634T447 637H414V683H425Q446 680 569 680Q704 680 713 683H724V637H691Q651 636 640 634T622 622V61Q628 51 639 49T691 46H724V0H713Q692 3 569 3Q434 3 425 0H414V46H447Q489 47 498 49T517 61V332H232V197L233 61Q239 51 250 49T302 46H335V0H324Q303 3 180 3Q45 3 36 0H25V46H58Q100 47 109 49T128 61V622Z"></path><path data-c="7A" d="M42 263Q44 270 48 345T53 423V431H393Q399 425 399 415Q399 403 398 402L381 378Q364 355 331 309T265 220L134 41L182 40H206Q254 40 283 46T331 77Q352 105 359 185L361 201Q361 202 381 202H401V196Q401 195 393 103T384 6V0H209L34 1L31 3Q28 8 28 17Q28 30 29 31T160 210T294 394H236Q169 393 152 388Q127 382 113 367Q89 344 82 264V255H42V263Z" transform="translate(750,0)"></path></g></g><g data-mml-node="mo" transform="translate(0,109)"><path data-c="221A" d="M95 178Q89 178 81 186T72 200T103 230T169 280T207 309Q209 311 212 311H213Q219 311 227 294T281 177Q300 134 312 108L397 -77Q398 -77 501 136T707 565T814 786Q820 800 834 800Q841 800 846 794T853 782V776L620 293L385 -193Q381 -200 366 -200Q357 -200 354 -197Q352 -195 256 15L160 225L144 214Q129 202 113 190T95 178Z"></path></g><rect width="1194" height="60" x="853" y="849"></rect></g></g></g></svg></mjx-container>，那么方差的单位就是<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="4.173ex" height="2.452ex" role="img" focusable="false" viewBox="0 -833.9 1844.6 1083.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><path data-c="5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path></g><g data-mml-node="mi" transform="translate(278,0)"><path data-c="1D44B" d="M42 0H40Q26 0 26 11Q26 15 29 27Q33 41 36 43T55 46Q141 49 190 98Q200 108 306 224T411 342Q302 620 297 625Q288 636 234 637H206Q200 643 200 645T202 664Q206 677 212 683H226Q260 681 347 681Q380 681 408 681T453 682T473 682Q490 682 490 671Q490 670 488 658Q484 643 481 640T465 637Q434 634 411 620L488 426L541 485Q646 598 646 610Q646 628 622 635Q617 635 609 637Q594 637 594 648Q594 650 596 664Q600 677 606 683H618Q619 683 643 683T697 681T738 680Q828 680 837 683H845Q852 676 852 672Q850 647 840 637H824Q790 636 763 628T722 611T698 593L687 584Q687 585 592 480L505 384Q505 383 536 304T601 142T638 56Q648 47 699 46Q734 46 734 37Q734 35 732 23Q728 7 725 4T711 1Q708 1 678 1T589 2Q528 2 496 2T461 1Q444 1 444 10Q444 11 446 25Q448 35 450 39T455 44T464 46T480 47T506 54Q523 62 523 64Q522 64 476 181L429 299Q241 95 236 84Q232 76 232 72Q232 53 261 47Q262 47 267 47T273 46Q276 46 277 46T280 45T283 42T284 35Q284 26 282 19Q279 6 276 4T261 1Q258 1 243 1T201 2T142 2Q64 2 42 0Z"></path></g><g data-mml-node="msup" transform="translate(1130,0)"><g data-mml-node="mo"><path data-c="5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path></g><g data-mml-node="mn" transform="translate(311,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></g></svg></mjx-container></p><p>ASD 在某个频率低→ 说明该频率成分的波动小→ 对整体方差贡献小；ASD 在某个频率高→ 对整体方差贡献大。因此，ASD 可以直观反映各频率分量对信号总能量（方差）的贡献。</p><p>总结：</p><p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.806ex;" xmlns="http://www.w3.org/2000/svg" width="20.444ex" height="2.874ex" role="img" focusable="false" viewBox="0 -914 9036.3 1270.4"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"></path></g><g data-mml-node="mn" transform="translate(604,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(1285.3,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path></g><g data-mml-node="msubsup" transform="translate(2341.1,0)"><g data-mml-node="mo" transform="translate(0 0.5)"><path data-c="222B" d="M113 -244Q113 -246 119 -251T139 -263T167 -269Q186 -269 199 -260Q220 -247 232 -218T251 -133T262 -15T276 155T297 367Q300 390 305 438T314 512T325 580T340 647T361 703T390 751T428 784T479 804Q481 804 488 804T501 805Q552 802 581 769T610 695Q610 669 594 657T561 645Q542 645 527 658T512 694Q512 705 516 714T526 729T538 737T548 742L552 743Q552 745 545 751T525 762T498 768Q475 768 460 756T434 716T418 652T407 559T398 444T387 300T369 133Q349 -38 337 -102T303 -207Q256 -306 169 -306Q119 -306 87 -272T55 -196Q55 -170 71 -158T104 -146Q123 -146 138 -159T153 -195Q153 -206 149 -215T139 -230T127 -238T117 -242L113 -244Z"></path></g><g data-mml-node="TeXAtom" transform="translate(699.9,532.6) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(505,-340.9) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path></g></g></g><g data-mml-node="msup" transform="translate(3964.8,0)"><g data-mml-node="mtext"><path data-c="41" d="M255 0Q240 3 140 3Q48 3 39 0H32V46H47Q119 49 139 88Q140 91 192 245T295 553T348 708Q351 716 366 716H376Q396 715 400 709Q402 707 508 390L617 67Q624 54 636 51T687 46H717V0H708Q699 3 581 3Q458 3 437 0H427V46H440Q510 46 510 64Q510 66 486 138L462 209H229L209 150Q189 91 189 85Q189 72 209 59T259 46H264V0H255ZM447 255L345 557L244 256Q244 255 345 255H447Z"></path><path data-c="53" d="M55 507Q55 590 112 647T243 704H257Q342 704 405 641L426 672Q431 679 436 687T446 700L449 704Q450 704 453 704T459 705H463Q466 705 472 699V462L466 456H448Q437 456 435 459T430 479Q413 605 329 646Q292 662 254 662Q201 662 168 626T135 542Q135 508 152 480T200 435Q210 431 286 412T370 389Q427 367 463 314T500 191Q500 110 448 45T301 -21Q245 -21 201 -4T140 27L122 41Q118 36 107 21T87 -7T78 -21Q76 -22 68 -22H64Q61 -22 55 -16V101Q55 220 56 222Q58 227 76 227H89Q95 221 95 214Q95 182 105 151T139 90T205 42T305 24Q352 24 386 62T420 155Q420 198 398 233T340 281Q284 295 266 300Q261 301 239 306T206 314T174 325T141 343T112 367T85 402Q55 451 55 507Z" transform="translate(750,0)"></path><path data-c="44" d="M130 622Q123 629 119 631T103 634T60 637H27V683H228Q399 682 419 682T461 676Q504 667 546 641T626 573T685 470T708 336Q708 210 634 116T442 3Q429 1 228 0H27V46H60Q102 47 111 49T130 61V622ZM593 338Q593 439 571 501T493 602Q439 637 355 637H322H294Q238 637 234 628Q231 624 231 344Q231 62 232 59Q233 49 248 48T339 46H350Q456 46 515 95Q561 133 577 191T593 338Z" transform="translate(1306,0)"></path></g><g data-mml-node="mn" transform="translate(2103,443.1) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(6471.3,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="mi" transform="translate(6860.3,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mo" transform="translate(7410.3,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mstyle" transform="translate(7799.3,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(7966.3,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></g><g data-mml-node="mi" transform="translate(8486.3,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g></g></g></svg></mjx-container></p><p>或者离散形式</p><p><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.663ex;" xmlns="http://www.w3.org/2000/svg" width="21.589ex" height="2.55ex" role="img" focusable="false" viewBox="0 -833.9 9542.2 1127.1"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"></path></g><g data-mml-node="mn" transform="translate(604,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mo" transform="translate(1285.3,0)"><path data-c="2248" d="M55 319Q55 360 72 393T114 444T163 472T205 482Q207 482 213 482T223 483Q262 483 296 468T393 413L443 381Q502 346 553 346Q609 346 649 375T694 454Q694 465 698 474T708 483Q722 483 722 452Q722 386 675 338T555 289Q514 289 468 310T388 357T308 404T224 426Q164 426 125 393T83 318Q81 289 69 289Q55 289 55 319ZM55 85Q55 126 72 159T114 210T163 238T205 248Q207 248 213 248T223 249Q262 249 296 234T393 179L443 147Q502 112 553 112Q609 112 649 141T694 220Q694 249 708 249T722 217Q722 153 675 104T555 55Q514 55 468 76T388 123T308 170T224 192Q164 192 125 159T83 84Q80 55 69 55Q55 55 55 85Z"></path></g><g data-mml-node="munder" transform="translate(2341.1,0)"><g data-mml-node="mo"><path data-c="2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z"></path></g><g data-mml-node="TeXAtom" transform="translate(1089,-285.4) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g></g><g data-mml-node="mtext" transform="translate(3890.7,0)"><path data-c="41" d="M255 0Q240 3 140 3Q48 3 39 0H32V46H47Q119 49 139 88Q140 91 192 245T295 553T348 708Q351 716 366 716H376Q396 715 400 709Q402 707 508 390L617 67Q624 54 636 51T687 46H717V0H708Q699 3 581 3Q458 3 437 0H427V46H440Q510 46 510 64Q510 66 486 138L462 209H229L209 150Q189 91 189 85Q189 72 209 59T259 46H264V0H255ZM447 255L345 557L244 256Q244 255 345 255H447Z"></path><path data-c="53" d="M55 507Q55 590 112 647T243 704H257Q342 704 405 641L426 672Q431 679 436 687T446 700L449 704Q450 704 453 704T459 705H463Q466 705 472 699V462L466 456H448Q437 456 435 459T430 479Q413 605 329 646Q292 662 254 662Q201 662 168 626T135 542Q135 508 152 480T200 435Q210 431 286 412T370 389Q427 367 463 314T500 191Q500 110 448 45T301 -21Q245 -21 201 -4T140 27L122 41Q118 36 107 21T87 -7T78 -21Q76 -22 68 -22H64Q61 -22 55 -16V101Q55 220 56 222Q58 227 76 227H89Q95 221 95 214Q95 182 105 151T139 90T205 42T305 24Q352 24 386 62T420 155Q420 198 398 233T340 281Q284 295 266 300Q261 301 239 306T206 314T174 325T141 343T112 367T85 402Q55 451 55 507Z" transform="translate(750,0)"></path><path data-c="44" d="M130 622Q123 629 119 631T103 634T60 637H27V683H228Q399 682 419 682T461 676Q504 667 546 641T626 573T685 470T708 336Q708 210 634 116T442 3Q429 1 228 0H27V46H60Q102 47 111 49T130 61V622ZM593 338Q593 439 571 501T493 602Q439 637 355 637H322H294Q238 637 234 628Q231 624 231 344Q231 62 232 59Q233 49 248 48T339 46H350Q456 46 515 95Q561 133 577 191T593 338Z" transform="translate(1306,0)"></path></g><g data-mml-node="mo" transform="translate(5960.7,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path></g><g data-mml-node="msub" transform="translate(6349.7,0)"><g data-mml-node="mi"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g><g data-mml-node="mi" transform="translate(523,-150) scale(0.707)"><path data-c="1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></g></g><g data-mml-node="msup" transform="translate(7166.7,0)"><g data-mml-node="mo"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></g><g data-mml-node="mn" transform="translate(422,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g><g data-mml-node="mstyle" transform="translate(7992.2,0)"><g data-mml-node="mspace"></g></g><g data-mml-node="mi" transform="translate(8159.2,0)"><path data-c="394" d="M51 0Q46 4 46 7Q46 9 215 357T388 709Q391 716 416 716Q439 716 444 709Q447 705 616 357T786 7Q786 4 781 0H51ZM507 344L384 596L137 92L383 91H630Q630 93 507 344Z"></path></g><g data-mml-node="mi" transform="translate(8992.2,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"></path></g></g></g></svg></mjx-container></p><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a href="https://zh.wikipedia.org/wiki/%E8%B0%B1%E5%AF%86%E5%BA%A6">维基百科-谱密度</a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GRACE</tag>
      
      <tag>GRACE-FO</tag>
      
      <tag>ASD</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>如何解读利用GRACE_L1B数据计算出的LGD的ASD图</title>
    <link href="/2025/09/23/%E5%A6%82%E4%BD%95%E8%A7%A3%E8%AF%BB%E5%88%A9%E7%94%A8GRACE-LB%E6%95%B0%E6%8D%AE%E8%AE%A1%E7%AE%97%E5%87%BA%E7%9A%84LGD%E7%9A%84ASD%E5%9B%BE/"/>
    <url>/2025/09/23/%E5%A6%82%E4%BD%95%E8%A7%A3%E8%AF%BB%E5%88%A9%E7%94%A8GRACE-LB%E6%95%B0%E6%8D%AE%E8%AE%A1%E7%AE%97%E5%87%BA%E7%9A%84LGD%E7%9A%84ASD%E5%9B%BE/</url>
    
    <content type="html"><![CDATA[<h1 id="1-前言"><a href="#1-前言" class="headerlink" title="1. 前言"></a>1. 前言</h1><p>利用 GRACE/GRACE-FO 星间测距数据（KBR、LRI）计算 LGD 通常会同时计算 LGD 的功率谱（PSD）或振幅谱（ASD），如下所示</p><center>[Li2024] ASD of LGD </center><p><img src="/2025/09/23/%E5%A6%82%E4%BD%95%E8%A7%A3%E8%AF%BB%E5%88%A9%E7%94%A8GRACE-LB%E6%95%B0%E6%8D%AE%E8%AE%A1%E7%AE%97%E5%87%BA%E7%9A%84LGD%E7%9A%84ASD%E5%9B%BE/image.png" alt="alt text"></p><center>[Zhu2025] AO error, ocean tide (OT) error</center><p><img src="/2025/09/23/%E5%A6%82%E4%BD%95%E8%A7%A3%E8%AF%BB%E5%88%A9%E7%94%A8GRACE-LB%E6%95%B0%E6%8D%AE%E8%AE%A1%E7%AE%97%E5%87%BA%E7%9A%84LGD%E7%9A%84ASD%E5%9B%BE/image-2.png" alt="alt text"></p><center>[Ghobadi-Far2022] ASD of LGD</center><p><img src="/2025/09/23/%E5%A6%82%E4%BD%95%E8%A7%A3%E8%AF%BB%E5%88%A9%E7%94%A8GRACE-LB%E6%95%B0%E6%8D%AE%E8%AE%A1%E7%AE%97%E5%87%BA%E7%9A%84LGD%E7%9A%84ASD%E5%9B%BE/image-1.png" alt="alt text"></p><p>对于不了解信号处理和功率谱的新手来说，刚接触时看到这类图或许无从获取信息及分析，本文从 ASD 的公式推导出发，对 ASD 进行详细介绍，并<strong>以[Li2024]论文中的 ASD 图为例进行解读</strong>，帮助新手更好的理解这类结果图。一些关于信号处理中的专业名词和原理可查看另一篇博客进行详细学习。</p><h1 id="2-分析ASD图"><a href="#2-分析ASD图" class="headerlink" title="2. 分析ASD图"></a>2. 分析ASD图</h1><h2 id="2-1-整体分析ASD"><a href="#2-1-整体分析ASD" class="headerlink" title="2.1 整体分析ASD"></a>2.1 整体分析ASD</h2><center>[Li2024] ASD of LGD </center><p><img src="/2025/09/23/%E5%A6%82%E4%BD%95%E8%A7%A3%E8%AF%BB%E5%88%A9%E7%94%A8GRACE-LB%E6%95%B0%E6%8D%AE%E8%AE%A1%E7%AE%97%E5%87%BA%E7%9A%84LGD%E7%9A%84ASD%E5%9B%BE/image.png" alt="alt text"></p><p>（1）因为：方差= ASD 的平方对频率积分（<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.806ex;" xmlns="http://www.w3.org/2000/svg" width="20.444ex" height="2.874ex" role="img" focusable="false" viewbox="0 -914 9036.3 1270.4"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mi"><path data-c="1D70E" d="M184 -11Q116 -11 74 34T31 147Q31 247 104 333T274 430Q275 431 414 431H552Q553 430 555 429T559 427T562 425T565 422T567 420T569 416T570 412T571 407T572 401Q572 357 507 357Q500 357 490 357T476 358H416L421 348Q439 310 439 263Q439 153 359 71T184 -11ZM361 278Q361 358 276 358Q152 358 115 184Q114 180 114 178Q106 141 106 117Q106 67 131 47T188 26Q242 26 287 73Q316 103 334 153T356 233T361 278Z"/></g><g data-mml-node="mn" transform="translate(604,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/></g></g><g data-mml-node="mo" transform="translate(1285.3,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"/></g><g data-mml-node="msubsup" transform="translate(2341.1,0)"><g data-mml-node="mo" transform="translate(0 0.5)"><path data-c="222B" d="M113 -244Q113 -246 119 -251T139 -263T167 -269Q186 -269 199 -260Q220 -247 232 -218T251 -133T262 -15T276 155T297 367Q300 390 305 438T314 512T325 580T340 647T361 703T390 751T428 784T479 804Q481 804 488 804T501 805Q552 802 581 769T610 695Q610 669 594 657T561 645Q542 645 527 658T512 694Q512 705 516 714T526 729T538 737T548 742L552 743Q552 745 545 751T525 762T498 768Q475 768 460 756T434 716T418 652T407 559T398 444T387 300T369 133Q349 -38 337 -102T303 -207Q256 -306 169 -306Q119 -306 87 -272T55 -196Q55 -170 71 -158T104 -146Q123 -146 138 -159T153 -195Q153 -206 149 -215T139 -230T127 -238T117 -242L113 -244Z"/></g><g data-mml-node="TeXAtom" transform="translate(699.9,532.6) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="221E" d="M55 217Q55 305 111 373T254 442Q342 442 419 381Q457 350 493 303L507 284L514 294Q618 442 747 442Q833 442 888 374T944 214Q944 128 889 59T743 -11Q657 -11 580 50Q542 81 506 128L492 147L485 137Q381 -11 252 -11Q166 -11 111 57T55 217ZM907 217Q907 285 869 341T761 397Q740 397 720 392T682 378T648 359T619 335T594 310T574 285T559 263T548 246L543 238L574 198Q605 158 622 138T664 94T714 61T765 51Q827 51 867 100T907 217ZM92 214Q92 145 131 89T239 33Q357 33 456 193L425 233Q364 312 334 337Q285 380 233 380Q171 380 132 331T92 214Z"/></g></g><g data-mml-node="TeXAtom" transform="translate(505,-340.9) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><path data-c="30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"/></g></g></g><g data-mml-node="msup" transform="translate(3964.8,0)"><g data-mml-node="mtext"><path data-c="41" d="M255 0Q240 3 140 3Q48 3 39 0H32V46H47Q119 49 139 88Q140 91 192 245T295 553T348 708Q351 716 366 716H376Q396 715 400 709Q402 707 508 390L617 67Q624 54 636 51T687 46H717V0H708Q699 3 581 3Q458 3 437 0H427V46H440Q510 46 510 64Q510 66 486 138L462 209H229L209 150Q189 91 189 85Q189 72 209 59T259 46H264V0H255ZM447 255L345 557L244 256Q244 255 345 255H447Z"/><path data-c="53" d="M55 507Q55 590 112 647T243 704H257Q342 704 405 641L426 672Q431 679 436 687T446 700L449 704Q450 704 453 704T459 705H463Q466 705 472 699V462L466 456H448Q437 456 435 459T430 479Q413 605 329 646Q292 662 254 662Q201 662 168 626T135 542Q135 508 152 480T200 435Q210 431 286 412T370 389Q427 367 463 314T500 191Q500 110 448 45T301 -21Q245 -21 201 -4T140 27L122 41Q118 36 107 21T87 -7T78 -21Q76 -22 68 -22H64Q61 -22 55 -16V101Q55 220 56 222Q58 227 76 227H89Q95 221 95 214Q95 182 105 151T139 90T205 42T305 24Q352 24 386 62T420 155Q420 198 398 233T340 281Q284 295 266 300Q261 301 239 306T206 314T174 325T141 343T112 367T85 402Q55 451 55 507Z" transform="translate(750,0)"/><path data-c="44" d="M130 622Q123 629 119 631T103 634T60 637H27V683H228Q399 682 419 682T461 676Q504 667 546 641T626 573T685 470T708 336Q708 210 634 116T442 3Q429 1 228 0H27V46H60Q102 47 111 49T130 61V622ZM593 338Q593 439 571 501T493 602Q439 637 355 637H322H294Q238 637 234 628Q231 624 231 344Q231 62 232 59Q233 49 248 48T339 46H350Q456 46 515 95Q561 133 577 191T593 338Z" transform="translate(1306,0)"/></g><g data-mml-node="mn" transform="translate(2103,443.1) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/></g></g><g data-mml-node="mo" transform="translate(6471.3,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"/></g><g data-mml-node="mi" transform="translate(6860.3,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"/></g><g data-mml-node="mo" transform="translate(7410.3,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"/></g><g data-mml-node="mstyle" transform="translate(7799.3,0)"><g data-mml-node="mspace"/></g><g data-mml-node="mi" transform="translate(7966.3,0)"><path data-c="1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"/></g><g data-mml-node="mi" transform="translate(8486.3,0)"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"/></g></g></g></svg></mjx-container>）</p><p>可据此从上图中判断各曲线的方差和标准差分布情况，其中LRI LGD (reference orbit removed)最小。</p><p>（2）保留参考轨道（蓝/橙）曲线在<strong>低频端（~10⁻⁴–10⁻³ Hz）</strong>振幅很大（十的负二次方量级），总体比“removed”曲线高很多 —— 表明参考轨道相关误差主要影响低频段。</p><p>（3）“removed”（黄/紫）曲线在整体上噪声底更低，尤其在中高频段（约 10⁻³ – 10⁻¹ Hz）能显著降低 ASD。</p><p>（4）曲线在中低频到中频有明显的摆动/谐振样的起伏（一系列峰谷），这类周期性 “波纹” 常见于处理的传递函数/滤波器效应、或者是基函数投影（例如球谐/滤波器）导致的频域形状。</p><p>（5）在较高频（大约 10⁻²–10⁻¹ Hz）有峰或凹陷（如紫色在 ~3×10⁻²–10⁻¹ Hz 出现上升），表明不同测距系统在高频噪声特性上不同。</p><p>（6）无参考 KBR 和 LRI LGD 的信噪比分别在 25 和 40 mHz 时达到 1。在信噪比等于 1 的频率之外，LGD 成分主要受高频噪声的影响，参考轨道几乎无法降低这些噪声。</p><p>（7）图上标注 “30 mHz (LRI)” 与 “1.2 mHz (KBR)”（绿色/粉色竖线），是作者为了抑制高频随机噪声，对 KBR LGD 应用了截止频率为 1 和 12 mHz 的带通滤波器，对 LRI LGD 应用了截止频率为 1 和 30 mHz 的带通滤波器。</p><h2 id="2-2-分段分析ASD"><a href="#2-2-分段分析ASD" class="headerlink" title="2.2 分段分析ASD"></a>2.2 分段分析ASD</h2><ul><li><strong>低频（~10⁻⁴ — 10⁻³ Hz）</strong></li></ul><p>曲线振幅最大。常见来源：轨道误差（参考轨道误差）、大尺度地球质量变化（潮汐、大气/水文长期变化）、地球自转相关成分、长期热漂移等。（每个波峰表示一个占比较大的分量）</p><p>图中“reserved” 曲线在此段显著高于“removed”，强烈支持“removed”处理确实削弱了低频的轨道相关噪声/误差。</p><ul><li><strong>中低频（~10⁻³ — 10⁻² Hz）</strong></li></ul><p>曲线开始下降，但仍有一系列波动（多重峰/谷）。可能原因：</p><pre><code class="hljs">真实地球信号（有些地球动力学/大气模态落在此段）；数据处理的传递函数（滤波、平滑或球谐截断等）引入的“纹波”；频谱估计方法（段长、窗函数）产生的频谱分辨率/泄漏效应。</code></pre><p>“removed” 曲线相比“reserved”更低，表明轨道校正/去除改善了此段的背景噪声。</p><details><summary>详细解释</summary>“曲线下降但仍有波动（多重峰谷）”背后确实可能来自三个方面：地球信号、数据处理传递函数、频谱估计方法。（1） 真实地球信号地球动力学模态：地球本身存在一些周期性或准周期性的过程，比如：潮汐（固体潮、海潮、大气潮汐），其主频往往落在日频、半日频、月频等位置；大气压力与风场变化，可能激发某些特定频率的响应；海洋质量变化等。在频谱上，这些信号会表现为特定频率点附近的“峰”或能量集中，而不是完全平滑的下降曲线。理解方式：这些是真实的物理信号，说明仪器确实观测到了地球的动力学效应，它们叠加在噪声基线上。如下图：我在图中人为在某些频段加入了局部峰，用以表示大气、海洋、地潮或地球动力学过程，其在ASD图中的特征通常表现为比较窄带、位置有物理解释。![alt text](image-16.png)（2）数据处理的传递函数滤波效应：在处理过程中（如高通、低通、带通滤波），滤波器的幅频响应不是一条完美的平直线，而会带来通带起伏（ripple） 或截止附近的陡降，造成谱线起伏。球谐截断：GRACE/GRACE-FO 等反演时往往在某一阶数截断球谐展开。截断等价于在频域上乘了一个矩形窗，会导致 Gibbs 振荡（纹波）。平滑/正则化：加权滤波或正则化算子也会在频域中引入“波纹”状特征。理解方式：这是数据处理算法自身的传递函数（transfer function）在频域上的印迹，它会把原始平滑谱弄出一些规律性的起伏。如下图：在 GRACE/GRACE-FO 数据处理中，滤波器的传递函数、球谐展开截断等，会在频率域引入周期性振荡。图里表现为曲线带有正弦调制（波浪形）。在ASD图中的特征表现为规律性、和处理参数（滤波宽度、阶数）有关。![alt text](image-15.png)（3）频谱估计方法有限数据段长：做 FFT 或 Welch 法时，时间序列不是无限长的，所以等价于乘了一个有限时间窗。有限窗会导致谱分辨率有限。窗函数选择：矩形窗容易产生严重的旁瓣泄漏，导致谱上出现周期性起伏；Hanning/Hamming 窗能抑制泄漏但仍可能引入能量展宽。谱泄漏：如果真实信号频率不能被采样长度整除，会“泄漏”到附近频率点，表现为假峰或纹波。理解方式：这是频谱估计的数值方法误差，和数据物理信号无关如下图，频谱计算（FFT、Welch）涉及窗函数和分段长度，容易导致能量“泄漏”到周围频率，产生伪峰。图里模拟成高频小幅抖动。特征：不规则、依赖分段与窗函数选择，通常与物理无关。![alt text](image-22.png)**总结**如果峰值位置与已知物理频率（潮汐、大气模态）一致 → 属于真实信号；如果峰谷呈现规则间隔（与滤波器或球谐截断的传递函数吻合） → 属于数据处理效应；如果峰谷随数据长度、窗函数改变而移动或消失 → 属于频谱估计方法造成的假象。如下图，这张合并图就把三种情况放到一张曲线图里了，便于和文字对应：![alt text](image-21.png)黑线：理想情况，只受 <mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="4.614ex" height="2.452ex" role="img" focusable="false" viewbox="0 -833.9 2039.6 1083.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mn"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(500,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"/></g></g><g data-mml-node="msup" transform="translate(1000,0)"><g data-mml-node="mi"><path data-c="1D453" d="M118 -162Q120 -162 124 -164T135 -167T147 -168Q160 -168 171 -155T187 -126Q197 -99 221 27T267 267T289 382V385H242Q195 385 192 387Q188 390 188 397L195 425Q197 430 203 430T250 431Q298 431 298 432Q298 434 307 482T319 540Q356 705 465 705Q502 703 526 683T550 630Q550 594 529 578T487 561Q443 561 443 603Q443 622 454 636T478 657L487 662Q471 668 457 668Q445 668 434 658T419 630Q412 601 403 552T387 469T380 433Q380 431 435 431Q480 431 487 430T498 424Q499 420 496 407T491 391Q489 386 482 386T428 385H372L349 263Q301 15 282 -47Q255 -132 212 -173Q175 -205 139 -205Q107 -205 81 -186T55 -132Q55 -95 76 -78T118 -61Q162 -61 162 -103Q162 -122 151 -136T127 -157L118 -162Z"/></g><g data-mml-node="mn" transform="translate(636,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/></g></g></g></g></svg></mjx-container> 噪声控制，曲线平滑下降。红虚线：在某频率（如 0.02 Hz）叠加了地球真实信号，表现为一个**局部峰**。蓝点划线：加入滤波或球谐截断效应，曲线出现规律性的“**波浪形**”纹波。绿色点线：模拟频谱估计泄漏，曲线出现**不规则的小抖动伪峰**。</details><ul><li><strong>中高频（~10⁻² — 10⁻¹ Hz）</strong></li></ul><p>这是仪表本身（LRI / KBR）性能差异更明显的频带。图上可以看到：</p><pre><code class="hljs">黄（LRI removed）在很多频率段是更低的噪声底，说明 LRI 在这些频率段噪声更小（激光测距在中高频通常优于微波测距）。紫（KBR removed）在某一段出现上升（一个 bump），可能是 KBR 的系统噪声、相位计噪声、或处理后遗留的谱线/机械/热噪所致。</code></pre><h2 id="2-3-LRI和KBR的对比"><a href="#2-3-LRI和KBR的对比" class="headerlink" title="2.3 LRI和KBR的对比"></a>2.3 LRI和KBR的对比</h2><p>短周期/中高频段（&gt;≈10⁻² Hz）：LRI（黄/蓝）总体<strong>噪声底</strong>比 KBR（紫/橙）更低，尤其是在“removed”情形下差距更明显 ⇒ 说明 LRI 在短时尺度/高频分量上性能更好（这与 LRI 的设计目标相符）。</p><p>超低频（&lt;≈10⁻³ Hz）：曲线受到参考轨道与大尺度地球信号主导，两种测距系统差别被轨道误差掩盖（因此“reserved”曲线接近）。去除轨道成分后，仪器之间的差异在中高频显现出来。</p><p>KBR 的 bump（紫色在 ~几×10⁻² Hz）：可能是 KBR 的系统带噪、谐振或处理残留。需要查看 KBR 的内部噪声谱或相位计特性确认。</p><h2 id="2-4-可能的噪声-谱形来源"><a href="#2-4-可能的噪声-谱形来源" class="headerlink" title="2.4 可能的噪声/谱形来源"></a>2.4 可能的噪声/谱形来源</h2><ul><li><p>参考轨道误差（低频、保留时主导）</p></li><li><p>大尺度地球物理信号（潮汐、长周期水文/大气质心变化）</p></li><li><p>仪器本底（相位计噪声、激光/微波系统噪声）</p></li><li><p>姿态/角速度耦合（卫星姿态抖动带来的加速度误差）</p></li><li><p>热/机械响应（构形变化、共振峰）</p></li><li><p>处理引入的传递函数/滤波效应（球谐截断、空域/频域平滑）</p></li><li><p>估谱参数导致的谱“波纹”（段长、窗函数、频率分辨率）</p></li></ul><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p>Li, Hao-si, Shuang Yi, Zi-ren Luo, and Peng Xu. 2024. “Revealing High-Temporal-Resolution Flood Evolution With Low Latency Using GRACE Follow-On Ranging Data.” Water Resources Research 60(6):e2023WR036332. doi:10.1029/2023WR036332.</p><p>Zhu, Zitong, Changqing Wang, Yihao Yan, Yuhao Xiong, Qinglu Mu, Haoming Yan, and Zizhan Zhang. 2025. “Assessing the Performance of GRACE-FO KBR and LRI in Detecting Mass Changes Using Along-Orbit Range-Accelerations.” Journal of Geophysical Research: Solid Earth 130(6):e2024JB029428. doi:10.1029/2024JB029428.</p><p>Han, Shin-Chan, David D. Rowlands, Scott B. Luthcke, and Frank G. Lemoine. 2008. “Localized Analysis of Satellite Tracking Data for Studying Time-Variable Earth’s Gravity Fields.” Journal of Geophysical Research: Solid Earth 113(B6). doi:10.1029/2007JB005218.</p><p>Ghobadi-Far, Khosro, Shin-Chan Han, Christopher M. McCullough, David N. Wiese, Richard D. Ray, Jeanne Sauber, Linus Shihora, and Henryk Dobslaw. 2022. “Along-Orbit Analysis of GRACE Follow-On Inter-Satellite Laser Ranging Measurements for Sub-Monthly Surface Mass Variations.” Journal of Geophysical Research: Solid Earth 127(2):e2021JB022983. doi:10.1029/2021JB022983.</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GRACE</tag>
      
      <tag>GRACE-FO</tag>
      
      <tag>LGD</tag>
      
      <tag>ASD</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>详细介绍利用GRACE1B单日数据计算LGD工作流程一(基于KBR1B单日数据)</title>
    <link href="/2025/09/23/%E8%AF%A6%E7%BB%86%E4%BB%8B%E7%BB%8D%E5%88%A9%E7%94%A8GRACE1B%E6%95%B0%E6%8D%AE%E8%AE%A1%E7%AE%97LGD%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B/"/>
    <url>/2025/09/23/%E8%AF%A6%E7%BB%86%E4%BB%8B%E7%BB%8D%E5%88%A9%E7%94%A8GRACE1B%E6%95%B0%E6%8D%AE%E8%AE%A1%E7%AE%97LGD%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="1-前言"><a href="#1-前言" class="headerlink" title="1.前言"></a>1.前言</h1><p>本文详细介绍了利用GRACE-FO卫星Level-1B（L1B）数据中的KBR1B单日观测数据，计算视线向重力差（line-of-sight gravity difference, LGD）和距离加速度残差（range accelrations difference, RA）的完整工作流程。该流程基于GROOPS软件进行动力学轨道积分与K‐Band ranging(KBR) Level1B数据提取，并结合Python与MATLAB脚本完成后续的LGD/RA计算、连续小波变换滤波、振幅谱密度分析及结果可视化。</p><p>需要特别说明的是：</p><p>本流程及附件中所提供的全部脚本，仅适用于处理单日KBR1B数据。</p><p>脚本对输入数据的采样完整性有严格要求，仅能处理一天内采样连续、无间断的KBR1B数据，即每日采样点数必须为完整的17280个（采样间隔为5秒）。</p><p>使用者在实际应用前，请务必确认所处理的数据满足上述条件，以确保计算结果的准确性与可靠性。</p><h1 id="2-利用GROOPS计算动力学轨道"><a href="#2-利用GROOPS计算动力学轨道" class="headerlink" title="2. 利用GROOPS计算动力学轨道"></a>2. 利用GROOPS计算动力学轨道</h1><p>工作目录（workdir）：<code>G:\GROOPS\dynamicOrbitSolutionWorkspace</code></p><h2 id="2-1-创建目录"><a href="#2-1-创建目录" class="headerlink" title="2.1 创建目录"></a>2.1 创建目录</h2><p>在工作目录下创建四个文件夹，分别命名为<code>input</code>、<code>output</code>、<code>image</code>、<code>gracefo_dataset</code>如下，包含GROOPS处理脚本，目录结构如下。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs Shell">workdir/<br>├── input/<br>├── output/<br>├── image/<br>├── gracefo_dataset/<br>└── S00GroopsIntegrateOrbitKBR-20200707.xml（GROOPS处理动力学轨道脚本）<br><br></code></pre></td></tr></table></figure><h2 id="2-2-数据准备"><a href="#2-2-数据准备" class="headerlink" title="2.2 数据准备"></a>2.2 数据准备</h2><p>本教程用以计算单日LGD数据，以2020-07-07日期数据为例。</p><p>数据下载包含AOD1B RL06数据和GRACE-FO Level 1B RL04 .noLRI数据和.LRI数据。以2020-07-07日期数据为例，文件下载解压后文件夹名为gracefo_1B_2020-07-07_RL04.ascii.noLRI 和 gracefo_1B_2020-07-07_RL04.ascii.LRI。</p><p>AOD1B RL06：ftp://isdcftp.gfz.de/grace-fo/Level-1B/GFZ/AOD/RL06/2020/AOD1B_2020-06-02_X_06.asc.gz （通过filezilla软件下载）</p><p>GRACE-FO数据下载链接：<a href="https://podaac.jpl.nasa.gov/dataset/GRACEFO_L1B_ASCII_GRAV_JPL_RL04">https://podaac.jpl.nasa.gov/dataset/GRACEFO_L1B_ASCII_GRAV_JPL_RL04</a> 或 <a href="https://search.earthdata.nasa.gov/search/granules?p=C2036882118-POCLOUD&amp;pg[0][v]=f&amp;tl=1743148786.317!3!!">https://search.earthdata.nasa.gov/search/granules?p=C2036882118-POCLOUD&amp;pg[0][v]=f&amp;tl=1743148786.317!3!!</a></p><p>GRACE-FO数据数据下载完成后，解压后将gracefo_1B_2020-07-07_RL04.ascii.noLRI 和 gracefo_1B_2020-07-07_RL04.ascii.LRI两个文件夹拷贝到<code>workdir/gracefo_dataset/</code>下。AOD1B数据下载完成后，解压后将文件拷贝到<code>workdir/gracefo_dataset/</code>下。</p><p><em>注意：AOD1B数据要在实际处理日期上多添加一天的文件。如本教程中处理2020-07-07，则AOD1B数据需要拷贝2020-07-07和2020-07-08两天的文件。</em></p><p><img src="/2025/09/23/%E8%AF%A6%E7%BB%86%E4%BB%8B%E7%BB%8D%E5%88%A9%E7%94%A8GRACE1B%E6%95%B0%E6%8D%AE%E8%AE%A1%E7%AE%97LGD%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B/image.png" alt="alt text"></p><h2 id="2-3-程序运行"><a href="#2-3-程序运行" class="headerlink" title="2.3 程序运行"></a>2.3 程序运行</h2><p><strong>参数修改</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs Shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">global 模块参数修改</span><br>workspace → "G:\GROOPS\dynamicOrbitSolutionWorkspace"<br>date4int → "2020-07-07"<br>resampleInterval → 5<br>instrument → kbr<br>background → ggm05b<br>timeIntervalsDaily(uniformSampling)<br>├── timeStart → 590372020-07-07 00:00:00<br>├── timeEnd → 59037+23/24+59/1440+55/86400 （2020-07-07 23:59:55）<br>└── sampling → 5/86400<br></code></pre></td></tr></table></figure><p>参数修改后在GROOPS运行<code>S00GroopsIntegrateDynamicOrbitKBR-20200707.xml</code>脚本（脚本放在后面）。</p><p>注意：<br>    （1）本脚本仅能运行KBR1B数据；<br>    （2）本脚本仅能运行所有L1B数据采样为17280的情况（本脚本使用的L1B数据仅涉及ACT1B、GNV1B、KBR1B和SCA1B双星数据。</p><h1 id="3-利用GROOPS提取KBR1B数据"><a href="#3-利用GROOPS提取KBR1B数据" class="headerlink" title="3.利用GROOPS提取KBR1B数据"></a>3.利用GROOPS提取KBR1B数据</h1><p>工作目录（workdir）：<code>G:\GROOPS\dynamicOrbitSolutionWorkspace</code></p><p><strong>参数修改</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">global 模块参数修改</span><br>workspace → "G:\GROOPS\dynamicOrbitSolutionWorkspace"<br>date4int → "2020-07-07"<br></code></pre></td></tr></table></figure><p>参数修改后在GROOPS运行<code>S01SatelliteTrackingFromKBR-20200707.xml</code>脚本（脚本放在后面）。</p><h1 id="4-利用Python计算RA和LGD"><a href="#4-利用Python计算RA和LGD" class="headerlink" title="4. 利用Python计算RA和LGD"></a>4. 利用Python计算RA和LGD</h1><p>工作目录（workdir）：<code>G:\GROOPS\dynamicOrbitSolutionWorkspace</code>。</p><p>下载附件中的<code>S02compute_grace_lgd.py</code>程序，修改以下参数后运行。</p><p><strong>参数修改</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python">date_str = <span class="hljs-string">'2020-07-07'</span>     <span class="hljs-comment"># 日期</span><br>groops_workspace = <span class="hljs-string">'G:\GROOPS\dynamicOrbitSolutionWorkspace'</span>    <span class="hljs-comment"># GROOPS工作目录</span><br></code></pre></td></tr></table></figure><p>程序运行后将在工作目录下生成<code>results</code>文件夹，其中<code>time-lgd-date_str</code>为计算的LGD数据，<code>time-ra-date_str</code>为计算的ra数据。</p><h1 id="5-利用MATLAB对LGD或RA数据执行连续小波变换"><a href="#5-利用MATLAB对LGD或RA数据执行连续小波变换" class="headerlink" title="5. 利用MATLAB对LGD或RA数据执行连续小波变换"></a>5. 利用MATLAB对LGD或RA数据执行连续小波变换</h1><p>工作目录（workdir）：<code>G:\GROOPS\dynamicOrbitSolutionWorkspace</code>。</p><p>下载附件中的<code>S03cwt_fliter_lgd_ra.m</code>程序，修改以下参数后运行。</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs matlab">date_str = <span class="hljs-string">'2020-07-07'</span>;    <span class="hljs-comment">% 日期</span><br>data_type = <span class="hljs-string">'ra'</span>;   <span class="hljs-comment">% 数据类型，'ra' 或 'lgd'</span><br></code></pre></td></tr></table></figure><p>程序运行后在<code>results</code>文件夹下生成<code>cwt_time_ra-date_str.mat</code>文件（滤波后的RA数据）或<code>cwt_time_lgd-date_str.mat</code>文件（滤波后的LGD数据）。</p><p>注意：输出文件中的lgd和ra的数据的单位都为<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="5.166ex" height="2.452ex" role="img" focusable="false" viewbox="0 -833.9 2283.6 1083.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(878,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"/></g></g><g data-mml-node="msup" transform="translate(1378,0)"><g data-mml-node="mi"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"/></g><g data-mml-node="mn" transform="translate(502,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/></g></g></g></g></svg></mjx-container>。</p><h1 id="6-利用Python绘制LGD或RA数据的振幅谱密度（ASD）"><a href="#6-利用Python绘制LGD或RA数据的振幅谱密度（ASD）" class="headerlink" title="6. 利用Python绘制LGD或RA数据的振幅谱密度（ASD）"></a>6. 利用Python绘制LGD或RA数据的振幅谱密度（ASD）</h1><p>工作目录（workdir）：<code>G:\GROOPS\dynamicOrbitSolutionWorkspace</code>。</p><p>下载附件中的<code>S04lgd_ra_lpsd.py</code>程序，修改以下参数后运行。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python">date_str = <span class="hljs-string">'2020-07-07'</span><br>groops_workspace = <span class="hljs-string">'G:\GROOPS\dynamicOrbitSolutionWorkspace'</span><br>data_type = <span class="hljs-string">'ra'</span>    <span class="hljs-comment"># options: ra, lgd</span><br></code></pre></td></tr></table></figure><p><code>S04lgd_ra_lpsd.py</code>程序读取来自<code>results</code>文件夹下生成的<code>time-lgd-date_str</code>文件（滤波前的LGD数据）、<code>time-ra-date_str</code>文件（滤波前的RA数据）、<code>cwt_time_ra-date_str.mat</code>文件（滤波后的RA数据）和<code>cwt_time_ra-date_str.mat</code>文件（滤波后的LGD数据），根据参数data_type的不同，绘制lgd或ra的振幅谱密度，并将绘制结果保存在<code>results</code>文件夹下。</p><p>注意：绘制程序中的输入文件的lgd和ra的单位都为<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="5.166ex" height="2.452ex" role="img" focusable="false" viewbox="0 -833.9 2283.6 1083.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(878,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"/></g></g><g data-mml-node="msup" transform="translate(1378,0)"><g data-mml-node="mi"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"/></g><g data-mml-node="mn" transform="translate(502,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/></g></g></g></g></svg></mjx-container>，图中绘制的ASD的单位都为[<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="11.289ex" height="2.745ex" role="img" focusable="false" viewbox="0 -963.5 4989.6 1213.5"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(878,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"/></g></g><g data-mml-node="msup" transform="translate(1378,0)"><g data-mml-node="mi"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"/></g><g data-mml-node="mn" transform="translate(502,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/></g></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(2283.6,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"/></g></g><g data-mml-node="msqrt" transform="translate(2783.6,0)"><g transform="translate(853,0)"><g data-mml-node="mi"><path data-c="1D43B" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 219 683Q260 681 355 681Q389 681 418 681T463 682T483 682Q499 682 499 672Q499 670 497 658Q492 641 487 638H485Q483 638 480 638T473 638T464 637T455 637Q416 636 405 634T387 623Q384 619 355 500Q348 474 340 442T328 395L324 380Q324 378 469 378H614L615 381Q615 384 646 504Q674 619 674 627T617 637Q594 637 587 639T580 648Q580 650 582 660Q586 677 588 679T604 682Q609 682 646 681T740 680Q802 680 835 681T871 682Q888 682 888 672Q888 645 876 638H874Q872 638 869 638T862 638T853 637T844 637Q805 636 794 634T776 623Q773 618 704 340T634 58Q634 51 638 51Q646 48 692 46H723Q729 38 729 37T726 19Q722 6 716 0H701Q664 2 567 2Q533 2 504 2T458 2T437 1Q420 1 420 10Q420 15 423 24Q428 43 433 45Q437 46 448 46H454Q481 46 514 49Q520 50 522 50T528 55T534 64T540 82T547 110T558 153Q565 181 569 198Q602 330 602 331T457 332H312L279 197Q245 63 245 58Q245 51 253 49T303 46H334Q340 38 340 37T337 19Q333 6 327 0H312Q275 2 178 2Q144 2 115 2T69 2T48 1Q31 1 31 10Q31 12 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"/></g><g data-mml-node="mi" transform="translate(888,0)"><path data-c="1D467" d="M347 338Q337 338 294 349T231 360Q211 360 197 356T174 346T162 335T155 324L153 320Q150 317 138 317Q117 317 117 325Q117 330 120 339Q133 378 163 406T229 440Q241 442 246 442Q271 442 291 425T329 392T367 375Q389 375 411 408T434 441Q435 442 449 442H462Q468 436 468 434Q468 430 463 420T449 399T432 377T418 358L411 349Q368 298 275 214T160 106L148 94L163 93Q185 93 227 82T290 71Q328 71 360 90T402 140Q406 149 409 151T424 153Q443 153 443 143Q443 138 442 134Q425 72 376 31T278 -11Q252 -11 232 6T193 40T155 57Q111 57 76 -3Q70 -11 59 -11H54H41Q35 -5 35 -2Q35 13 93 84Q132 129 225 214T340 322Q352 338 347 338Z"/></g></g><g data-mml-node="mo" transform="translate(0,103.5)"><path data-c="221A" d="M95 178Q89 178 81 186T72 200T103 230T169 280T207 309Q209 311 212 311H213Q219 311 227 294T281 177Q300 134 312 108L397 -77Q398 -77 501 136T707 565T814 786Q820 800 834 800Q841 800 846 794T853 782V776L620 293L385 -193Q381 -200 366 -200Q357 -200 354 -197Q352 -195 256 15L160 225L144 214Q129 202 113 190T95 178Z"/></g><rect width="1353" height="60" x="853" y="843.5"/></g></g></g></svg></mjx-container>]。</p><h1 id="7-利用Python绘制LGD或RA数据滤波前后的曲线图"><a href="#7-利用Python绘制LGD或RA数据滤波前后的曲线图" class="headerlink" title="7. 利用Python绘制LGD或RA数据滤波前后的曲线图"></a>7. 利用Python绘制LGD或RA数据滤波前后的曲线图</h1><p>工作目录（workdir）：<code>G:\GROOPS\dynamicOrbitSolutionWorkspace</code>。</p><p>下载附件中的<code>S05plot_lgd_ra_cwt_filter.py</code>程序，修改以下参数后运行。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python">date_str = <span class="hljs-string">'2020-07-07'</span>     <span class="hljs-comment"># 日期</span><br>groops_workspace = <span class="hljs-string">'G:/GROOPS/dynamicOrbitSolutionWorkspace'</span>    <span class="hljs-comment"># GROOPS工作目录</span><br>data_type = <span class="hljs-string">'lgd'</span>   <span class="hljs-comment"># 'ra' or 'lgd'</span><br>trunc_st, trunc_ed = <span class="hljs-number">5470</span>, <span class="hljs-number">5990</span>  <span class="hljs-comment"># 2020-07-07   # 截取范围，不设置则视作一天的全部采样点</span><br></code></pre></td></tr></table></figure><p><code>S05plot_lgd_ra_cwt_filter.py</code>程序读取来自<code>results</code>文件夹下生成的<code>time-lgd-date_str</code>文件（滤波前的LGD数据）、<code>time-ra-date_str</code>文件（滤波前的RA数据）、<code>cwt_time_ra-date_str.mat</code>文件（滤波后的RA数据）和<code>cwt_time_ra-date_str.mat</code>文件（滤波后的LGD数据），根据参数data_type的不同，绘制lgd或ra的曲线图，包含lgd-lat图和时序图。</p><p>注意：绘制程序中的输入文件的lgd和ra的单位都为<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="5.166ex" height="2.452ex" role="img" focusable="false" viewbox="0 -833.9 2283.6 1083.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(878,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"/></g></g><g data-mml-node="msup" transform="translate(1378,0)"><g data-mml-node="mi"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"/></g><g data-mml-node="mn" transform="translate(502,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/></g></g></g></g></svg></mjx-container>，图中绘制的曲线图的单位都为<mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="6.524ex" height="2.452ex" role="img" focusable="false" viewbox="0 -833.9 2883.6 1083.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="mi" transform="translate(600,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"/></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(1478,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"/></g></g><g data-mml-node="msup" transform="translate(1978,0)"><g data-mml-node="mi"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"/></g><g data-mml-node="mn" transform="translate(502,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/></g></g></g></g></svg></mjx-container>。</p><h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p>Li, Hao-si, Shuang Yi, Zi-ren Luo, and Peng Xu. 2024. “Revealing High-Temporal-Resolution Flood Evolution With Low Latency Using GRACE Follow-On Ranging Data.” Water Resources Research 60(6):e2023WR036332. doi:10.1029/2023WR036332.</p><p>Han, Shin-Chan, Khosro Ghobadi-Far, In-Young Yeo, Christopher M. McCullough, Eunjee Lee, and Jeanne Sauber. 2021. “GRACE Follow-On Revealed Bangladesh Was Flooded Early in the 2020 Monsoon Season Due to Premature Soil Saturation.” Proceedings of the National Academy of Sciences 118(47):e2109086118. doi:10.1073/pnas.2109086118.</p><h1 id="附件"><a href="#附件" class="headerlink" title="附件"></a>附件</h1><p>上述中涉及到的所有程序脚本都打包到压缩包中，解压后文件目录如下。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs Shell">Scripts_grace_kbr1b_lgd_20250926/<br>├── process_cwt_fliter_signal_data.m<br>├── S00GroopsIntegrateOrbitKBR-20200707.xml<br>├── S01SatelliteTrackingFromKBR-20200707.xml<br>├── S02compute_grace_lgd.py<br>├── S03cwt_fliter_lgd_ra.m<br>├── S04lgd_ra_lpsd.py<br>└── S05plot_lgd_ra_cwt_filter.py<br><br></code></pre></td></tr></table></figure><p>下载链接：<a href="/downloads/Scripts_grace_kbr1b_lgd_20250926.zip" download>GRACE-FO KBR1B单日数据反演LGD和RA脚本</a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GRACE</tag>
      
      <tag>GRACE-FO</tag>
      
      <tag>Python</tag>
      
      <tag>LGD</tag>
      
      <tag>ASD</tag>
      
      <tag>GROOPS</tag>
      
      <tag>KBR1B</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>GRACE中的Mascons数据最新下载简介</title>
    <link href="/2025/01/07/GRACE%E4%B8%AD%E7%9A%84MASCON%E6%95%B0%E6%8D%AE%E4%B8%8B%E8%BD%BD%E7%AE%80%E4%BB%8B/"/>
    <url>/2025/01/07/GRACE%E4%B8%AD%E7%9A%84MASCON%E6%95%B0%E6%8D%AE%E4%B8%8B%E8%BD%BD%E7%AE%80%E4%BB%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="1-GRACE中的Mascons数据下载简介"><a href="#1-GRACE中的Mascons数据下载简介" class="headerlink" title="1. GRACE中的Mascons数据下载简介"></a>1. GRACE中的Mascons数据下载简介</h1><p>GRACE 孪生卫星于 2002 年 3 月 17 日发射，对地球重力场变化进行详细测量，并彻底改变了对地球陆地、冰盖和海洋水库以及地震和地壳变形的研究。两颗 GRACE 卫星已完成超过 13 年的连续测量！</p><p>GRACE 是美国和德国航天机构（NASA 和 DLR）的合作项目。目前，GRACE 地面段的运营由 GFZ 德国地球科学研究中心和欧洲航天局 (ESA) 共同资助。NASA、ESA、GFZ 和 DLR 正在支持继续测量地球系统的质量再分布。该任务的设计、建造和发射的主要合作伙伴包括喷气推进实验室（JPL）、德克萨斯大学空间研究中心（CSR）、德国地球科学研究中心（GFZ）以及 Astrium GmBH、Space Systems Loral (SS&#x2F;L)、Onera 和 Eurockot GmBH。</p><p>质量浓度块（Mascons）本质上是另一种形式的重力场基函数，用于拟合 GRACE 卫星的星间测距观测数据。与标准的球谐函数方法相比，mascons 提供了多个关键优势。球谐方法是 GRACE&#x2F;GRACE-FO 观测前十年中的标准方法，而 Mascons 的应用使得地球物理约束的实现变得更加容易。这些先验约束有助于在 Level-2 数据处理阶段过滤掉 GRACE&#x2F;GRACE-FO 观测数据中的噪声，这种方法比球谐方法生成的陆地和海洋网格所需的经验性后处理滤波更加严谨。</p><p>目前发布Mascons数据产品的包括三大机构，分别是CSR、JPL和GSFC（注意不是GFZ）。</p><h1 id="2-JPL发布的Mascons数据下载"><a href="#2-JPL发布的Mascons数据下载" class="headerlink" title="2.JPL发布的Mascons数据下载"></a>2.JPL发布的Mascons数据下载</h1><p>简介：JPL RL06M 质量块解决方案针对放置在椭圆地球表面的 4,551 个等面积 3 度球冠质量块求解每月重力场变化。自然，这些质量块的子集位于海岸线上，因此它们包含混合的陆地和海洋信号。该产品应用了海岸线分辨率改进 (CRI) 过滤器以在后处理步骤中分离每个陆地&#x2F;海洋质量块内的陆地和海洋质量部分。由于海岸线定义明确，因此此过滤器的效果将在数据中轻松看到。更多处理细节可在<a href="https://grace.jpl.nasa.gov/data/get-data/jpl_global_mascons/">官网</a>查看。</p><p>JPL Mascons数据下载官网：<a href="https://grace.jpl.nasa.gov/data/get-data/jpl_global_mascons/">https://grace.jpl.nasa.gov/data/get-data/jpl_global_mascons/</a></p><h2 id="数据下载"><a href="#数据下载" class="headerlink" title="数据下载"></a>数据下载</h2><ol><li>登陆官网，如图，当前JPL-Mascons数据最新版本为JPL RL06.3_v04。</li></ol><ol start="2"><li>点击右上角”Current Data Versions”中的”JPL PO.DAAC.”，跳转的页面为最新JPL-Mascons数据下载页面，如图。</li></ol><ol start="3"><li>进入”JPL PO.DAAC.”页面后，点击”Data Access”，跳转至数据下载页面，如图。</li></ol><ol start="4"><li>点击上图中红框标记的链接，即”Search Granules”，跳转至数据搜索页面，如图。</li></ol><ol start="5"><li>搜索页面如上图，点击“下载”按钮，进行下载，数据格式为NC格式，下载成功。</li></ol><ol start="6"><li>查看数据可使用Matlab或Python读取查看，也可使用NASA提供的可视化工具进行查看，如<a href="https://www.giss.nasa.gov/tools/panoply/download/">Panoply</a>，如使用Ubuntu系统，Panoply可参考<a href="https://singyutang.github.io/2023/09/26/ubuntu16.04%E5%AE%89%E8%A3%85jdk%E5%92%8Cpanoply/">博客</a>安装。</li></ol><h1 id="3-CSR发布的Mascons数据下载"><a href="#3-CSR发布的Mascons数据下载" class="headerlink" title="3.CSR发布的Mascons数据下载"></a>3.CSR发布的Mascons数据下载</h1><p>简介：CSR-Mascons数据产品当前最新产品为RL06.3(RL0603)，RL06.3 质量块已被重新处理的 RL06.3 质量块取代。与 RL06.2 质量块相比，RL06.3产品使用改进后的 GRACE-FO 加速度计数据处理重力场（ACH 与 ACX2 数据集），以应对采用宽松的姿态控制死区的日期，从而缓解冷气体推进系统的泄漏。重新处理的月份包括 2023 年 1 月和 2 月，以及 2023 年 7 月及之后的所有月份。更多处理细节可在<a href="https://www2.csr.utexas.edu/grace/RL06_mascons.html">CSR Mascons官网</a>查看。</p><p>CSR Mascons数据下载官网：<a href="https://www2.csr.utexas.edu/grace/RL06_mascons.html">https://www2.csr.utexas.edu/grace/RL06_mascons.html</a></p><p>注意：本文撰写时发布的CSR Mascons数据时间跨度：2002 年 4 月至 2024 年 10 月，数据更新日期：2025-01-06.</p><h2 id="数据下载-1"><a href="#数据下载-1" class="headerlink" title="数据下载"></a>数据下载</h2><ol><li>登陆官网，如图，当前CSR Mascons数据最新版本为 CSR RL06.3(RL0603)。</li></ol><ol start="2"><li>点击下图红框中的内容进行下载，数据格式为NC，数据查看见上文。</li></ol><h1 id="4-GSFC发布的Mascons数据下载"><a href="#4-GSFC发布的Mascons数据下载" class="headerlink" title="4. GSFC发布的Mascons数据下载"></a>4. GSFC发布的Mascons数据下载</h1><p>简介：GSFC机构发布的Mascons产品包含每月 Mascons 产品和高分辨率趋势质量矩产品，更多细节和<a href="https://earth.gsfc.nasa.gov/sites/default/files/2022-05/gsfc_mascons_hdf5_format_rl06v2.pdf">参考文档</a>可在<a href="https://earth.gsfc.nasa.gov/geo/data/grace-mascons">GSFC官网</a>查看。</p><p>数据下载官网：<a href="https://earth.gsfc.nasa.gov/geo/data/grace-mascons">https://earth.gsfc.nasa.gov/geo/data/grace-mascons</a></p><h2 id="数据下载-2"><a href="#数据下载-2" class="headerlink" title="数据下载"></a>数据下载</h2><ol><li>登陆官网，如图，当前GSFC Mascons数据最新版本为RL06v2.0。</li></ol><ol start="2"><li>根据研究需要下载对应的数据，数据格式为HDF5、ASCII或NC，数据查看见上文。</li></ol>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GRACE</tag>
      
      <tag>GRACE-FO</tag>
      
      <tag>websites</tag>
      
      <tag>Mascons</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>GitHub如何上传大于25MB的文件</title>
    <link href="/2025/01/05/GitHub%E5%A6%82%E4%BD%95%E4%B8%8A%E4%BC%A0%E5%A4%A7%E4%BA%8E25MB%E7%9A%84%E6%96%87%E4%BB%B6/"/>
    <url>/2025/01/05/GitHub%E5%A6%82%E4%BD%95%E4%B8%8A%E4%BC%A0%E5%A4%A7%E4%BA%8E25MB%E7%9A%84%E6%96%87%E4%BB%B6/</url>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>利用Git上传代码，当大于25MB的文件时，会提示上传失败，此时需要使用Git LFS(Git Large File)来上传大文件。Git安装可参考<a href="https://blog.csdn.net/qq_46351233/article/details/124733661">Git的安装步骤</a>。</p><h1 id="1-下载安装Git-LFS"><a href="#1-下载安装Git-LFS" class="headerlink" title="1 下载安装Git LFS"></a>1 下载安装Git LFS</h1><h2 id="1-1-下载Git-LFS"><a href="#1-1-下载Git-LFS" class="headerlink" title="1.1 下载Git LFS"></a>1.1 下载Git LFS</h2><p>Git LFS 下载链接：<a href="https://github.com/git-lfs/git-lfs/releases">https://github.com/git-lfs/git-lfs/releases</a></p><h2 id="1-2-安装Git-LFS"><a href="#1-2-安装Git-LFS" class="headerlink" title="1.2 安装Git LFS"></a>1.2 安装Git LFS</h2><p>下载完成后，双击安装包，按照提示进行安装即可。</p><h1 id="2-使用Git-LFS"><a href="#2-使用Git-LFS" class="headerlink" title="2.使用Git LFS"></a>2.使用Git LFS</h1><h2 id="2-1-初始化并推送单个文件"><a href="#2-1-初始化并推送单个文件" class="headerlink" title="2.1 初始化并推送单个文件"></a>2.1 初始化并推送单个文件</h2><p>进入我的项目文件夹路径<code>C:\Users\tang xingyou\MyGithub\GRACE_GMT_scripts</code>，打开Git Bash，输入以下命令：</p><p>初始化仓库并安装LFS应用</p><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">git init<br>git <span class="hljs-keyword">lfs</span> install<br>git <span class="hljs-keyword">lfs</span> track *<br>git <span class="hljs-keyword">add</span> .gitattributes<br><br></code></pre></td></tr></table></figure><p>添加属性文件上传的说明：</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">git</span> commit -m <span class="hljs-string">&quot;.gitattributes commit&quot;</span><br></code></pre></td></tr></table></figure><p>建立本地和 Github 仓库的链接（origin 后接自己仓库的链接）</p><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-symbol">git</span> remote <span class="hljs-keyword">add</span> origin https:<span class="hljs-comment">//github.com/SingyuTang/GRACE_GMT_scripts.git</span><br></code></pre></td></tr></table></figure><p>上传文件，推送到远程分支，远程仓库默认分支是 <code>main</code>，因此这里为main分支（可以使用<code>git branch</code>命令查看当前分支</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima">git <span class="hljs-built_in">push</span> -u <span class="hljs-built_in">origin</span> main<br></code></pre></td></tr></table></figure><p>注意，推送前可以使用<code>git ls-remote --heads origin</code>查看远程仓库分支，如果显示的是其他分支（如 master），需要推送到对应分支：</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima">git <span class="hljs-built_in">push</span> <span class="hljs-built_in">origin</span> master<br></code></pre></td></tr></table></figure><p>或者将远程分支名称更改为 main（推荐）再推送：</p><figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs maxima">git <span class="hljs-built_in">push</span> <span class="hljs-built_in">origin</span> main<br></code></pre></td></tr></table></figure><p>如果当前分支名称不是main，可使用命令<code>git branch -M main</code>将当前分支重命名为 main，并强制执行（如果目标分支名已经存在，将会覆盖它）。实际操作步骤如下：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs css">查看当前分支<br>git branch<br>如果当前分支名称不是 <span class="hljs-selector-tag">main</span>，可以使用以下命令重命名<br>git branch -M <span class="hljs-selector-tag">main</span><br>如果远程仓库使用的是 <span class="hljs-selector-tag">main</span> 分支，重命名本地分支后，需要更新远程的分支关联<br>git push <span class="hljs-attr">--set-upstream</span> origin <span class="hljs-selector-tag">main</span><br></code></pre></td></tr></table></figure><h2 id="2-2-推送全部文件"><a href="#2-2-推送全部文件" class="headerlink" title="2.2 推送全部文件"></a>2.2 推送全部文件</h2><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs armasm"><span class="hljs-symbol">git</span> <span class="hljs-keyword">add</span> *<br><span class="hljs-symbol">git</span> commit -m <span class="hljs-string">&quot;Git LFS commit&quot;</span><br><span class="hljs-symbol">git</span> <span class="hljs-keyword">push</span> origin main<br></code></pre></td></tr></table></figure><h2 id="2-3-其它配置"><a href="#2-3-其它配置" class="headerlink" title="2.3 其它配置"></a>2.3 其它配置</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs stylus">设置为 <span class="hljs-number">0</span> 表示关闭低速检测，Git 不会因传输速度过低而中断连接<br>git config <span class="hljs-attr">--global</span> http<span class="hljs-selector-class">.lowSpeedLimit</span> <span class="hljs-number">0</span><br>设置为 <span class="hljs-number">99999</span> 表示允许长时间的低速传输<br>git config <span class="hljs-attr">--global</span> http<span class="hljs-selector-class">.lowSpeedTime</span> <span class="hljs-number">99999</span><br>支持更大的数据块传输<br>git config <span class="hljs-attr">--global</span> http<span class="hljs-selector-class">.postBuffer</span> <span class="hljs-number">157286400</span><br>清除当前远程仓库（origin）的代理设置，确保 Git 直接通过本地网络连接到远程仓库<br>git config <span class="hljs-attr">--global</span> <span class="hljs-attr">--add</span> remote<span class="hljs-selector-class">.origin</span><span class="hljs-selector-class">.proxy</span> <span class="hljs-string">&quot;&quot;</span><br>指定使用 OpenSSL 作为 Git 的 SSL 后端，用于处理 HTTPS 请求的加密通信，更稳定<br>git config <span class="hljs-attr">--global</span> http<span class="hljs-selector-class">.sslBackend</span> <span class="hljs-string">&quot;openssl&quot;</span><br>禁用 SSL 证书验证，忽略 HTTPS 请求中的证书检查。这样可以绕过证书相关的问题<br>git config <span class="hljs-attr">--global</span> http<span class="hljs-selector-class">.sslVerify</span> false<br><br></code></pre></td></tr></table></figure><h1 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h1><p><a href="https://openatomworkshop.csdn.net/67400fc2cd8b2677c3e4ac18.html?spm=1001.2101.3001.6650.3&utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~activity-3-129878135-blog-129417749.235%5Ev43%5Epc_blog_bottom_relevance_base1&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~activity-3-129878135-blog-129417749.235%5Ev43%5Epc_blog_bottom_relevance_base1">GitHub 上传大文件（＞25 MB）教程</a>（推荐）</p><p><a href="https://blog.csdn.net/mu_xing_/article/details/128285608?spm=1001.2101.3001.6650.2&utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Ctr-2-128285608-blog-129417749.235%5Ev43%5Epc_blog_bottom_relevance_base1&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~Ctr-2-128285608-blog-129417749.235%5Ev43%5Epc_blog_bottom_relevance_base1">CSDN-GitHub上传大于25M的文件</a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Git</tag>
      
      <tag>GitHub</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>GRACE/GRACE-FO L2数据下载最新链接</title>
    <link href="/2024/09/29/GRACE-GRACE-FO-L2%E6%95%B0%E6%8D%AE%E4%B8%8B%E8%BD%BD%E6%9C%80%E6%96%B0%E9%93%BE%E6%8E%A5/"/>
    <url>/2024/09/29/GRACE-GRACE-FO-L2%E6%95%B0%E6%8D%AE%E4%B8%8B%E8%BD%BD%E6%9C%80%E6%96%B0%E9%93%BE%E6%8E%A5/</url>
    
    <content type="html"><![CDATA[<h1 id="ICGEM（国际全球地球模型中心）"><a href="#ICGEM（国际全球地球模型中心）" class="headerlink" title="ICGEM（国际全球地球模型中心）"></a>ICGEM（国际全球地球模型中心）</h1><p>ICGEM收录目前所有可用的重力场模型月解数据（L2），不仅包括CSR，GFZ和JPL的GRACE Level-2产品，也包括其它组织机构发布的数据。这里主要介绍三家主要机构发布的产品，数据格式为”.gfc”，包含RL05、RL06，RL06.1，RL06.2。详细产品分类见下图。重力场模型数据下载点击<a href="https://icgem.gfz-potsdam.de/sl/temporal">ICGEM官网链接</a>。</p><h1 id="CSR，GFZ，JPL"><a href="#CSR，GFZ，JPL" class="headerlink" title="CSR，GFZ，JPL"></a>CSR，GFZ，JPL</h1><p>目前，GFZ、JPL和CSR官方发布的L2 产品共有6种，CSR发布RL06以及RL06.2，JPL发布RL06和RL06.1，GFZ发布RL06和RL06.1.</p><p>id &#x3D; BA01 : 60阶</p><p>id &#x3D; BB01 : 96阶</p><p>CSR RL06: <a href="https://search.earthdata.nasa.gov/search/granules?p=C2491772131-POCLOUD&pg%5B0%5D%5Bv%5D=f&pg%5B0%5D%5Bgsk%5D=start_date&q=GRACE%20level-2&tl=1646814569!3!!">GRACE FIELD GEOPOTENTIAL COEFFICIENTS CSR RELEASE 6.0</a></p><p>2002-04-05 to 2017-06-30</p><p>GFZ RL06: <a href="https://search.earthdata.nasa.gov/search/granules?p=C2491772132-POCLOUD&pg%5B0%5D%5Bv%5D=f&pg%5B0%5D%5Bgsk%5D=start_date&g=G2562152220-POCLOUD&q=GRACE%20level-2&tl=1646814569!3!!&zoom=0">GRACE FIELD GEOPOTENTIAL COEFFICIENTS GFZ RELEASE 6.0</a></p><p>2002-04-05 to 2017-06-30</p><p>JPL RL06: <a href="https://search.earthdata.nasa.gov/search/granules?p=C2491772133-POCLOUD&pg%5B0%5D%5Bv%5D=f&pg%5B0%5D%5Bgsk%5D=start_date&q=GRACE%20level-2&tl=1646814569!3!!&zoom=0">GRACE FIELD GEOPOTENTIAL COEFFICIENTS JPL RELEASE 6.0</a></p><p>2002-04-05 to 2017-06-30</p><p>CSR RL06.2：<a href="https://search.earthdata.nasa.gov/search/granules?p=C2753948997-POCLOUD&pg%5B0%5D%5Bv%5D=f&pg%5B0%5D%5Bgsk%5D=-start_date&q=GRACE%20level-2&tl=1646814569!3!!&zoom=0">GRACE-FO Level-2 Monthly Geopotential Spherical Harmonics CSR Release 06.2 (RL06.2)</a></p><p>2018-05-22 ongoing</p><p>JPL RL06.1：<a href="https://search.earthdata.nasa.gov/search/granules?p=C2257298823-POCLOUD&pg%5B0%5D%5Bv%5D=f&pg%5B0%5D%5Bgsk%5D=-start_date&q=GRACE%20level-2&tl=1646814569!3!!&zoom=0">GRACE-FO Level-2 Monthly Geopotential Spherical Harmonics JPL Release 6.1 (RL06.1)</a></p><p>2018-05-22 ongoing</p><p>GFZ RL06.1：<a href="https://search.earthdata.nasa.gov/search/granules?p=C2257298799-POCLOUD&pg%5B0%5D%5Bv%5D=f&pg%5B0%5D%5Bgsk%5D=-start_date&q=GRACE%20level-2&tl=1646814569!3!!&zoom=0">GRACE-FO Level-2 Monthly Geopotential Spherical Harmonics GFZ Release 6.1 (RL06.1)</a></p><p>2018-05-22 ongoing</p><h1 id="一阶项和二阶项的文件下载"><a href="#一阶项和二阶项的文件下载" class="headerlink" title="一阶项和二阶项的文件下载"></a>一阶项和二阶项的文件下载</h1><p>fengweitoolbox包中需要用到的一阶项和二阶项文件下载链接如下。</p><h2 id="一阶项"><a href="#一阶项" class="headerlink" title="一阶项"></a>一阶项</h2><p>CSR：<a href="https://archive.podaac.earthdata.nasa.gov/podaac-ops-cumulus-docs/grace/open/docs/TN-13_GEOC_CSR_RL0601.txt">https://archive.podaac.earthdata.nasa.gov/podaac-ops-cumulus-docs/grace/open/docs/TN-13_GEOC_CSR_RL0601.txt</a><br>GFZ：<a href="https://archive.podaac.earthdata.nasa.gov/podaac-ops-cumulus-docs/grace/open/docs/TN-13_GEOC_GFZ_RL0601.txt">https://archive.podaac.earthdata.nasa.gov/podaac-ops-cumulus-docs/grace/open/docs/TN-13_GEOC_GFZ_RL0601.txt</a><br>JPL：<a href="https://archive.podaac.earthdata.nasa.gov/podaac-ops-cumulus-docs/grace/open/docs/TN-13_GEOC_JPL_RL0601.txt">https://archive.podaac.earthdata.nasa.gov/podaac-ops-cumulus-docs/grace/open/docs/TN-13_GEOC_JPL_RL0601.txt</a></p><p>如果下载链接失效，可跳转<a href="https://podaac.jpl.nasa.gov/gravity/grace-documentation#TechnicalNotes">GRACE Documentation</a>查找对应文件进行下载。</p><h2 id="二阶项"><a href="#二阶项" class="headerlink" title="二阶项"></a>二阶项</h2><p><a href="https://download.csr.utexas.edu/pub/slr/degree_2/">https://download.csr.utexas.edu/pub/slr/degree_2/</a></p><p>更多关于一阶项和二阶项的替换文件可参考文章：<a href="https://singyutang.github.io/2023/07/24/GRCE%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E4%B8%AD%E5%8F%AF%E8%83%BD%E7%94%A8%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E7%BD%91%E7%AB%99/">GRACE数据处理中可能用到的一些网站</a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GRACE</tag>
      
      <tag>GRACE-FO</tag>
      
      <tag>websites</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【读后感】-窄门</title>
    <link href="/2024/09/14/%E8%AF%BB%E5%90%8E%E6%84%9F-%E7%AA%84%E9%97%A8/"/>
    <url>/2024/09/14/%E8%AF%BB%E5%90%8E%E6%84%9F-%E7%AA%84%E9%97%A8/</url>
    
    <content type="html"><![CDATA[<p>作者：[法] 安德烈·纪德</p><h1 id="读后感"><a href="#读后感" class="headerlink" title="读后感"></a>读后感</h1><p>记于2024年9月14日晚</p><p>上学期购买的《窄门》这本书了，虽然全篇篇幅不长，但是一直不想看，今天突然想起很久没看书了，便拿起这本书看了起来，至于为什么买了那么多本书偏偏选择这一本呢，可能也是因为这本书篇幅不长，想以此来重新培养我的阅读兴趣罢了。</p><p>本书总体上来说可以称之为一本爱情小说，主要以男主人公杰罗姆（下文中以第一人称的口吻进行叙述）和女主人公阿莉莎之间的爱情为主线进行展开。杰罗姆的父亲在我还不满十二岁时去世了，母亲为了他的学业前往巴黎居住。在巴黎附近的勒阿弗尔附近的芬格斯玛尔农庄（巴黎市区内），舅舅布兰科居住在那里，女主人公阿莉莎（大我2岁）就是舅舅的长女，除阿莉莎以外，舅舅家还有一个表妹朱莉叶特（小我1岁）和表弟罗贝尔（小我两岁）。舅舅家的房子不大，因此我和母亲居住在了母亲的一个姐姐普朗提埃姨妈家里（巴黎郊区）。</p><p>阿莉莎小小年纪就已经知道妈妈出轨并承受了巨大的痛苦，而我在一次偶然的机会也发现了这一切，但我由于年龄尚小还不明白阿莉莎痛苦的缘由，但看到痛苦的阿莉莎，我便祈求上帝，今生今世愿意风险自己只求庇护这个女孩免受恐惧之苦和生活的伤害。</p><p>读的时候心情起伏很大，一度以为等到杰罗姆服完兵役回来就可以一直在一起了，在信里面他们的交谈是那么紧密，他们是那么的思念对方，在见面前他们俩的爱情是那么牢固，我在阅读时一直认为服完兵役后回来他们就可以在一起了，经历过异地恋的我对于这种心情是十分能理解，也是十分希望他们能修成正果的，可是偏偏作者却鬼使神工的将他们的命运与读者的意图相悖，全篇读完后觉得这一切都是合理的，下文再展开分析。</p><p>全书中多次提到“德行”、“追求”、“幸福”、“美德”，初读时常常忽略，这可能会导致在部分段落无法明白作者的意思，无法明白主人公为啥会有这种想法，只有当文章全部读完后从头来看才能明白。</p>]]></content>
    
    
    <categories>
      
      <category>阅读</category>
      
    </categories>
    
    
    <tags>
      
      <tag>窄门</tag>
      
      <tag>读后感</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WRF-Hydro中的部分脚本更新一</title>
    <link href="/2024/09/06/WRF-Hydro%E4%B8%AD%E7%9A%84%E9%83%A8%E5%88%86%E8%84%9A%E6%9C%AC%E6%9B%B4%E6%96%B0/"/>
    <url>/2024/09/06/WRF-Hydro%E4%B8%AD%E7%9A%84%E9%83%A8%E5%88%86%E8%84%9A%E6%9C%AC%E6%9B%B4%E6%96%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="FNL和GFS数据介绍-WRF-WPS气象数据输入"><a href="#FNL和GFS数据介绍-WRF-WPS气象数据输入" class="headerlink" title="FNL和GFS数据介绍-WRF&#x2F;WPS气象数据输入"></a>FNL和GFS数据介绍-WRF&#x2F;WPS气象数据输入</h1><p>FNL再分析数据：常用的气象再分析数据；<br>GFS数据：最常用的气象预报数据。<br>除GFS&#x2F;FNL数据外，还可使用其它气象数据源作为输入，如NAM、RAP&#x2F;HRRR、重新分析（NARR、CFSR、NNRP、ERA-interim、ERA5 等）、其他 WRF 运行。详细可用数据源可查看<a href="https://www2.mmm.ucar.edu/wrf/users/wrf_users_guide/build/html/wps.html#function-of-each-wps-program">WRF-WPS</a></p><p>FNL（Final analyzed field）数据集和GFS（Global Forecast System）数据集虽有联系，但在同一资料同化和预报系统中却有不同的产品。它们基于相同的基础模型和数据同化技术，且包含相同的数据源。FNL是最终分析场，是经过同化处理后的结果，可以补充实时状态下没有收集齐全的某些观测资料。大部分情况下，FNL和GFS的初始场相近。FNL是再分析资料，获取方便，有长期的历史数据，而GFS官方只提供近几天的下载，获取历史数据比较麻烦。</p><p>FNL数据官网：<a href="https://rda.ucar.edu/datasets/d083002/dataaccess/#">https://rda.ucar.edu/datasets/d083002/dataaccess/#</a></p><p>GFS官方数据下载：<a href="https://nomads.ncep.noaa.gov/pub/data/nccf/com/gfs/prod/">https://nomads.ncep.noaa.gov/pub/data/nccf/com/gfs/prod/</a></p><h1 id="FNL数据下载脚本"><a href="#FNL数据下载脚本" class="headerlink" title="FNL数据下载脚本"></a>FNL数据下载脚本</h1><p>FNL可以作为WRF模型的输入数据，用于模型初始化和创建边界条件网格。<br>脚本下载链接：<a href="https://github.com/SingyuTang/wrf_scripts/blob/main/fnl_download_for_wrf.py">https://github.com/SingyuTang/wrf_scripts/blob/main/fnl_download_for_wrf.py</a></p><h1 id="create-soilproperties-R脚本"><a href="#create-soilproperties-R脚本" class="headerlink" title="create_soilproperties.R脚本"></a>create_soilproperties.R脚本</h1><p>官方没有将GENPARM.TBL中的refdk, refkdt, slope参数和MPTABLE.TBL中的rsurf_exp参数添加到soil_properties.nc文件中，修改后的create_soilproperties_Zuo.R对这一特性进行了修复。</p><p>脚本下载链接：<a href="https://github.com/SingyuTang/wrf_scripts/tree/main/create_soilproperties">https://github.com/SingyuTang/wrf_scripts/tree/main/create_soilproperties</a></p><h1 id="参考博客"><a href="#参考博客" class="headerlink" title="参考博客"></a>参考博客</h1><p><a href="https://www.heywhale.com/mw/notebook/6476e6cd3f075e5cb1519a34">Model Whale - Workshop第一期：初探气象数据 Part2</a></p><p><a href="https://www.cnblogs.com/avivi/p/10880131.html">博客园 - GFS和Fnl文件的区别</a></p><p><a href="https://blog.csdn.net/weixin_64799803/article/details/137654097">CSDN - 运行WRF的常用气象场数据</a></p><p><a href="http://bbs.06climate.com/forum.php?mod=viewthread&tid=104598">气象家园 - Fnl.Gfs的区别 </a></p><p><a href="https://www.cnblogs.com/avivi/p/14833263.html">博客园 - 跑 wrf 所需 fnl 数据下载</a></p><p><a href="https://blog.csdn.net/weixin_44237337/article/details/137228430">CSDN - Real-data WRF | setup and run and experiment</a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>脚本</tag>
      
      <tag>WRF-Hydro5.2.0</tag>
      
      <tag>Python</tag>
      
      <tag>R</tag>
      
      <tag>FNL</tag>
      
      <tag>WRF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>使用ERA5_Land小时数据作为WRF-Hydro气象强迫数据输入</title>
    <link href="/2024/09/01/%E4%BD%BF%E7%94%A8ERA5-Land%E5%B0%8F%E6%97%B6%E6%95%B0%E6%8D%AE%E4%BD%9C%E4%B8%BAWRF-Hydro%E6%B0%94%E8%B1%A1%E5%BC%BA%E8%BF%AB%E6%95%B0%E6%8D%AE%E8%BE%93%E5%85%A5/"/>
    <url>/2024/09/01/%E4%BD%BF%E7%94%A8ERA5-Land%E5%B0%8F%E6%97%B6%E6%95%B0%E6%8D%AE%E4%BD%9C%E4%B8%BAWRF-Hydro%E6%B0%94%E8%B1%A1%E5%BC%BA%E8%BF%AB%E6%95%B0%E6%8D%AE%E8%BE%93%E5%85%A5/</url>
    
    <content type="html"><![CDATA[<p>本教程用于下载ERA5_Land数据处理作为WRF-Hydro FORCING输入数据（YYYYMMDDHH.LDASIN_DOMAINX），分为有降雨变量（total_precipitation）和无降雨变量（total_precipitation）两种处理方法。</p><h1 id="ERA5-Land数据下载"><a href="#ERA5-Land数据下载" class="headerlink" title="ERA5_Land数据下载"></a>ERA5_Land数据下载</h1><p><a href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/reanalysis-era5-land?tab=form">ERA5-Land hourly data from 1950 to present</a></p><p>下载变量：10m_u_component_of_wind’,                 ‘10m_v_component_of_wind’, ‘2m_dewpoint_temperature’,<br>            ‘2m_temperature’, ‘surface_pressure’, ‘surface_solar_radiation_downwards’,<br>            ‘surface_thermal_radiation_downwards’, ‘total_precipitation’</p><p>下载数据格式：Zipped NetCDF-3 (experimental)</p><p><em>根据需要代码选择是否下载total_precipitation变量</em></p><h1 id="处理代码下载"><a href="#处理代码下载" class="headerlink" title="处理代码下载"></a>处理代码下载</h1><p><a href="https://github.com/SingyuTang/prepare_era5_land_for_wrf_hydro_forcing">prepare_era5_land_for_wrf_hydro_forcing</a></p><h1 id="运行流程"><a href="#运行流程" class="headerlink" title="运行流程"></a>运行流程</h1><p>  （1）创建文件夹input_files1；<br>  <figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs arduino">mkdir input_files1<br></code></pre></td></tr></table></figure><br>  （2）读取处理ERA5数据变量；<br>  <figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">python</span> read_era5_land_with_precipitaion.<span class="hljs-keyword">py</span><br></code></pre></td></tr></table></figure><br>  （3）生成重新网格化权重网格文件；<br>  <figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">ncl <span class="hljs-symbol">&#x27;interp_opt</span>=<span class="hljs-string">&quot;bilinear&quot;</span><span class="hljs-string">&#x27; &#x27;</span>srcGridName=<span class="hljs-string">&quot;input_files1/ERA5_025_1H.20060601.0100.nc4&quot;</span><span class="hljs-string">&#x27; &#x27;</span>dstGridName=<span class="hljs-string">&quot;geo_em.d03.nc&quot;</span>&#x27; ERA52WRFHydro_generate_weights.ncl<br></code></pre></td></tr></table></figure><br>  （4）重新网格化。<br>  <figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ada">ncl <span class="hljs-symbol">&#x27;srcFileName</span>=<span class="hljs-string">&quot;*.nc4&quot;</span><span class="hljs-string">&#x27; &#x27;</span>dstGridName=<span class="hljs-string">&quot;geo_em.d03.nc&quot;</span>&#x27; ERA52WRFHydro_regrid.ncl<br></code></pre></td></tr></table></figure></p><p><em>如果在代码运行过程中出现权限问题报错，运行以下代码给予权限</em><br>  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">chmod</span> -R 777 *<br></code></pre></td></tr></table></figure></p><h1 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h1><p><a href="https://mp.weixin.qq.com/s/Zf69Ot_KG2_KhuD1aWmFUA">应用ERA5-Land小时数据到WRF-hydro模型</a></p><p><a href="https://www.cnblogs.com/ruo-li-suo-yi/p/7772777.html">博客园 - 温度、水汽压、湿度计算公式</a></p><p><a href="https://www.fao.org/4/X0490E/x0490e07.htm">Crop evapotranspiration - Guidelines for computing crop water requirements - Chapter 3 Meteorological data - FAO Irrigation and drainage paper 56 </a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>脚本</tag>
      
      <tag>WRF-Hydro5.2.0</tag>
      
      <tag>ERA5_Land</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>运行WPS、WRF、WRF-Hydro的一些错误总结一</title>
    <link href="/2024/07/22/%E8%BF%90%E8%A1%8CWPS%E3%80%81WRF%E3%80%81WRF-Hydro%E7%9A%84%E4%B8%80%E4%BA%9B%E9%94%99%E8%AF%AF%E6%80%BB%E7%BB%93%E4%B8%80/"/>
    <url>/2024/07/22/%E8%BF%90%E8%A1%8CWPS%E3%80%81WRF%E3%80%81WRF-Hydro%E7%9A%84%E4%B8%80%E4%BA%9B%E9%94%99%E8%AF%AF%E6%80%BB%E7%BB%93%E4%B8%80/</url>
    
    <content type="html"><![CDATA[<h1 id="运行WRF-WRF-Hydro的一些错误经验"><a href="#运行WRF-WRF-Hydro的一些错误经验" class="headerlink" title="运行WRF&#x2F;WRF-Hydro的一些错误经验"></a>运行WRF&#x2F;WRF-Hydro的一些错误经验</h1><p>1.执行<code>mpirun -np 1 ./real.exe</code>命令，rsl.error.0000文件出现以下错误。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs textile"> metgrid input_wrf.F first_date_input = 2024-03-12_00:00:00<br> metgrid input_wrf.F first_date_nml = 2024-03-12_00:00:00<br> i_parent_start from namelist.input file =           53<br> i_parent_start from gridded input file  =           10<br> j_parent_start from namelist.input file =           25<br> j_parent_start from gridded input file  =           20<br>d02 2024-03-12_00:00:00 ---- ERROR: Nest start locations do not match: namelist.input vs gridded input file<br>NOTE:       1 namelist vs input data inconsistencies found.<br>-------------- FATAL CALLED ---------------<br>FATAL CALLED FROM FILE:  &lt;stdin&gt;  LINE:    1298<br></code></pre></td></tr></table></figure><p>解决办法：</p><blockquote><p>使namelist.wps和namelist.input两个文件中的 i_parent_start 和 j_parent_start 两个参数保持一致。</p></blockquote><p>2.操作：WRF-Hydro在执行xxx命令出现错误。</p><p>错误：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs textile">netcdf_layer.f90:77:19:            <br>    &amp;  comm = object%mpi_communicator, info = object%default_info)                    <br>1 Error: Keyword argument ‘comm’ at (1) is not in the procedure<br></code></pre></td></tr></table></figure><p>重新设置netcdf环境，参考<a href="https://singyutang.github.io/2024/03/23/%E5%A6%82%E4%BD%95%E5%9C%A8ubuntu16-04%E4%B8%8A%E5%AE%89%E8%A3%85%E7%BC%96%E8%AF%91WRF-Hydro5-2-0/">教程</a>。</p><p>3.操作：安装netcdf-fortran，尽管我的netcdf-c的版本大于4.7.4依旧error。</p><p>错误：configure netcdf-fortran error，详细错误如下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs textile">..l...<br>checking for nc_def_var_szip...no<br>configure:error:netcdf-c version 4.7.4 or greater is required.<br></code></pre></td></tr></table></figure><p>解决方案: 向<code>~/.bashrc</code>文件添加环境变量如下，主要是<code>LDFLAGS</code>变量和<code>CPPFLAGS</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs textile">## netcdf 4.9.2<br><br>export WRFHYDRO_DIR=~/coding/WRF_Hydro/LIBRARIES<br>export NETCDF=$WRFHYDRO_DIR/netcdf<br>export LDFLAGS=-L$NETCDF/lib<br>export CPPFLAGS=-I$NETCDF/include<br></code></pre></td></tr></table></figure><p>感谢<a href="https://github.com/Unidata/netcdf-fortran/issues/299">WardF</a>的回答，同时参考了他的<a href="https://github.com/Unidata/netcdf-fortran/issues/278">另一次解答</a>。</p><p>4.利用3的解决方案解决了错误后出现了另外一个错误。错误大致如下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs textile">configure error: netcdf could not link to netcdfc library.Please set LDFLAGS;<br>for static builds set LIBS to the results fo nc-config--libs ....<br></code></pre></td></tr></table></figure><p>解决方案：没能直接解决这个问题。也参考过别的博客上在环境变量中添加或更改<code>LDFLAGS</code>和<code>LIBS</code>的值依旧未成功，在<code>configure</code>时添加这两个参数也未成功。最终通过在<code>/usr/local/netcdf4</code>中新建了一个netcdf环境才解决，相应的安装教程和环境设置参考xxx。虽然没能查明原因，但是很大可能是因为在安装netcdf-fortran时netcdf-c库、netcdf-fortran库、zlib库、hdf5库和curl库的安装位置和安装顺序的原因，在教程xxx中将其放在同个位置下进行另一个版本的netcdf安装并重新设置环境变量就解决了这个问题。</p><p>综合3和4，出现这两个错误的很大程度上的原因是因为通过教程安装的netcdf版本为v4.1.3，不满足运行WRF-Hydro的条件，WRF-Hydro运行的netcdf版本为v4.4+。</p><p>5.操作：在WRF-Hydro中执行<code>./compile_offline_Noah.sh setEnvar.sh</code></p><p>错误：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs textile">f951: Warning: Nonexistent include directory ‘/home/root123/coding/WRF/Build_WRF/LIBRARIES/netcdf/include’ [-Wmissing-include-dirs]<br>netcdf_layer.f90:2:6:<br><br>   use netcdf<br>      1<br>Fatal Error: Can&#x27;t open module file ‘netcdf.mod’ for reading at (1): 没有那个文件或目录<br>compilation terminated.<br></code></pre></td></tr></table></figure><p>解决方案：netcdf版本不够，升级版本，参考<a href="https://singyutang.github.io/2024/03/23/%E5%A6%82%E4%BD%95%E5%9C%A8ubuntu16-04%E4%B8%8A%E5%AE%89%E8%A3%85%E7%BC%96%E8%AF%91WRF-Hydro5-2-0/">安装教程</a>。</p><p>6.[错误] 运行命令<code> mpirun -np 4 ./wrf_hydro.exe &gt; log</code>出现错误</p><figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs vhdl"> Calling config noahlsm_offline<br> Calling config noahlsm_offline<br> Calling config noahlsm_offline<br> Calling config noahlsm_offline<br><span class="hljs-literal">WARNING</span>:  LDASIN <span class="hljs-keyword">file</span> has a perverse version identifier<br>ldasin_version =        <span class="hljs-number">0</span><br><span class="hljs-literal">WARNING</span>:  LDASIN <span class="hljs-keyword">file</span> has a perverse version identifier<br>ldasin_version =        <span class="hljs-number">0</span><br><span class="hljs-literal">WARNING</span>:  LDASIN <span class="hljs-keyword">file</span> has a perverse version identifier<br>ldasin_version =        <span class="hljs-number">0</span><br><span class="hljs-literal">WARNING</span>:  LDASIN <span class="hljs-keyword">file</span> has a perverse version identifier<br>ldasin_version =        <span class="hljs-number">0</span><br><br><br><br><br><br><br><br><br> SNOW HEIGHT <span class="hljs-keyword">NOT</span> FOUND - VALUE DEFINED <span class="hljs-keyword">IN</span> LSMINIT<br> SNOW HEIGHT <span class="hljs-keyword">NOT</span> FOUND - VALUE DEFINED <span class="hljs-keyword">IN</span> LSMINIT<br> SNOW HEIGHT <span class="hljs-keyword">NOT</span> FOUND - VALUE DEFINED <span class="hljs-keyword">IN</span> LSMINIT<br> SNOW HEIGHT <span class="hljs-keyword">NOT</span> FOUND - VALUE DEFINED <span class="hljs-keyword">IN</span> LSMINIT<br> The job <span class="hljs-keyword">is</span> stopped due <span class="hljs-keyword">to</span> the fatal <span class="hljs-literal">error</span>. hydro.namelist <span class="hljs-literal">ERROR</span>: Please specify a udmap_file <span class="hljs-keyword">file</span>.<br> <span class="hljs-comment">---</span><br> FATAL <span class="hljs-literal">ERROR</span>! Program stopped. Recompile <span class="hljs-keyword">with</span> environment <span class="hljs-keyword">variable</span> HYDRO_D set <span class="hljs-keyword">to</span> <span class="hljs-number">1</span> <span class="hljs-keyword">for</span> enhanced debug information.<br><br> The job <span class="hljs-keyword">is</span> stopped due <span class="hljs-keyword">to</span> the fatal <span class="hljs-literal">error</span>. hydro.namelist <span class="hljs-literal">ERROR</span>: Please specify a udmap_file <span class="hljs-keyword">file</span>.<br> <span class="hljs-comment">---</span><br> FATAL <span class="hljs-literal">ERROR</span>! Program stopped. Recompile <span class="hljs-keyword">with</span> environment <span class="hljs-keyword">variable</span> HYDRO_D set <span class="hljs-keyword">to</span> <span class="hljs-number">1</span> <span class="hljs-keyword">for</span> enhanced debug information.<br><br> The job <span class="hljs-keyword">is</span> stopped due <span class="hljs-keyword">to</span> the fatal <span class="hljs-literal">error</span>. hydro.namelist <span class="hljs-literal">ERROR</span>: Please specify a udmap_file <span class="hljs-keyword">file</span>.<br> <span class="hljs-comment">---</span><br> FATAL <span class="hljs-literal">ERROR</span>! Program stopped. Recompile <span class="hljs-keyword">with</span> environment <span class="hljs-keyword">variable</span> HYDRO_D set <span class="hljs-keyword">to</span> <span class="hljs-number">1</span> <span class="hljs-keyword">for</span> enhanced debug information.<br><br> The job <span class="hljs-keyword">is</span> stopped due <span class="hljs-keyword">to</span> the fatal <span class="hljs-literal">error</span>. hydro.namelist <span class="hljs-literal">ERROR</span>: Please specify a udmap_file <span class="hljs-keyword">file</span>.<br> <span class="hljs-comment">---</span><br> FATAL <span class="hljs-literal">ERROR</span>! Program stopped. Recompile <span class="hljs-keyword">with</span> environment <span class="hljs-keyword">variable</span> HYDRO_D set <span class="hljs-keyword">to</span> <span class="hljs-number">1</span> <span class="hljs-keyword">for</span> enhanced debug information.<br><br><br>===================================================================================<br>=   BAD TERMINATION <span class="hljs-keyword">OF</span> ONE <span class="hljs-keyword">OF</span> YOUR APPLICATION PROCESSES<br>=   <span class="hljs-keyword">EXIT</span> CODE: <span class="hljs-number">1</span><br>=   CLEANING UP REMAINING PROCESSES<br>=   YOU CAN IGNORE THE BELOW CLEANUP MESSAGES<br>===================================================================================<br></code></pre></td></tr></table></figure><p>解决方案:重新编译wrf-hydro，在setEnvar.sh文件中调整WRF_HYDRO参数为</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-built_in">export</span> <span class="hljs-attribute">HYDRO_D</span>=1<br></code></pre></td></tr></table></figure><p>重新编译</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-string">./configure</span><br><span class="hljs-string">./compile_offline_NoahMP.sh</span> <span class="hljs-keyword">set</span>Envar.sh<br></code></pre></td></tr></table></figure><p>7.[错误]运行命令 <code>mpirun -np 4 ./wrf_hydro.exe &gt; log</code>出现错误</p><figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs vhdl"> The job <span class="hljs-keyword">is</span> stopped due <span class="hljs-keyword">to</span> the fatal <span class="hljs-literal">error</span>. hydro.namelist <span class="hljs-literal">ERROR</span>: Please specify a udmap_file <span class="hljs-keyword">file</span>.<br> The job <span class="hljs-keyword">is</span> stopped due <span class="hljs-keyword">to</span> the fatal <span class="hljs-literal">error</span>. hydro.namelist <span class="hljs-literal">ERROR</span>: Please specify a udmap_file <span class="hljs-keyword">file</span>.<br> The job <span class="hljs-keyword">is</span> stopped due <span class="hljs-keyword">to</span> the fatal <span class="hljs-literal">error</span>. hydro.namelist <span class="hljs-literal">ERROR</span>: Please specify a udmap_file <span class="hljs-keyword">file</span>.<br> The job <span class="hljs-keyword">is</span> stopped due <span class="hljs-keyword">to</span> the fatal <span class="hljs-literal">error</span>. hydro.namelist <span class="hljs-literal">ERROR</span>: Please specify a udmap_file <span class="hljs-keyword">file</span>.<br><br>===================================================================================<br>=   BAD TERMINATION <span class="hljs-keyword">OF</span> ONE <span class="hljs-keyword">OF</span> YOUR APPLICATION PROCESSES<br>=   <span class="hljs-keyword">EXIT</span> CODE: <span class="hljs-number">1</span><br>=   CLEANING UP REMAINING PROCESSES<br>=   YOU CAN IGNORE THE BELOW CLEANUP MESSAGES<br>===================================================================================<br></code></pre></td></tr></table></figure><p>解决方案：修改 hydro.namelist 文件中的UDMP_OPT参数和udmap_file参数</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">UDMP_OPT</span> = <span class="hljs-number">0</span><br><span class="hljs-attr">udmap_file</span> = <span class="hljs-string">&quot;&quot;</span><br></code></pre></td></tr></table></figure><p>8.[错误]运行命令 <code>mpirun -np 4 ./wrf_hydro.exe</code>出现错误</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">*** Error <span class="hljs-keyword">in</span> `./wrf_hydro.exe<span class="hljs-string">&#x27;: free(): invalid next size (fast): 0x000000001dafcb80 ***</span><br><span class="hljs-string">*** Error in `./wrf_hydro.exe&#x27;</span>: munmap_chunk(): invalid pointer: 0x000000001bd0e9f0 ***<br>======= Backtrace: =========<br>======= Backtrace: =========<br>/lib/x86_64-linux-gnu/libc.so.6(+0x777f5)[0x7f480ffc37f5]<br>/lib/x86_64-linux-gnu/libc.so.6(+0x777f5)[0x7f7f0b95a7f5]<br>/lib/x86_64-linux-gnu/libc.so.6(cfree+0x1a8)[0x7f480ffd06e8]<br>......<br>......<br>......<br><span class="hljs-comment">#13  0x46E9B9 in __module_noahmp_hrldas_driver_MOD_land_driver_ini</span><br><span class="hljs-comment">#9  0x4A1404 in __module_hydro_io_MOD_read_routelink</span><br><span class="hljs-comment">#10  0x55D48A in __module_routing_MOD_landrt_ini</span><br><span class="hljs-comment">#11  0x52A6FA in __module_hydro_drv_MOD_hydro_ini</span><br><span class="hljs-comment">#12  0x52C889 in __module_hrldas_hydro_MOD_hrldas_cpl_hydro_ini</span><br><span class="hljs-comment">#13  0x52FB65 in hrldas_drv_hydro_ini_</span><br><span class="hljs-comment">#14  0x46E9B9 in __module_noahmp_hrldas_driver_MOD_land_driver_ini</span><br></code></pre></td></tr></table></figure><p>不使用mpirun命令执行<code>./wrf_hydro.exe</code></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">RNING: KDAY is deprecated <span class="hljs-keyword">and</span> may be removed <span class="hljs-keyword">in</span> <span class="hljs-keyword">a</span> future <span class="hljs-built_in">version</span>, please use KHOUR.<br>WARNING: In land_driver_ini() - KHOUR &lt; <span class="hljs-number">0.</span> DEFINED USING KDAY.<br>WARNING:  LDASIN <span class="hljs-built_in">file</span> has <span class="hljs-keyword">a</span> perverse <span class="hljs-built_in">version</span> identifier<br>ldasin_version =        <span class="hljs-number">0</span><br><br><br> SNOW HEIGHT NOT FOUND - VALUE DEFINED IN LSMINIT<br>getting dimension <span class="hljs-built_in">from</span> <span class="hljs-built_in">file</span>: ./DOMAIN/Route_Link.nc<br> reading <span class="hljs-built_in">from</span> hydrotbl_f(HYDRO.TBL.nc)  <span class="hljs-built_in">file</span> ....<br> WARNING: get2d_real: failed <span class="hljs-built_in">to</span> find <span class="hljs-keyword">the</span> variables: CHAN_DEPTH <span class="hljs-keyword">and</span> CHAN_DEPTH                                                                                                                                                                                    <br> compound_channel is <span class="hljs-literal">FALSE</span> <span class="hljs-keyword">in</span> hydro.namelist.<br> <span class="hljs-built_in">read</span> gwbasmskfil <span class="hljs-keyword">as</span> nc <span class="hljs-built_in">format</span>: ./DOMAIN/GWBASINS.nc<br> <span class="hljs-built_in">read</span> GWBUCKPARM <span class="hljs-built_in">file</span> <span class="hljs-keyword">as</span> nc <span class="hljs-built_in">format</span>: ./DOMAIN/GWBUCKPARM.nc<br> Resetting RESTART Accumulation Variables <span class="hljs-built_in">to</span> <span class="hljs-number">0.</span>..           <span class="hljs-number">1</span><br>application called MPI_Abort(comm=<span class="hljs-number">0x84000000</span>, <span class="hljs-number">1</span>) - <span class="hljs-built_in">process</span> <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><p>使用<code>./wrf_hydro.exe &gt; log</code>打印日志文件，log文件中的错误意思差不多为</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dns">无法找到wrfout_d<span class="hljs-number">01_2024-02</span>-<span class="hljs-number">01_00:00:00</span>相关forcing数据<br></code></pre></td></tr></table></figure><p>解决方案</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs markdown">FORCING文件夹中的文件名不能使用wrfout<span class="hljs-emphasis">_d02_</span><span class="hljs-emphasis">*，必须使用wrfout_d01_*</span>，<br>如果要使用d02的数据也必须重命名为d01<br></code></pre></td></tr></table></figure><p>9.[错误]运行命令 <code>mpirun -np 4 ./wrf_hydro.exe</code>出现错误</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-code"> starting wrf task            0  of            4</span><br><span class="hljs-code"> starting wrf task            1  of            4</span><br><span class="hljs-code"> starting wrf task            2  of            4</span><br><span class="hljs-code"> starting wrf task            3  of            4</span><br><br>===================================================================================<br>=   BAD TERMINATION OF ONE OF YOUR APPLICATION PROCESSES<br>=   EXIT CODE: 139<br>=   CLEANING UP REMAINING PROCESSES<br>=   YOU CAN IGNORE THE BELOW CLEANUP MESSAGES<br>===================================================================================<br>YOUR APPLICATION TERMINATED WITH THE EXIT STRING: Segmentation fault (signal 11)<br>This typically refers to a problem with your application.<br>Please see the FAQ page for debugging suggestions<br></code></pre></td></tr></table></figure><p>解决方案</p><p>减小时间步长，同时能够被时间间隔整除，history_interval是积分步长time_step的整数倍</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs 1c"><span class="hljs-meta">&amp;domains</span><br>time_step <br></code></pre></td></tr></table></figure><p>分辨率太高，区域太大，内存不足，参数化方案更换（微物理方案）</p><p>10.利用i_parent_start和e_we选择WRF domain的问题</p><p>i_parent_start和e_we相关</p><p>j_parent_start和e_sn相关</p><p>11.运行命令<code>./metgrid.exe</code>报错</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">Processing domain 1 of 3<br><span class="hljs-code"> Processing 2024-02-01_00</span><br><span class="hljs-code">    FILE</span><br><span class="hljs-symbol">WARNING: </span>Field PRES has missing values at level 200100 at (i,j)=(1,1)<br><span class="hljs-symbol">WARNING: </span>Field PMSL has missing values at level 200100 at (i,j)=(1,1)<br><span class="hljs-symbol">WARNING: </span>Field PSFC has missing values at level 200100 at (i,j)=(1,1)<br>ERROR: Missing values encountered in interpolated fields. Stopping.<br>application called MPI_Abort(MPI_COMM_WORLD, 0) - process 0<br></code></pre></td></tr></table></figure><p>ERA5数据范围比domain小，重新下载</p><p>12.运行<code>./wrf_hydro.exe</code>报错</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs tap">......<br>......<br>(Near) match for destination layer:  Taking destination layer at  0.7000 from source layer at  0.7000<br>(Near) match for destination layer:  Taking destination layer at  1.5000 from source layer at  1.5000<br> xstart,xend, ystart, yend          <span class="hljs-number"> 1 </span>       <span class="hljs-number"> 159 </span>         <span class="hljs-number"> 1 </span>        159<br> xstart,xend, ystart, yend          <span class="hljs-number"> 1 </span>       <span class="hljs-number"> 159 </span>         <span class="hljs-number"> 1 </span>        159<br> xstart,xend, ystart, yend          <span class="hljs-number"> 1 </span>       <span class="hljs-number"> 159 </span>         <span class="hljs-number"> 1 </span>        159<br> xstart,xend, ystart, yend          <span class="hljs-number"> 1 </span>       <span class="hljs-number"> 159 </span>         <span class="hljs-number"> 1 </span>        159<br>  SOIL TEXTURE CLASSIFICATION = STAS FOUND         <span class="hljs-number"> 19 </span> CATEGORIES<br> SNOW HEIGHT NOT FOUND - VALUE DEFINED IN LSMINIT<br> NTIME =         <span class="hljs-number"> 216 </span>KHOUR=        <span class="hljs-number"> 216 </span>dtbl =    3600.00000    <br> zsoil/soil_thick_input =   0.100000001      0.300000012      0.600000024       1.00000000    <br> The job is stopped due to the fatal error. HYDRO_nlst namelist error in read_rt_nlst<br>application called MPI_Abort(comm=0x84000000, 1) - process 0<br></code></pre></td></tr></table></figure><p>解决方案</p><p>hydro.namelist中的变量格式错误，我这里是这样的（不知道什么时候弄得）</p><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs lasso">GWBUCKPARM_file = <span class="hljs-string">&quot;./DOMAIN/</span><br><span class="hljs-string">GWBUCKPARM.nc&quot;</span><br><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br></code></pre></td></tr></table></figure><p>需更改为</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">GWBUCKPARM_file</span> = <span class="hljs-string">&quot;./DOMAIN/GWBUCKPARM.nc&quot;</span><br></code></pre></td></tr></table></figure><p>3.运行命令   <code>./wrf_hydro.exe</code>报错</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">PrPt</span>/LkIn   <span class="hljs-number">0</span> *** ********** ********* <span class="hljs-number">1588</span> <span class="hljs-number">1590</span><br><span class="hljs-attribute">PrPt</span>/LkIn   <span class="hljs-number">0</span> *** ********** ********* <span class="hljs-number">1589</span> <span class="hljs-number">1590</span><br><span class="hljs-attribute">PrPt</span>/LkIn   <span class="hljs-number">0</span> *** ********** ********* <span class="hljs-number">1590</span> <span class="hljs-number">1590</span><br> <span class="hljs-attribute">found</span> type <span class="hljs-number">0</span> nodes         <span class="hljs-number">291</span><br> <span class="hljs-attribute">total</span> number of channel elements         <span class="hljs-number">292</span><br> <span class="hljs-attribute">total</span> number of NLINKS               <span class="hljs-number">2528100</span><br> <span class="hljs-attribute">Apparent</span> error in network topology         <span class="hljs-number">292</span>     <span class="hljs-number">2528100</span><br> <span class="hljs-attribute">ixrt</span> =        <span class="hljs-number">1590</span> jxrt =        <span class="hljs-number">1590</span><br> <span class="hljs-attribute">The</span> job is stopped due to the fatal error. READ_ROUTEDIM<br><span class="hljs-attribute">application</span> called MPI_Abort(comm=<span class="hljs-number">0</span>x84000000, <span class="hljs-number">1</span>) - process <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><p>终端打印的错误中开始报错的位置及信息如下</p><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs lasso">(Near) <span class="hljs-keyword">match</span> for destination layer:  Taking destination layer at  <span class="hljs-number">1.5000</span> from source layer at  <span class="hljs-number">1.5000</span><br> xstart,xend, ystart, yend           <span class="hljs-number">1</span>         <span class="hljs-number">159</span>           <span class="hljs-number">1</span>         <span class="hljs-number">159</span><br> xstart,xend, ystart, yend           <span class="hljs-number">1</span>         <span class="hljs-number">159</span>           <span class="hljs-number">1</span>         <span class="hljs-number">159</span><br> xstart,xend, ystart, yend           <span class="hljs-number">1</span>         <span class="hljs-number">159</span>           <span class="hljs-number">1</span>         <span class="hljs-number">159</span><br> xstart,xend, ystart, yend           <span class="hljs-number">1</span>         <span class="hljs-number">159</span>           <span class="hljs-number">1</span>         <span class="hljs-number">159</span><br>  SOIL TEXTURE CLASSIFICATION = STAS FOUND          <span class="hljs-number">19</span>  CATEGORIES<br> SNOW HEIGHT <span class="hljs-literal">NOT</span> FOUND - VALUE DEFINED <span class="hljs-keyword">IN</span> LSMINIT<br> NTIME =          <span class="hljs-number">216</span> KHOUR=         <span class="hljs-number">216</span> dtbl =    <span class="hljs-number">3600.00000</span>    <br> zsoil/soil_thick_input =   <span class="hljs-number">0.100000001</span>      <span class="hljs-number">0.300000012</span>      <span class="hljs-number">0.600000024</span>       <span class="hljs-number">1.00000000</span>    <br> rt_domain(did)%g_IXRT, rt_domain(did)%g_JXRT, rt_domain(did)%ixrt, rt_domain(did)%jxrt<br>        <span class="hljs-number">1431</span>        <span class="hljs-number">1431</span>        <span class="hljs-number">1431</span>        <span class="hljs-number">1431</span><br> rt_domain(did)%ix, rt_domain(did)%jx <br>         <span class="hljs-number">159</span>         <span class="hljs-number">159</span><br> global_nx, global_ny, local_nx, local_ny<br>         <span class="hljs-number">159</span>         <span class="hljs-number">159</span>         <span class="hljs-number">159</span>         <span class="hljs-number">159</span><br> Channel Option <span class="hljs-keyword">in</span> Routedim is            <span class="hljs-number">3</span><br> get2d_int: failed <span class="hljs-keyword">to</span> read the <span class="hljs-built_in">variable</span>: CHANNELGRID <span class="hljs-keyword">in</span> ./DOMAIN/Fulldom_hires.nc<br> read LINKID for CH_LNKRT from ./DOMAIN/Fulldom_hires.nc<br> get2d_int: failed <span class="hljs-keyword">to</span> read the <span class="hljs-built_in">variable</span>: FLOWDIRECTION <span class="hljs-keyword">in</span> ./DOMAIN/Fulldom_hires.nc<br> get2d_int: failed <span class="hljs-keyword">to</span> read the <span class="hljs-built_in">variable</span>: LAKEGRID <span class="hljs-keyword">in</span> ./DOMAIN/Fulldom_hires.nc<br> WARNING: get2d_real: failed <span class="hljs-keyword">to</span> read the <span class="hljs-built_in">variable</span>: LATITUDE <span class="hljs-literal">or</span> LATITUDE<br> WARNING: get2d_real: failed <span class="hljs-keyword">to</span> read the <span class="hljs-built_in">variable</span>: LONGITUDE <span class="hljs-literal">or</span> LONGITUDE<br> NLINKS IS      <span class="hljs-number">2047761</span><br>PrPt/LkIn   <span class="hljs-number">0</span> *** ********** *********    <span class="hljs-number">1</span>    <span class="hljs-number">1</span><br>PrPt/LkIn   <span class="hljs-number">0</span> *** ********** *********    <span class="hljs-number">2</span>    <span class="hljs-number">1</span><br>PrPt/LkIn   <span class="hljs-number">0</span> *** ********** *********    <span class="hljs-number">3</span>    <span class="hljs-number">1</span><br>PrPt/LkIn   <span class="hljs-number">0</span> *** ********** *********    <span class="hljs-number">4</span>    <span class="hljs-number">1</span><br>PrPt/LkIn   <span class="hljs-number">0</span> *** ********** *********    <span class="hljs-number">5</span>    <span class="hljs-number">1</span><br>PrPt/LkIn   <span class="hljs-number">0</span> *** ********** *********    <span class="hljs-number">6</span>    <span class="hljs-number">1</span><br><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span><span class="hljs-params">...</span>.<br></code></pre></td></tr></table></figure><p>分析</p><p>与AGGFACTRT有关，具体原因未知。目前想到的办法就是提高geo_em.d01的分辨率或者尽可能使用小的AGGFACTRT，大的DXRT（但是这个一般在洪水预测中低于300），所以只能提高geo_em.d01的分辨率。</p><p>一个很大可能性的原因：根据错误出现开始的位置，报错信息与Fulldom_hires文件有关，可能是Fulldom_hires中的变量和geo_em.d01、FORCING的分辨率冲突。分析如下：在WPS GIS Preprocessing工具箱中有一个参数为Ridgridding Factor，可计算Routing Resolution &#x3D; GEOGRID Resolution &#x2F; Regridding Factor. 包括Fulldom_hires文件在内的由WPS GIS Preprocessing工具箱生成的所有变量分辨率都为Routing Resolution，FORCING的分辨率与geo_em.d01的分辨率相同，如果AGGFACTRT和DXRT设置不恰当，geo_em.d01与FORCING生成的子网格的分辨率就和Fulldom_hires的分辨率对不上，就会出现上述错误。</p><p>与DOMAIN中是否有海洋无关。</p><p>解决方案</p><p>公式：Routing Resolution &#x3D; GEOGRID Resolution &#x2F; Regridding Factor</p><p>            GEOGRID Resolution &#x3D; AGGFACTRT × DXRT</p><p>预测洪水要求子网格大小 DXRT &lt; 300m</p><p>假设DXRT 取300m，geo_em.d01的分辨率为3km，则Routing Resolution为300m，推导得出Regridding Factor为10，AGGFACTRT等于10。</p><p>14.运行命令<code>./wrf.exe</code>或<code>mpirun -np 2 ./wrf.exe</code>出现段错误。</p><p>物理参数使用默认。参数错误？格网点太多？分辨率太低或太高？内存不够？我使用两个（27和9km）或三个域（27、9、3km）运行时就会出错，用一个域（3km）跑模型的时候就不会，是不是证明和内存有关。</p><p>15.使用NLDAS重新网格化后的数据（已经替换NAN值）作为FORCING数据运行<code>mpirun -np 6 ./wrf_hydro.exe</code>报错，通过diag_hydro.00000文件查看</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">t0OutputFlag</span>:            <span class="hljs-number">1</span><br><span class="hljs-attribute">read</span> forcing data at <span class="hljs-number">2024</span>-<span class="hljs-number">02</span>-<span class="hljs-number">01</span>_00:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>./FORCING/<span class="hljs-number">2024020101</span>.LDASIN_DOMAIN1<br><span class="hljs-attribute">name</span> = <span class="hljs-string">&quot;T2D&quot;</span><br><span class="hljs-attribute">The</span> job is stopped due to the fatal error. In get_2d_netcdf() - nf90_get_var problem<br></code></pre></td></tr></table></figure><p>FORCING中的LDASIN_DOMAIN1类型数据覆盖范围与DOMAIN中的geo_em.d01数据覆盖范围不匹配，一开始我以为FORCING是全球覆盖的，就直接拷贝了过来，后来可视化发现覆盖范围对不上，一定要用geo_em.d01数据和NLDAS数据重新网格化，保证LDASIN_DOMAI数据是DOMAIN中的geo_em.d01生成。</p><p>16.<code>mpirun -np 4 ./wrf_hydro.exe</code></p><figure class="highlight vhdl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs vhdl"> get2d_int: failed <span class="hljs-keyword">to</span> read the <span class="hljs-keyword">variable</span>: LAKEGRID <span class="hljs-keyword">in</span> ./DOMAIN/Fulldom_hires.nc<br> <span class="hljs-literal">WARNING</span>: get2d_real: failed <span class="hljs-keyword">to</span> read the <span class="hljs-keyword">variable</span>: LATITUDE <span class="hljs-keyword">or</span> LATITUDE<br> <span class="hljs-literal">WARNING</span>: get2d_real: failed <span class="hljs-keyword">to</span> read the <span class="hljs-keyword">variable</span>: LONGITUDE <span class="hljs-keyword">or</span> LONGITUDE<br> Apparent <span class="hljs-literal">error</span> <span class="hljs-keyword">in</span> network topology           <span class="hljs-number">4</span>       <span class="hljs-number">13967</span><br> ixrt =         <span class="hljs-number">150</span> jxrt =         <span class="hljs-number">160</span><br> The job <span class="hljs-keyword">is</span> stopped due <span class="hljs-keyword">to</span> the fatal <span class="hljs-literal">error</span>. READ_ROUTEDIM<br> <span class="hljs-comment">---</span><br> FATAL <span class="hljs-literal">ERROR</span>! Program stopped. Recompile <span class="hljs-keyword">with</span> environment <span class="hljs-keyword">variable</span> HYDRO_D set <span class="hljs-keyword">to</span> <span class="hljs-number">1</span> <span class="hljs-keyword">for</span> enhanced debug information.<br><br>application called MPI_Abort(comm=<span class="hljs-number">0</span>x84000004, <span class="hljs-number">1</span>) - <span class="hljs-keyword">process</span> <span class="hljs-number">0</span><br><br>===================================================================================<br>=   BAD TERMINATION <span class="hljs-keyword">OF</span> ONE <span class="hljs-keyword">OF</span> YOUR APPLICATION PROCESSES<br>=   <span class="hljs-keyword">EXIT</span> CODE: <span class="hljs-number">1</span><br>=   CLEANING UP REMAINING PROCESSES<br>=   YOU CAN IGNORE THE BELOW CLEANUP MESSAGES<br>===================================================================================<br></code></pre></td></tr></table></figure><p>调整DXRT和AGGFACTRT参数，DXRT×AGGFACTRT&#x3D;geo_dem.d0*分辨率</p><p>17.<code>mpirun -np 4 ./ungrib.exe</code>报错，错误位于ungrib.log。错误如下</p><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs dns">...<br>...<br><span class="hljs-number">2024-07-21</span> <span class="hljs-number">16</span>:<span class="hljs-number">04:32.899</span> ---       <span class="hljs-number">200</span>         X         -         X         X         X         X         -         -         -         -         -         -         -         -         -         -         -         -         -         -         -         -         -         -         -         -         - <br><span class="hljs-number">2024-07-21</span> <span class="hljs-number">16</span>:<span class="hljs-number">04:32.902</span> ---       <span class="hljs-number">100</span>         X         -         X         X         X         X         -         -         -         -         -         -         -         -         -         -         -         -         -         -         -         -         -         -         -         -         - <br><span class="hljs-number">2024-07-21</span> <span class="hljs-number">16</span>:<span class="hljs-number">04:32.906</span> --- -------------------------------------------------<br><span class="hljs-number">2024-07-21</span> <span class="hljs-number">16</span>:<span class="hljs-number">04:36.462</span> --- INFORM: First pass done, doing a reprocess<br><span class="hljs-number">2024-07-21</span> <span class="hljs-number">16</span>:<span class="hljs-number">04:36.485</span> --- ERROR: unknown out_format, ifv = <span class="hljs-number">1176463528</span><br></code></pre></td></tr></table></figure><p>解决办法; 不能使用mpirun运行ungrib.exe</p><h1 id="其他错误参考资料"><a href="#其他错误参考资料" class="headerlink" title="其他错误参考资料"></a>其他错误参考资料</h1><p><a href="https://blog.csdn.net/zhangyimings/article/details/128979015">CSDN-WRF报错记录</a></p><p><a href="https://zhuanlan.zhihu.com/p/517219915">知乎-WRF模型模拟时所遇到的问题及解决方法</a></p><p><a href="https://wk-atmchem.github.io/2021/06/03/WRFCMAQ-bugandSolutions/">WRF常见bug及解决方案</a></p><p><a href="https://blog.csdn.net/stanlyYP/article/details/127365156">CSDN-WRF-Hydro运行过程与错误总结</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>WRF-Hydro5.2.0</tag>
      
      <tag>WRF4.5.2</tag>
      
      <tag>WPS4.5.0</tag>
      
      <tag>错误总结</tag>
      
      <tag>ubuntu16.04</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WRF-Hydro使用的一些处理脚本</title>
    <link href="/2024/07/15/WRF-Hydro%E4%BD%BF%E7%94%A8%E4%B8%AD%E4%B8%8ENLDAS%E7%9B%B8%E5%85%B3%E7%9A%84%E5%A4%84%E7%90%86%E8%84%9A%E6%9C%AC/"/>
    <url>/2024/07/15/WRF-Hydro%E4%BD%BF%E7%94%A8%E4%B8%AD%E4%B8%8ENLDAS%E7%9B%B8%E5%85%B3%E7%9A%84%E5%A4%84%E7%90%86%E8%84%9A%E6%9C%AC/</url>
    
    <content type="html"><![CDATA[<h1 id="NLDAS下载脚本"><a href="#NLDAS下载脚本" class="headerlink" title="NLDAS下载脚本"></a>NLDAS下载脚本</h1><p>访问github访问链接：<a href="https://github.com/SingyuTang/wrf_scripts/blob/main/download_NLDAS_FORCNG.py">Here</a></p><h1 id="NLDAS变量NAN替换脚本"><a href="#NLDAS变量NAN替换脚本" class="headerlink" title="NLDAS变量NAN替换脚本"></a>NLDAS变量NAN替换脚本</h1><p><a href="https://github.com/SingyuTang/wrf_scripts/blob/main/NLDAS_regrid_data_replaceNAN.py">Here</a></p><h1 id="NLDAS重新格网化脚本"><a href="#NLDAS重新格网化脚本" class="headerlink" title="NLDAS重新格网化脚本"></a>NLDAS重新格网化脚本</h1><p><a href="https://github.com/SingyuTang/wrf_scripts/tree/main/ESMFregrid_NLDAS">Here</a></p><h1 id="GPM数据绘图脚本"><a href="#GPM数据绘图脚本" class="headerlink" title="GPM数据绘图脚本"></a>GPM数据绘图脚本</h1><p><a href="https://github.com/SingyuTang/wrf_scripts/blob/main/GPM_draw.py">Here</a></p><h1 id="绘制WRF-Hydro输出文件CHRTOUT中的streamflow专题地图和时序图脚本"><a href="#绘制WRF-Hydro输出文件CHRTOUT中的streamflow专题地图和时序图脚本" class="headerlink" title="绘制WRF-Hydro输出文件CHRTOUT中的streamflow专题地图和时序图脚本"></a>绘制WRF-Hydro输出文件CHRTOUT中的streamflow专题地图和时序图脚本</h1><p><a href="https://github.com/SingyuTang/wrf_scripts/blob/main/plot_CHRTOUT_streamflow_map.py">Here</a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>脚本</tag>
      
      <tag>WRF-Hydro5.2.0</tag>
      
      <tag>Python</tag>
      
      <tag>WRF</tag>
      
      <tag>NLDAS</tag>
      
      <tag>绘图</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>利用python脚本下载WRF所需的ERA5气象数据</title>
    <link href="/2024/07/14/%E5%88%A9%E7%94%A8python%E8%84%9A%E6%9C%AC%E4%B8%8B%E8%BD%BDWRF%E6%89%80%E9%9C%80%E7%9A%84ERA5%E6%B0%94%E8%B1%A1%E6%95%B0%E6%8D%AE/"/>
    <url>/2024/07/14/%E5%88%A9%E7%94%A8python%E8%84%9A%E6%9C%AC%E4%B8%8B%E8%BD%BDWRF%E6%89%80%E9%9C%80%E7%9A%84ERA5%E6%B0%94%E8%B1%A1%E6%95%B0%E6%8D%AE/</url>
    
    <content type="html"><![CDATA[<h1 id="1-环境设置"><a href="#1-环境设置" class="headerlink" title="1.环境设置"></a>1.环境设置</h1><p>使用脚本下载数据之前，需要进行一些环境的设置。</p><p>（1）cdsapi url和key申请<br><em>本教程的cdsapi key暂时只更新在Windows下运行，在Linux或MacOS系统申请使用的可查看<a href="https://cds.climate.copernicus.eu/api-how-to">ECMWF官网教程</a>。</em><br>在<code>C:\User\xxx\</code>目录下创建文件.cdsapirc，在文件中输入url和key，如获取api url和key可跳转<a href="https://blog.csdn.net/qq_40505953/article/details/124745310">博客</a>或<a href="https://cds.climate.copernicus.eu/api-how-to">ECMWF官网教程</a>进行申请。</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">url</span>: https://cds.climate.copernicus.eu/api/v2<br><span class="hljs-attribute">key</span>: <span class="hljs-number">178412</span>:<span class="hljs-number">48</span>fc6bf4-c18a-<span class="hljs-number">4</span>aee-<span class="hljs-number">9950</span>-<span class="hljs-number">341</span>af67efbf2<br></code></pre></td></tr></table></figure><p>（2）python<br>在python环境中下载<code>cdsapi</code>库</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">pip installl cdsapi</span><br></code></pre></td></tr></table></figure><h1 id="2-数据下载"><a href="#2-数据下载" class="headerlink" title="2.数据下载"></a>2.数据下载</h1><p>WRF运行所需的气象数据可以使用ECMWF机构的ERA5再分析数据，共包括<a href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/reanalysis-era5-single-levels?tab=form">ERA5 hourly data on single levels from 1940 to present</a> 和<a href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/reanalysis-era5-pressure-levels?tab=form">ERA5 hourly data on pressure levels from 1940 to present</a>两种数据（分辨率都为0.25°），可以使用附件中的脚本进行下载，所需要的变量也可通过脚本查看。</p><p>但该脚本下载通常会失败，但我们依旧可以使用该脚本在终端中提供的grib文件的URL地址复制到浏览器进行下载。</p><p><em>注意：脚本运行期间终端长时间处于以下状态为正常，因为下载该数据需要排队，一般来说为30min~60min。</em></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">14</span> <span class="hljs-number">01</span>:<span class="hljs-number">12</span>:<span class="hljs-number">39</span>,<span class="hljs-number">393</span> INFO Welcome to the CDS<br><span class="hljs-attribute">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">14</span> <span class="hljs-number">01</span>:<span class="hljs-number">12</span>:<span class="hljs-number">39</span>,<span class="hljs-number">393</span> INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-pressure-levels<br><span class="hljs-attribute">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">14</span> <span class="hljs-number">01</span>:<span class="hljs-number">12</span>:<span class="hljs-number">39</span>,<span class="hljs-number">906</span> INFO Request is queued<br><span class="hljs-attribute">2024</span>-<span class="hljs-number">07</span>-<span class="hljs-number">14</span> <span class="hljs-number">01</span>:<span class="hljs-number">12</span>:<span class="hljs-number">41</span>,<span class="hljs-number">420</span> INFO Request is running<br></code></pre></td></tr></table></figure><h1 id="3-WRF使用ERA5数据"><a href="#3-WRF使用ERA5数据" class="headerlink" title="3.WRF使用ERA5数据"></a>3.WRF使用ERA5数据</h1><p>详细WRF设置可查看博客<a href="https://blog.csdn.net/qq_40505953/article/details/124745310">WRF中使用ERA5再分析数据</a>。</p><h1 id="参考博客"><a href="#参考博客" class="headerlink" title="参考博客"></a>参考博客</h1><p><a href="https://blog.csdn.net/weixin_64799803/article/details/137654097">CSDN - 运行WRF的常用气象场数据</a><br><a href="https://blog.csdn.net/qq_40505953/article/details/124745310">CSDN - WRF中使用ERA5再分析数据</a></p><h1 id="附件"><a href="#附件" class="headerlink" title="附件"></a>附件</h1><p><a href="/downloads/dld_ERA5_to_WRF.py" download>ERA5下载脚本</a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>脚本</tag>
      
      <tag>Python</tag>
      
      <tag>WRF</tag>
      
      <tag>ERA5</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WRF-Hydro模型配置的相关参数配置参考原论文分享二</title>
    <link href="/2024/07/12/WRF-Hydro%E6%A8%A1%E5%9E%8B%E9%85%8D%E7%BD%AE%E7%9A%84%E7%9B%B8%E5%85%B3%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE%E5%8F%82%E8%80%83%E5%8E%9F%E8%AE%BA%E6%96%87%E5%88%86%E4%BA%AB%E4%BA%8C/"/>
    <url>/2024/07/12/WRF-Hydro%E6%A8%A1%E5%9E%8B%E9%85%8D%E7%BD%AE%E7%9A%84%E7%9B%B8%E5%85%B3%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE%E5%8F%82%E8%80%83%E5%8E%9F%E8%AE%BA%E6%96%87%E5%88%86%E4%BA%AB%E4%BA%8C/</url>
    
    <content type="html"><![CDATA[<h1 id="1-使用-WRF-Hydro-模型模拟纽约市大都会地区的街区级洪水淹没和径流"><a href="#1-使用-WRF-Hydro-模型模拟纽约市大都会地区的街区级洪水淹没和径流" class="headerlink" title="1.使用 WRF-Hydro 模型模拟纽约市大都会地区的街区级洪水淹没和径流"></a>1.使用 WRF-Hydro 模型模拟纽约市大都会地区的街区级洪水淹没和径流</h1><p>标题：Simulating block-scale flood inundation and streamflow using the WRF-Hydro model in the New York City metropolitan area<br>原文链接：<a href="https://link.springer.com/article/10.1007/s11069-024-06597-y">https://link.springer.com/article/10.1007/s11069-024-06597-y</a></p><p>期刊：Natural Hazards</p><p>摘要：本研究评估了天气研究与预报-水文建模系统 (WRF-Hydro) 在模拟街道规模洪水淹没方面的性能。案例研究是美国新泽西州的哈肯萨克河流域，它是史蒂文斯洪水预警系统 (SFAS) 的一部分，SFAS 是一个单向耦合的水动力-水文系统，目前使用水文工程中心的水文建模系统 (HEC-HMS) 来模拟径流。对 50 米网格 WRF-Hydro 模型的性能进行了评估，以便将其集成到 SFAS 系统中。该模型使用径流观测值通过动态维度搜索算法进行了校准。使用 (i) 径流观测值、(ii) 美国地质调查局 HWM 和 (iii) 众包街道淹没数据评估了模型性能。结果表明，WRF-Hydro 的表现优于 HEC-HMS 模型。由于综合洪水预报曲线不准确以及模型结构错误，WRF-Hydro 高估或低估了洪水淹没范围。WRF-Hydro 与众包数据在洪水范围方面存在一致性。</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>文献分享</tag>
      
      <tag>数据分享</tag>
      
      <tag>WRF-Hydro5.2.0</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>新疆旅游好去处————景色绝好</title>
    <link href="/2024/07/01/%E6%96%B0%E7%96%86%E6%97%85%E6%B8%B8%E6%99%AF%E8%89%B2%E7%BB%9D%E5%A5%BD%E7%9A%84%E5%8E%BB%E5%A4%84/"/>
    <url>/2024/07/01/%E6%96%B0%E7%96%86%E6%97%85%E6%B8%B8%E6%99%AF%E8%89%B2%E7%BB%9D%E5%A5%BD%E7%9A%84%E5%8E%BB%E5%A4%84/</url>
    
    <content type="html"><![CDATA[<h1 id="新疆"><a href="#新疆" class="headerlink" title="新疆"></a>新疆</h1><p><a href="https://www.bilibili.com/video/BV1Au411K7NB">大学生的新疆毕业旅行能拍出什么样的片子——《仲夏新疆》</a></p><iframe src="//player.bilibili.com/player.html?isOutside=true&aid=532904168&bvid=BV1Au411K7NB&cid=1252513809&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" height=400 width=600></iframe><p><a href="https://www.bilibili.com/video/BV1qo4y1872f">【4K中国🇨🇳】新疆🏞️明月出天山 苍茫云海间</a></p><iframe src="//player.bilibili.com/player.html?isOutside=true&aid=397477640&bvid=BV1qo4y1872f&cid=1095546567&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" height=400 width=600></iframe><p><a href="https://www.bilibili.com/video/BV1KN411Y7mQ">姜时一-在新疆遇到了色彩斑斓的夏天</a></p><iframe src="//player.bilibili.com/player.html?isOutside=true&aid=489051165&bvid=BV1KN411Y7mQ&cid=1214222458&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" height=400 width=600></iframe><h1 id="新疆-伊犁"><a href="#新疆-伊犁" class="headerlink" title="新疆-伊犁"></a>新疆-伊犁</h1><p><a href="https://www.bilibili.com/video/BV1Hv411n7oc">【4K治愈】真实存在的动漫场景，在新疆！《伊犁的童话II：鹰的国》</a></p><iframe src="//player.bilibili.com/player.html?isOutside=true&aid=249203824&bvid=BV1Hv411n7oc&cid=371224005&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" height=400 width=600></iframe><h1 id="新疆-伊犁-天山花海"><a href="#新疆-伊犁-天山花海" class="headerlink" title="新疆-伊犁-天山花海"></a>新疆-伊犁-天山花海</h1><p><a href="https://www.bilibili.com/video/BV1Fu411x7k3">天山花海｜伊犁夏日的紫色温柔</a></p><iframe src="//player.bilibili.com/player.html?isOutside=true&aid=529262870&bvid=BV1Fu411x7k3&cid=1150326367&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" height=400 width=600></iframe><h1 id="新疆-伊犁-那拉提草原"><a href="#新疆-伊犁-那拉提草原" class="headerlink" title="新疆-伊犁-那拉提草原"></a>新疆-伊犁-那拉提草原</h1><p><a href="https://www.bilibili.com/video/BV1rN411a767">那拉提｜奔赴一场治愈的草原行</a></p><iframe src="//player.bilibili.com/player.html?isOutside=true&aid=488937332&bvid=BV1rN411a767&cid=1211795271&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" height=400 width=600></iframe><h1 id="新疆-伊犁-库尔德宁、恰西"><a href="#新疆-伊犁-库尔德宁、恰西" class="headerlink" title="新疆-伊犁-库尔德宁、恰西"></a>新疆-伊犁-库尔德宁、恰西</h1><p><a href="https://www.bilibili.com/video/BV1pT411L7Ji">新疆这两个鲜为人知的小众景点，完全可以满足你对自驾的所有幻想</a></p><iframe src="//player.bilibili.com/player.html?isOutside=true&aid=471723658&bvid=BV1pT411L7Ji&cid=795270159&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" height=400 width=600></iframe><p><a href="https://www.bilibili.com/video/BV18w4m1i7xf">库尔德宁｜伊犁的夏季美得温柔又热烈</a></p><iframe src="//player.bilibili.com/player.html?isOutside=true&aid=1105254420&bvid=BV18w4m1i7xf&cid=1569742796&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" height=400 width=600></iframe><h1 id="新疆-伊犁-喀拉峻草原"><a href="#新疆-伊犁-喀拉峻草原" class="headerlink" title="新疆-伊犁-喀拉峻草原"></a>新疆-伊犁-喀拉峻草原</h1><p><a href="https://www.bilibili.com/video/BV16v4y1n7Vw">喀拉峻草原 | 全方位无死角的草原景观“交响乐”</a></p><iframe src="//player.bilibili.com/player.html?isOutside=true&aid=569647819&bvid=BV16v4y1n7Vw&cid=1088059550&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" height=400 width=600></iframe><h1 id="新疆-喀纳斯"><a href="#新疆-喀纳斯" class="headerlink" title="新疆-喀纳斯"></a>新疆-喀纳斯</h1><p><a href="https://www.bilibili.com/video/BV1UF4m157UE">掉进油画里的旅行，他们说这里是“神的后花园”·新疆·喀纳斯</a></p><iframe src="//player.bilibili.com/player.html?isOutside=true&aid=1201269279&bvid=BV1UF4m157UE&cid=1457041700&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" height=400 width=600></iframe><h1 id="新疆-博州-赛里木湖"><a href="#新疆-博州-赛里木湖" class="headerlink" title="新疆-博州-赛里木湖"></a>新疆-博州-赛里木湖</h1><p><a href="https://www.bilibili.com/video/BV1A14y1S7ZD">赛里木湖｜漫画中的缤纷世界</a></p><iframe src="//player.bilibili.com/player.html?isOutside=true&aid=784658742&bvid=BV1A14y1S7ZD&cid=1157697875&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" height=400 width=600></iframe><p><a href="https://www.bilibili.com/video/BV12L411s7Ut">姜时一——被赛里木湖的风浪吹打的一天</a></p><iframe src="//player.bilibili.com/player.html?isOutside=true&aid=463423006&bvid=BV12L411s7Ut&cid=420233563&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" height=400 width=600></iframe><p><a href="https://www.bilibili.com/video/BV15C411s7q8">你一定要去看新疆的赛里木湖，去吹自由的风，去找灵魂里的另一个自己！</a></p><iframe src="//player.bilibili.com/player.html?isOutside=true&aid=1951137094&bvid=BV15C411s7q8&cid=1452296384&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" height=400 width=600></iframe><h1 id="新疆-独库公路"><a href="#新疆-独库公路" class="headerlink" title="新疆-独库公路"></a>新疆-独库公路</h1><p><a href="https://www.bilibili.com/video/BV1No4y1K7BQ">独库公路｜500多公里的天然风景画长卷</a></p><iframe src="//player.bilibili.com/player.html?isOutside=true&aid=402355667&bvid=BV1No4y1K7BQ&cid=1163658613&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" height=400 width=600></iframe><h1 id="新疆-阿勒泰-可可托海"><a href="#新疆-阿勒泰-可可托海" class="headerlink" title="新疆-阿勒泰-可可托海"></a>新疆-阿勒泰-可可托海</h1><p><a href="https://www.bilibili.com/video/BV1ju411c7BL">可可托海｜探索富宝蕴奇的美好世界</a></p><iframe src="//player.bilibili.com/player.html?isOutside=true&aid=533548978&bvid=BV1ju411c7BL&cid=1268299232&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" height=400 width=600></iframe><h1 id="新疆-塔城-安集海大峡谷"><a href="#新疆-塔城-安集海大峡谷" class="headerlink" title="新疆-塔城-安集海大峡谷"></a>新疆-塔城-安集海大峡谷</h1><p><a href="https://www.bilibili.com/video/BV1gx4y1K7Jv">安集海大峡谷｜五彩斑斓的峡谷里，石头也能开出花</a></p><iframe src="//player.bilibili.com/player.html?isOutside=true&aid=993485411&bvid=BV1gx4y1K7Jv&cid=1052369509&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" height=400 width=600></iframe><h1 id="新疆-库木塔格沙漠"><a href="#新疆-库木塔格沙漠" class="headerlink" title="新疆-库木塔格沙漠"></a>新疆-库木塔格沙漠</h1><p><a href="https://www.bilibili.com/video/BV1B94y1G7i3">库木塔格沙漠｜沙海上凝固的浪花</a></p><iframe src="//player.bilibili.com/player.html?isOutside=true&aid=365493878&bvid=BV1B94y1G7i3&cid=1320196952&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" height=400 width=600></iframe><h1 id="新疆-巴州-巴音布鲁克"><a href="#新疆-巴州-巴音布鲁克" class="headerlink" title="新疆-巴州-巴音布鲁克"></a>新疆-巴州-巴音布鲁克</h1><p><a href="https://www.bilibili.com/video/BV15h411V7tq">巴音布鲁克 | 天山之心，献给草原最浪漫的情书</a></p><iframe src="//player.bilibili.com/player.html?isOutside=true&aid=1300421572&bvid=BV1Hu4m1K7dU&cid=1431751864&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" height=400 width=600></iframe><p><a href="https://www.bilibili.com/video/BV1Hu4m1K7dU">飞驰在巴音布鲁克！</a></p><iframe src="//player.bilibili.com/player.html?isOutside=true&aid=226664441&bvid=BV15h411V7tq&cid=1071795374&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" height=400 width=600></iframe><h1 id="新疆-喀什"><a href="#新疆-喀什" class="headerlink" title="新疆-喀什"></a>新疆-喀什</h1><p><a href="https://www.bilibili.com/video/BV15M411N7Eq">新疆喀什旅拍</a></p><iframe src="//player.bilibili.com/player.html?isOutside=true&aid=527199395&bvid=BV15M411N7Eq&cid=1086750415&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" height=400 width=600></iframe>]]></content>
    
    
    
    <tags>
      
      <tag>旅游</tag>
      
      <tag>新疆</tag>
      
      <tag>摄影</tag>
      
      <tag>[object Object]</tag>
      
      <tag>生活</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WRF-Hydro模型配置的相关参数配置参考原论文分享一</title>
    <link href="/2024/06/01/WRF-Hydro%E6%A8%A1%E5%9E%8B%E9%85%8D%E7%BD%AE%E7%9A%84%E7%9B%B8%E5%85%B3%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE%E5%8E%9F%E8%AE%BA%E6%96%87%E5%88%86%E4%BA%AB/"/>
    <url>/2024/06/01/WRF-Hydro%E6%A8%A1%E5%9E%8B%E9%85%8D%E7%BD%AE%E7%9A%84%E7%9B%B8%E5%85%B3%E5%8F%82%E6%95%B0%E9%85%8D%E7%BD%AE%E5%8E%9F%E8%AE%BA%E6%96%87%E5%88%86%E4%BA%AB/</url>
    
    <content type="html"><![CDATA[<p>本文分享的文章中包含WRF和WRF-Hydro模型中的一些参数配置的参考值及其介绍。以下文章部分参考<a href="https://ral.ucar.edu/projects/wrf_hydro/publications">WRF-Hydro官网-publications</a>的文章（只选取2021年）</p><h1 id="1-气象研究与降水预报驱动的分布式网格-新安江模型洪水预报能力评估"><a href="#1-气象研究与降水预报驱动的分布式网格-新安江模型洪水预报能力评估" class="headerlink" title="1.气象研究与降水预报驱动的分布式网格-新安江模型洪水预报能力评估"></a>1.气象研究与降水预报驱动的分布式网格-新安江模型洪水预报能力评估</h1><p>标题：Evaluation of flood prediction capability of the distributed Grid‐Xinanjiang model driven by weather research and forecasting precipitation</p><p>原文链接：<a href="https://onlinelibrary.wiley.com/doi/10.1111/jfr3.12544">https://onlinelibrary.wiley.com/doi/10.1111/jfr3.12544</a><br>期刊：Journal of Flood Risk Management</p><p>摘要：业务洪水预报的提前时间对于洪水警报和降低洪水风险的有效性至关重要。仅仅依靠雨量计观测不可能延长洪水预报的提前时间。然而，天气研究和预报（WRF）模型具有产生定量降水预报的潜力，可以通过增加洪水预报提前时间来促进洪水风险管理。本研究分别在仪表观测和 WRF 降水预报的驱动下，研究了经过充分测试的网格新安江模型 (GXM) 在位于淮河流域上游的洪水易发地区的洪水预测能力。结果表明，GXM 能够通过使用 WRF 降水预报来改进洪水预测。利用测量的降水量很难提前预测来洪水，特别是当提前时间大于流量集中时间时。然而，通过 WRF 预报，可以在更长的时间内预测洪水事件的发生。这项研究还表明，降水预报的时间和空间模式对洪水到来的时间和强度的预测具有重要影响。</p><h1 id="2-使用-WRF-Hydro-集成模拟预测-21-世纪中叶美国东北部极端径流和内陆洪水的变化"><a href="#2-使用-WRF-Hydro-集成模拟预测-21-世纪中叶美国东北部极端径流和内陆洪水的变化" class="headerlink" title="2.使用 WRF-Hydro 集成模拟预测 21 世纪中叶美国东北部极端径流和内陆洪水的变化"></a>2.使用 WRF-Hydro 集成模拟预测 21 世纪中叶美国东北部极端径流和内陆洪水的变化</h1><p>标题：Projected changes in extreme streamflow and inland flooding in the mid-21st century over Northeastern United States using ensemble WRF-Hydro simulations<br>原文链接：<a href="https://www.sciencedirect.com/science/article/pii/S2214581823000587">https://www.sciencedirect.com/science/article/pii/S2214581823000587</a></p><p>期刊：Journal of Hydrology: Regional Studies</p><p>摘要：研究区域：美国东北部（NEUS）。<br>研究重点：我们研究了 21 世纪中叶气候变化对 NEUS 降水、径流和内陆洪水的潜在影响。在一切照旧情景下，对历史（1995-2004）和未来（2045-2054）时期的三个全球气候模型进行动态缩小的气候预测，用于迫使水文模型 WRF-Hydro 达到 200 米分辨率，并创建集合水文模拟。此外，还开发了极值模型来预测与低频水文事件相关的风险。<br>该地区新的水文见解：四个主要流域的结果表明，冬季月份明显湿润，春末至夏初可能出现干燥情况。预计北部流域秋季流量将减少，南部流域流量将增加。极端内陆洪水造成的极端流量和水深预计将分别增加 5-20% 和 &gt; 100%。到本世纪中叶，洪水总面积可能会增加 20%。这些增加的风险可归因于 (i) 十年平均值增加约 25%，十年间极端降水强度增加 &gt; 40%，(ii) 全年积雪量减少高达 30%，蒸散量增加 5-25%， (iii) 除夏季外，所有季节土壤湿度预计增加 5%。此外，冬季积雪快速融化可能会导致河流高峰流量提前。</p><h1 id="3-利用-WRF-Hydro-RAPID-模拟框架对德克萨斯州模拟蒸散量和溪流进行时空评估"><a href="#3-利用-WRF-Hydro-RAPID-模拟框架对德克萨斯州模拟蒸散量和溪流进行时空评估" class="headerlink" title="3.利用 WRF-Hydro-RAPID 模拟框架对德克萨斯州模拟蒸散量和溪流进行时空评估"></a>3.利用 WRF-Hydro-RAPID 模拟框架对德克萨斯州模拟蒸散量和溪流进行时空评估</h1><p>标题：Spatiotemporal Evaluation of Simulated Evapotranspiration and Streamflow over Texas Using the WRF-Hydro-RAPID Modeling Framework<br>原文链接：<a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/1752-1688.12585">https://onlinelibrary.wiley.com/doi/abs/10.1111/1752-1688.12585</a></p><p>期刊：JAWRA Journal of the American Water Resources Association</p><p>摘要：本研究评估了大规模水文模型框架 (WRF-Hydro-RAPID) 对德克萨斯州蒸散量 (ET) 和水流的高分辨率模拟（流域面积：464,135 平方公里）。使用的参考观测数据包括来自 MODIS 和 FLUXNET 的八天蒸散数据，以及来自位于气候梯度上的 271 个美国地质调查仪的每日河流流量数据。应用递归数字滤波器将河流流量分解为地表径流和基流，以便与模型对应物进行比较。虽然模型的布线组件已预先校准，但陆地组件未校准。结果表明，ET 和径流的模型性能取决于干旱度。湿润年份比干旱年份更能预测 ET。在潮湿地区可以更好地预测水流，效率最高约为 0.7。相比之下，干旱地区的水流预测效果最差，正偏差较大。模拟的蒸散偏差与基流偏差的相关性比地表径流偏差的相关性更强。这些结果通过纳入更多空间细节来补充之前的评估。它们还有助于确定未来模型改进的潜在流程。事实上，改进干旱地区水流模拟需要在当前模型配置中协同增强蒸散、土壤湿度和地下水参数化。我们的评估是实现准确的大规模水文预报的重要初步步骤。</p><h1 id="4-改进结构的-WRF-WRF-Hydro-耦合系统，用于混合径流生成机制的降雨-径流模拟"><a href="#4-改进结构的-WRF-WRF-Hydro-耦合系统，用于混合径流生成机制的降雨-径流模拟" class="headerlink" title="4.改进结构的 WRF&#x2F;WRF-Hydro 耦合系统，用于混合径流生成机制的降雨-径流模拟"></a>4.改进结构的 WRF&#x2F;WRF-Hydro 耦合系统，用于混合径流生成机制的降雨-径流模拟</h1><p>标题：A WRF&#x2F;WRF-Hydro coupling system with an improved structure for rainfall-runoff simulation with mixed runoff generation mechanism<br>原文链接：<a href="https://www.sciencedirect.com/science/article/pii/S0022169422006242">https://www.sciencedirect.com/science/article/pii/S0022169422006242</a></p><p>期刊：Journal of Hydrology</p><p>摘要：大气-水文耦合系统有助于更深入地了解大气与地表过程之间的相互作用，提高水文预报的时空精度，延长预报提前时间。 WRF-Hydro 是当今广泛使用的水文模块，与中尺度数值天气模型 WRF 结合用于大气水文研究和应用。本研究对WRF-Hydro的结构进行了改进和扩展，以更好地适应混合产流区复杂的降雨-径流转化机制。将入渗参数化替换为考虑表层土壤湿度变化对入渗能力影响的入渗方程，并基于地形指数的概念实现了入渗能力分布曲线的空间离散。为了实现径流收敛，将河道渗漏损失引入随时间变化的Muskingum-Cunge (MC) 水流计算中。我们还努力减少 WRF-Hydro 中的参数校准误差。通过使用带有外部漂移 (KED) 插值工具的克里金法合并天气雷达和雨量计观测结果，提高了 WRF 降雨强迫的准确性。然后使用改进的降雨强迫和合并观测来校准 WRF-Hydro 的关键参数。改进的 WRF-Hydro 结构的性能通过 WRF 模型以单向和全耦合模式进行了探索。选取中国北方半湿润和半干旱流域的典型暴雨事件作为案例研究。结果表明，改进后的WRFHydro在模拟高峰、涨落陡峭的洪水方面更为有效，但也存在低峰退去较快的问题。改进的模型结构改变了混合径流生成的比例。从长期来看，入渗超额径流量增加，饱和超额径流减少。单向和完全耦合的 WRF&#x2F;WRF-Hydro 系统都证明了改进的结构对于以渗透-过量径流生成为主的降雨径流过程的适用性。</p><h1 id="5-确定干旱地区-WRF-Hydro-模型水文校准参数的创新方法"><a href="#5-确定干旱地区-WRF-Hydro-模型水文校准参数的创新方法" class="headerlink" title="5.确定干旱地区 WRF-Hydro 模型水文校准参数的创新方法"></a>5.确定干旱地区 WRF-Hydro 模型水文校准参数的创新方法</h1><p>标题：An innovative method for determining hydrological calibration parameters for the WRF-Hydro model in arid regions<br>原文链接：<a href="https://www.sciencedirect.com/science/article/pii/S1364815216303280">https://www.sciencedirect.com/science/article/pii/S1364815216303280</a></p><p>期刊：Environmental Modelling &amp; Software</p><p>摘要：本文提出的技术允许直接确定 WRF-Hydro 洪水预报模型的某些关键校准参数。通常，校准是通过迭代、经验、试错过程来选择的。我们建议采用更系统的方法来实现可用的校准。我们的方法基于物理土壤特性，并不依赖于在特定风暴事件期间观察到的某些流域的径流。解决了对径流预测影响最大的三个特定校准变量：地形坡度、饱和导水率和渗透。我们概述了为三个变量中的每一个创建空间分布值的过程。通过计算校准、默认值和专家校准来执行涵盖多个风暴事件的模拟运行。我们表明，我们的校准仅源自土壤物理特性，其预测能力优于默认校准，并且至少与基于专家的校准一样好。</p><h1 id="6-使用-WRF-Hydro-和微波遥感对大型跨界河流进行洪水建模"><a href="#6-使用-WRF-Hydro-和微波遥感对大型跨界河流进行洪水建模" class="headerlink" title="6.使用 WRF-Hydro 和微波遥感对大型跨界河流进行洪水建模"></a>6.使用 WRF-Hydro 和微波遥感对大型跨界河流进行洪水建模</h1><p>标题：Flood modeling of a large transboundary river using WRF-Hydro and microwave remote sensing<br>原文链接：<a href="https://www.sciencedirect.com/science/article/pii/S0022169421004388">https://www.sciencedirect.com/science/article/pii/S0022169421004388</a></p><p>期刊：Journal of Hydrology</p><p>摘要：雅鲁藏布江是印度和孟加拉国之间的跨界河流，经常发生大规模洪水，淹没事件频繁，每年影响数百万人。定量理解洪水波浪特征和实时洪水建模框架的综合方法有助于有效决策和规划洪水风险管理策略。在这项研究中，我们利用仪表观测和模型模拟来表征雅鲁藏布江洪水波的传播。利用沿河不同测站的阶段过程线估算洪水升力的时空变化。洪水过程线的时间变化以控制雅鲁藏布江洪水状况的测量站的不同洪水波参数为特征。这些洪水波特征用于对不同强度的洪水事件进行分类。为了估算河流流量，在雅鲁藏布江流域建立了 WRF-Hydro 模型，用于每小时流量估算。高度计和合成孔径雷达 (SAR) 的卫星观测数据用于估计河流漫滩海拔和淹没情况。 Jason-3 卫星的高度测量数据用于水位反演，并与仪表和模拟排放时间序列进行比较，以进一步验证模型功能。 Sentinel-1 卫星 SAR 图像用于根据古瓦哈提下游洪泛区的洪水波特征评估洪水淹没程度和概率。最后，我们将这些数据集整合为辫状跨界河流系统的洪水建模和预测框架。该集成系统针对 2019 年 7 月在雅鲁藏布江发生的极端事件进行了详细研究。对洪水期间每个事件的每小时估计证明了该系统在南亚洪水易发地区进行近实时洪水评估和预报的操作部署的能力</p><h1 id="7-利用-LSTM-网络改进-WRF-Hydro-模型中的水流预测"><a href="#7-利用-LSTM-网络改进-WRF-Hydro-模型中的水流预测" class="headerlink" title="7.利用 LSTM 网络改进 WRF-Hydro 模型中的水流预测"></a>7.利用 LSTM 网络改进 WRF-Hydro 模型中的水流预测</h1><p>标题：Improving streamflow prediction in the WRF-Hydro model with LSTM networks<br>原文链接：<a href="https://www.sciencedirect.com/science/article/pii/S0022169421013470">https://www.sciencedirect.com/science/article/pii/S0022169421013470</a></p><p>期刊：Journal of Hydrology</p><p>摘要：研究人员尝试使用机器学习算法来替代基于物理的水流预测模型。尽管现有的研究有助于改进机器学习方法，但它们仍然存在弱点，例如大数据集要求和过度拟合。因此，我们提出了一种结合天气研究和预报水文建模系统（WRF-Hydro）和长短期记忆（LSTM）网络的方法，即WRF-Hydro-LSTM，以改进水流模拟。在这种方法中，LSTM被用来预测WRF-Hydro的残差；相比之下，传统的 LSTM 方法直接预测水流。在这里，我们使用 WRF-Hydro-LSTM、WRF-Hydro-only 和 LSTM-only 进行了数值实验来预测韩国昭阳湖的流入量。与仅使用 WRF-Hydro（NSE &#x3D; 0.72，R &#x3D; 0.88）相比，WRF-Hydro-LSTM 和仅 LSTM 显示出更好的结果（NSE &#x3D; 0.95，R 大于 0.96）；然而，就百分比偏差而言，WRF-Hydro-LSTM 的值 (1.75) 比仅 LSTM (17.36) 更好。虽然仅 LSTM 遵循目标函数而不是物理原理，但 WRF-Hydro-LSTM 可以模拟残余误差并有效降低传统方法固有的不确定性。此外，对训练数据集的敏感性测试表明，相关系数和 NSE 值并不太敏感，但 PBIAS 值根据训练集的不同而存在很大差异。这项研究表明，WRF-Hydro-LSTM 对于表示现实世界的物理约束特别有用，因此与单独使用这两种方法中的任何一种相比，可以潜在地改进水流预测。</p><h1 id="8-利用耦合水文气象数值天气预报模拟系统预测孟加拉国东北部季风前山洪事件"><a href="#8-利用耦合水文气象数值天气预报模拟系统预测孟加拉国东北部季风前山洪事件" class="headerlink" title="8.利用耦合水文气象数值天气预报模拟系统预测孟加拉国东北部季风前山洪事件"></a>8.利用耦合水文气象数值天气预报模拟系统预测孟加拉国东北部季风前山洪事件</h1><p>标题：Forecasting of pre-monsoon flash flood events in the northeastern Bangladesh using coupled hydrometeorological NWP modelling system<br>原文链接：<a href="https://doi.org/10.1007/s00703-021-00831-z">https://doi.org/10.1007/s00703-021-00831-z</a></p><p>期刊：Meteorology and Atmospheric Physics</p><p>摘要：孟加拉国东北部洼地地区和上游丘陵地区降雨过多，极易发生山洪暴发。 2016年和2017年发生了两起严重的季风前山洪事件。本研究尝试使用大气-水文数值天气预报（NWP）耦合模型，即天气研究和预报（WRF）模型来预测这两次山洪事件。 ARW（高级研究 WRF）模型能够提前 91 小时预测这些地区的降雨量。然而，WRF-Hydro 模型高估了流量和水位。该模型预测山洪暴发与最高降雨量相比会有大约 12 小时的滞后。模型的整体表现令人满意。描述滞后时间所需的降雨量和后续流量这两个参数几乎被精确模拟。模拟值的误差也较少，均方根误差 (RMSE) 和平均绝对误差值证明了这一点。模型导出的放电的 Nash-Sutcliffe 效率标准得分接近 1.0，RMSE 观察标准偏差比得分小于 0.5。这一发现证明数值天气预报模型可以考虑用于预测孟加拉国选定地区的山洪事件。</p><h1 id="9-将水文气象过程与科罗拉多州前沿山区的低概率洪水联系起来"><a href="#9-将水文气象过程与科罗拉多州前沿山区的低概率洪水联系起来" class="headerlink" title="9.将水文气象过程与科罗拉多州前沿山区的低概率洪水联系起来"></a>9.将水文气象过程与科罗拉多州前沿山区的低概率洪水联系起来</h1><p>标题：Connecting Hydrometeorological Processes to Low-Probability Floods in the Mountainous Colorado Front Range<br>原文链接：<a href="https://onlinelibrary.wiley.com/doi/abs/10.1029/2021WR029768">https://onlinelibrary.wiley.com/doi/abs/10.1029/2021WR029768</a></p><p>期刊：Water Resources Research</p><p>摘要：由于季节性变化的融雪和土壤湿度动态的水文气象复杂性以及极端降水的时空变化，估计山区流域罕见洪水的概率具有挑战性。设计风暴方法和统计洪水频率分析常常忽视这些复杂性以及它们如何影响罕见洪水的概率。本研究提出了一种基于过程的方法，结合了网格降水、随机风暴换位 (SST) 和基于物理的分布式降雨径流建模，以模拟长达 10,000 年重现间隔的洪峰和水量分布，并提供对洪水的深入了解。这些事件的水文气象驱动因素。该方法应用于美国科罗拉多州弗兰特山脉的一个小山区流域。我们表明，根据现有的区域降水均匀性定义，可以证明前岭的风暴转移是合理的。基于过程的结果显示与考虑潜在洪水驱动因素的基于统计的混合分布非常一致。我们进一步证明，先期条件和融雪导致频繁的洪峰流量和罕见的洪水量，而洪峰分布的上尾部似乎受到强降雨和雪雨雪的控制。我们特别强调了早秋极端降雨在控制罕见洪峰（但不是水量）方面的重要作用，尽管近几十年来只观察到一次此类事件。尽管存在与网格降水数据集的准确性相关的问题，但这些发现凸显了海表温度和基于过程的建模的潜力，有助于了解洪水驱动因素和洪水频率之间的关系。</p><h1 id="10-使用-WRF-Hydro-和数据同化对城市洪水进行高分辨率建模和预测"><a href="#10-使用-WRF-Hydro-和数据同化对城市洪水进行高分辨率建模和预测" class="headerlink" title="10.使用 WRF-Hydro 和数据同化对城市洪水进行高分辨率建模和预测"></a>10.使用 WRF-Hydro 和数据同化对城市洪水进行高分辨率建模和预测</h1><p>标题：High-resolution modeling and prediction of urban floods using WRF-Hydro and data assimilation<br>原文链接：<a href="https://www.sciencedirect.com/science/article/pii/S0022169421002833">https://www.sciencedirect.com/science/article/pii/S0022169421002833</a></p><p>期刊：Journal of Hydrology</p><p>摘要：我们评估了提高水文建模分辨率、校准选定模型参数和同化流量观测值对使用 WRF-Hydro 在达拉斯-沃斯堡地区 (DFW) 进行基于事件的城市洪水建模和预测的影响。我们使用来自协同自适应大气感知雷达网络的 500 米 1 分钟分辨率的定量降水估计值来观测降雨，使用逐步线搜索进行校准，使用固定滞后平滑进行数据同化 (DA)。模型区域是一个 144.6 平方公里的区域，包括 DFW 中部阿灵顿和大草原的 3 个城市集水区。结果表明，针对事件对 6 个 WRF-Hydro 参数进行校准在模拟集水区出口的水文图方面非常成功，尤其是对于最重要的上升枝干，但对于衰减的峰值或快速消退的下降枝干则不太成功。陆地表面模型 (LSM) 需要至少 250 米的空间分辨率才能描绘出小集水区，从而以可接受的精度捕捉整个集水区的降雨。在选定的分辨率组合下进行的模拟（LSM 为 250 和 125 米，路由模型为 250、125、50 米）显示出不同的结果。总体结果表明，在没有特定分辨率的规定和通道路由参数校准的情况下，LSM 和路由模型的 250 米分辨率在性能和计算要求方面都是不错的选择，并且，在没有高质量校准和连续流量模拟的情况下，DA 是初始化 WRF-Hydro 进行基于事件的高分辨率城市洪水预报所必需的。</p><h1 id="11-横向陆地水流对大陆尺度夏季降水的贡献——使用-WRF-Hydro-tag-集合对欧洲和西非进行比较"><a href="#11-横向陆地水流对大陆尺度夏季降水的贡献——使用-WRF-Hydro-tag-集合对欧洲和西非进行比较" class="headerlink" title="11.横向陆地水流对大陆尺度夏季降水的贡献——使用 WRF-Hydro-tag 集合对欧洲和西非进行比较"></a>11.横向陆地水流对大陆尺度夏季降水的贡献——使用 WRF-Hydro-tag 集合对欧洲和西非进行比较</h1><p>标题：Lateral terrestrial water flow contribution to summer precipitation at continental scale – A comparison between Europe and West Africa with WRF-Hydro-tag ensembles<br>原文链接：<a href="https://onlinelibrary.wiley.com/doi/10.1002/hyp.14183">https://onlinelibrary.wiley.com/doi/10.1002/hyp.14183</a></p><p>期刊：Hydrological Processes</p><p>摘要：众所周知，夏季降水量会受土壤湿度条件影响。耦合陆地表面 - 大气模型通常用于量化土壤湿度 - 降水反馈过程。然而，大多数陆地表面模型 (LSM) 都假设土壤水垂直输送，而忽略了地表和地下的横向陆地水流，这可能会降低模拟的土壤湿度 - 降水反馈的真实性。在本研究中，评估了 2008 年 6 月至 9 月期间欧洲和西非两个不同气候区横向陆地水流对夏季降水的贡献。采用耦合大气水文模型 WRF-Hydro 的一个版本，该版本具有标记和跟踪模拟大气中陆地表面蒸发的选项，称为 WRF-Hydro-tag。使用随机动能后向散射方案随机实现湍流能量，生成了 30 个包含陆地路径的模拟和 30 个不包含陆地路径的模拟的集合，适用于欧洲和西非。集合大小允许从大陆尺度平均模拟降水中提取随机噪声。研究发现，横向陆地水流使欧洲陆地表面蒸发对降水的相对贡献增加了 3.6%，西非增加了 5.6%，这增强了正土壤水分 - 降水反馈，并在模拟降水中产生了更多的不确定性，正如标准化集合散度略有增加所诊断的那样。这项研究表明，横向陆地水流对大陆尺度降水的贡献很小，但不可忽略。</p><h1 id="12-通过具有更高时空分辨率的海面温度场改进-WRF-Hydro-径流模拟"><a href="#12-通过具有更高时空分辨率的海面温度场改进-WRF-Hydro-径流模拟" class="headerlink" title="12.通过具有更高时空分辨率的海面温度场改进 WRF-Hydro 径流模拟"></a>12.通过具有更高时空分辨率的海面温度场改进 WRF-Hydro 径流模拟</h1><p>标题：Improving WRF-Hydro runoff simulations of heavy floods through the sea surface temperature fields with higher spatio-temporal resolution<br>原文链接：<a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/hyp.14338">https://onlinelibrary.wiley.com/doi/abs/10.1002/hyp.14338</a></p><p>期刊：Hydrological Processes</p><p>摘要：本研究调查了四个不同海面温度 (SST) 数据集的时空精度对天气研究和预报 (WRF)Hydro 系统的精度的影响，该系统用于模拟黑海东部两次灾难性洪水事件期间的水文响应（ EBS）和土耳其的地中海（MED）地区。三种时变和高空间分辨率外部 SST 产品（GHRSST、Medspiration 和 NCEP-SST）和一种粗分辨率和时不变 SST 产品（分别用于 EBS 和 MED 区域的 ERA5-和 GFS-SST）已嵌入WRF模型的初始和边界条件数据集用于通过WRF推导近地表大气变量。使用两个地区每小时和每日的水流数据对 WRF-Hydro 系统进行适当的基于事件的校准后，对独立海表温度事件进行非耦合模型模拟，以评估海表温度触发的降水对模拟极端径流的影响。与取决于海表温度表示的观测相比，洪水事件发生的一些局部和时间差异是显而易见的。具有较高互相关性的海表温度产品（GHRSST 和 Medspiration）显示这两个地区的洪水过程线有显着改善。与 EBS 地区模拟径流中的不变 SST（ERA5）相比，GHRSST 数据集显示 NSE 大幅提高（约 70%），RMSE 降低达 20%，相关性从 0.3 提高到 0.8。使用具有高度时空相关性的 GHRSST 和 Medspiration SST 数据，减少了 MED 地区不变 SST（GFS）的高估，从而使径流模拟与观测到的 300 立方米&#x2F;秒径流峰值完全吻合。通过详细的 SST 表示，WRF 模型的降水模拟能力得到了提高，这表明 GHRSST 和 Medspiration 模拟的水文图与观测降水模拟的水文图相比表现更好。</p><h1 id="13-参数化和模型耦合在能量和水平衡模拟中的作用——大气模型-WRF-和水文模型-WRF-Hydro-的研究"><a href="#13-参数化和模型耦合在能量和水平衡模拟中的作用——大气模型-WRF-和水文模型-WRF-Hydro-的研究" class="headerlink" title="13.参数化和模型耦合在能量和水平衡模拟中的作用——大气模型 WRF 和水文模型 WRF-Hydro 的研究"></a>13.参数化和模型耦合在能量和水平衡模拟中的作用——大气模型 WRF 和水文模型 WRF-Hydro 的研究</h1><p>标题：The Role of Parameterizations and Model Coupling on Simulations of Energy and Water Balances – Investigations With the Atmospheric Model WRF and the Hydrologic Model WRF-Hydro<br>原文链接：<a href="https://onlinelibrary.wiley.com/doi/abs/10.1029/2023JD040335">https://onlinelibrary.wiley.com/doi/abs/10.1029/2023JD040335</a></p><p>期刊：Journal of Geophysical Research: Atmospheres</p><p>摘要：分布式水文模型 WRF-Hydro 可以与大气天气、研究和预报 (WRF) 模型完全耦合模式运行。 WRF-Hydro 通过模拟侧面水流和地下水流，增强了 WRF&#x2F;WRF-Hydro 耦合中的陆地水文过程建模。本研究的目的是（a）在全耦合 WRF&#x2F;WRF-Hydro 模拟中检查 WRF-Hydro 对表面能和水平衡的影响，以及（b）检查五种 WRF 物理参数化对 WRF-Hydro 的影响。水力水流。研究区域为地中海岛屿塞浦路斯和31个山区流域。在为期 1 年的模拟中，相对于独立 WRF 模型，耦合 WRF&#x2F;WRFHydro 的域平均土壤湿度高出 20%。较高的土壤湿度可以解释潜热（36%）和蒸散量（33%）的增加。通过对模型蒸腾参数化进行修改以表示夜间蒸腾并使用遥感叶面积指数数据，这些通量的增加较小。耦合模型的模拟降水量相对于 WRF 增加了 3%。长达两年的 WRF-Hydro 模拟给出了 31 个流域日流量的中值纳什-萨特克利夫效率（对于观测到的降水强迫）为 0.5，对于五个 WRF 参数化的强迫而言，中值纳什-萨特克利夫效率在 1.9 到 0.2 之间。这项研究表明，在与 WRF-Hydro 耦合模式下，通过侧向水流过程增强独立 WRF 模型可以改变陆地能量和水平衡。未来使用 WRF 进行水文循环研究时应考虑改进的陆地过程表示。</p><h1 id="14-通过-WRF-Hydro-实验量化-AQPI-间隙填充雷达网络进行流量模拟的潜力"><a href="#14-通过-WRF-Hydro-实验量化-AQPI-间隙填充雷达网络进行流量模拟的潜力" class="headerlink" title="14.通过 WRF-Hydro 实验量化 AQPI 间隙填充雷达网络进行流量模拟的潜力"></a>14.通过 WRF-Hydro 实验量化 AQPI 间隙填充雷达网络进行流量模拟的潜力</h1><p>标题：Quantifying the Potential of AQPI Gap-Filling Radar Network for Streamflow Simulation through a WRF-Hydro Experiment<br>原文链接：<a href="https://journals.ametsoc.org/view/journals/hydr/22/7/JHM-D-20-0122.1.xml">https://journals.ametsoc.org/view/journals/hydr/22/7/JHM-D-20-0122.1.xml</a></p><p>期刊：Journal of Hydrometeorology</p><p>摘要：在美国西部许多地区提供准确及时的洪水预警仍然是一项挑战。作为高级定量降水信息 (AQPI) 项目的一部分，本研究探索了在 WRF-Hydro 建模系统下使用 AQPI 间隙填充雷达网络模拟旧金山湾区选定风暴事件的流量的潜力。研究调查了湾区最容易发生洪水的地区中的两种流域，包括自然流域和人为流域。基于高分辨率 AQPI X 波段雷达降雨估计，使用三种基本路由配置（包括网格、河段和国家水模型 (NWM)）来量化不同模型物理选项对模拟流量的影响。研究发现，当流域中存在水库时，NWM 在重现流量和水文图形状方面的表现优于其他路由配置。此外，AQPI X 波段雷达降雨估计值（未经水位计校正）提供了合理的径流模拟，与基于 S 波段下一代气象雷达网络的水位计校正降雨估计值相比，它们在重现水文峰值方面表现出更好的性能。此外，敏感性测试表明，地表条件对暴风雨期间的径流模拟有显著影响：随着渗透因子 (REFKDT) 的降低，流量增加到更高水平，随着表面粗糙度系数 (Mann) 的增加，其峰值下降并滞后。对所调查流域两个出水口的径流降水输入时间延迟分析进一步证明了 AQPI 填补空白雷达观测与该城市地区径流变化之间的联系。</p><h1 id="15-使用耦合水文气象-NWP-建模系统预测孟加拉国东北部季风前山洪事件"><a href="#15-使用耦合水文气象-NWP-建模系统预测孟加拉国东北部季风前山洪事件" class="headerlink" title="15.使用耦合水文气象 NWP 建模系统预测孟加拉国东北部季风前山洪事件"></a>15.使用耦合水文气象 NWP 建模系统预测孟加拉国东北部季风前山洪事件</h1><p>标题：Forecasting of pre-monsoon flash flood events in the northeastern Bangladesh using coupled hydrometeorological NWP modelling system<br>原文链接：<a href="https://link.springer.com/article/10.1007/s00703-021-00831-z">https://link.springer.com/article/10.1007/s00703-021-00831-z</a></p><p>期刊：Meteorology and Atmospheric Physics</p><p>摘要：孟加拉国东北部洼地地区极易发生反复的山洪暴发，原因是这些地区和上游丘陵地区降雨过多。2016 年和 2017 年发生了两次如此严重的季风前山洪暴发事件。本研究尝试使用耦合的大气-水文数值天气预报 (NWP) 模型，即天气研究和预报 (WRF) 模型来预测这两次山洪暴发事件。ARW（高级研究 WRF）模型能够提前 91 小时预测这些地区的降雨量。然而，WRF-Hydro 模型高估了流量和水位。该模型预测的山洪暴发时间与最高降雨量相比大约滞后 12 小时。这些模型的整体性能令人满意。降雨量和随后的流量这两个参数是描述滞后时间所必需的，它们几乎被精确模拟。模拟值的误差也较少，这由均方根误差 (RMSE) 和平均绝对误差值证明。模型得出的流量的纳什-萨特克利夫效率标准得分接近 1.0，RMSE-观测标准偏差比得分小于 0.5。这一发现证明 NWP 模型可用于预测孟加拉国选定地区的山洪事件。</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>文献分享</tag>
      
      <tag>数据分享</tag>
      
      <tag>WRF-Hydro5.2.0</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>利用WRF-Hydro进行河流流量估计或洪水预报的相关论文整理一</title>
    <link href="/2024/05/17/%E5%88%A9%E7%94%A8WRF-Hydro%E8%BF%9B%E8%A1%8C%E6%B2%B3%E6%B5%81%E6%B5%81%E9%87%8F%E4%BC%B0%E8%AE%A1%E6%88%96%E6%B4%AA%E6%B0%B4%E9%A2%84%E6%8A%A5%E7%9A%84%E7%9B%B8%E5%85%B3%E8%AE%BA%E6%96%87%E6%95%B4%E7%90%86%E4%B8%80/"/>
    <url>/2024/05/17/%E5%88%A9%E7%94%A8WRF-Hydro%E8%BF%9B%E8%A1%8C%E6%B2%B3%E6%B5%81%E6%B5%81%E9%87%8F%E4%BC%B0%E8%AE%A1%E6%88%96%E6%B4%AA%E6%B0%B4%E9%A2%84%E6%8A%A5%E7%9A%84%E7%9B%B8%E5%85%B3%E8%AE%BA%E6%96%87%E6%95%B4%E7%90%86%E4%B8%80/</url>
    
    <content type="html"><![CDATA[<p><a href="https://ral.ucar.edu/projects/wrf_hydro/publications">WRF-Hydro Publications</a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>文献分享</tag>
      
      <tag>WRF-Hydro5.2.0</tag>
      
      <tag>洪水</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WRF-Hydro学习拓展一</title>
    <link href="/2024/05/16/%E5%AD%A6%E4%B9%A0%E6%8B%93%E5%B1%95%E4%B8%80/"/>
    <url>/2024/05/16/%E5%AD%A6%E4%B9%A0%E6%8B%93%E5%B1%95%E4%B8%80/</url>
    
    <content type="html"><![CDATA[<h1 id="FNL和GFS数据的区别"><a href="#FNL和GFS数据的区别" class="headerlink" title="FNL和GFS数据的区别"></a>FNL和GFS数据的区别</h1><p>GFS<br>（1）gfs是实时产品，包括初始分析场和预报场，其中，只有初始场为同化（三维变分）过后的分析场，随后时次都是预报结果。因此，每隔6小时，都有N多天的预报结果，3小时间隔，前192小时位高分辨率，后面分辨率降低。<br>（2）gfs是预报场，可以实时的提供。<br>GFS和Fnl文件的区别FNL<br>（1）fnl（Final）Fnl全球资料数据是每隔6小时一次的（1度<em>1度或者为2.5度</em>2.5度）的格点数据。这个产品来自全球资料同化系统（GDAS），这一个系统持续的手机来自全球通讯系统（The Global Telecommunications System(GTS))以及其他的一些资源。这个再分析资料从地表面一直到高空，设置了26层，从1000Hpa到10Hpa。参数包括表面气压、海表面气压、位势高度、温度、海表温度、土壤状况、冰覆盖率、相对湿度、u，v风速、垂直运动、涡度以及臭氧。<br>（2）fnl是最终分析场，都是同化过后的结果，可以补齐了实时状态下没有收集齐的某些观测资料，但是绝大部分情况下和gfs的初始场差不多。因为只有分析场，每天只有4个时次。<br>（3）fnl是分析场，只能做历史个例的分析。<br>（4）FNL本质上是operational analysis（业务分析）。它是利用Global Forecast System和Data Assimilation产生的。每六个小时， GFS会初始化，然后进行16天的预报。过一段时间后，随着更多的数据收集到，GFS再进行一次run，并同化这些数据。这次run只有9个小时，产生的数据会作为下次的（6小时之后）初始条件，并产生FNL数据。Reanalysis数据是用历史上收集的所有数据，用统一的算法进行同化。这样，就尽可能减少算法变化带来的对数据的影响。reanalysis数据当然也有自己各种各样的问题，但相对于operational analysis, 就更适合于气候研究。</p><h1 id="水文过程线"><a href="#水文过程线" class="headerlink" title="水文过程线"></a>水文过程线</h1><p>水文过程线描述的是河川径流量随时间的变化过程。它将河川径流量与雨雪补给来源联系起来，表达了径流与降水和其他流域环境要素之间的关系，及其随时间的推移变化。水文过程线提供了在干旱、洪涝及正常天气情况下，地表径流过程及其变化信息。总之，河川径流的长期过程，在一系列不规则的增减作用下，保持相对稳定的变化。在雨季，径流量随降水而增加，到了旱季，则逐渐减少。影响径流量大小的因素包括集水面积、暴雨强度、流域条件、到达观测点之前水流的距离及路径。</p><p>水文过程线反映了降水通过水文气候过程转化成径流的过程。同时，水文过程线也描述了径流速率随时间的变化过程、径流速率峰值和径流总量。径流过程中的水文气候作用，指的是降雨到达地表后如何以不同方式到达河道。追溯单次降雨事件是评估多次降雨事件的基础。</p><p>参考：<a href="https://baike.baidu.com/item/%E6%B0%B4%E6%96%87%E8%BF%87%E7%A8%8B%E7%BA%BF/5886126">百度百科-水文过程线</a></p><h1 id="WRF-Hydro研究"><a href="#WRF-Hydro研究" class="headerlink" title="WRF-Hydro研究"></a>WRF-Hydro研究</h1><p>首先，一维 (1D) 柱地表模型计算能量（显热和潜热、净辐射）和水分（冠层拦截、渗透、过度渗透、深层渗透）的垂直通量以及土壤热和水分状态。随后，使用时间步长加权方法 (Gochis) 将渗透过量、积水深度和土壤湿度从 1D LSM 网格（通常为 1-4 km 空间分辨率）分解为高分辨率（通常为 30-100 m）路由网格。和Chen，2003）并被传递到地下和地表水流地形路由模块。</p><p>为了让模型读取soil_properties.nc.nc 文件，必须在编译时将 SPATIAL_SOIL 环境变量设置为 1。</p><p>如果采用wrfout_d01*作为FORCING数据，分辨率可查看WRF中的namelist.input文件。DOMAIN文件夹中的wrfinput_d01、geo_em01文件的分辨率也可根据同种方法进行查看。</p><p>问题：如何设置查看WRF-Hydro输出文件的分辨率？</p><p>LDASOUT_DOMAIN1文件：通过ncdump命令打印查看global attributes中的proj4，该变量定义了LDASOUT_DOMAIN1文件的投影方式和坐标系统（不为经纬度坐标，需转换）。</p><p>在 WRF-Hydro 中，子网格聚合/分解（aggregation/disaggregation）用于表示比本地陆地表面模型网格更精细的网格尺度上的陆上和地下流动过程。</p><p>路由计算可以在相对高分辨率的陆地表面（例如，25米数字高程模型）上执行，而本地陆地表面模型可以在更大（例如，1公里）的网格尺寸上运行。</p><p>AGGFACTR：子网格聚合因子，定义为子网格分辨率与原生土地模型分辨率的比率。不能为1.</p><p>通过在模型名称列表文件中指定地面流或地下流路由选项并指定与陆地表面模型域文件尺寸（IX、JX）不同的地形网格域文件尺寸（IXRT、JXRT）来激活聚合/分解例程。 ）。此外，模型子网格大小 (DXRT)、路由时间步长 (DTRT) 和整数除数 (AGGFACTRT) 决定聚合/分解例程如何划分本机模型网格方块，所有这些都需要在模型 Hydro.namelist 文件中指定。<br>如果 IXRT=IX、JXRT=JX 和 AGGFACTRT=1，聚合/分解方案将被激活，但不会对陆地表面模型网格和地形路径网格之间的模型分辨率产生任何有效的变化。为 IXRT、JXRT 和 AGGFACTRT≠1 指定不同的值将有效改变陆地模型和地形布线网格之间的模型分辨率。如地表径流路由第 3.5 节中所述，<strong>DXRT 和 DTRT 必须始终根据路由网格指定，即使它们与本地陆地表面模型网格相同</strong>。</p><p>DXRT：Specification of the routing grid cell spacing，布线网格单元间距的规范</p><p>聚合因子 = 4 的常规陆地表面模型网格内的路由子网格实施示例<br><img src="image.png" alt="alt text"></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WRF-Hydro5.2.0</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WRF-Hydro中可能使用到的各种数据整理【附原文分享】</title>
    <link href="/2024/05/14/WRF-Hydro%E4%B8%AD%E5%8F%AF%E8%83%BD%E4%BD%BF%E7%94%A8%E5%88%B0%E7%9A%84%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE%E6%95%B4%E7%90%86%E3%80%90%E9%99%84%E5%8E%9F%E6%96%87%E5%88%86%E4%BA%AB%E3%80%91/"/>
    <url>/2024/05/14/WRF-Hydro%E4%B8%AD%E5%8F%AF%E8%83%BD%E4%BD%BF%E7%94%A8%E5%88%B0%E7%9A%84%E5%90%84%E7%A7%8D%E6%95%B0%E6%8D%AE%E6%95%B4%E7%90%86%E3%80%90%E9%99%84%E5%8E%9F%E6%96%87%E5%88%86%E4%BA%AB%E3%80%91/</url>
    
    <content type="html"><![CDATA[<h2 id="径流-入渗分区和已解决的地表流量对陆地-大气反馈的作用：西非-WRF-水力耦合建模系统的案例研究"><a href="#径流-入渗分区和已解决的地表流量对陆地-大气反馈的作用：西非-WRF-水力耦合建模系统的案例研究" class="headerlink" title="径流-入渗分区和已解决的地表流量对陆地-大气反馈的作用：西非 WRF-水力耦合建模系统的案例研究"></a>径流-入渗分区和已解决的地表流量对陆地-大气反馈的作用：西非 WRF-水力耦合建模系统的案例研究</h2><p>标题：Role of Runoff–Infiltration Partitioning and Resolved Overland Flow on Land–Atmosphere Feedbacks: A Case Study with the WRF-Hydro Coupled Modeling System for West Africa<br>原文链接：<a href="https://journals.ametsoc.org/view/journals/hydr/17/5/jhm-d-15-0089_1.xml">https://journals.ametsoc.org/view/journals/hydr/17/5/jhm-d-15-0089_1.xml</a><br>期刊：Journal of Hydrometeorology</p><p>（TRMM 降水数据在<a href="http://mirador.gsfc.nasa.gov/cgi-bin/mirador/homepageAlt.pl?keyword=TRMM_3B42%E5%9C%A8%E7%BA%BF%E8%8E%B7%E5%8F%96%EF%BC%8CESA-CCI">http://mirador.gsfc.nasa.gov/cgi-bin/mirador/homepageAlt.pl?keyword=TRMM_3B42在线获取，ESA-CCI</a> 土壤湿度数据在<a href="http://www.esa-soilmoisture/">http://www.esa-soilmoisture</a> -cci.org&#x2F;node&#x2F;145，CRU 温度数据位于<a href="http://www.cru.uea.ac.uk/cru/data/hrg/%EF%BC%8CMTE">http://www.cru.uea.ac.uk/cru/data/hrg/，MTE</a> 数据位于<a href="https://climatedataguide.ucar.edu/climate-">https://climatedataguide.ucar.edu/climate-</a> data&#x2F;fluxnet-mte-multi-tree-ensemble。）流量数据由加纳水资源、工程和住房部水文服务部提供。有关 HydroSHEDS 数据的技术信息可在线获取：<a href="http://hydrosheds.cr.usgs.gov./">http://Hydrosheds.cr.usgs.gov。</a> WRF-Hydro 预处理工具可在线获取：<a href="https://www.ral.ucar.edu/sites/default/files/public/projects/wrf_Hydro/v3_0/Standalone_Tool_v2_2.zip%E3%80%82">https://www.ral.ucar.edu/sites/default/files/public/projects/wrf_Hydro/v3_0/Standalone_Tool_v2_2.zip。</a> WRF 和 WRF-Hydro 模拟在德国气候计算中心进行。</p><h2 id="使用-LSTM-网络改进-WRF-Hydro-模型中的水流预测"><a href="#使用-LSTM-网络改进-WRF-Hydro-模型中的水流预测" class="headerlink" title="使用 LSTM 网络改进 WRF-Hydro 模型中的水流预测"></a>使用 LSTM 网络改进 WRF-Hydro 模型中的水流预测</h2><p>标题：Improving streamflow prediction in the WRF-Hydro model with LSTM networks<br>原文链接：<a href="https://www.sciencedirect.com/science/article/pii/S0022169421013470">https://www.sciencedirect.com/science/article/pii/S0022169421013470</a><br>期刊：Journal of Hydrology</p><p>HydroSHEDS 条件DEM和湖泊多边形可在<a href="http://www.hydrosheds.org获取,昭阳湖入流观测数据可在http//www.water.or.kr">http://www.Hydrosheds.org获取，昭阳湖入流观测数据可在http://www.water.or.kr</a> 获取，LDAPS和 ASOS 气象强迫数据集可以在<a href="http://data.kma.go.kr上获取,土壤图可以在/">http://data.kma.go.kr上获取，土壤图可以在</a> <a href="http://soil.rda.go.kr/">http://soil.rda.go.kr</a> 上获取。</p><h2 id="使用长短期记忆网络和大陆规模的数据集成增强水流预测并提取见解"><a href="#使用长短期记忆网络和大陆规模的数据集成增强水流预测并提取见解" class="headerlink" title="使用长短期记忆网络和大陆规模的数据集成增强水流预测并提取见解"></a>使用长短期记忆网络和大陆规模的数据集成增强水流预测并提取见解</h2><p>标题：Enhancing Streamflow Forecast and Extracting Insights Using Long-Short Term Memory Networks With Data Integration at Continental Scales<br>原文链接：<a href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2019WR026793">https://agupubs.onlinelibrary.wiley.com/doi/full/10.1029/2019WR026793</a><br>期刊：Water Resources Research</p><p>CAMELS的大部分每日径流观测开始于1980年，结束于2014年。我们在本研究中使用的气象强迫数据是北美陆地数据同化系统（NLDAS）的每日数据。用作我们模型输入的骆驼流域属性包括地形、气候特征、土地覆盖、土壤和地质特征（表 1）。</p><p>CAMELS数据集，包括流域属性、强迫数据和水流，可以从本文提供的引文中下载。这项工作得到了国家科学基金会奖 EAR-1832294 的支持。根据合同 DE-SC0016605，KF 得到了美国能源部生物与环境研究办公室的部分支持。径流数据可以从美国地质调查局国家水数据网站（<a href="https://doi.org/10.5066/F7P55KJN%EF%BC%89%E4%B8%8B%E8%BD%BD%E3%80%82%E6%88%91%E4%BB%AC%E7%9A%84">https://doi.org/10.5066/F7P55KJN）下载。我们的</a> LSTM 代码可在 GitHub ( <a href="https://github.com/mhpi/HydroDL">https://github.com/mhpi/HydroDL</a> )上获取。</p><h2 id="使用长短期记忆-LSTM-网络进行降雨径流建模"><a href="#使用长短期记忆-LSTM-网络进行降雨径流建模" class="headerlink" title="使用长短期记忆 (LSTM) 网络进行降雨径流建模"></a>使用长短期记忆 (LSTM) 网络进行降雨径流建模</h2><p>标题：Rainfall–runoff modelling using Long Short-Term Memory (LSTM) networks<br>原文链接：<a href="https://hess.copernicus.org/articles/22/6005/2018/">https://hess.copernicus.org/articles/22/6005/2018/</a><br>期刊：Hydrology and Earth System Sciences</p><p>我们在 CAMELS 数据集的大量流域上测试了该方法 （Addor 等人，  2017 b；Newman 等人，  2014）。该数据集可免费获取，包括美国本土 671 个流域的气象强迫数据和观测到的流量。对于每个流域，CAMELS 数据集还包括 Sacramento 土壤湿度核算模型（Burnash 等人，  1973 年）与 Snow-17 雪模型（Anderson，  1973 年）相结合的模拟流量的时间序列。</p><p>我们研究的基础数据是 CAMELS 数据集 （Addor 等人，  2017 b；Newman 等人，  2014）。该缩写代表“大样本研究的流域属性”，它是一个免费提供的数据集，包含美国本土 (CONUS) 的 671 个流域，人为干扰最小。该数据集包含流域汇总（集中）气象强迫数据和从 1980 年开始（对于大多数流域）的每日时间尺度观测到的流量。气象数据是根据三个不同的网格数据源计算的（Daymet、 Thornton 等人，  2012 年；Maurer ，Maurer 等人，  2002 年；以及 NLDAS， Xia 等人，  2012 年），包括日长、降水量、短波向下辐射、最高和最低温度、雪水当量和湿度。<strong>我们使用 Daymet 数据，因为它具有最高的空间分辨率（1 公里网格，而 Maurer 和 NLDAS 为 12 公里网格）作为计算流域平均值和所有可用气象输入变量（雪水当量和白天的长度</strong>。</p><p>Addor, N., Newman, A. J., Mizukami, N., and Clark, M. P.: Catchment attributes for large-sample studies, UCAR&#x2F;NCAR, Boulder, CO, USA, <a href="https://doi.org/10.5065/D6G73C3Q">https://doi.org/10.5065/D6G73C3Q</a>, 2017b. a, b</p><p>Newman, A., Sampson, K., Clark, M., Bock, A., Viger, R., and Blodgett, D.: A large-sample watershed-scale hydrometeorological dataset for the contiguous USA, UCAR&#x2F;NCAR, Boulder, CO, USA, <a href="https://doi.org/10.5065/D6MW2F4D">https://doi.org/10.5065/D6MW2F4D</a>, 2014. a, b</p><p>Newman, A. J., Clark, M. P., Sampson, K., Wood, A., Hay, L. E., Bock, A., Viger, R. J., Blodgett, D., Brekke, L., Arnold, J. R., Hopson, T., and Duan, Q.: Development of a large-sample watershed-scale hydrometeorological data set for the contiguous USA: data set characteristics and assessment of regional variability in hydrologic model performance, Hydrol. Earth Syst. Sci., 19, 209–223, <a href="https://doi.org/10.5194/hess-19-209-2015">https://doi.org/10.5194/hess-19-209-2015</a>, 2015. a, b, c, d</p><h2 id="使用独立估计的流量持续时间曲线对未测量位置的模拟历史日流量进行偏差校正"><a href="#使用独立估计的流量持续时间曲线对未测量位置的模拟历史日流量进行偏差校正" class="headerlink" title="使用独立估计的流量持续时间曲线对未测量位置的模拟历史日流量进行偏差校正"></a>使用独立估计的流量持续时间曲线对未测量位置的模拟历史日流量进行偏差校正</h2><p>标题：Bias correction of simulated historical daily streamflow at ungauged locations by using independently estimated flow duration curves<br>原文链接：<a href="https://hess.copernicus.org/articles/22/5741/2018/">https://hess.copernicus.org/articles/22/5741/2018/</a><br>期刊：Hydrology and Earth System Sciences</p><p>提出的方法是使用来自美国本土GAGES-II 数据库（Falcone，  2011）中 1980 年 10 月 1 日至 2013 年 9 月 30 日期间参考质量流量计的每日平均流量数据进行探索的。径流数据直接从国家水信息系统网站（NWISWeb， <a href="http://waterdata.usgs.gov；最后访问：2017年9月20日）获得。对于每个流量计，相关的盆地特征是从">http://waterdata.usgs.gov；最后访问：2017年9月20日）获得。对于每个流量计，相关的盆地特征是从</a> GAGES-II 数据库中获得的（Falcone，  2011）。</p><p>Falcone, J.：用于评估水流的量具的地理空间属性，数字空间数据集，可访问：<a href="http://water.usgs.gov/GIS/metadata/usgswrd/XML/gagesII_Sept2011.xml">http://water.usgs.gov/GIS/metadata/usgswrd/XML/gagesII_Sept2011.xml</a> （最后访问：2018 年 11 月 5 日）， 2011.a  、b、c、d</p><h2 id="使用实时监测站网络和混合机器学习方法进行每日流量预测"><a href="#使用实时监测站网络和混合机器学习方法进行每日流量预测" class="headerlink" title="使用实时监测站网络和混合机器学习方法进行每日流量预测"></a>使用实时监测站网络和混合机器学习方法进行每日流量预测</h2><p>标题：Daily Streamflow Forecasting Using Networks of Real-Time Monitoring Stations and Hybrid Machine Learning Methods<br>原文链接：<a href="https://www.mdpi.com/2073-4441/16/9/1284">https://www.mdpi.com/2073-4441/16/9/1284</a><br>期刊：Water</p><p>本研究中使用的数据集属于公共领域，可从加拿大水调查（针对排放）、安大略省环境部省级地下水监测计划（针对地下水位数据）和加拿大环境部（针对排放）下载。降水数据）。</p><h2 id="提高水文数据稀疏地区数据驱动降雨径流模型预测能力的自训练方法"><a href="#提高水文数据稀疏地区数据驱动降雨径流模型预测能力的自训练方法" class="headerlink" title="提高水文数据稀疏地区数据驱动降雨径流模型预测能力的自训练方法"></a>提高水文数据稀疏地区数据驱动降雨径流模型预测能力的自训练方法</h2><p>标题：Self-training approach to improve the predictability of data-driven rainfall-runoff model in hydrological data-sparse regions<br>原文链接：<a href="https://doi.org/10.1016/j.jhydrol.2024.130862">https://doi.org/10.1016/j.jhydrol.2024.130862</a><br>期刊：Journal of Hydrology</p><p>为了研究自我训练在分析涵盖各种地质和气候条件的水流网络中的有效性，我们使用流域属性和大样本研究气象学（CAMELS）数据集（Newman et al., 2015）。我们利用该数据集是因为他们对数据的公众信心，这可能会加强我们假设的验证（在2.4 节中讨论）。该数据集包括美国大陆 671 个不受管制的流域的流域平均水文气象时间序列、流域特征和每日径流量测量值。值得注意的是，该数据集已被广泛利用，以促进数据驱动模型用于各种目的的泛化和应用（例如，Feng et al., 2020、Gauch et al., 2021b、Kratzert et al., 2019b）。我们采用了与Gauch 等人 (2021b)和Kratzert 等人 (2019b)相同的 531 个盆地子集（见图1），同时排除了 140 个盆地，这些盆地在不同方法中计算的流域边界显示出相当大的不一致。与上述研究一致，我们利用毛雷尔气象强迫数据集，其中包括每日累积降水量（<br>PRCP，最高和最低气温、短波辐射和蒸气压，对每个盆地进行空间平均。此外，我们使用了27个静态流域特征，包括地形、气候特征、土地覆盖、土壤和地质特征（表1）。</p><p>CAMELS数据集：Newman, A. J., Clark, M. P., Sampson, K., Wood, A., Hay, L. E., Bock, A., Viger, R. J., Blodgett, D., Brekke, L., Arnold, J. R., Hopson, T., and Duan, Q.: Development of a large-sample watershed-scale hydrometeorological data set for the contiguous USA: data set characteristics and assessment of regional variability in hydrologic model performance, Hydrol. Earth Syst. Sci., 19, 209–223, <a href="https://doi.org/10.5194/hess-19-209-2015">https://doi.org/10.5194/hess-19-209-2015</a>, 2015.</p><h2 id="使用长短期记忆-LSTM-神经网络来提高美国西部河流的流量预测"><a href="#使用长短期记忆-LSTM-神经网络来提高美国西部河流的流量预测" class="headerlink" title="使用长短期记忆 (LSTM) 神经网络来提高美国西部河流的流量预测"></a>使用长短期记忆 (LSTM) 神经网络来提高美国西部河流的流量预测</h2><p>标题：<br>原文链接：<a href="https://hess.copernicus.org/articles/26/5449/2022">https://hess.copernicus.org/articles/26/5449/2022</a><br>期刊：Hydrology and Earth System Sciences</p><p>ERA5：我们使用流域平均 ERA5 变量（近地表、地表和地下）作为 LSTM 的训练数据。ERA5 的数据可从<a href="https://cds.climate.copernicus.eu/#!/search?text=ERA5&type=dataset%E8%8E%B7%E5%8F%96%E3%80%82">https://cds.climate.copernicus.eu/#!/search?text=ERA5&amp;type=dataset获取。</a></p><p>IFS：IFS 数据（最多 10 天的前置时间）在运行时用作 LSTM 的输入（可从<a href="https://apps.ecmwf.int/archive-catalogue/?class=od&stream=oper&expver=1%E8%8E%B7%E5%8F%96%EF%BC%89%E3%80%82">https://apps.ecmwf.int/archive-catalogue/?class=od&amp;stream=oper&amp;expver=1获取）。</a> 该系统有详细描述（<a href="https://www.ecmwf.int/en/publications/ifs-documentation%EF%BC%89">https://www.ecmwf.int/en/publications/ifs-documentation）</a></p><p>GloFAS：全球水文预报和监测系统。自 2017 年 11 月起一直在生成每日集合洪水预测和每月季节性水流展望，并作为哥白尼应急管理服务的组成部分运行。对于2021年5月25日之前的日期（即所有测试期和大部分运行期），我们使用GloFAS 2.1版（Zsoter et al. ,  2019 a）；此后，我们使用 GloFAS 3.1 版（Zsoter 等人，  2021）。GloFAS 产品可从其专用信息系统免费获取，并向所有以下注册者开放（<a href="https://www.globalfloods.eu/%EF%BC%8C%E6%9C%80%E5%90%8E%E8%AE%BF%E9%97%AE%E6%97%A5%E6%9C%9F%EF%BC%9A2022">https://www.globalfloods.eu/，最后访问日期：2022</a> 年 8 月 1 日），其水文数据来自哥白尼气候数据存储 ( <a href="https://cds/">https://cds</a>) .climate.copernicus.eu&#x2F;#!&#x2F;home，最后访问日期：2022 年 8 月 1 日）。有关 GloFAS 服务的更多详细信息，请访问专用 wiki（<a href="https://confluence.ecmwf.int/display/CEMS/Global+Flood+Awareness+System%EF%BC%8C%E6%9C%80%E5%90%8E%E8%AE%BF%E9%97%AE%E6%97%A5%E6%9C%9F%EF%BC%9A2022">https://confluence.ecmwf.int/display/CEMS/Global+Flood+Awareness+System，最后访问日期：2022</a> 年 8 月 1 日）。使用了两组 GloFAS 数据：GloFAS-ERA5 （Zsoter 等人，  2019 b），这是通过使用 ERA5 重新分析强制水文模型创建的每日河流流量的全球建模数据集，以及 GloFAS 预测（Zsoter 等人，  2019 ） a，2021），全球每日河流流量预报的集合，由 ECMWF IFS 的集合预报强制执行。这些数据是全球性的，具有每日频率，分辨率为0.1°×0.1°。</p><p>观测值数据：观测仪表数据下载自<a href="https://dwr.state.co.us/Tools/Stations%EF%BC%88%EF%BC%88%E5%AF%B9%E4%BA%8E">https://dwr.state.co.us/Tools/Stations（（对于</a> ESSC2）和<a href="https://waterdata.usgs.gov/nwis%EF%BC%88%E6%89%80%E6%9C%89%E5%85%B6%E4%BB%96%EF%BC%89%E3%80%82%E8%BF%99%E4%BA%9B%E6%95%B0%E6%8D%AE%E4%BB%A5">https://waterdata.usgs.gov/nwis（所有其他）。这些数据以</a> 3 小时为单位提供，几乎实时发布，并且大部分覆盖范围从 1990 年左右开始。</p><h1 id="使用独立估计的流量持续时间曲线对未测量位置模拟的历史日流量进行偏差校正"><a href="#使用独立估计的流量持续时间曲线对未测量位置模拟的历史日流量进行偏差校正" class="headerlink" title="使用独立估计的流量持续时间曲线对未测量位置模拟的历史日流量进行偏差校正"></a>使用独立估计的流量持续时间曲线对未测量位置模拟的历史日流量进行偏差校正</h1><p>标题：Bias correction of simulated historical daily streamflow at ungauged locations by using independently estimated flow duration curves<br>原文链接：<a href="https://hess.copernicus.org/articles/22/5741/2018/">https://hess.copernicus.org/articles/22/5741/2018/</a></p><p>期刊：Hydrology and Earth System Sciences</p><p>使用 GAGES-II 数据库 ( Falcone ,  2011 )中美国本土从 1980 年 10 月 1 日至 2013 年 9 月 30 日期间的参考质量流量计的每日平均流量数据。</p><p>用于产生本文讨论的结果的数据和脚本可以在Farmer 等人（2018）中找到。</p><p>Farmer, WH、Over, TM 和 Kiang, JE：使用独立估计的流量持续时间曲线对未测量位置模拟的历史每日流量进行偏差校正：数据发布，技术代表，美国地质调查局，弗吉尼亚州雷斯顿，https: &#x2F;&#x2F;doi.org&#x2F;10.5066&#x2F;F7VD6XNG，2018年</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>websites</tag>
      
      <tag>文献分享</tag>
      
      <tag>数据分享</tag>
      
      <tag>WRF-Hydro5.2.0</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>土耳其2023双震部分参考数据和处理工具整理【附原文分享】</title>
    <link href="/2024/05/14/%E5%9C%9F%E8%80%B3%E5%85%B62023%E5%8F%8C%E9%9C%87%E9%83%A8%E5%88%86%E5%8F%82%E8%80%83%E6%95%B0%E6%8D%AE%E5%92%8C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7%E6%95%B4%E7%90%86-%E9%99%84%E5%8E%9F%E6%96%87%E5%88%86%E4%BA%AB/"/>
    <url>/2024/05/14/%E5%9C%9F%E8%80%B3%E5%85%B62023%E5%8F%8C%E9%9C%87%E9%83%A8%E5%88%86%E5%8F%82%E8%80%83%E6%95%B0%E6%8D%AE%E5%92%8C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7%E6%95%B4%E7%90%86-%E9%99%84%E5%8E%9F%E6%96%87%E5%88%86%E4%BA%AB/</url>
    
    <content type="html"><![CDATA[<h1 id="土耳其2023双震同震形变分析的参考数据和处理工具整理【附原文分享】"><a href="#土耳其2023双震同震形变分析的参考数据和处理工具整理【附原文分享】" class="headerlink" title="土耳其2023双震同震形变分析的参考数据和处理工具整理【附原文分享】"></a>土耳其2023双震同震形变分析的参考数据和处理工具整理【附原文分享】</h1><h2 id="提供可用数据和代码的论文"><a href="#提供可用数据和代码的论文" class="headerlink" title="提供可用数据和代码的论文"></a>提供可用数据和代码的论文</h2><h3 id="Traditional-seismic-hazard-analyses-underestimate-hazard-levels-when-compared-to-observations-from-the-2023-Kahramanmaras-earthquakes"><a href="#Traditional-seismic-hazard-analyses-underestimate-hazard-levels-when-compared-to-observations-from-the-2023-Kahramanmaras-earthquakes" class="headerlink" title="Traditional seismic hazard analyses underestimate hazard levels when compared to observations from the 2023 Kahramanmaras earthquakes"></a>Traditional seismic hazard analyses underestimate hazard levels when compared to observations from the 2023 Kahramanmaras earthquakes</h3><p>原文链接：<a href="https://www.nature.com/articles/s43247-023-01148-y">https://www.nature.com/articles/s43247-023-01148-y</a></p><p>两次地震记录的地面运动数据集来自 Gülerce 等人。<a href="https://www.nature.com/articles/s43247-023-01148-y#ref-CR10">10</a>，他们使用了土耳其灾害和应急管理局 (AFAD) 发布的原始地面加速度数据。他们消除了潜在有问题的记录（即，跟踪不完整、噪声内容较多或事件跟踪不清晰的记录），并根据 Akkar 等人中描述的程序处理剩余记录。<a href="https://www.nature.com/articles/s43247-023-01148-y#ref-CR11">11</a> .由于本研究主要关注振幅相对较高的地震动，因此仅考虑断层面100 km以内的记录。此外，上部 30 米内的时间平均剪切波速度（）未知的台站记录也被删除，因为该站点代理是 GMM 的关键输入。这导致了<em>Mw</em> 7.8 Pazarcik 事件的 51 项记录和<em>Mw</em> 7.5 Elbistan 事件的 25 项记录。对于所有记录，计算三个地面运动强度测量：峰值地面加速度 ( <em>PGA</em> ) 和 0.5 秒和 1.0 秒周期的 5% 阻尼弹性谱加速度 (和 )。选择这三个参数是为了粗略地考虑地面运动频率内容的变化。所有强度测量的 RotD50 值都是根据两个正交水平分量计算的。对于两个水平和正交分量，RotD50值是通过以小增量旋转地面运动来计算的，以获得各个方向上的加速度；计算每个方向的强度测量；并计算所有方向的中值强度<a href="https://www.nature.com/articles/s43247-023-01148-y#ref-CR12">12</a>。(选自论文<a href="https://www.nature.com/articles/s43247-023-01148-y">Traditional seismic hazard analyses underestimate hazard levels when compared to observations from the 2023 Kahramanmaras earthquakes</a>)</p><p><a href="https://tadas.afad.gov.tr/event-detail/17966">AFAD_Kahramanmaraş_Mw7.7_PGA_data</a></p><p><a href="https://tadas.afad.gov.tr/event-detail/17969">AFAD_Elbistan (Kahramanmaraş)_Mw7.6_PGA_data</a></p><h3 id="Geometric-controls-on-cascading-rupture-of-the-2023-Kahramanmaras-earthquake-doublet"><a href="#Geometric-controls-on-cascading-rupture-of-the-2023-Kahramanmaras-earthquake-doublet" class="headerlink" title="Geometric controls on cascading rupture of the 2023 Kahramanmaraş earthquake doublet"></a>Geometric controls on cascading rupture of the 2023 Kahramanmaraş earthquake doublet</h3><p>原文链接：<a href="https://www.nature.com/articles/s41561-023-01283-3">https://www.nature.com/articles/s41561-023-01283-3</a></p><p><a href="https://www.tusaga-aktif.gov.tr/Web/DepremVerileri.aspx">地震区TUSAGA-Active固定GNSS站1秒数据</a></p><p>GNSS 原始数据由 Türkiye Ulusal Sabit GNSS Ağı-Aktif (TUSAGA-Active) 系统 ( <a href="https://www.tusaga-aktif.gov.tr/Web/DepremVerileri.aspx">https://www.tusaga-aktif.gov.tr/Web/DepremVerileri.aspx</a> )提供。</p><p>与BP结果相关的大地测量数据、滑动模型和数据集可以从<a href="https://doi.org/10.5281/zenodo.8271589%E4%B8%8B%E8%BD%BD">https://doi.org/10.5281/zenodo.8271589下载</a></p><h3 id="The-overall-subshear-and-multi-segment-rupture-of-the-2023-Mw7-8-Kahramanmaras-Turkey-earthquake-in-millennia-supercycle"><a href="#The-overall-subshear-and-multi-segment-rupture-of-the-2023-Mw7-8-Kahramanmaras-Turkey-earthquake-in-millennia-supercycle" class="headerlink" title="The overall-subshear and multi-segment rupture of the 2023 Mw7.8 Kahramanmaraş, Turkey earthquake in millennia supercycle"></a>The overall-subshear and multi-segment rupture of the 2023 Mw7.8 Kahramanmaraş, Turkey earthquake in millennia supercycle</h3><p>原文链接：<a href="https://www.nature.com/articles/s43247-023-01030-x">https://www.nature.com/articles/s43247-023-01030-x</a></p><p>断层破裂痕迹来自USGS。高速率 GNSS 数据由 TUSAGA-Aktif (<a href="https://www.tusagaaktif.gov.tr/">https://www.tusagaaktif.gov.tr/</a>) 提供。强震动数据可从土耳其灾害和紧急事务管理局（AFAD；<a href="https://tadas.afad.gov.tr/event-detail/15499%EF%BC%89%E8%8E%B7%E5%8F%96%E3%80%82%E7%9F%A9%E5%BC%A0%E9%87%8F%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%E6%9D%A5%E8%87%AA%E5%85%A8%E5%B1%80%E8%B4%A8%E5%BF%83%E7%9F%A9%E5%BC%A0%E9%87%8F%E9%A1%B9%E7%9B%AE%EF%BC%88CMT%EF%BC%9Bhttp://www.globalcmt.org%EF%BC%89%E3%80%82%E5%9C%B0%E9%9C%87%E6%95%B0%E6%8D%AE%E7%94%B1IRIS%EF%BC%88https://ds.iris.edu/wilber3/%EF%BC%89%E5%92%8C%E4%B8%AD%E5%9B%BD%E5%9C%B0%E9%9C%87%E5%B1%80%E5%9C%B0%E7%90%83%E7%89%A9%E7%90%86%E7%A0%94%E7%A9%B6%E6%89%80%E5%9B%BD%E5%AE%B6%E5%9C%B0%E9%9C%87%E5%8F%B0%E7%BD%91%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86%E4%B8%AD%E5%BF%83%EF%BC%88http://www.seisdmc.ac%EF%BC%89%E6%8F%90%E4%BE%9B.cn%EF%BC%89%E3%80%82%E5%BD%93%E5%9C%B0%E5%9C%B0%E9%9C%87%E7%9B%AE%E5%BD%95%E5%8F%AF%E5%9C%A8">https://tadas.afad.gov.tr/event-detail/15499）获取。矩张量解决方案来自全局质心矩张量项目（CMT；http://www.globalcmt.org）。地震数据由IRIS（https://ds.iris.edu/wilber3/）和中国地震局地球物理研究所国家地震台网数据管理中心（http://www.seisdmc.ac）提供.cn）。当地地震目录可在</a> AFAD (<a href="https://deprem.afad.gov.tr/eventcatalog">https://deprem.afad.gov.tr/eventcatalog</a>) 上获取。反演中使用的 SAR 数据、马赫波搜索中使用的台站列表、SEBP 结果和 FFI 滑移模型可在以下网址获取：<a href="https://doi.org/10.5281/zenodo.8402190%E3%80%82">https://doi.org/10.5281/zenodo.8402190。</a></p><h3 id="Immature-characteristics-of-the-East-Anatolian-Fault-Zone-from-SAR-GNSS-and-strong-motion-data-of-the-2023-Turkiye–Syria-earthquake-doublet"><a href="#Immature-characteristics-of-the-East-Anatolian-Fault-Zone-from-SAR-GNSS-and-strong-motion-data-of-the-2023-Turkiye–Syria-earthquake-doublet" class="headerlink" title="Immature characteristics of the East Anatolian Fault Zone from SAR, GNSS and strong motion data of the 2023 Türkiye–Syria earthquake doublet"></a>Immature characteristics of the East Anatolian Fault Zone from SAR, GNSS and strong motion data of the 2023 Türkiye–Syria earthquake doublet</h3><p>原文链接：<a href="https://www.nature.com/articles/s41598-024-61326-6">https://www.nature.com/articles/s41598-024-61326-6</a></p><p>2023 年土耳其-叙利亚双重地震的震源和地表破裂轨迹由美国地质调查局提供 (<a href="https://earthquake.usgs.gov).强震数据从土耳其地震、灾害和应急管理局/">https://earthquake.usgs.gov)。强震数据从土耳其地震、灾害和应急管理局</a> (AFAD) 下载 (<a href="https://deprem.afad.gov.tr/)%E3%80%82%E6%89%80%E6%9C%89%E7%BD%91%E7%AB%99%E7%9A%84%E6%9C%80%E5%90%8E%E4%B8%80%E6%AC%A1%E8%AE%BF%E9%97%AE%E6%97%A5%E6%9C%9F%E4%B8%BA">https://deprem.afad.gov.tr/)。所有网站的最后一次访问日期为</a> 2023 年 8 月 15 日。</p><h3 id="Coseismic-Faulting-Model-and-Post-Seismic-Surface-Motion-of-the-2023-Turkey–Syria-Earthquake-Doublet-Revealed-by-InSAR-and-GPS-Measurements"><a href="#Coseismic-Faulting-Model-and-Post-Seismic-Surface-Motion-of-the-2023-Turkey–Syria-Earthquake-Doublet-Revealed-by-InSAR-and-GPS-Measurements" class="headerlink" title="Coseismic Faulting Model and Post-Seismic Surface Motion of the 2023 Turkey–Syria Earthquake Doublet Revealed by InSAR and GPS Measurements"></a>Coseismic Faulting Model and Post-Seismic Surface Motion of the 2023 Turkey–Syria Earthquake Doublet Revealed by InSAR and GPS Measurements</h3><p>原文链接：<a href="https://www.mdpi.com/2072-4292/15/13/3327">https://www.mdpi.com/2072-4292/15/13/3327</a></p><p>GPS数据是从内华达测地实验室收集的：<a href="http://geodesy.unr.edu/">http://geodesy.unr.edu/</a>  ，<a href="http://geodesy.unr.edu/#:~:text=%5BFebruary%2013%2C%202023%5D%20Turkey%20M%207.8%20and%20M%207.5%20Earthquakes">Turkey Mw 7.8 and Mw 7.5 Earthquakes</a>   包含初步同震偏移测量的文件可用于<a href="http://geodesy.unr.edu/news_items/20230213/us6000jllz_final5min.txt">M7.8 (us6000jllz)</a>和<a href="http://geodesy.unr.edu/news_items/20230213/us6000jlqa_final5min.txt">M7.5 (us6000jlqa)</a>。</p><p>SRTM DEM 数据是空隙填充的无缝 SRTM 数据 V4，可从 CGIAR-CSI SRTM 30 数据库获取：<a href="http://srtm.csi.cgiar.org/%EF%BC%8C%E4%BA%8E">http://srtm.csi.cgiar.org/，于</a> 2023 年 4 月 10 日访问。GACOS 数据可在此处免费获取： <a href="http://www.gacos.net,于/">www.gacos.net，于</a> 2023 年 3 月 20 日访问。GPS 数据是从内华达大地测量实验室收集的（<a href="http://geodesy.unr.edu/%EF%BC%8C%E4%BA%8E">http://geodesy.unr.edu/，于</a> 2023 年 3 月 6 日访问）。</p><h3 id="Source-Model-of-the-2023-Turkey-Earthquake-Sequence-Imaged-by-Sentinel-1-and-GPS-Measurements-Implications-for-Heterogeneous-Fault-Behavior-along-the-East-Anatolian-Fault-Zone"><a href="#Source-Model-of-the-2023-Turkey-Earthquake-Sequence-Imaged-by-Sentinel-1-and-GPS-Measurements-Implications-for-Heterogeneous-Fault-Behavior-along-the-East-Anatolian-Fault-Zone" class="headerlink" title="Source Model of the 2023 Turkey Earthquake Sequence Imaged by Sentinel-1 and GPS Measurements: Implications for Heterogeneous Fault Behavior along the East Anatolian Fault Zone"></a>Source Model of the 2023 Turkey Earthquake Sequence Imaged by Sentinel-1 and GPS Measurements: Implications for Heterogeneous Fault Behavior along the East Anatolian Fault Zone</h3><p>原文链接：<a href="https://www.mdpi.com/2072-4292/15/10/2618">https://www.mdpi.com/2072-4292/15/10/2618</a></p><p>高速率 (1 Hz) GPS 数据是从 TUSAGA-Aktif（<a href="https://www.tusaga-aktif.gov.tr/%EF%BC%8C%E4%BA%8E">https://www.tusaga-aktif.gov.tr/，于</a> 2023 年 2 月 25 日访问）收集的。基于震后卫星数据分析的土耳其地震序列的初步地表破裂来自 USGS（<a href="https://usgs.maps.arcgis.com/apps/webappviewer/index.html?id=5229bb842bd64b688d769abbefe43b46%EF%BC%8C%E4%BA%8E">https://usgs.maps.arcgis.com/apps/webappviewer/index.html?id=5229bb842bd64b688d769abbefe43b46，于</a> 20 日访问） 2023 年 3 月）。 2023 年土耳其地震序列的重新定位余震由 Zenodo 存档（<a href="https://zenodo.org/record/76">https://zenodo.org/record/76</a> 99882#.ZEKnT3ZBy3A，于 2023 年 3 月 10 日访问）。</p><h3 id="Coseismic-Slip-Distribution-and-Coulomb-Stress-Change-of-the-2023-MW-7-8-Pazarcik-and-MW-7-5-Elbistan-Earthquakes-in-Turkey"><a href="#Coseismic-Slip-Distribution-and-Coulomb-Stress-Change-of-the-2023-MW-7-8-Pazarcik-and-MW-7-5-Elbistan-Earthquakes-in-Turkey" class="headerlink" title="Coseismic Slip Distribution and Coulomb Stress Change of the 2023 MW 7.8 Pazarcik and MW 7.5 Elbistan Earthquakes in Turkey"></a>Coseismic Slip Distribution and Coulomb Stress Change of the 2023 MW 7.8 Pazarcik and MW 7.5 Elbistan Earthquakes in Turkey</h3><p>原文链接：<a href="https://www.mdpi.com/2072-4292/16/2/240">https://www.mdpi.com/2072-4292/16/2/240</a></p><p> GPS 数据收集自内华达大地测量实验室（<a href="http://geodesy.unr.edu/%EF%BC%8C%E8%AE%BF%E9%97%AE%E6%97%A5%E6%9C%9F%EF%BC%9A2023">http://geodesy.unr.edu/，访问日期：2023</a> 年 3 月 6 日）。基于对震后卫星数据分析的土耳其地震序列的初步地表破裂数据来自 USGS（<a href="https://usgs.maps.arcgis.com/apps/webappviewer/%EF%BC%8C%E4%BA%8E">https://usgs.maps.arcgis.com/apps/webappviewer/，于</a> 2023 年 6 月 16 日访问）。 2023 年土耳其地震序列的重新定位余震由 Zenodo 存档（<a href="https://zenodo.org/record/7699882#.ZEKnT3ZBy3A%EF%BC%8C%E4%BA%8E">https://zenodo.org/record/7699882#.ZEKnT3ZBy3A，于</a> 2023 年 8 月 10 日访问）。 SRTM DEM 数据取自美国国家航空航天局 (NASA) 提供的 30 m 分辨率航天飞机雷达地形任务 (SRTM) 数字高程模型 (DEM) (<a href="https://www.earthdata.nasa.gov/esds/%E7%AB%9E%E4%BA%89%E6%80%A7%E8%AE%A1%E5%88%92/%E6%8E%AA%E6%96%BD/nasadem%EF%BC%8C%E4%BA%8E">https://www.earthdata.nasa.gov/esds/竞争性计划/措施/nasadem，于</a> 2023 年 4 月 12 日访问）。</p><p>震区有23个GPS站。 GPS 数据从内华达大地测量实验室获得（网站：<a href="http://geodesy.unr.edu/%EF%BC%8C%E4%BA%8E">http://geodesy.unr.edu/，于</a> 2023 年 3 月 6 日访问）。数据采样率为5分钟[ <a href="https://www.mdpi.com/2072-4292/16/2/240#B29-remotesensing-16-00240">29</a> ]。该数据集包括每个 GPS 站坐标与其每日平均坐标的偏差的时间序列。根据美国地质调查局(UGUS)公布的土耳其两次地震的地震发生时间，计算了土耳其两次地震引起的三维地表位移。</p><p>Space Geodetic Insights to the Dramatic Stress Rotation Induced by the February 2023 Turkey-Syria Earthquake Doublet</p><p>原文链接：<a href="https://onlinelibrary.wiley.com/doi/abs/10.1029/2023GL107788">https://onlinelibrary.wiley.com/doi/abs/10.1029/2023GL107788</a></p><p>焦点机制数据可以从 <a href="https://deprem.afad.gov.tr/event-focal-mechanism">https://deprem.afad.gov.tr/event-focal-mechanism</a> 免费下载。简单断层迹线和破裂迹线可以从Reitman等人那里得到。 （2023）。大多数图形是由 Generic Mapping Tools 6.4.0 软件绘制的（<a href="https://www.generic-mapping-tools.org/download/%EF%BC%9BWessel">https://www.generic-mapping-tools.org/download/；Wessel</a> 等人，2019）。 SMVCE软件可以从<a href="https://gip.csu.edu.cn/radar/gongkaicontent.jsp?urltype=news.NewsContentUrl&wbtreeid=1137&wbnewsid=3072%E4%B8%8B%E8%BD%BD%EF%BC%8C%E8%A7%A3%E5%8E%8B%E7%A0%81%E5%B0%86%E5%8F%91%E9%80%81%E5%88%B0%E5%A1%AB%E5%86%99%E7%9A%84%E9%82%AE%E7%AE%B1%E5%9C%B0%E5%9D%80%E3%80%82%E6%9C%AC%E6%96%87%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%9A%84%E7%94%A8%E4%BA%8E">https://gip.csu.edu.cn/radar/gongkaicontent.jsp?urltype=news.NewsContentUrl&amp;wbtreeid=1137&amp;wbnewsid=3072下载，解压码将发送到填写的邮箱地址。本文中使用的用于</a> Sentinel-1 干涉处理的 CtSent 工具箱可以从 Zenodo (Ma, 2021) 下载。解包操作的代码可以从 Zenodo (Ma, 2024) 下载。我们的 3D 位移图和滑移分布可以从 Zenodo 下载（Ma et al., 2023）。</p><h3 id="Rapid-Surface-Rupture-Mapping-from-Satellite-Data-The-2023-Kahramanmaras-Turkey-Turkiye-Earthquake-Sequence"><a href="#Rapid-Surface-Rupture-Mapping-from-Satellite-Data-The-2023-Kahramanmaras-Turkey-Turkiye-Earthquake-Sequence" class="headerlink" title="Rapid Surface Rupture Mapping from Satellite Data: The 2023 Kahramanmaraş, Turkey (Türkiye), Earthquake Sequence"></a>Rapid Surface Rupture Mapping from Satellite Data: The 2023 Kahramanmaraş, Turkey (Türkiye), Earthquake Sequence</h3><p>原文链接：<a href="https://pubs.geoscienceworld.org/ssa/tsr/article/3/4/289/628908/Rapid-Surface-Rupture-Mapping-from-Satellite-Data">https://pubs.geoscienceworld.org/ssa/tsr/article/3/4/289/628908/Rapid-Surface-Rupture-Mapping-from-Satellite-Data</a></p><p>测绘数据可作为美国地质调查局 (USGS) 数据发布 (doi: <a href="https://doi.org/10.5066/P985I7U2">10.5066&#x2F;P985I7U2</a> )。雷达像素相关数据可作为 USGS 数据发布 (doi: <a href="https://doi.org/10.5066/P9R6DSVZ">10.5066&#x2F;P9R6DSVZ</a> )。 USGS 活动页面Mw 7.8 和Mw 7.5 级地震可分别访问<a href="https://earthquake.usgs.gov/earthquakes/eventpage/us6000jllz/executive%E5%92%8Chttps://earthquake.usgs.gov/earthquakes/eventpage/us6000jlqa/executive%E3%80%82">https://earthquake.usgs.gov/earthquakes/eventpage/us6000jllz/executive和https://earthquake.usgs.gov/earthquakes/eventpage/us6000jlqa/executive。</a> WorldView 图像可从 USGS 危险数据分发系统<a href="https://hddsexplorer.usgs.gov/">https://hddsexplorer.usgs.gov</a>获取，并通过 Maxar 的 USG+ 许可证进行访问。 Sentinel 场景可从 Copernicus 开放访问中心获取，网址为<a href="https://scihub.copernicus.eu/%E3%80%82%E5%85%88%E8%BF%9B%E9%99%86%E5%9C%B0%E8%A7%82%E6%B5%8B%E5%8D%AB%E6%98%9F">https://scihub.copernicus.eu/。先进陆地观测卫星</a> (ALOS) 场景可从阿拉斯加卫星设施获取：<a href="https://asf.alaska.edu/data-sets/sar-data-sets/alos-palsar/%E3%80%82%E6%89%80%E6%9C%89%E7%BD%91%E7%AB%99%E7%9A%84%E6%9C%80%E5%90%8E%E4%B8%80%E6%AC%A1%E8%AE%BF%E9%97%AE%E6%97%B6%E9%97%B4%E4%B8%BA">https://asf.alaska.edu/data-sets/sar-data-sets/alos-palsar/。所有网站的最后一次访问时间为</a> 2023 年 8 月。</p><h3 id="The-GEM-Global-Active-Faults-Database"><a href="#The-GEM-Global-Active-Faults-Database" class="headerlink" title="The GEM Global Active Faults Database"></a>The GEM Global Active Faults Database</h3><p>原文链接：<a href="https://journals.sagepub.com/doi/full/10.1177/8755293020944182">https://journals.sagepub.com/doi/full/10.1177/8755293020944182</a></p><hr><h2 id="可使用的数据"><a href="#可使用的数据" class="headerlink" title="可使用的数据"></a>可使用的数据</h2><p>地震数据由IRIS（<a href="https://ds.iris.edu/wilber3/%EF%BC%89%EF%BC%9A%E9%9C%87%E7%BA%A7%E5%92%8C%E6%B7%B1%E5%BA%A6%E4%BF%A1%E6%81%AF">https://ds.iris.edu/wilber3/）：震级和深度信息</a></p><p>当地地震目录 AFAD ：利用PGA、PGV数据</p><p><a href="https://tadas.afad.gov.tr/event-detail/17966">AFAD_Kahramanmaraş_Mw7.7_PGA_data</a></p><p><a href="https://tadas.afad.gov.tr/event-detail/17969">AFAD_Elbistan (Kahramanmaraş)_Mw7.6_PGA_data</a></p><p>在地震学中，rjb、rrup、repi 和 rhyp 是指地震事件中的不同距离参数，用于描述地震的影响范围和强度。它们的含义如下：</p><ol><li>**Rjb (Joyner-Boore距离)**：Rjb是指从地震震源到地表上一个位置的水平距离，通常以水平地面的最短路径来计算。Rjb通常用于描述地震动的地表效应，是建筑物受到地震影响的重要参数。</li><li>**Rrup (Radiated距离)**：Rrup是指从地震震源到一个位置的最短三维路径距离，考虑了地震波的传播路径和地球的地形。Rrup是用于描述地震强度的一个重要参数，通常用于地震烈度的计算。</li><li>**Repi (Epicentral距离)**：Repi是指从地震震源到地表上的一个位置的水平距离，沿着地表的最短路径计算。Repi通常用于描述地震震中附近地区的地震影响，是一个重要的地震参数。</li><li>**Rhyp (Hypocentral距离)**：Rhyp是指从地震震源到地球内部某一点的直线距离，即震源到该点的最短路径。Rhyp通常用于描述地震发生的深度，以及地震波在地球内部传播的距离。</li></ol><p>高速率 GNSS 数据由 TUSAGA-Aktif：<a href="https://www.tusaga-aktif.gov.tr/Web/DepremVerileri.aspx">地震区TUSAGA-Active固定GNSS站1秒数据</a></p><p>GNSS处理后的数据：<a href="https://doi.org/10.5281/zenodo.8271589">https://doi.org/10.5281/zenodo.8271589</a></p><p>处理方法见论文：<a href="https://www.nature.com/articles/s41561-023-01283-3">Geometric controls on cascading rupture of the 2023 Kahramanmaraş earthquake doublet</a></p><p>USGS地震震源信息：<a href="https://earthquake.usgs.gov/earthquakes/map/?extent=36.03133,34.21143&extent=38.8782,40.89111&range=search&timeZone=utc&search=%7B%22name%22:%22Search%20Results%22,%22params%22:%7B%22starttime%22:%222023-02-04%2000:00:00%22,%22endtime%22:%222023-02-07%2023:59:59%22,%22minmagnitude%22:7,%22orderby%22:%22time%22%7D%7D">震源信息-CSV-KML</a></p><p>全球断层数据：<a href="https://github.com/GEMScienceTools/gem-global-active-faults">https://github.com/GEMScienceTools/gem-global-active-faults</a></p><p>地震USGS测绘信息：USGS 活动页面Mw 7.8 和Mw 7.5 级地震可分别访问<a href="https://earthquake.usgs.gov/earthquakes/eventpage/us6000jllz/executive%E5%92%8Chttps://earthquake.usgs.gov/earthquakes/eventpage/us6000jlqa/executive%E3%80%82">https://earthquake.usgs.gov/earthquakes/eventpage/us6000jllz/executive和https://earthquake.usgs.gov/earthquakes/eventpage/us6000jlqa/executive。</a></p><p>内华达大地测量实验室收集的GPS数据：<a href="http://geodesy.unr.edu/">http://geodesy.unr.edu/</a>  ，</p><p><a href="http://geodesy.unr.edu/#:~:text=%5BFebruary%2013%2C%202023%5D%20Turkey%20M%207.8%20and%20M%207.5%20Earthquakes">Turkey M 7.8 and M 7.5 Earthquakes</a>   包含初步同震偏移测量的文件可用于<a href="http://geodesy.unr.edu/news_items/20230213/us6000jllz_final5min.txt">M7.8 (us6000jllz)</a>和<a href="http://geodesy.unr.edu/news_items/20230213/us6000jlqa_final5min.txt">M7.5 (us6000jlqa)</a>。</p><p> 数据采样率为5分钟。该数据集包括每个 GPS 站坐标与其每日平均坐标的偏差的时间序列。根据美国地质调查局(UGUS)公布的土耳其两次地震的地震发生时间，计算了<strong>土耳其两次地震引起的三维地表位移</strong>。</p><h2 id="其它论文"><a href="#其它论文" class="headerlink" title="其它论文"></a>其它论文</h2><h3 id="会议论文"><a href="#会议论文" class="headerlink" title="会议论文"></a>会议论文</h3><p><a href="https://gfzpublic.gfz-potsdam.de/pubman/faces/ViewItemFullPage.jsp?itemId=item_5021830">A 3D co-seismic ground deformation reconstruction of the February 2023 Southeast Anatolian earthquake sequence using satellite SAR and optical data</a></p><p><a href="https://www.spiedigitallibrary.org/conference-proceedings-of-spie/12786/127861C/Impact-assessment-of-the-catastrophic-earthquakes-of-6-February-2023/10.1117/12.2682926.full">Impact assessment of the catastrophic earthquakes of 6 February 2023 in Turkey and Syria via the exploitation of satellite datasets</a></p><p><a href="https://gfzpublic.gfz-potsdam.de/pubman/faces/ViewItemFullPage.jsp?itemId=item_5021830_2">A 3D co-seismic ground deformation reconstruction of the February 2023 Southeast Anatolian earthquake sequence using satellite SAR and optical data</a></p><h3 id="期刊文章"><a href="#期刊文章" class="headerlink" title="期刊文章"></a>期刊文章</h3><p><a href="https://www.lyellcollection.org/doi/abs/10.1144/jgs2023-021">Journal of the Geological Society - Long silence on the East Anatolian Fault Zone (Southern Turkey) ends with devastating double earthquakes (6 February 2023) over a seismic gap: implications for the seismic potential in the Eastern Mediterranean region</a></p><p><a href="http://arxiv.org/abs/2308.02144">arxiv - Rapid 3D dynamic rupture modeling of the February 6, 2023, Kahramanmaras, Turkey, Mw7.8 and Mw7.7 earthquake doublet</a></p><p><a href="https://par.nsf.gov/biblio/10417588-slip-distribution-february-mw-mw-kahramanmaras-turkey-earthquake-sequence-east-anatolian-fault-zone">Seismica - Slip distribution of the February 6, 2023 Mw 7.8 and Mw 7.6, Kahramanmaraş, Turkey earthquake sequence in the East Anatolian Fault Zone</a></p><p><a href="https://onlinelibrary.wiley.com/doi/abs/10.1029/2023GL104693">Geophysical Research Letters - Coseismic Kinematics of the 2023 Kahramanmaras, Turkey Earthquake Sequence From InSAR and Optical Data</a></p><p><a href="http://proceedings.bas.bg/index.php/cr/article/view/293">Proceedings of the Bulgarian Academy of Sciences - Determining the Deformations of the Earth’s Surface after the Earthquakes in Turkey-Syria of 06 February 2023 - Initial Results</a></p><p><a href="https://www.mdpi.com/1424-8220/23/14/6342">Sensors - Evaluating Urban Building Damage of 2023 Kahramanmaras, Turkey Earthquake Sequence Using SAR Change Detection</a></p><p><a href="https://www.mdpi.com/2072-4292/15/10/2656">Remote Sensing - Three-Dimensional Deformation of the 2023 Turkey Mw 7.8 and Mw 7.7 Earthquake Sequence Obtained by Fusing Optical and SAR Images</a></p><p><a href="https://doi.org/10.1785/0220230146">Seismological Research Letters - The 2023 Mw 7.8 and 7.6 Earthquake Doublet in Southeast Türkiye: Coseismic and Early Postseismic Deformation, Faulting Model, and Potential Seismic Hazard</a></p><p><a href="https://www.science.org/doi/10.1126/science.adi0685">Science - The complex dynamics of the 2023 Kahramanmaraş, Turkey, Mw 7.8-7.7 earthquake doublet</a></p><p><a href="https://www.science.org/doi/abs/10.1126/science.adi1519">Science - Supershear triggering and cascading fault ruptures of the 2023 Kahramanmaraş, Türkiye, earthquake doublet</a></p><p><a href="https://www.science.org/doi/10.1126/science.adj3770">Science - Surface deformations of the 6 February 2023 earthquake sequence, eastern Türkiye</a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>websites</tag>
      
      <tag>文献分享</tag>
      
      <tag>InSAR</tag>
      
      <tag>数据分享</tag>
      
      <tag>toolkit</tag>
      
      <tag>地震</tag>
      
      <tag>土耳其双震</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>文献推荐-无测站流域特大洪水的全球预测</title>
    <link href="/2024/05/10/%E6%96%87%E7%8C%AE%E6%8E%A8%E8%8D%90-%E6%97%A0%E6%B5%8B%E7%AB%99%E6%B5%81%E5%9F%9F%E7%89%B9%E5%A4%A7%E6%B4%AA%E6%B0%B4%E7%9A%84%E5%85%A8%E7%90%83%E9%A2%84%E6%B5%8B/"/>
    <url>/2024/05/10/%E6%96%87%E7%8C%AE%E6%8E%A8%E8%8D%90-%E6%97%A0%E6%B5%8B%E7%AB%99%E6%B5%81%E5%9F%9F%E7%89%B9%E5%A4%A7%E6%B4%AA%E6%B0%B4%E7%9A%84%E5%85%A8%E7%90%83%E9%A2%84%E6%B5%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="【文献推荐1】无测站流域特大洪水的全球预测"><a href="#【文献推荐1】无测站流域特大洪水的全球预测" class="headerlink" title="【文献推荐1】无测站流域特大洪水的全球预测"></a>【文献推荐1】无测站流域特大洪水的全球预测</h1><p>题目：Global prediction of extreme floods in ungauged watersheds<br>期刊：Nature</p><p>文章原文：<a href="https://www.nature.com/articles/s41586-024-07145-1">https://www.nature.com/articles/s41586-024-07145-1</a></p><p>研究者使用基于LSTM网络的AI模型预测河道流量。研究者基于LSTM网络开发了一种新的预测模型，分为编码器和解码器两部分，编码器用于读取一系列的历史气象信息，</p><h2 id="1-摘要"><a href="#1-摘要" class="headerlink" title="1 摘要"></a>1 摘要</h2><p>洪水是最常见的自然灾害之一，对发展中国家的影响尤为严重，因为这些国家通常缺乏密集的水流测量网络。准确及时的预警对于降低洪水风险至关重要，但水文模拟模型通常必须根据每个流域的长期数据记录进行校准。在这里，我们展示了<strong>基于人工智能的预报在预测无测站流域的极端河流事件方面所达到的可靠性</strong>，其最长预报时间为五天，与目前最先进的全球建模系统（哥白尼应急管理服务全球洪水预警系统）的现时预报（零天预报时间）的可靠性相近或更好。此外，我们对五年重现期事件的预测精度与目前对一年重现期事件的预测精度相近或更高。这意味着人工智能可以在无测站流域更早、更大、影响更大的事件中提供洪水预警。在此开发的模型已被纳入一个实用的预警系统，该系统可在 80 多个国家实时生成公开（免费和开放）的预报。这项工作凸显了提高水文数据可用性的必要性，以继续改善全球对可靠洪水预警的获取。</p><h2 id="2-数据与方法"><a href="#2-数据与方法" class="headerlink" title="2 数据与方法"></a>2 数据与方法</h2><h3 id="2-1-AI模型：基于-LSTM-的预测模型的架构"><a href="#2-1-AI模型：基于-LSTM-的预测模型的架构" class="headerlink" title="2.1 AI模型：基于 LSTM 的预测模型的架构"></a>2.1 AI模型：基于 LSTM 的预测模型的架构</h3><p>参照基于 LSTM 网络开发的水文临近预报模型（该模型根据气象输入数据序列模拟水流数据序列）。在此基础上开发了一种预测模型，该模型使用<strong>编码器-解码器模型</strong>，其中一个 LSTM 运行在气象（和地球物理）输入数据的历史序列（编码器 LSTM）上，另一个独立的 LSTM 运行在 7 天的数据上。预测范围与气象预报的输入（解码器 LSTM）。模型架构如图4所示。</p><p><img src="/41586_2024_7145_Fig10_ESM.webp" alt="alt text"></p><p>研究者利用该AI模型预测河道流量，并与GloFAS进行对比。</p><h3 id="2-3-AI模型输入数据"><a href="#2-3-AI模型输入数据" class="headerlink" title="2.3 AI模型输入数据"></a>2.3 AI模型输入数据</h3><p>完整数据集包括来自 5,680 个流域的总共 152,259 年的模型输入和（水流）目标。</p><ul><li><p>来自 ECMWF 综合预报系统 (IFS) 高分辨率 (HRES) 大气模型的每日汇总单级预报。变量包括：总降水量 (TP)、2 米温度 (T2M)、地表净太阳辐射 (SSR)、地表净热辐射 (STR)、降雪量 (SF) 和地表压力 (SP)。</p></li><li><p>ECMWF ERA5-Land 再分析中的六个变量相同。</p></li><li><p>降水量估算来自美国国家海洋和大气管理局 (NOAA) 气候预测中心 (CPC) 全球统一的每日降水量分析。</p></li><li><p>NASA 综合多卫星检索 GPM (IMERG) 早期运行的降水量估算。</p></li><li><p>来自 HydroATLAS 数据库的地质、地球物理和人为盆地属性。</p></li></ul><p>使用来自另一个数据源的类似变量（例如，使用 ERA5-Land 数据估算 HRES 数据）或通过使用平均值估算缺失数据。</p><p>训练和测试目标来自全球径流数据中心（GRDC）<br>训练和测试所有可用流量计位置。</p><p><img src="/41586_2024_7145_Fig12_ESM.webp" alt="alt text"></p><h3 id="2-4-实验"><a href="#2-4-实验" class="headerlink" title="2.4 实验"></a>2.4 实验</h3><h3 id="2-4-评估与验证"><a href="#2-4-评估与验证" class="headerlink" title="2.4 评估与验证"></a>2.4 评估与验证</h3><h3 id="2-5-GlsFAS"><a href="#2-5-GlsFAS" class="headerlink" title="2.5 GlsFAS"></a>2.5 GlsFAS</h3><h2 id="其它"><a href="#其它" class="headerlink" title="*** 其它 ***"></a>*** 其它 ***</h2><h3 id="k倍交叉验证"><a href="#k倍交叉验证" class="headerlink" title="k倍交叉验证"></a>k倍交叉验证</h3><p>对于空间数据的 k 倍交叉验证，我们希望在评估模型时考虑到数据点之间的空间相关性。具体步骤如下：</p><ul><li>空间分割：首先，将空间范围划分为 k 个互不重叠的区域或子集，确保每个子集中包含一定数量的空间数据点。这些子集可以是等大小的空间区域，也可以是根据某种空间划分准则来生成的，以保证每个子集中的数据点之间具有空间相关性。</li><li>交叉验证：然后，进行 k 次迭代。在每次迭代中，将其中一个子集作为测试集，其余的 k-1 个子集作为训练集。这样就得到了 k 个训练集和 k 个测试集。</li><li>模型拟合和评估：在每次迭代中，使用训练集训练模型，然后在对应的测试集上进行模型评估。可以使用各种评估指标（如准确率、均方误差等）来评估模型的性能。</li><li>性能汇总：将 k 次迭代中的模型性能评估指标（如平均准确率、平均均方误差等）进行汇总，得到最终的评估结果。</li></ul>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>文献分享</tag>
      
      <tag>洪水</tag>
      
      <tag>机器学习</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>机器学习中的评价指标</title>
    <link href="/2024/05/09/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E4%B8%AD%E7%9A%84%E8%AF%84%E4%BB%B7%E6%8C%87%E6%A0%87/"/>
    <url>/2024/05/09/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E4%B8%AD%E7%9A%84%E8%AF%84%E4%BB%B7%E6%8C%87%E6%A0%87/</url>
    
    <content type="html"><![CDATA[<h1 id="混淆矩阵"><a href="#混淆矩阵" class="headerlink" title="混淆矩阵"></a>混淆矩阵</h1><p>混淆矩阵特别用于监督学习。混淆矩阵的每一行的总数代表了预测该类别的个数，每一列的总数表示为该类别的实际数据的数目。</p><p>TP、FP、FN、TN可以理解为：</p><p>TP：预测为1，实际为1，预测正确。</p><p>FP：预测为1，实际为0，预测错误。</p><p>FN：预测为0，实际为1，预测错误。</p><p>TN：预测为0，实际为0，预测正确。</p><h1 id="准确率、精确率、召回率、F1值"><a href="#准确率、精确率、召回率、F1值" class="headerlink" title="准确率、精确率、召回率、F1值"></a>准确率、精确率、召回率、F1值</h1><ul><li>准确率（Accuracy）：预测正确的结果占总样本的百分比。</li></ul><p>$$<br>\frac{TP + TN }{TP + FP + FN + TN}<br>$$</p><ul><li>精确率（Precision）：在被所有预测为正的样本中实际为正样本的概率。，意思就是在预测为正样本的结果中，我们有多少把握可以预测正确。</li></ul><p>$$<br>\frac{TP}{TP + FP}<br>$$</p><ul><li>召回率（Recall）：在实际为正的样本中被预测为正样本的概率。</li></ul><p>$$<br>\frac{TP}{TP + FN}<br>$$</p><p><em>精确率和召回率又被叫做查准率和查全率。</em></p><ul><li>F1分数</li></ul><p>精确率和召回率无法做到双高。因此，选择合适的阈值点，就需要根据实际问题需求，比如我们想要很高的精确率，就要牺牲掉一些召回率。想要得到很高的召回率，就要牺牲掉一些精准率。但通常情况下，我们可以根据他们之间的平衡点，定义一个新的指标：F1分数(F1-Score)。F1分数同时考虑精确率和召回率，让两者同时达到最高，取得平衡。</p><p>$$<br>F1分数 &#x3D; \frac{2<em>精确率</em>召回率}{精确率+召回率}<br>$$</p><p>F1分数的取值范围是0到1之间，值越接近1表示模型的性能越好。当Precision和Recall都很高时，F1分数也会很高。</p><h1 id="灵敏度，特异度，真正率，假正率"><a href="#灵敏度，特异度，真正率，假正率" class="headerlink" title="灵敏度，特异度，真正率，假正率"></a>灵敏度，特异度，真正率，假正率</h1><ul><li>灵敏度（Sensitivity）：灵敏度和召回率是一模一样的，只是名字换了而已。</li></ul><p> $$<br> \frac{TP}{TP + FN}<br> $$</p><ul><li>特异度（Specificity）:</li></ul><p>$$<br>\frac{TN}{FP + TN}<br>$$</p><ul><li><p>真正率（TPR）：在实际为正的样本中被预测为正样本的概率。</p><p>$$<br>&#x3D; 灵敏度 &#x3D; TP&#x2F;(TP+FN)<br>$$</p></li><li><p>假正率（FPR）：在实际为负的样本中被预测为正样本的概率。</p><p>$$<br>&#x3D; 1- 特异度 &#x3D; FP&#x2F;(FP+TN)<br>$$</p></li></ul><h1 id="ROC曲线"><a href="#ROC曲线" class="headerlink" title="ROC曲线"></a>ROC曲线</h1><p>ROC（Receiver Operating Characteristic）曲线，又称接受者操作特征曲线。ROC曲线中的主要两个指标就是真正率和假正率， 上面也解释了这么选择的好处所在。其中横坐标为假正率（FPR），纵坐标为真正率（TPR），下面就是一个标准的ROC曲线图。</p><p>FPR表示模型虚报的响应程度，而TPR表示模型预测响应的覆盖程度。TPR越高，同时FPR越低（即ROC曲线越陡），那么模型的性能就越好。</p><h1 id="AUC"><a href="#AUC" class="headerlink" title="AUC"></a>AUC</h1><p>曲线下面积（Area Under Curve）。AUC的一般判断标准</p><p>0.5 - 0.7： 效果较低，但用于预测股票已经很不错了</p><p>0.7 - 0.85： 效果一般</p><p>0.85 - 0.95： 效果很好</p><p>0.95 - 1： 效果非常好，但一般不太可能</p><h1 id="参考博客771941112158236672-utm-source-wechat-session"><a href="#参考博客771941112158236672-utm-source-wechat-session" class="headerlink" title="参考博客771941112158236672&amp;utm_source&#x3D;wechat_session)"></a>参考博客771941112158236672&amp;utm_source&#x3D;wechat_session)</h1><p><a href="https://zhuanlan.zhihu.com/p/549835162?utm_campaign=shareopn&utm_medium=social&utm_psn=1771941112158236672&utm_source=wechat_session">知乎-准确率、精确率、召回率、F1值</a></p><p><a href="https://easyaitech.medium.com/%E4%B8%80%E6%96%87%E7%9C%8B%E6%87%82%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E6%8C%87%E6%A0%87-%E5%87%86%E7%A1%AE%E7%8E%87-%E7%B2%BE%E5%87%86%E7%8E%87-%E5%8F%AC%E5%9B%9E%E7%8E%87-f1-roc%E6%9B%B2%E7%BA%BF-auc%E6%9B%B2%E7%BA%BF-19b1ed9e9260">Medium-一文看懂机器学习指标：准确率、精准率、召回率、F1、ROC曲线、AUC曲线</a></p><p><a href="https://www.6aiq.com/article/1549986548173">AIQ-一文让你彻底理解准确率，精准率，召回率，真正率，假正率，ROC&#x2F;AUC</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>机器学习</tag>
      
      <tag>[object Object]</tag>
      
      <tag>学习</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>机器学习中的监督学习与非监督学习</title>
    <link href="/2024/05/09/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E4%B8%AD%E7%9A%84%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0%E4%B8%8E%E9%9D%9E%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0/"/>
    <url>/2024/05/09/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E4%B8%AD%E7%9A%84%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0%E4%B8%8E%E9%9D%9E%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<h1 id="1-监督学习与非监督学习"><a href="#1-监督学习与非监督学习" class="headerlink" title="1. 监督学习与非监督学习"></a>1. 监督学习与非监督学习</h1><h2 id="1-1-监督学习（Supervised-Learning）"><a href="#1-1-监督学习（Supervised-Learning）" class="headerlink" title="1.1. 监督学习（Supervised Learning）"></a>1.1. 监督学习（Supervised Learning）</h2><p><strong>在监督学习中，模型通过学习输入数据与其对应的标签之间的关系来进行训练</strong>。这意味着给定一组输入数据和其对应的正确输出（标签），模型尝试学习如何将输入映射到输出。<br>监督学习的常见应用包括分类和回归问题。在分类任务中，模型试图将输入数据分为预定义的类别之一；在回归任务中，模型试图预测一个连续值。<br>例如，给定一组电子邮件和它们的分类（垃圾邮件或非垃圾邮件），监督学习算法可以学习如何自动将新的电子邮件分类为垃圾邮件或非垃圾邮件。</p><h2 id="1-2-非监督学习（Unsupervised-Learning）"><a href="#1-2-非监督学习（Unsupervised-Learning）" class="headerlink" title="1.2. 非监督学习（Unsupervised Learning）"></a>1.2. 非监督学习（Unsupervised Learning）</h2><p><strong>在非监督学习中，模型在没有标签的情况下从未标记的数据中学习结构和模式</strong>。<br>非监督学习的目标通常是发现数据中的隐藏结构或特征。这可以通过聚类或降维等技术来实现。<br>聚类是将数据集中的样本分成不同的组，使得每个组内的样本彼此相似，而不同组之间的样本则尽可能不同。降维则是将高维数据转换为低维表示，同时尽可能地保留原始数据的信息。<br>例如，给定一组包含未标记的图片，非监督学习算法可以将这些图片分成不同的群组，而无需事先知道图片的内容或主题。<br>总的来说，监督学习关注如何从带有标签的数据中学习，而非监督学习关注如何从无标签的数据中学习。这两种学习范式都在各自的场景中有着广泛的应用。</p><h1 id="2-监督分类与非监督分类"><a href="#2-监督分类与非监督分类" class="headerlink" title="2.监督分类与非监督分类"></a>2.监督分类与非监督分类</h1><h2 id="2-1-监督分类（Supervised-Classification）"><a href="#2-1-监督分类（Supervised-Classification）" class="headerlink" title="2.1 监督分类（Supervised Classification）"></a>2.1 监督分类（Supervised Classification）</h2><p>监督分类是一种监督学习任务，其中数据集中的每个样本都有一个明确的标签或类别。<br><strong>监督分类的目标是通过训练模型来预测新数据的类别标签，使得模型能够将输入数据正确地分类到预定义的类别中</strong>。<br>常见的监督分类算法包括支持向量机（SVM）、决策树、随机森林、逻辑回归等。</p><h2 id="2-2-非监督聚类（Unsupervised-Clustering）"><a href="#2-2-非监督聚类（Unsupervised-Clustering）" class="headerlink" title="2.2 非监督聚类（Unsupervised Clustering）"></a>2.2 非监督聚类（Unsupervised Clustering）</h2><p>非监督聚类是一种非监督学习任务，其中数据集中的样本没有明确的标签或类别。<br><strong>非监督聚类的目标是将数据集中的样本分成不同的组或簇，使得每个组内的样本彼此相似，而不同组之间的样本尽可能不同</strong>。<br>聚类算法试图找到数据中的内在结构，而不是根据预定义的类别进行分类。<br>常见的非监督聚类算法包括 K-means 聚类、层次聚类、DBSCAN（基于密度的聚类）、高斯混合模型等。<br>虽然监督分类和非监督聚类都涉及将数据划分为不同的类别或组，但它们的关键区别在于监督分类需要标签，而非监督聚类不需要。监督分类的目标是学习数据中的模式，以便根据这些模式对新数据进行分类，而非监督聚类的目标是在不知道数据内在结构的情况下对数据进行分组。</p><h1 id="参考博客"><a href="#参考博客" class="headerlink" title="参考博客"></a>参考博客</h1><p><a href="https://blog.csdn.net/chenKFKevin/article/details/70547549">监督学习和非监督学习的区别</a><br><a href="https://aws.amazon.com/cn/compare/the-difference-between-machine-learning-supervised-and-unsupervised/">有监督机器学习和无监督机器学习之间有什么区别？</a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>机器学习</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>【文献分享】-洪水研究相关文献整理一</title>
    <link href="/2024/05/07/%E6%B4%AA%E6%B0%B4%E7%A0%94%E7%A9%B6%E7%9B%B8%E5%85%B3%E6%96%87%E7%8C%AE%E6%95%B4%E7%90%86%E4%B8%80/"/>
    <url>/2024/05/07/%E6%B4%AA%E6%B0%B4%E7%A0%94%E7%A9%B6%E7%9B%B8%E5%85%B3%E6%96%87%E7%8C%AE%E6%95%B4%E7%90%86%E4%B8%80/</url>
    
    <content type="html"><![CDATA[<h1 id="1-基于全球地形和水文的洪水易发指数，用于地表水的降尺度、分析和数据融合"><a href="#1-基于全球地形和水文的洪水易发指数，用于地表水的降尺度、分析和数据融合" class="headerlink" title="1.基于全球地形和水文的洪水易发指数，用于地表水的降尺度、分析和数据融合"></a>1.基于全球地形和水文的洪水易发指数，用于地表水的降尺度、分析和数据融合</h1><p>题目：A global topography- and hydrography-based floodability index for the downscaling, analysis, and data-fusion of surface water<br>期刊：Journal of Hydrology</p><p>文章原文：<a href="https://www.sciencedirect.com/science/article/pii/S0022169423003487">https://www.sciencedirect.com/science/article/pii/S0022169423003487</a></p><h2 id="1-1-摘要"><a href="#1-1-摘要" class="headerlink" title="1.1 摘要"></a>1.1 摘要</h2><p>首先，采用神经网络方法，<strong>根据 MERIT 数据库提供的基于地形的信息构建了分辨率为 3 弧秒的新的全球可淹性指数</strong>。地形和永久水以一致的方式定义，确保了所得的可淹性指数和永久水之间的一致性，这在以前的版本中是前所未有的。可淹性指数的评估是利用地表水和土地覆盖的独立观测数据集进行的，在地表水受地形条件自然驱动的地区以及受人类影响的地区和一些特定环境（如泥炭地）的限制下显示出良好的性能。其次，介绍了可淹性指数可以服务的一些应用，包括<strong>低分辨率数据的降尺度</strong>、不同分辨率下数据集的分析和比较以及数据融合。</p><h2 id="1-2-背景"><a href="#1-2-背景" class="headerlink" title="1.2 背景"></a>1.2 背景</h2><p>迄今为止还无法通过卫星观测获得高分辨率洪水指数。这一问题有望通过即将于 2022 年发射的 SWOT 卫星得到解决。</p><p>洪水状态部分由地形条件驱动，例如坡度和海拔。洪水也取决于其它因素，如土地覆盖、人类灌溉活动等，但目前本研究只考虑地形因素，暂时忽略其它因素。本研究的可淹没性指数虽然基于地形信息，但在处理过程中仍然添加了一些地表水数据集，由多个HR水数据集的数据融合产生的HR永久水信息将被集成到可淹没性指数中。</p><p>本研究旨在实现两个目标：（1）改进可淹没性指数；（2）展示可淹没性指数的潜在应用。</p><h2 id="1-3-数据集"><a href="#1-3-数据集" class="headerlink" title="1.3 数据集"></a>1.3 数据集</h2><p>MERIT DEM：提供3弧秒空间分辨率（赤道约90m）的全球地形高程。使用该DEM的一大优点是它约观测到的永久水的一致性，HydroSHEDS DEM并不能保证这种一致性。</p><h1 id="2-极端温度诊断中的误区"><a href="#2-极端温度诊断中的误区" class="headerlink" title="2.极端温度诊断中的误区"></a>2.极端温度诊断中的误区</h1><p>题目：Pitfalls in diagnosing temperature extremes<br>期刊：Nature Communications</p><p>文章原文：<a href="https://www.nature.com/articles/s41467-024-46349-x">https://www.nature.com/articles/s41467-024-46349-x</a></p><h2 id="2-1-摘要"><a href="#2-1-摘要" class="headerlink" title="2.1 摘要"></a>2.1 摘要</h2><p>极端气温的恶化是人类引起的气候变化最严重的影响之一。这些极端事件通常被定义为在日最高气温分布中超过特定百分位数阈值的罕见事件。基于百分位数的方法遵循区域和季节温度变化，因此极端事件可能在全球和所有季节都会发生，并且经常使用运行季节窗口来增加阈值计算的样本量。在这里，我们表明，<strong>近年来许多研究中使用的运行季节窗会带来一种因时间、地区和数据集而异的偏差，从而导致对预期极端频率的惊人低估。我们揭示了这种偏差产生的原因是人为地将平均季节周期混入了极端阈值</strong>，并提出了一个简单的解决方案，基本上消除了这种偏差。然后，我们使用修正后的极端频率作为参考，表明这种偏差还导致某些地区对未来热浪变化的高估高达 30%。基于这些结果，我们强调，在估算极端天气及其影响时，不应不加校正地使用季节性运行窗口。</p><h1 id="3-通过变形测试评估机器学习模型在水文预测中的可靠性"><a href="#3-通过变形测试评估机器学习模型在水文预测中的可靠性" class="headerlink" title="3.通过变形测试评估机器学习模型在水文预测中的可靠性"></a>3.通过变形测试评估机器学习模型在水文预测中的可靠性</h1><p>题目：Reliability Assessment of Machine Learning Models in Hydrological Predictions Through Metamorphic Testing<br>期刊：Water Resources Research</p><p>文章原文：<a href="https://onlinelibrary.wiley.com/doi/abs/10.1029/2020WR029471">https://onlinelibrary.wiley.com/doi/abs/10.1029/2020WR029471</a></p><h2 id="3-1-摘要"><a href="#3-1-摘要" class="headerlink" title="3.1 摘要"></a>3.1 摘要</h2><p>机器学习模型对给定输入的预测是否可靠，可以通过与实际输出进行比较来评估。然而，在水文研究中，机器学习模型通常用于预测未来或未知事件，而<strong>实际输出结果是不可用</strong>的。模型的预测准确度衡量的是其在观测数据集中的平均表现，可能与特定输入不相关。本研究提出了一种基于软件工程中的变形测试（MT）的方法，用于评估实际输出未知情况下的预测可靠性。在这种方法中，只有当输入和输出遵循从建模系统的属性中推导出的某些关系时，对一组相关输入的预测才被认为是一致的。例如，在降雨-径流模型中，随着输入的降雨量增加，预测的径流量也应增加。在这项研究中，<strong>基于 MT 的方法被用于评估各种机器学习模型的预测结果</strong>，这些模型都是为预测德国洪水事件的规模而训练的。令人惊讶的是，模型的预测准确性与其提供一致预测的能力并不相关。本研究进一步调查了影响给定输入评估结果的因素，如输入与观测数据的相似性。总之，这项研究表明，MT 是检测模型预测不一致的一种有效而简单的方法，建议在新条件下使用模型进行预测时使用。</p><h1 id="4-基于景观格局的非点源污染控制生态缓冲带评价：-中国汉江流域案例研究"><a href="#4-基于景观格局的非点源污染控制生态缓冲带评价：-中国汉江流域案例研究" class="headerlink" title="4.基于景观格局的非点源污染控制生态缓冲带评价： 中国汉江流域案例研究"></a>4.基于景观格局的非点源污染控制生态缓冲带评价： 中国汉江流域案例研究</h1><p>题目：Evaluation of ecological buffer zone based on landscape pattern for non-point source pollution control: A case study in Hanjiang River basin, China<br>期刊：Journal of Hydrology</p><p>文章原文：<a href="https://www.sciencedirect.com/science/article/pii/S0022169423012830">https://www.sciencedirect.com/science/article/pii/S0022169423012830</a></p><h2 id="4-1-摘要"><a href="#4-1-摘要" class="headerlink" title="4.1 摘要"></a>4.1 摘要</h2><p>非点源污染（NPS）导致生态环境恶化，严重威胁人类健康和社会经济发展。有效识别关键污染源区域并为流域选择适当的最佳管理实践（BMP）是控制非点源污染的关键。本文以中国南水北调中线重要水源地汉江流域为例，介绍了一种根据下垫面和污染负荷的空间分布特征，结合核动力源风险指数（NPPRI）、最小累积阻力（MCR）模型和水土评估工具（SWAT），准确识别关键源区的方法。本研究在关键源区设置了 10 个单一情景和 3 个组合情景，包括 3 个非工程管理措施、2 个工程管理措施和 5 个生态缓冲区。最后，利用景观模式理论和信息熵法评估了 BMP 对非点源污染的影响。此外，还分析了五个生态缓冲区对流域景观特征的影响以及景观格局与非点源污染之间的响应关系。结果表明：（1）关键源区主要分布在研究区的中南部和东南部，占流域总面积的 35.9%，分别产生了流域总氮（TN）和总磷（TP）负荷的 54.2%和 60.7%。 (3) 五个生态缓冲带的布设对 “汇 ”景观的互补并置指数（IJI）有显著影响，增强了 “汇 ”景观的连通性，降低了 “源 ”景观的多样性，提高了 “汇 ”景观的拦截能力；(4) 信息熵的计算结果显示，生态缓冲带中实践属性值最高的是缓冲带 200 m。总之，研究结果为该流域的核动力源控制和水环境管理提供了参考，并增强了在该流域实施 BMPs 的可行性。</p><h1 id="5-利用基于树的机器学习模型在全球生物圈保护区进行洪水易感性预测"><a href="#5-利用基于树的机器学习模型在全球生物圈保护区进行洪水易感性预测" class="headerlink" title="5.利用基于树的机器学习模型在全球生物圈保护区进行洪水易感性预测"></a>5.利用基于树的机器学习模型在全球生物圈保护区进行洪水易感性预测</h1><p>题目：Flood susceptibility prediction using tree-based machine learning models in the GBA<br>期刊：Sustainable Cities and Society</p><p>文章原文：<a href="https://www.sciencedirect.com/science/article/pii/S2210670723003554">https://www.sciencedirect.com/science/article/pii/S2210670723003554</a></p><h2 id="5-1-摘要"><a href="#5-1-摘要" class="headerlink" title="5.1 摘要"></a>5.1 摘要</h2><p>粤港澳大湾区（GBA）经常遭受台风带来的洪涝灾害。本研究<strong>利用基于树的机器学习（ML）和地理信息系统技术开发了一个评估粤港澳大湾区洪水易感性的框架</strong>。在洪水清单的基础上，使用基于树的模型，即随机森林、梯度提升决策树、极端梯度提升和将地形、暴露度和脆弱性作为影响因素的分类提升，来训练和测试 ML 模型，然后使用训练好的模型来预测洪水易感性。所有基于树的 ML 模型都取得了良好的性能，准确率均大于 0.79。在预测洪水易感性方面，分类增强模型的表现优于其他模型。洪水易发性地图显示，全球生物圈保护区超过 16% 的区域被归类为洪水易发性高的区域，近 70% 的历史洪水位于洪水易发性高的区域。沙普利加法解释值摘要的模型解释表明，海拔高度、人口密度和台风强度等影响因素对洪水易感性有很大影响。所获得的空间洪水易感性为减轻全球生物圈保护区的洪水灾害提供了建议。</p><h1 id="6-加利福尼亚州的极端降水-温度比例：-大气河流的作用"><a href="#6-加利福尼亚州的极端降水-温度比例：-大气河流的作用" class="headerlink" title="6.加利福尼亚州的极端降水-温度比例： 大气河流的作用"></a>6.加利福尼亚州的极端降水-温度比例： 大气河流的作用</h1><p>题目：Extreme Precipitation-Temperature Scaling in California: The Role of Atmospheric Rivers<br>期刊：Geophysical Research Letters</p><p>文章原文：<a href="https://onlinelibrary.wiley.com/doi/abs/10.1029/2023GL104606">https://onlinelibrary.wiley.com/doi/abs/10.1029/2023GL104606</a></p><h2 id="6-1-摘要"><a href="#6-1-摘要" class="headerlink" title="6.1 摘要"></a>6.1 摘要</h2><p>大气河（AR）引起的降水对气候变化的敏感性主要是由于变暖导致大气水蒸气增加所致。然而，基于 AR 的降水随着变暖而加剧的速率以及该速率是否与非 AR 事件不同仍然不确定。这项工作<strong>使用多个统计模型来估计加利福尼亚州 AR 和非 AR 事件的区域极端降水-温度缩放率。缩放率是使用冷季每日和每小时降水量以及多个温度变量来确定的</strong>，以评估结果的稳健性。我们发现 AR 的区域缩放率始终大于非 AR，特别是对于每小时事件最大值（AR 和非 AR 的后中位缩放率分别为每 °C 5.7％ 和 2.4％）。与非 AR 相比，AR 保持接近饱和状态（即相对湿度较高），并且随着变暖，高空比湿度表现出更大的升力和更强的增加，这有助于解释降水-温度缩放率的差异。</p><h1 id="7-CMIP5-和-CMIP6-下的水文预测：不确定性的来源和程度"><a href="#7-CMIP5-和-CMIP6-下的水文预测：不确定性的来源和程度" class="headerlink" title="7.CMIP5 和 CMIP6 下的水文预测：不确定性的来源和程度"></a>7.CMIP5 和 CMIP6 下的水文预测：不确定性的来源和程度</h1><p>题目：Hydrological Projections under CMIP5 and CMIP6: Sources and Magnitudes of Uncertainty<br>期刊：Bulletin of the American Meteorological Society</p><p>文章原文：<a href="https://journals.ametsoc.org/view/journals/bams/105/1/BAMS-D-23-0104.1.xml">https://journals.ametsoc.org/view/journals/bams/105/1/BAMS-D-23-0104.1.xml</a></p><h2 id="7-1-摘要"><a href="#7-1-摘要" class="headerlink" title="7.1 摘要"></a>7.1 摘要</h2><p>对未来水文条件的预测很大程度上依赖于全球气候模型，但模型的性能差异很大。在本研究中，我们<strong>根据耦合模型比对项目第五和第六阶段（CMIP5 和 CMIP6）研究了径流 (R)、降水 (P)、蒸散量 (ET) 和土壤湿度 (SM) 的预计变化，并进行了量化他们预测的年度和季节性变化的不确定性</strong>。结果表明，所有四个水文变量在全球大部分土地上都呈现增加：CMIP6 的年度预测 R、P、ET 和 SM 将在全球陆地面积的 72%、81%、82% 和 66% 中增加分别是在 2080-99 年相对于 1970-99 年的高排放情景下。我们以年度规模估计了来自不同来源的 CMIP6 的不确定性，发现模型不确定性在二十一世纪的总预测不确定性中占主导地位 [76% (R)、73% (P)、89% (ET) 和 95 % (SM) in the 2090s]，并且内部变异的贡献随着时间的推移而减少。低纬度地区水文预测的不确定性最大。在 CMIP6 中，P 预测变化的不确定性对 R 预测变化的不确定性贡献最大，在年尺度上的贡献达到 93%，其次是 ET 和 SM。总体而言，CMIP5 和 CMIP6 模型在水文变化及其不确定性构成方面的表现相似。本研究为全球气候模型中水文成分的进一步完善和发展提供了理论参考。</p><h1 id="8-更高的排放情景会导致美国发生更极端的洪灾"><a href="#8-更高的排放情景会导致美国发生更极端的洪灾" class="headerlink" title="8.更高的排放情景会导致美国发生更极端的洪灾"></a>8.更高的排放情景会导致美国发生更极端的洪灾</h1><p>题目：Higher emissions scenarios lead to more extreme flooding in the United States<br>期刊：Nature Communications</p><p>文章原文：<a href="https://www.nature.com/articles/s41467-023-44415-4">https://www.nature.com/articles/s41467-023-44415-4</a></p><h2 id="8-1-摘要"><a href="#8-1-摘要" class="headerlink" title="8.1 摘要"></a>8.1 摘要</h2><p>了解美国本土 (CONUS) 洪水的预计变化有助于提高我们适应和减轻这一灾害的能力。在这里，我们使用 28 个全球气候模型的输出和耦合模型比对项目第六阶段的四种情景来评估美国本土洪水的未来变化。我们发现，预计美国大陆的洪水将总体增加，特别是在排放量较高的情况下；存在次区域差异，东北部和东南部（北部和西南大平原）由于季节尺度洪水过程的变化，呈现出洪水增加（减少）趋势较高的趋势。此外，即使在历史时期可能无法检测到思想趋势，这些预测的未来趋势也凸显了​​当前将气候变化纳入未来基础设施设计和水资源管理的需求。</p><h1 id="10-长江流域年际和年内极端径流量的时空变化"><a href="#10-长江流域年际和年内极端径流量的时空变化" class="headerlink" title="10.长江流域年际和年内极端径流量的时空变化"></a>10.长江流域年际和年内极端径流量的时空变化</h1><p>题目：Spatiotemporal variations of inter- and intra-annual extreme streamflow in the Yangtze River Basin<br>期刊：Journal of Hydrology</p><p>文章原文：<a href="https://www.sciencedirect.com/science/article/pii/S0022169424000283">https://www.sciencedirect.com/science/article/pii/S0022169424000283</a></p><h2 id="10-1-摘要"><a href="#10-1-摘要" class="headerlink" title="10.1 摘要"></a>10.1 摘要</h2><p>气候变化导致全球河流系统的极端溪流出现异常波动，而人类活动（如筑坝）的叠加加剧了极端溪流的变化，影响了洪水和河流生态系统。然而，人们对极端溪流的多时尺度变化和主要驱动因素了解有限。在本研究中，我们<strong>考察了长江流域从 1940 年代到 2020 年年际和年内极端（最大 1 天、连续 3 天和 7 天）径流量（包括量级和时间）的变化规律。此外，还确定了全流域厄尔尼诺&#x2F;南方涛动事件和大坝对年际和年内极端径流量时空异常的影响</strong>。我们发现，在长河源流域和中下游流域，年极端溪流有所增加，但在上游流域则有所减少。春秋两季的极端径流量在源头呈上升趋势，而在其他河段呈下降趋势。中上游河段冬季极端径流出现时间明显推迟。源区和长江上游河段的年际极端径流与厄尔尼诺&#x2F;南方涛动呈负相关，而中下游河段则呈正相关。年极端径流量的主要异常现象（&gt;50%）一般发生在厄尔尼诺&#x2F;南方涛动（1+2）年，而降水则对极端径流量的季节分布有影响。在长江河段下游，降水量与年极端径流量和夏季极端径流量之间有很好的相关性，但在长江河段上游，这种关系在 2003 年后完全改变了。此外，大坝的修建严重影响了极端溪流，导致年溪流和夏秋溪流逐步下降，而春冬季溪流则突然上升。这项研究有助于预测极端溪流并制定可持续的流域管理策略。</p><h1 id="11-改进结构的-WRF-WRF-Hydro-耦合系统，用于混合径流生成机制的降雨-径流模拟"><a href="#11-改进结构的-WRF-WRF-Hydro-耦合系统，用于混合径流生成机制的降雨-径流模拟" class="headerlink" title="11.改进结构的 WRF&#x2F;WRF-Hydro 耦合系统，用于混合径流生成机制的降雨-径流模拟"></a>11.改进结构的 WRF&#x2F;WRF-Hydro 耦合系统，用于混合径流生成机制的降雨-径流模拟</h1><p>题目：A WRF&#x2F;WRF-Hydro coupling system with an improved structure for rainfall-runoff simulation with mixed runoff generation mechanism<br>期刊：Journal of Hydrology</p><p>文章原文：<a href="https://www.sciencedirect.com/science/article/pii/S0022169422006242">https://www.sciencedirect.com/science/article/pii/S0022169422006242</a></p><h2 id="11-1-摘要"><a href="#11-1-摘要" class="headerlink" title="11.1 摘要"></a>11.1 摘要</h2><p>大气-水文耦合系统有助于更深入地了解大气过程与陆地表面过程之间的相互作用，提高水文预报的时空精度，延长预报提前期。WRF-Hydro 是目前广泛使用的水文模块，它与中尺度数值天气模式 WRF 相耦合，用于大气-水文研究和应用。本研究<strong>对 WRF-Hydro 的结构进行了改进和扩展，以更好地适应混合径流生成区复杂的降雨-径流转换机制</strong>。考虑到地表土壤水分变化对入渗能力的影响，将入渗参数化改为入渗方程，并根据地形指数的概念实现了入渗能力分布曲线的空间离散化。为了收敛径流，在计算马斯金库姆-昆格（MC）河川流量时引入了河道渗漏损失，并在时间上采用可变参数。此外，还努力减少 WRF-Hydro 中的参数校准误差。通过使用带外部漂移的克里格法（KED）插值工具合并天气雷达和雨量计观测数据，提高了 WRF 降水强迫的精度。然后，利用改进的降雨强迫和合并观测数据对 WRF-Hydro 的关键参数进行校准。在单向和与 WRF 模型完全耦合的模式下，对改进的 WRF-Hydro 结构的性能进行了探讨。案例研究选取了华北半湿润和半干旱流域的典型暴雨事件。结果表明，改进后的 WRFHydro 在模拟高峰和陡涨陡落的洪水时更加有效，但也出现了低峰洪水消退更快的问题。改进后的模型结构改变了混合径流的生成比例。从长期来看，入渗径流量增加，饱和径流量减少。单向和完全耦合的 WRF&#x2F;WRF-Hydro 系统都表明，改进后的结构适用于以入渗-溢出径流生成为主的降雨-径流过程。</p><h1 id="12-利用机器学习技术识别绘制洪水易发区地图的基本洪水条件因子"><a href="#12-利用机器学习技术识别绘制洪水易发区地图的基本洪水条件因子" class="headerlink" title="12.利用机器学习技术识别绘制洪水易发区地图的基本洪水条件因子"></a>12.利用机器学习技术识别绘制洪水易发区地图的基本洪水条件因子</h1><p>题目：Identifying the essential flood conditioning factors for flood prone area mapping using machine learning techniques<br>期刊：CATENA</p><p>文章原文：<a href="https://www.sciencedirect.com/science/article/pii/S0341816218305472">https://www.sciencedirect.com/science/article/pii/S0341816218305472</a></p><h2 id="12-1-摘要"><a href="#12-1-摘要" class="headerlink" title="12.1 摘要"></a>12.1 摘要</h2><p>河流洪水是一种破坏性极大的自然灾害。人们已经使用了许多方法来研究这一现象；然而，由于对洪水调节因素的了解不足，防控措施仍然受阻。本研究探讨的假设是，在河流洪水模型中使用的数据集中添加更多的调节因子，可提高最终易受影响程度绘图结果的准确性。此外，本研究还评估了单个调节因子对洪水易感性绘图的影响，以及它们在构建潜在洪水区域精确绘图中的重要性。<strong>利用决策树（DT）和支持向量机（SVM）这两种稳健的机器学习方法来评估洪水影响因素之间的空间相关性，并评定它们在绘制洪水易发区地图时的重要程度。</strong>为此使用了两个数据集：数据集 1 (DS1)： 数据集 1（DS1）：光探测与测距（LiDAR）得出的海拔高度、坡度、坡向、曲率、溪流动力指数（SPI）、地形湿润指数（TWI）、地形粗糙度指数（TRI）和沉积物迁移指数（STI）等因子；数据集 2（DS2）：LiDAR 得出的因子与地质、土壤、土地利用&#x2F;覆盖（LULC）、与道路的距离和与河流的距离等参数的组合。2011 年在澳大利亚布里斯班发生的特大洪水事件被用作案例研究，其中使用了 DT 和 SVM 技术，并同时使用了两个数据集。此外，多重共线性、方差膨胀因子 (VIF)、皮尔逊相关系数和科恩卡帕分析提供了有关因子间相互关系的有用信息，以及各因子对最终地图精度的影响。精度评估采用了曲线下面积（AUC）法。使用 DS1（激光雷达数据集），SVM 和 DT 的预测准确率最高，分别为 85.52% 和 88.47%。研究发现，海拔高度、SPI 和 TRI 对结果的精确度有显著影响。结论是，在建模中加入其他因素并不一定能保证获得更高的精度。但是，建模方法可以显著改变结果。</p><h1 id="13-利用物理编码深度学习的分布式水文建模：-通用框架及其在亚马逊流域的应用"><a href="#13-利用物理编码深度学习的分布式水文建模：-通用框架及其在亚马逊流域的应用" class="headerlink" title="13.利用物理编码深度学习的分布式水文建模： 通用框架及其在亚马逊流域的应用"></a>13.利用物理编码深度学习的分布式水文建模： 通用框架及其在亚马逊流域的应用</h1><p>题目：Distributed Hydrological Modeling With Physics-Encoded Deep Learning: A General Framework and Its Application in the Amazon<br>期刊：Water Resources Research</p><p>文章原文：<a href="https://onlinelibrary.wiley.com/doi/abs/10.1029/2023WR036170">https://onlinelibrary.wiley.com/doi/abs/10.1029/2023WR036170</a></p><h2 id="13-1-摘要"><a href="#13-1-摘要" class="headerlink" title="13.1 摘要"></a>13.1 摘要</h2><p>与传统的分布式水文模型（DHMs）相比，深度学习（DL）模型显示出更高的模拟精度，但其主要局限性在于不透明性和缺乏基本物理机制。追求 DL 与 DHM 之间的协同效应是一个引人入胜的研究领域，但明确的路线图仍遥遥无期。在本研究中，开发了一个新颖的框架，该框架无缝集成了以神经网络（NN）编码的基于过程的水文模型、用于从流域属性映射空间分布和物理意义参数的附加 NN，以及代表不充分理解的过程的基于 NN 的替代模型。多源观测数据被用作训练数据，该框架是完全可微分的，可通过反向传播快速调整参数。基于该框架建立了亚马逊流域（6×106 平方公里）的混合 DL 模型，并将全球尺度 DHM HydroPy 作为其物理骨干进行编码。通过同时使用流场观测数据和重力恢复与气候实验卫星数据进行训练，混合模型在动态和分布式模拟流场和总蓄水量时的纳什-萨特克利夫效率中值分别为 0.83 和 0.77，比原始 HydroPy 模型分别高出 41% 和 35%。用替代 NN 取代 HydroPy 中的原始 Penman-Monteith 公式，可得出更合理的潜在蒸散量（PET）估算值，并揭示出这一巨大盆地中潜在蒸散量的空间模式。对用于参数化的 NN 进行了解释，以确定控制关键参数空间变化的因素。总之，这项研究为大数据时代的分布式水文建模提供了可行的技术路线图。</p><h1 id="14-基于影响的高分辨率河流洪水预警系统"><a href="#14-基于影响的高分辨率河流洪水预警系统" class="headerlink" title="14.基于影响的高分辨率河流洪水预警系统"></a>14.基于影响的高分辨率河流洪水预警系统</h1><p>题目：High-resolution impact-based early warning system for riverine flooding<br>期刊：Nature Communications</p><p>文章原文：<a href="https://www.nature.com/articles/s41467-024-48065-y">https://www.nature.com/articles/s41467-024-48065-y</a></p><h2 id="14-1-摘要"><a href="#14-1-摘要" class="headerlink" title="14.1 摘要"></a>14.1 摘要</h2><p>尽管近几十年来洪水预报取得了可观的进展，但最先进的实用洪水预警系统（FEWS）仍需要配备近实时的洪水淹没和影响预报及其相关的不确定性。高分辨率、基于影响的洪水预报可为做出更明智的决策和有针对性的应急行动提供有见地的信息。通过利用高分辨率的前置时间图以及对建筑物和基础设施的潜在影响，现在可以向地方当局提供有价值的信息，以便做出基于风险的决策。在此，我们展示了 2021 年欧洲夏季洪水的综合洪泛区淹没后报，说明了这些可能性，以更好地做好备灾工作，为采取明智的行动提供 17 小时的准备时间。</p><h1 id="15-来自正在运行的全球洪水意识系统的每日整体河流流量重新预测和实时预报"><a href="#15-来自正在运行的全球洪水意识系统的每日整体河流流量重新预测和实时预报" class="headerlink" title="15.来自正在运行的全球洪水意识系统的每日整体河流流量重新预测和实时预报"></a>15.来自正在运行的全球洪水意识系统的每日整体河流流量重新预测和实时预报</h1><p>题目：Daily ensemble river discharge reforecasts and real-time forecasts from the operational Global Flood Awareness System<br>期刊：Hydrology and Earth System Sciences</p><p>文章原文：<a href="https://hess.copernicus.org/articles/27/1/2023/">https://hess.copernicus.org/articles/27/1/2023/</a></p><h2 id="15-1-摘要"><a href="#15-1-摘要" class="headerlink" title="15.1 摘要"></a>15.1 摘要</h2><p>实用的全球规模水文预报系统用于帮助管理洪水和干旱等水文极端事件。迄今为止，支撑预测系统的大量原始数据以及生成预测技能信息的能力尚未公开。作为全球洪水意识系统（GloFAS；<a href="https://www.globalfloods.eu/%EF%BC%8C%E6%9C%80%E5%90%8E%E8%AE%BF%E9%97%AE%EF%BC%9A2022">https://www.globalfloods.eu/，最后访问：2022</a> 年 12 月 3 日）服务发展的一部分，本文中的每日集合河流流量重新预测和实时预测数据集是免费和可通过哥白尼气候变化服务 (C3S) 气候数据存储 (CDS) 公开获取。其中包括自 2020 年 1 月 1 日开始每天更新的实时预测数据以及一组 20 年的重新预测和相关元数据。本文描述了用于生成实时河流流量预测和重新预测的模型组件和配置。还使用连续排序概率技能得分（CRPSS）对全球河流点进行了集合预报技能评估。结果表明，根据持久性基准预测，GloFAS 在短期（1 至 3 天）和中期（5 至 15 天）内的超过 93% 的流域中表现出色，在扩展范围（16至 30 d) 与气候基准预测相比。然而，不同地点的技能强度差异很大，在热带非洲、南美洲西海岸的广阔水文气候地区以及北高纬度地区以冰雪为主的集水区，GloFAS 被发现在较长的交付时间内没有技能或负技能。预测技能被概括为新的标题技能分数，可作为 GloFAS 预测 Web 地图查看器上的新层来帮助用户解释和理解预测质量。</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>文献分享</tag>
      
      <tag>洪水</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>使用WRF-Hydro预测河道流量入门学习文档整理一</title>
    <link href="/2024/04/26/%E4%BD%BF%E7%94%A8WRF-Hydro%E9%A2%84%E6%B5%8B%E6%B2%B3%E9%81%93%E6%B5%81%E9%87%8F%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0%E6%96%87%E6%A1%A3%E6%95%B4%E7%90%86%E4%B8%80/"/>
    <url>/2024/04/26/%E4%BD%BF%E7%94%A8WRF-Hydro%E9%A2%84%E6%B5%8B%E6%B2%B3%E9%81%93%E6%B5%81%E9%87%8F%E5%85%A5%E9%97%A8%E5%AD%A6%E4%B9%A0%E6%96%87%E6%A1%A3%E6%95%B4%E7%90%86%E4%B8%80/</url>
    
    <content type="html"><![CDATA[<h1 id="1-前言"><a href="#1-前言" class="headerlink" title="1. 前言"></a>1. 前言</h1><p>这篇文档主要是针对WRF-Hydro计算河道流量（Standalone Mode下）相关流程中可能使用到的工具、学习文档、使用教程进行一些汇总和梳理，其最终目的为获取河道流量及其相关变量。</p><h1 id="2-软件下载、安装和编译"><a href="#2-软件下载、安装和编译" class="headerlink" title="2. 软件下载、安装和编译"></a>2. 软件下载、安装和编译</h1><p>本章主要介绍相关工具包的下载、安装与编译的文档与教程分享。</p><h2 id="2-1-WRF4-5-2和WPS4-5-0下载、安装与编译"><a href="#2-1-WRF4-5-2和WPS4-5-0下载、安装与编译" class="headerlink" title="2.1 WRF4.5.2和WPS4.5.0下载、安装与编译"></a>2.1 WRF4.5.2和WPS4.5.0下载、安装与编译</h2><p>可通过结合下面两个链接查看WRF和WPS的下载安装与编译。</p><p><a href="https://www2.mmm.ucar.edu/wrf/OnLineTutorial/compilation_tutorial.php">在线官方教程-How to Compile WRF:The Complete Process</a></p><p><a href="https://singyutang.github.io/2024/03/17/%E5%A6%82%E4%BD%95%E5%9C%A8ubuntu16-04%E4%B8%8A%E5%AE%89%E8%A3%85%E7%BC%96%E8%AF%91WRF4-5-2%E3%80%81WRF-hydro5-2-0%E5%92%8CWPS4-5-0/">个人博客-如何在ubuntu16.04上安装编译WRF4.5.2和WPS4.5.0</a></p><h2 id="2-2-WRF-Hydro5-2-0下载、安装与编译"><a href="#2-2-WRF-Hydro5-2-0下载、安装与编译" class="headerlink" title="2.2 WRF-Hydro5.2.0下载、安装与编译"></a>2.2 WRF-Hydro5.2.0下载、安装与编译</h2><p>详细安装已在个人博客中进行介绍，可点击下面链接进行查看下载、安装与编译。</p><p><a href="https://singyutang.github.io/2024/03/23/%E5%A6%82%E4%BD%95%E5%9C%A8ubuntu16-04%E4%B8%8A%E5%AE%89%E8%A3%85%E7%BC%96%E8%AF%91WRF-Hydro5-2-0/">个人博客-如何在ubuntu16.04上安装编译WRF-Hydro5.2.0</a></p><h2 id="2-3-WRF-Hydro-GIS-Pre-Processing-Tools5-2-0下载、安装"><a href="#2-3-WRF-Hydro-GIS-Pre-Processing-Tools5-2-0下载、安装" class="headerlink" title="2.3 WRF Hydro GIS Pre-Processing Tools5.2.0下载、安装"></a>2.3 WRF Hydro GIS Pre-Processing Tools5.2.0下载、安装</h2><p>详细安装已在个人博客中进行介绍，可点击下面链接进行查看下载、安装与编译，该工具包支持的ArCGIS Pro的版本也在博客中提供，可点击下面的博客链接跳转进行下载。这里也给出了WRF-Hydro ArcGIS Pre-processing Tools Version v5.2.0的工具包下载链接。</p><p><a href="https://github.com/NCAR/wrf_hydro_arcgis_preprocessor/archive/refs/tags/5.2.0.tar.gz">WRF-Hydro ArcGIS Pre-processing Tools Version v5.2.0 release tar.gz压缩包下载</a></p><p><a href="https://singyutang.github.io/2024/04/03/%E5%A6%82%E4%BD%95%E5%9C%A8ubuntu16-04%E4%B8%8A%E5%AE%89%E8%A3%85WRF-Hydro-GIS-Pre-Processing-Tools5-2-0/">个人博客-安装使用WRF Hydro GIS Pre-Processing Tools5.2.0</a></p><h1 id="3-工具包模块功能介绍与使用教程"><a href="#3-工具包模块功能介绍与使用教程" class="headerlink" title="3. 工具包模块功能介绍与使用教程"></a>3. 工具包模块功能介绍与使用教程</h1><p>本章内容主要是对以上内容中提到的工具包说明文档以及使用教程的分享，并简单介绍处理流程。下面将根据工具包的使用顺序进行依次介绍。注意：本章内容都是基于WRF-Hydro在Standalone Mode下运行，使用Noah-MP陆地表面模型。</p><p>1.<a href="https://www2.mmm.ucar.edu/wrf/users/wrf_users_guide/build/html/wps.html#">在线WPS用户指南-The WRF Preprocessing System (WPS)模块功能详细介绍与运行</a></p><p>该教程中主要展示了如何利用WPS得到WRF-Hydro工具包中所需要的<code>geo_em.d*.nc</code>文件和<code>met_em.d*</code>文件。<code>geo_em.d*.nc</code>是WRFHydro_GIS_Preprocessor工具包处理所必要的文件，<code>met_em.d*</code>文件是WRF工具包生成<code>wrfinput_d*</code>的必要文件。<code>wrfinput_d*</code>文件是WRFHydro_GIS_Preprocessor工具包处理所必要的文件。WPS主要需要修改的配置文件为”namelist.wps”。</p><p>WPS所必要的数据包括Static Geographical Data和Grided Meteorological Data两种数据文件，可通过查看<a href="https://singyutang.github.io/2024/03/17/%E5%A6%82%E4%BD%95%E5%9C%A8ubuntu16-04%E4%B8%8A%E5%AE%89%E8%A3%85%E7%BC%96%E8%AF%91WRF4-5-2%E3%80%81WRF-hydro5-2-0%E5%92%8CWPS4-5-0/#7-%E9%9D%99%E6%80%81%E5%9C%B0%E7%90%86%E6%95%B0%E6%8D%AE">个人博客-静态地理数据</a>和<a href="https://singyutang.github.io/2024/03/17/%E5%A6%82%E4%BD%95%E5%9C%A8ubuntu16-04%E4%B8%8A%E5%AE%89%E8%A3%85%E7%BC%96%E8%AF%91WRF4-5-2%E3%80%81WRF-hydro5-2-0%E5%92%8CWPS4-5-0/#8-%E5%AE%9E%E6%97%B6%E6%B0%94%E8%B1%A1%E6%95%B0%E6%8D%AE">个人博客-GFS实时气象数据</a>进行下载。</p><p>关于WPS详细模块和功能介绍可点击上面链接进行查看，这里将其目录截图进行展示。<a href="https://ral.ucar.edu/sites/default/files/public/projects/wrf-hydro/technical-description-user-guide/wrf-hydrov5.2technicaldescription.pdf">wrf-hydrov5.2用户手册</a>在第 5.2节 <em>Domain processing and description of surface physiographic input files</em>也作了简单运行流程介绍。</p><p>2.<a href="https://www2.mmm.ucar.edu/wrf/users/wrf_users_guide/build/html/running_wrf.html">在线WRF用户指南-WRF运行详细步骤与说明</a></p><p>该教程只介绍WRF在河道流量中使用到的处理流程，确保在运行WRF前进行<a href="https://www2.mmm.ucar.edu/wrf/users/wrf_users_guide/build/html/initialization.html">编译</a>。在WRF的处理流程中，主要会使用到WPS处理结果中<code>met_em.*</code>文件，然后利用<code>real.exe</code>程序生成<code>WRFHydro_GIS_Preprocessor</code>工具将会使用的 <code>wrfinput_d0* </code>文件，当然该文件也可通过R程序<a href="https://ral.ucar.edu/sites/default/files/public/create_wrfinput.zip">create_wrfinput.R</a>生成。WRF中主要修改的配置文件为”namelist.wps”和”namelist.input”。<em>注意修改WRF中的配置文件时要和WPS中的配置文件参数相对应。</em></p><p>3.<a href="https://github.com/NCAR/wrf_hydro_arcgis_preprocessor/releases/download/5.2.0/WRFHydro_GIS_Preprocessor_v5_2_0.pdf">WRFHydro_GIS_Preprocessor_v5_2_0 pdf版本学习教程</a></p><p>该实用程序旨在帮助用户使用ArcGIS Pro软件创建 WRF-Hydro routing grids。文档中详细介绍了模块的功能、、数据介绍、操作流程、文件输入、文件输出、输入文件和输出文件的详细介绍及使用到的参数说明等。</p><p>程序所需的必备文件输入为WPS中的输出”geo_em.d*.nc”和高程文件，高程文件主要使用<a href="https://www.hydrosheds.org/hydrosheds-core-downloads">HydroSHEDS</a>中的Void-filled DEM产品。输出文件包含”Fulldom_hires.nc”、”GEOGRID_LDASOUT_Spatial_Metadata.nc”、”GWBASINS.nc”、”LAKEPARM.nc”、”Route_Link.nc”、”Streams.*”等，有关的文件说明和变量介绍在文档中有详细介绍。</p><p>4.<a href="https://ral.ucar.edu/sites/default/files/public/projects/wrf-hydro/technical-description-user-guide/wrf-hydrov5.2technicaldescription.pdf">WRF-HydroV5.2.0TechnicalDescription pdf</a></p><p>本文档主要介绍WR-Hydro中各模块的功能介绍，对于处理流程的介绍较为简略，但对于每个配置文件的设置，每个参数的含义都有详细介绍和说明。如果想要了解和学习WRF-Hydro的详细操作流程和演示（独立模式，standalone mode），请参照<a href="https://ral.ucar.edu/sites/default/files/docs/water/howtobuildrunwrfhydrov511instandalonemode.pdf">howtobuildrunwrfhydrov511instandalonemode.pdf</a>和<a href="https://ral.ucar.edu/sites/default/files/docs/water/howtobuildrunwrfhydrov511instandalonemode.pdf">wrf-hydrov511testcaseuserguide.pdf</a></p><p>5.<a href="https://ral.ucar.edu/sites/default/files/docs/water/howtobuildrunwrfhydrov511instandalonemode.pdf">如何在独立模式下构建和运行 WRF-Hydro 5.1.1</a></p><p>该文档仍然支持WRF-Hydro v5.2.0的学习。该文档用于对示例测试用例的引导，旨在引导您使用准备好的地理输入以及为特定区域（域）准备的强迫数据来运行 WRF-Hydro 建模系统。我们提供<a href="https://github.com/NCAR/wrf_hydro_nwm_public/releases/download/v5.2.0/croton_NY_training_example_v5.2.tar.gz">测试数据</a>来测试您的 WRF-Hydro 可执行文件是否已正确编译并能够在您的系统上运行。</p><p> <em>注意：这里提供的测试数据为在独立模式（Standalone Mode）下运行WRF-Hydro。</em></p><p>6.<a href="https://ral.ucar.edu/sites/default/files/docs/water/howtobuildrunwrfhydrov511instandalonemode.pdf">WRF-Hydro V5.1.1 独立测试用例用户指南</a></p><p>该文档仍然支持WRF-Hydro v5.2.0的学习。文档旨在利用示例测试用例指导完成 WRF-Hydro 模型构建过程，然后指导您完成创建自定义地理输入和强制数据与 Noah-MP 陆地表面模型一起在独立模式下运行的工作流程。详细目录和工作流程如下图所示。</p><p>该文档介绍了WRF-Hydro如下内容：</p><p>（1）WRF-Hydro的编译与运行；</p><p>（2）WRF-Hydro的所需脚本与必要安装库；</p><p>（3）WRF-Hydro的案例分享和数据下载；</p><p>（4）WRF-Hydro的详细工作流程，包含WRF、WPS和WRFHydro_GIS_Preprocessor的数据准备部分；</p><p>（5）配置文件的必要修改部分注明；</p><p>（6）WRF-Hydro的输出结果评价，主要是利用<a href="https://github.com/NCAR/rwrfhydro">rwrfhydro</a>工具进行评价和可视化，但不建议使用这个工具包，受限太多。</p><p>7.<a href="https://ral.ucar.edu/sites/default/files/public/projects/wrf-hydro/technical-description-user-guide/outputvariablematrix-v5.2.0.pdf">WRF-Hydro v5.2 Output Variable Matrix pdf</a></p><p> 该文档详细介绍了WRF-Hydro程序运行输出后的各文件以及变量，包含对于所有文件中变量的详细介绍，有不清楚的可进行下载查看。</p><p>8.其他文档</p><p>以下v5.1.1版本的文档皆可用于v5.2.0的学习。</p><p><a href="https://ral.ucar.edu/sites/default/files/docs/water/howtobuildandrunwrfhydrov511coupledtowrf.pdf">如何构建和运行与 WRF 耦合的 WRF-Hydro V5.1.1</a> 暂不使用</p><p><a href="https://ral.ucar.edu/sites/default/files/docs/water/wrf-hydrov511testcaseuserguide.pdf">耦合 WRF|WRF-Hydro V5.1.1 测试用例用户指南</a> 暂不使用</p><p><a href="https://ral.ucar.edu/sites/default/files/docs//noah-mpoptionsindicatorsofusagewithwrfhydronwm.pdf">Noah-MP 名单 选项 WRFHydro v5.1.1&#x2F;NWM 使用指标</a> NWM暂不使用，但是NOah-MP有需要可进行查看</p><p><a href="https://data.hydrosheds.org/file/technical-documentation/HydroSHEDS_TechDoc_v1_4.pdf">HydroSHEDS Technical Documentation</a></p><h1 id="4-后记"><a href="#4-后记" class="headerlink" title="4. 后记"></a>4. 后记</h1><p>WRF-Hydro中的树形工作目录如图，只展示用户需要自己计算的部分</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs stylus">wrf_hydro_nwm_public-<span class="hljs-number">5.2</span>.<span class="hljs-number">0</span><br>    └── tests<br>    └── ...<br>    └── trunk<br>        ├── NDHMS<br>            ├── ...<br>            └── RUN<br>                ├── ...<br>                ├── DOMAIN<br>                    ├── Fulldom_hires<span class="hljs-selector-class">.nc</span><br>                    ├── wrinput_d01<span class="hljs-selector-class">.nc</span><br>                    ├── geo_em<span class="hljs-selector-class">.d01</span><span class="hljs-selector-class">.nc</span><br>                    └── ...<br>                ├── FORCING<br>                    └── ...<br>                ├── RESTART<br>                    └── ... <br>                ├── wrf_hydro<span class="hljs-selector-class">.exe</span><br>                ├── namelist<span class="hljs-selector-class">.hrldas</span><br>                ├── hydro<span class="hljs-selector-class">.namelist</span><br>                ├── SOILPARM<span class="hljs-selector-class">.TBL</span><br>                ├── MPTABLE<span class="hljs-selector-class">.TBL</span><br>                ├── CHANPAM<span class="hljs-selector-class">.TBL</span><br>                ├── HYDRO<span class="hljs-selector-class">.TBL</span><br>                ├── GENPARM<span class="hljs-selector-class">.TBL</span><br>                └── ...<br><br></code></pre></td></tr></table></figure><p>本文档中分享的内容尚不完整，后续将根据实际处理进行不断完善。<br>目前以上内容包括WRF-Hydro中处理流程的一些文档的介绍和分享，但只包含了处理过程中“DOMAIN”文件夹中数据的描述，缺少关于气象强迫(FORCING)数据的获取以及“FORCING”文件夹的介绍说明和处理流程，以及坐标转化、格式转化、重采样等相关问题的整理，这些工作将于最近进行更新。</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>websites</tag>
      
      <tag>WRF-Hydro5.2.0</tag>
      
      <tag>toolkit</tag>
      
      <tag>documents</tag>
      
      <tag>WRF4.5.2</tag>
      
      <tag>WPS4.5.0</tag>
      
      <tag>WRF Hydro GIS Pre-Processing Tools</tag>
      
      <tag>HydroSHEDS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WRF-Hydro的文献调研</title>
    <link href="/2024/04/25/WRF-Hydro%E7%9A%84%E6%96%87%E7%8C%AE%E8%B0%83%E7%A0%94/"/>
    <url>/2024/04/25/WRF-Hydro%E7%9A%84%E6%96%87%E7%8C%AE%E8%B0%83%E7%A0%94/</url>
    
    <content type="html"><![CDATA[<h1 id="1-2023-WRF-Hydro-模型模拟西北干旱区径流的标定与评估——以开都河流域为例"><a href="#1-2023-WRF-Hydro-模型模拟西北干旱区径流的标定与评估——以开都河流域为例" class="headerlink" title="1. 2023 - WRF-Hydro 模型模拟西北干旱区径流的标定与评估——以开都河流域为例"></a>1. 2023 - WRF-Hydro 模型模拟西北干旱区径流的标定与评估——以开都河流域为例</h1><p><a href="https://www.mdpi.com/2071-1050/15/7/6175">https://www.mdpi.com/2071-1050/15/7/6175</a></p><p>本研究采用天气研究与预报模型（WRF-Hydro）的水文系统来<strong>模拟开都河流域的水流</strong>，这对中国西北塔里木河下游的生态系统至关重要。离线WRF-Hydro模型与Noah多参数化地表模型（Noah-MP）耦合，并由中国气象强迫数据集（CMFD）强制，水文路由模块的网格间距为250 m。使用3年期（1983年至1985年）进行校准，并使用17年期（1986年至2002年）进行评估。对 WRF-Hydro 的几个关键参数和四个 Noah-MP 参数化选项进行了校准，并使用每日水流观测来评估具有优化模型设置的 WRF-Hydro 的性能。结果表明，WRF-Hydro 可以合理地再现观测到的水流，并且低估了水流峰值。开都河流域模拟水流对bexp、dksat、smcmax、REFKDT、坡度、OVROUGHRTAC、mann等参数敏感。同时，Noah-MP的参数化选项对水流模拟也有很大的影响。经过优化模型设置的 WRF-Hydro 模型在校准期内的相关系数（CC）和纳什效率系数（NSE）统计得分分别为 0.78 和 0.61。同时，在评估期间，得分分别为0.7和0.50。本研究表明了基于物理的WRF-Hydro模型在西北地区应用的重要性，为附近地区提供了参考。</p><h1 id="2-2023-使用-Noah-MP-模型对-WRF-Hydro-进行基于网格的校准，并改进地下水和蒸腾过程方程"><a href="#2-2023-使用-Noah-MP-模型对-WRF-Hydro-进行基于网格的校准，并改进地下水和蒸腾过程方程" class="headerlink" title="2. 2023 -  使用 Noah-MP 模型对 WRF-Hydro 进行基于网格的校准，并改进地下水和蒸腾过程方程"></a>2. 2023 -  使用 Noah-MP 模型对 WRF-Hydro 进行基于网格的校准，并改进地下水和蒸腾过程方程</h1><p><a href="https://doi.org/10.1016/j.jhydrol.2022.128991" title="使用数字对象标识符的持久链接"> https://doi.org/10.1016/j.jHydrol.2022.128991 </a></p><p>基于物理的分布式 WRF-Hydro 建模系统，包括具有多种参数化选项的 Noah 陆地表面模型（Noah-MP）和 WRF 大气模型（天气研究和预报模型）的水文扩展，最近已被广泛应用于水平衡研究、水流和陆地-大气耦合模拟。尽管模型中有多个可用的物理参数化，但缺少模拟水平衡特定损失的方程，并且尚未研究跨多个流域的分布式参数的基于网格的校准。为了填补这些空白，本研究的目的是：（i）分析土壤、径流、地下水和植被参数对水平衡组成部分的影响； (ii) 改进基流和蒸腾方程； (iii) 使用水流观测来测试分布式模型参数的基于网格的校准方法。<strong>通过引入地下水损失因子改进了 WRF-Hydro 地下水模型</strong>，并对 Jarvis 气孔导度模型进行了修改以考虑夜间蒸腾作用。使用参数估计 (PEST) 软件对 19 个空间分布类别的三个参数（渗透、导水率和渗滤）进行基于网格的校准。研究区域包括东地中海塞浦路斯的 31 个小型山区流域（5-115 km 2 ）。使用两年期（2011-2013）进行校准，使用五年期（2013-2018）进行评估。基线模型设置在 2011-2012 年平均高估了 50% 的水流，在 2012-2013 年高估了 100% 以上。总体而言，使用不同的模型参数和模型选项，水流和蒸散量 (ET) 可能与基线模拟相差约 ±30%。将地下水损失模拟为地下水位的函数，使总水流平均减少 30%。使用拟议的 Jarvis 夜间蒸腾方程使总 ET 平均增加了 25%。基于网格的方法有助于校准 31 个流域区域的分布参数。校准期间的中位纳什-萨特克利夫效率 (NSE) 为 0.49，但在干燥评估期间为 0.02。校准后的 WRF-Hydro 模型再现了 ET 的年度变化，改进的地下水和蒸腾方程减少了 WRF-Hydro 的水流大幅高估。干旱年份的模型性能表明需要表示更多发生在半干旱环境中且具有短暂流的过程，并且这些过程未包含在 WRF-Hydro 和 Noah-MP 中。基于网格的 WRF-Hydro 参数化可应用于整个研究区域，进行完全耦合的大气-水文模拟。</p><h2 id="强调"><a href="#强调" class="headerlink" title="强调"></a>强调</h2><ul><li><p>新的 WRF-Hydro 地下水损失系数可减少<a href="https://www.sciencedirect.com/topics/earth-and-planetary-sciences/streamflow" title="从 ScienceDirect 的 AI 生成的主题页面了解有关流的更多信息">水流</a>高估。</p></li><li><p>贾维斯模型通过夜间蒸腾成分得到增强。</p></li><li><p>Jarvis 模型在半干旱地区的表现优于默认的 Noah-MP Ball-Berry。</p></li><li><p>基于网格的校准对分布式 WRF-Hydro 参数有效且有效。</p></li></ul><h1 id="3-2020-利用单向耦合大气-水文建模系统模拟地中海小流域的极端降雨和径流事件"><a href="#3-2020-利用单向耦合大气-水文建模系统模拟地中海小流域的极端降雨和径流事件" class="headerlink" title="3. 2020 -  利用单向耦合大气-水文建模系统模拟地中海小流域的极端降雨和径流事件"></a>3. 2020 -  利用单向耦合大气-水文建模系统模拟地中海小流域的极端降雨和径流事件</h1><p><a href="https://nhess.copernicus.org/articles/20/2791/2020/">https://nhess.copernicus.org/articles/20/2791/2020/</a></p><p>大气-水文耦合系统越来越多地用作洪水预报和水管理目的的工具，使水文程序的性能成为模型功能的关键指标。本研究的目标是 (i) 校准单向耦合 WRF-Hydro 模型，用于通过观测到的降水来模拟塞浦路斯的极端事件，以及 (ii) 评估强制使用 WRF 缩小尺度 ( 1×1  km 2 )时的模型性能重新分析降水数据（ERA-中期）。这种设置类似于用于预测应用和气候预测的现实建模链。对 1989 年 1 月（校准）和 1994 年 11 月（验证）22 个山区流域发生的<strong>极端降雨事件期间的水流进行了建模</strong>。在六个流域中，两个事件的纳什-萨克利夫效率 (NSE) 均大于 0.5。 WRF 模拟的降雨量显示 1989 年 1 月的平均 NSE 为 0.83，1994 年 11 月的平均 NSE 为 0.49。然而，使用 WRF 模拟的降雨量和校准的 WRF-Hydro 对这两个事件进行的水文模拟返回了 1989 年 1 月 13 个流域的负水流 NSE。以及1994年11月的18个流域。这些结果表明，与观测到的降水相比，模拟降雨量或时间或空间变化的微小差异可以强烈改变小流域对极端事件的水文响应。因此，小流域 WRF-Hydro 的校准取决于具有高时间和空间分辨率的观测降雨的可用性。然而，使用模拟降水输入数据对于研究未来极端事件对洪水和水资源的影响仍然很重要。</p><h1 id="4-2022-我国干旱区典型湖盆大气水文剖面耦合重建与干涸风险预测"><a href="#4-2022-我国干旱区典型湖盆大气水文剖面耦合重建与干涸风险预测" class="headerlink" title="4. 2022 - # 我国干旱区典型湖盆大气水文剖面耦合重建与干涸风险预测"></a>4. 2022 - # 我国干旱区典型湖盆大气水文剖面耦合重建与干涸风险预测</h1><p><a href="https://www.nature.com/articles/s41598-022-10284-y">https://www.nature.com/articles/s41598-022-10284-y</a></p><p>干旱地区对全球变暖非常敏感，极易受到气候变化的影响。而且，干旱地区水资源系统脆弱，将随着气候变化而发生巨大变化。因此，干旱区气候与水文的相互作用对区域小气候的形成和水文变化具有重要影响。岱海是我国干旱区典型的封闭式内陆湖泊，也是华北地区生态保护的重点区域。<strong>本文采用WRF-Hydro模型模拟了岱海流域1980—2020年的气候水文耦合情况，并通过气象统计、径流计算和遥感分析对耦合结果进行了验证和校准</strong>。在总结近40年气候、水文概况的基础上，分析了岱海流域水文要素的成因及未来趋势。通过分析发现，岱海盆地降水量年际变化剧烈，1980—1994年平均降水量为401.75毫米； 1995年至2011年波动剧烈，最大值与最小值年际相差近400毫米； 2012年至2020年波动较小。蒸发量年际变化虽有波动，但呈上升趋势，斜率为8.855毫米&#x2F;年。年平均气温呈明显上升趋势，上升趋势为0.040℃&#x2F;年。 1980年至2020年，岱海入湖流量呈下降趋势； 2013年以来，入湖径流量趋于平缓。气候变化和人类活动是导致岱海水量变化的决定性因素，其中人类活动的作用更大。耕地灌溉和工业用水与湖泊流量高度相关，这两个因素对湖泊流量影响很大。如果现在的农业和工业用水量不增加，岱海还有近120年的寿命。如果人类活动不改变，不及时采取任何保护措施，在全球气候变化的背景下，2025年岱海入湖流量将减少为零，2025年岱海将彻底干涸。 2031–2033。岱海流域长时间序列的气候水文耦合研究不仅可以弥补径流资料的不足，而且可以为水资源管理、防灾减灾提供依据。</p><h1 id="5-2021-2020-2050年长江上游流域水文预测"><a href="#5-2021-2020-2050年长江上游流域水文预测" class="headerlink" title="5. 2021 - # 2020-2050年长江上游流域水文预测"></a>5. 2021 - # 2020-2050年长江上游流域水文预测</h1><p><a href="https://www.nature.com/articles/s41598-021-88135-5?fromPaywallRec=false">https://www.nature.com/articles/s41598-021-88135-5?fromPaywallRec=false</a><br>了解气候变化对径流的影响对于有效的水资源管理和规划至关重要。在本研究中，区域气候模型 (RCM) RegCM4.5 用于将长江上游 (UYRB) 的近期气候预测<strong>从两个全球气候模型动态缩小到 50 公里的水平分辨率。基于偏差校正的气候预测结果，评估了气候变化对21世纪中叶青藏高原降水和气温的影响</strong>。然后，通过大尺度水文模型与RegCM4.5的耦合，<strong>评估了气候变化对乌干达河口河道流量的影响</strong>。据预测，与参考期相比，近期乌干达东部地区将趋于暖干，而乌干达西部地区将趋于暖湿。降水量将以19.05～19.25毫米&#x2F;10年的速度减少，多年平均年降水量变化在-0.5～0.5毫米&#x2F;天之间。气温预计将以 0.38-0.52 °C&#x2F;10 a 的速度显着升高，预计多年平均气温升高约为 1.3-1.5 ℃。融雪径流对UYBR年径流的贡献仅约为4%，而对春季径流的贡献约为9.2%。受气候变暖影响，流域年平均融雪径流将减少36%<del>39%，年径流总量将减少4.1%</del>5%，极端径流略有减少。预计径流深度减少的区域主要集中在流域东南部地区。东南部地区降水量减少是导致径流深度减少的原因，而西北地区径流深度减少则主要是由于蒸发量增加造成的。</p><h1 id="6-侧向陆地水流对降水的贡献-–-WRF-Hydro-系综分析和欧洲大陆蒸发标记"><a href="#6-侧向陆地水流对降水的贡献-–-WRF-Hydro-系综分析和欧洲大陆蒸发标记" class="headerlink" title="6. 侧向陆地水流对降水的贡献 – WRF-Hydro 系综分析和欧洲大陆蒸发标记"></a>6. 侧向陆地水流对降水的贡献 – WRF-Hydro 系综分析和欧洲大陆蒸发标记</h1><p><a href="https://publikationen.bibliothek.kit.edu/1000129004">https://publikationen.bibliothek.kit.edu/1000129004</a></p><p>陆地-大气反馈过程是地球气候系统的关键组成部分。一般来说，地表状态在多大程度上反馈到大气状态是值得怀疑的。这个问题可以通过耦合的地表-大气模型来解决，并且可以通过模型与观测的比较来评估模拟反馈的真实性。本研究调查了连接侧向陆地水流、土壤湿度、地表蒸发和降水的过程链的特殊情况。重点关注欧洲地区的夏季降水。研究期限定为 2008 年 6 月至 9 月的四个月。进行这项研究的工具是大气-水文耦合模型 WRF-Hydro，它允许地表水和地下水路由。对于大气部分的设置，选择水平网格为700x500网格点，网格间距为5 km，覆盖面积为3500 km x 2500 km，垂直网格为50个，最高可达10 hPa。对于陆地水路由的设置，选择了由 14000x10000 网格点组成的水平网格，网格间距为 250 m，并且选择了 4 个土层，深度为 2 m。所采用的模型版本包括表面蒸发标记程序，以便量化源自整个欧洲大陆蒸发的欧洲降水部分。该方法包括通过使用随机动能反向散射方案的随机实现来生成一组有或没有陆地水路由的 WRF-Hydro 模拟，并使用每日网格降水观测数据集评估侧向陆地水流对降水的影响。欧洲（E-OBS）。使用由 20 名成员组成的集合规模来理清导致 WRF-Hydro 模拟（有或没有陆地水路由）之间降水差异的两个过程的贡献，即地表蒸发的变化和大气混沌行为。结果发现，**考虑侧向陆地水流通过增强地表蒸发使夏季降水量增加了10%**，从而减少了对E-OBS的偏差。</p><h1 id="7-WRF-Hydro-中降水对陆地水流不确定性的敏感性：中欧的集合分析"><a href="#7-WRF-Hydro-中降水对陆地水流不确定性的敏感性：中欧的集合分析" class="headerlink" title="7. WRF-Hydro 中降水对陆地水流不确定性的敏感性：中欧的集合分析"></a>7. WRF-Hydro 中降水对陆地水流不确定性的敏感性：中欧的集合分析</h1><p><a href="https://publikationen.bibliothek.kit.edu/1000084710">https://publikationen.bibliothek.kit.edu/1000084710</a></p><p>降水量受土壤湿度空间变化的影响。然而，这种变异性在没有将土壤水分输送视为三维过程的大气模型中并没有得到很好的体现。本研究调查降水对陆地水流表示的不确定性的敏感性。本次调查使用的工具是天气研究和预报 (WRF) 模型及其水文增强版本 WRF-Hydro，于 2008 年 4 月至 10 月在中欧应用。模型网格允许对流，水平间距为 2.8 公里。 WRF-Hydro 子网格采用 280 米分辨率来解析横向陆地水流。通过修改控制地表径流和渗透之间的划分的参数以及改变行星边界层（PBL）方案来构建 WRF&#x2F;WRF-Hydro 系综。该系综代表了陆地水流的不确定性，该不确定性源于对已解决的横向流、垂直方向的陆地水流不确定性和湍流参数化不确定性的考虑。<strong>在地形温和、地表通量空间变异性高、天气状况受局部过程主导的情况下，陆地水流的不确定性显着增加了日降水量的归一化集合分布。</strong> 调整后的连续排名概率得分表明，PBL 不确定性将集合子集从 E-OBS 观测产品再现每日降水量的技能提高了 16%–20%。与 WRF 相比，WRF-Hydro 将这项技能提高了 0.4%–0.7%。 Nash-Sutcliffe 模型效率系数普遍高于 0.3 的每日观测流量的再现证明了 WRF-Hydro 在水文科学中的潜力。</p><h1 id="8-2019-WRF-Hydro-土壤-植被-大气水联合标记程序：在多瑙河上游流域降水分区案例中的实施和应用"><a href="#8-2019-WRF-Hydro-土壤-植被-大气水联合标记程序：在多瑙河上游流域降水分区案例中的实施和应用" class="headerlink" title="8. 2019 - WRF-Hydro 土壤-植被-大气水联合标记程序：在多瑙河上游流域降水分区案例中的实施和应用"></a>8. 2019 - WRF-Hydro 土壤-植被-大气水联合标记程序：在多瑙河上游流域降水分区案例中的实施和应用</h1><p><a href="https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2019WR024780">https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2019WR024780</a></p><p>天气研究和预报 (WRF) 模型等大气模型提供了评估区域水文循环组成部分（包括降水、蒸散、土壤水储存和径流）行为的工具。最近的模型开发重点关注大气-水文耦合建模系统，例如 WRF-Hydro，以考虑地下、陆上和河流流量，并有可能改善陆地-大气相互作用的表示。本研究的目的是借助 WRF-tag 和 WRF-Hydro- 中新开发的土壤-植被-大气水联合标记程序，调查<strong>侧向陆地水流对区域水文循环</strong>的贡献。标记模型。介绍了两种模型在 2008 年 8 月 15 日多瑙河上游流域德国和奥地利部分地区（94,100 km 2 ）高降水事件中的应用。该事件期间流域内的降水被视为水源，被标记并随后跟踪 40 个月，直至 2011 年 12 月。在研究期结束时，在两次模拟中，大约 57%标记的水已经流失，41% 蒸发回到大气中，其中 2% 作为降水在多瑙河上游流域循环利用。在 WRF-Hydro-tag 中，标记水的表面蒸发因地表流渗透而略有增强，而在地形梯度较低的区域则因地下侧向水流而略有减弱。这对源降水回收的影响很小，可以忽略不计。</p><h1 id="9-2018-在美国东北部使用-WRF-Hydro-来估算小流域的水收支趋势"><a href="#9-2018-在美国东北部使用-WRF-Hydro-来估算小流域的水收支趋势" class="headerlink" title="9. 2018 -在美国东北部使用 WRF-Hydro 来估算小流域的水收支趋势"></a>9. 2018 -在美国东北部使用 WRF-Hydro 来估算小流域的水收支趋势</h1><p><a href="https://www.mdpi.com/2073-4441/10/12/1709">https://www.mdpi.com/2073-4441/10/12/1709</a></p><p>在美国东北部，气候变化将对陆地水文带来一系列影响。观察表明，上个世纪气温稳步上升，降水量也发生变化。本研究实施了天气研究和预报 (WRF)-Hydro 框架以及目前在国家水模型中使用的诺亚多参数化 (Noah-MP) 模型，以<strong>估计构成东北部水预算的不同变量的趋势</strong>美国1980年至2016年期间的数据。我们使用北美土地数据同化系统-2（NLDAS-2）气候数据作为强迫，并使用192个美国地质调查局（USGS）用于评估径流II的测量仪的地理空间属性来校准模型（量具 II) 参考站。我们使用最大三天平均流量、七天最小流量和单调五天平均时间序列来研究确定水流肯德尔-泰尔斜率的趋势。对于水预算，我们确定了降水量、地表和地下径流、蒸散量、蒸腾量、土壤湿度和积雪月值变化的肯德尔-泰尔斜率。结果表明，<strong>降水量的变化在水预算的各个组成部分中的分布并不均匀</strong>。降水量冬季减少，夏季增加，直接影响是积雪减少、蒸散量增加。土壤趋于干燥，这并不意味着入渗增加，因为地表径流聚集趋势为正，地下径流聚集趋势为负。<strong>气候变化对径流的影响被较大的区域所缓冲</strong>，这表明需要更多地关注小型流域以适应气候变化。</p><h1 id="10-2018-年喀拉拉邦洪水：气候变化视角"><a href="#10-2018-年喀拉拉邦洪水：气候变化视角" class="headerlink" title="10. 2018 年喀拉拉邦洪水：气候变化视角"></a>10. 2018 年喀拉拉邦洪水：气候变化视角</h1><p><a href="https://link.springer.com/article/10.1007/s00382-020-05123-7">https://link.springer.com/article/10.1007/s00382-020-05123-7</a></p><p>2018 年 8 月，印度喀拉拉邦遭受了长时间的强降雨，原因是月初出现低压系统，几天后又出现季风低压。由此引发的洪水导致 400 多人死亡，100 万人流离失所。在这里，天气研究和预报 (WRF) 模型的高分辨率设置（4 km）与水文模型（WRF-Hydro，以 125 m 分辨率运行）结合使用，以探索导致洪水的情况。除了控制实验之外，还<strong>通过扰动边界条件进行了两个附加实验，以模拟工业化前和 RCP8.5 背景气候中的事件</strong>。模拟降雨量与研究期间的观测结果非常吻合，并且发现，由于最近季风低压系统的减弱，在工业化前时期，降雨量会增加约 18%，但在 RCP8 中，降雨量会增加 36% .5 热带对流层湿润造成的气候。模拟的河流水流会做出相应的响应：结果显示，为该州服务的六个主要水库需要增加 34% 的容量来应对强降雨，而如果 RCP8.5 气候导致洪水放大，则需要增加 43% 的容量。进一步表明，这种未来的气候将大大扩展洪水的南部边界。因此得出的结论是，虽然迄今为止的气候变化很可能减轻了洪水的影响，但未来的气候变化可能会加剧洪水的影响。</p><h1 id="11-2023-使用集成-WRF-Hydro-模拟预测-21-世纪中叶美国东北部极端水流和内陆洪水的变化"><a href="#11-2023-使用集成-WRF-Hydro-模拟预测-21-世纪中叶美国东北部极端水流和内陆洪水的变化" class="headerlink" title="11. 2023 - 使用集成 WRF-Hydro 模拟预测 21 世纪中叶美国东北部极端水流和内陆洪水的变化"></a>11. 2023 - 使用集成 WRF-Hydro 模拟预测 21 世纪中叶美国东北部极端水流和内陆洪水的变化</h1><p><a href="https://doi.org/10.1016/j.ejrh.2023.101371" title="使用数字对象标识符的持久链接"> https://doi.org/10.1016/j.ejrh.2023.101371 </a></p><p>研究地区： 美国东北部 (NEUS)。研究重点： 我们研究了 21 世纪中叶气候变化对美国东北部降水、溪流和内陆洪水的潜在影响。在 “一切照旧 “的情景下，使用三个全球气候模型对历史时期（1995-2004 年）和未来时期（2045-2054 年）的气候进行<strong>动态降尺度预测</strong>，以 200 米的分辨率强制 WRF-Hydro 水文模型，并创建集合<strong>水文模拟</strong>。此外，还开发了一个极值模型，以<strong>预测与低频水文事件相关的风险</strong>。为该地区提供新的水文见解： 四个主要流域的研究结果表明，冬季的水文状况明显较湿，而春末夏初可能较干。预计秋季北部流域的排水量将减少，南部流域的排水量将增加。预计极端内陆洪水造成的极端流量和水深将分别增加 5-20% 和 &gt;100%。到本世纪中期，洪水泛滥的总面积可能会增加 20%。这些风险的增加可归因于：(i) 十年平均<strong>降水强度</strong>增加约 25%，十年极端降水强度增加 &gt;40%；(ii) 全年<strong>积雪</strong>供应量减少多达 30%，<strong>蒸散</strong>量增加 5-25%；(iii) 除夏季外，其他季节<strong>土壤湿度</strong>预计增加 5%。此外，冬季积雪迅速融化可能会导致<strong>河流流量</strong>峰值提前。</p><h1 id="12-2023-使用动态地面路由系统对漫滩洪水进行建模"><a href="#12-2023-使用动态地面路由系统对漫滩洪水进行建模" class="headerlink" title="12. 2023 - 使用动态地面路由系统对漫滩洪水进行建模"></a>12. 2023 - 使用动态地面路由系统对漫滩洪水进行建模</h1><p><a href="https://gfzpublic.gfz-potsdam.de/pubman/faces/ViewItemOverviewPage.jsp?itemId=item_5019836">https://gfzpublic.gfz-potsdam.de/pubman/faces/ViewItemOverviewPage.jsp?itemId=item_5019836</a></p><p>当前的洪水淹没预测模型基于非物理和水动力方法。圣维南方程源自浅水方程，通常用于动态模拟地表水流。考虑河流性质，基于圣维南方程，地表水演算过程分为河道演算和径流演算。渠道路由被建模为预定义渠道网格上的一维明渠流量，侧向流量源自地表径流路由。然而，<strong>WRF-Hydro 系统集成了动态地表水流，不允许漫滩水流返回非河道网格，限制了模拟漫滩淹没的能力</strong>。本研究提出基于一维&#x2F;二维圣维南方程对地表水流模型进行修订，以考虑渠道路由和陆路路由的优点来模拟漫滩淹没。修正后的模型不仅<strong>预测了淹没面积</strong>，而且由于洪泛区水持续时间的增加而改变了土壤湿度的空间分布。这导致沿河<strong>土壤湿度的记忆增加</strong>。该模型被应用于 2020 年夏季韩国洪水案例，当时破纪录的强降雨导致全国河流水位上升，并导致下游洪水泛滥。卫星图像用于验证数据。预计改进后的水文系统将成为建立业务洪水预警系统的基础，并为更好地预测大气模型提供改进的边界条件。</p><h1 id="13-2022-增强-WRF-Hydro-来模拟烧伤疤痕中地流和水流产生的泥石流敏感性"><a href="#13-2022-增强-WRF-Hydro-来模拟烧伤疤痕中地流和水流产生的泥石流敏感性" class="headerlink" title="13. 2022 - 增强 WRF-Hydro 来模拟烧伤疤痕中地流和水流产生的泥石流敏感性"></a>13. 2022 - 增强 WRF-Hydro 来模拟烧伤疤痕中地流和水流产生的泥石流敏感性</h1><p><a href="https://escholarship.org/uc/item/7fz7s1cv">https://escholarship.org/uc/item/7fz7s1cv</a></p><p>在陡峭的野火烧毁地区，强降雨会产生大量径流，引发极具破坏性的泥石流。然而，使用基于物理的工具准确描述和预测烧毁地区泥石流敏感性的能力仍然有限。在这里，我们增强了天气研究和预报水文建模系统（WRF-Hydro），以<strong>模拟陆上和渠道流，并评估区域范围内的火灾后泥石流敏感性</strong>。我们使用高分辨率天气雷达得出的降水和再分析数据进行后报模拟，以驱动非烧伤基线和烧伤疤痕敏感性实验。我们的模拟重点关注 2021 年 1 月，当时一条大气河在大苏尔的野火烧伤疤痕内引发了大量泥石流，其中一场烧毁了加利福尼亚州著名的 1 号高速公路。与基线相比，我们的烧伤疤痕模拟显示总排放量和峰值排放量急剧增加，降雨开始和流量峰值之间的滞后时间较短，这与美国地质调查局 (USGS) 附近水流监测站的水流观测结果一致。对于位于模拟烧伤疤痕区域的 404 个集水区，中位集水区归一化峰值流量与基线相比增加了约 450%。集<strong>水区归一化峰值流量异常高的集水区与事件后基于现场和遥感的泥石流观测结果非常吻合</strong>。我们建议，我们的区域火后泥石流敏感性分析表明，WRF-Hydro 是一种引人注目的基于物理的新型工具，其效用可以通过与沉积物侵蚀和输送模型和&#x2F;或基于集合的业务天气预报的耦合来进一步扩展。鉴于我们增强版 WRF-Hydro 的高保真性能，以及其在概率灾害预测中的潜在用途，我们主张其在火灾后水文和自然灾害评估中的持续开发和应用。</p><h1 id="14-2021-关联水文气象模型在水文预报中应用可能性的研究和评价"><a href="#14-2021-关联水文气象模型在水文预报中应用可能性的研究和评价" class="headerlink" title="14.2021 - 关联水文气象模型在水文预报中应用可能性的研究和评价"></a>14.2021 - 关联水文气象模型在水文预报中应用可能性的研究和评价</h1><p><a href="https://vjol.info.vn/index.php/TCKHBDKH/article/view/57486">https://vjol.info.vn/index.php/TCKHBDKH/article/view/57486</a></p><p>在这项研究中，分布式参数水文模型（WRF-Hydro）与数值气象模型（WRF）双向连接，以计算Luy河和Binh河子流域的短期水文预报。气象模型采用全球预报模型数据，网格分辨率分别为9 km、3 km、1 km 3个，水文模型网格分辨率为250 m。采用网格雨量数据结合地面实测雨量数据对独立水文模型进行标定和测试，取得了纳什指数0.9的高结果。然而，当实现双向连接时，流量预测质量显着下降，纳什指数达到0.5。然而，结果表明该模型对输入变化反应良好，并且流量变化对预报降雨很敏感。为保证精度并提高预报时效，在与水文模型双向对接之前，需要对气象预报结果进行研究和校准。研究中的实验表明，利用水文气象联动模型是水文预报的一个新的、可行的方向。</p><h1 id="15-2016-径流-入渗分区和已解决的地表流量对陆地-大气反馈的作用：西非-WRF-水力耦合建模系统的案例研究"><a href="#15-2016-径流-入渗分区和已解决的地表流量对陆地-大气反馈的作用：西非-WRF-水力耦合建模系统的案例研究" class="headerlink" title="15. 2016 - 径流-入渗分区和已解决的地表流量对陆地-大气反馈的作用：西非 WRF-水力耦合建模系统的案例研究"></a>15. 2016 - 径流-入渗分区和已解决的地表流量对陆地-大气反馈的作用：西非 WRF-水力耦合建模系统的案例研究</h1><p><a href="https://publikationen.bibliothek.kit.edu/1000059010">https://publikationen.bibliothek.kit.edu/1000059010</a></p><p>陆地-大气反馈的分析需要大气模型中陆地过程的详细表示。这里的重点是径流渗透分区和解决的地表径流。在 WRF 的标准版本中，径流-入渗分区被描述为纯粹的垂直过程。在 WRF-Hydro 中，横向水流增强了径流。研究区域为 Sissili 流域（12 800 平方公里）22）在西非，研究期间为2003年3月至2004年2月。这里的WRF设置包括分辨率为10公里和2公里的外部域和内部域，分别覆盖西非和西西里地区。在此 WRF-Hydro 设置中，内部域与分辨率为 500 米的子网格相结合，以<strong>计算陆上和河流流量</strong>。将模型结果与 TRMM 降水、模型树集合 (MTE) 蒸散量、气候变化倡议 (CCI) 土壤湿度、CRU 温度和水流观测进行比较。径流-入渗分配和已解决的地表流量对陆地-大气反馈的作用通过 WRF 结果对径流-入渗分配参数的敏感性分析以及 WRF 和 WRF-Hydro 结果之间的比较分别得到解决。 在外部区域，降水对西西里地区（~100 × 100 km2）规模的径流入渗分配敏感，但对 A 地区（500 × 2500 km2）不敏感。22）。在内部区域，降水模式主要由横向边界条件决定，敏感性很小，但另外解决的地面流明显增加了雨季开始时土壤仍然干燥时的渗透和蒸散。这里介绍的 WRF-Hydro 设置显示了联合大气和陆地水平衡研究的潜力，并以 0.43 的 Nash-Sutcliffe 模型效率系数重现了观测到的每日流量。</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>文献分享</tag>
      
      <tag>WRF-Hydro</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>在Ubuntu16.04中安装R和WRF-Hydro可视化工具箱rwrfhydro时可能遇到的问题汇总一</title>
    <link href="/2024/04/23/%E5%9C%A8Ubuntu16-04%E4%B8%AD%E5%AE%89%E8%A3%85R%E5%92%8CWRF-Hydro%E5%8F%AF%E8%A7%86%E5%8C%96%E5%B7%A5%E5%85%B7%E7%AE%B1rwrfhydro%E6%97%B6%E5%8F%AF%E8%83%BD%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB%E4%B8%80/"/>
    <url>/2024/04/23/%E5%9C%A8Ubuntu16-04%E4%B8%AD%E5%AE%89%E8%A3%85R%E5%92%8CWRF-Hydro%E5%8F%AF%E8%A7%86%E5%8C%96%E5%B7%A5%E5%85%B7%E7%AE%B1rwrfhydro%E6%97%B6%E5%8F%AF%E8%83%BD%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E6%B1%87%E6%80%BB%E4%B8%80/</url>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>基于WRF-Hydro包计算河道流量，整理好所需要的准备配置文件（hydro.namelist和namelist.hrldas）和数据后，需要使用命令<code>mpirun -np 8 ./wrf_hydro.exe</code>运行计算最终结果，结果变量详细介绍可查看<a href="https://ral.ucar.edu/sites/default/files/public/projects/wrf-hydro/technical-description-user-guide/outputvariablematrix-v5.2.0.pdf">WRF-Hydro v5.2 Output Variable Matrix</a>，对于输出结果可视化可使用 <a href="https://github.com/NCAR/rwrfhydro%E2%80%8B">rwrfhydro</a> 工具，该工具是基于R语言进行编写，如果使用需要在ubuntu中配置R环境，这里将在配置R环境以及安装rwrfhydro工具时可能会出现的一些问题进行简单的汇总。</p><h1 id="安装R包devtools出现错误，无法安装ragg-profvis-textshaping包"><a href="#安装R包devtools出现错误，无法安装ragg-profvis-textshaping包" class="headerlink" title="安装R包devtools出现错误，无法安装ragg,profvis,textshaping包"></a>安装R包devtools出现错误，无法安装ragg,profvis,textshaping包</h1><p>将这些R包分开进行安装，将缺失的依赖一一找到并进行安装。</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs cmake"><span class="hljs-keyword">install</span>.packages(<span class="hljs-string">&quot;ragg&quot;</span>)<br><span class="hljs-keyword">install</span>.packages(<span class="hljs-string">&quot;profvis&quot;</span>)<br><span class="hljs-keyword">install</span>.packages(<span class="hljs-string">&quot;textshaping&quot;</span>)<br><br></code></pre></td></tr></table></figure><p>可能遇到的详细安装报错信息查看下文。</p><h1 id="安装rwrfhydro包提示GDAL版本低于2-0-1，需要更新"><a href="#安装rwrfhydro包提示GDAL版本低于2-0-1，需要更新" class="headerlink" title="安装rwrfhydro包提示GDAL版本低于2.0.1，需要更新"></a>安装rwrfhydro包提示GDAL版本低于2.0.1，需要更新</h1><p>参考博客<a href="https://zhuanlan.zhihu.com/p/447664123">Ubuntu 安装 GDAL 2.1</a>进行更新，具体操作如下。</p><figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs smali">sudo<span class="hljs-built_in"> add-apt-repository </span>-y ppa:ubuntugis/ppa<br>sudo apt update<br>sudo apt upgrade<br><br>apt install gdal-bin libgdal-dev<br><br></code></pre></td></tr></table></figure><p>安装完成后，使用<code>gdalinfo --version</code>查看版本。</p><h1 id="安装R包raster报错C-17"><a href="#安装R包raster报错C-17" class="headerlink" title="安装R包raster报错C++17"></a>安装R包raster报错C++17</h1><p>参考博客<a href="https://www.omicsclass.com/article/2313">安装R包报错C++17</a>进行修改，具体操作如下。</p><p>这个是GCC版本问题;设置一下用新版本就行了。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">mkdir</span> -p ~/.R<br><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;CXX17 = g++ -std=c++17 -fPIC&#x27;</span> &gt; ~/.R/Makevars<br></code></pre></td></tr></table></figure><h1 id="安装R包ragg配置错误"><a href="#安装R包ragg配置错误" class="headerlink" title="安装R包ragg配置错误"></a>安装R包ragg配置错误</h1><p>报错<stdin>:1:22: fatal error: ft2build.h: 没有那个文件或目录</p><p>解决方法：安装该R包所需要的相关依赖和库，可通过查看报错信息找到必须的库进行安装。我的系统为Ubuntu系统，因此选择安装deb包进行安装。</p><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs q">sudo apt libfreetype6-<span class="hljs-built_in">dev</span> libpng-<span class="hljs-built_in">dev</span> libtiffs-<span class="hljs-built_in">dev</span> libjpeg-<span class="hljs-built_in">dev</span><br></code></pre></td></tr></table></figure><h1 id="安装R包ggmap报错dependency-png’-isnot-available-for-package-‘ggmap’"><a href="#安装R包ggmap报错dependency-png’-isnot-available-for-package-‘ggmap’" class="headerlink" title="安装R包ggmap报错dependency png’ isnot available for package ‘ggmap’"></a>安装R包ggmap报错dependency png’ isnot available for package ‘ggmap’</h1><p>该错误信息说明缺少系统软件包libpng，或需要升级。</p><p>解决方法</p><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs q"><br>sudo apt-<span class="hljs-built_in">get</span> <span class="hljs-keyword">update</span><br>sudo apt-<span class="hljs-built_in">get</span> install libpng-<span class="hljs-built_in">dev</span><br><br></code></pre></td></tr></table></figure><h1 id="安装R包ggmap提示libpng16-so-16：无法打开共享对象文件-没有那个文件或目录"><a href="#安装R包ggmap提示libpng16-so-16：无法打开共享对象文件-没有那个文件或目录" class="headerlink" title="安装R包ggmap提示libpng16.so.16：无法打开共享对象文件: 没有那个文件或目录"></a>安装R包ggmap提示libpng16.so.16：无法打开共享对象文件: 没有那个文件或目录</h1><p>参考<a href="https://blog.csdn.net/qq_38402294/article/details/112629389">博客</a>进行对应库的安装。ubuntu系统可直接进行安装。</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">sudo apt-<span class="hljs-built_in">get</span> install libpng16-16<br></code></pre></td></tr></table></figure><h1 id="安装R包textshaping配置错误"><a href="#安装R包textshaping配置错误" class="headerlink" title="安装R包textshaping配置错误"></a>安装R包textshaping配置错误</h1><p>报错<stdin>:1:19: fatal error: hb-ft.h: 没有那个文件或目录</p><p>解决方法：安装该R包所需要的相关依赖和库，可通过查看报错信息找到必须的库进行安装。我的系统为Ubuntu系统，因此选择安装deb包进行安装。</p><figure class="highlight q"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs q">sudo apt-<span class="hljs-built_in">get</span> install libharfbuzz-<span class="hljs-built_in">dev</span> libfribidi-<span class="hljs-built_in">dev</span><br></code></pre></td></tr></table></figure><h1 id="安装R包profvis配置错误"><a href="#安装R包profvis配置错误" class="headerlink" title="安装R包profvis配置错误"></a>安装R包profvis配置错误</h1><p>报错信息与安装R包textshaping相同，可参照安装R包textshaping时的解决方案进行修改。</p><h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>rwrfhydro在使用中脚本有诸多限制，可能会出现较多问题，且利用R语言进行地学制图美观性较差，绘图建议使用<a href="https://www.ncl.ucar.edu/Download/">NCL</a>，可视化可使用<a href="https://downloads.unidata.ucar.edu/idv/">IDV</a>或<a href="https://www.giss.nasa.gov/tools/panoply/download/">Panoply</a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WRF-Hydro5.2.0</tag>
      
      <tag>R</tag>
      
      <tag>toolkit</tag>
      
      <tag>Ubuntu16.04</tag>
      
      <tag>GDAL</tag>
      
      <tag>rwrfhydro</tag>
      
      <tag>错误总结</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>安装使用WRF Hydro GIS Pre-Processing Tools</title>
    <link href="/2024/04/03/%E5%A6%82%E4%BD%95%E5%9C%A8ubuntu16-04%E4%B8%8A%E5%AE%89%E8%A3%85WRF-Hydro-GIS-Pre-Processing-Tools5-2-0/"/>
    <url>/2024/04/03/%E5%A6%82%E4%BD%95%E5%9C%A8ubuntu16-04%E4%B8%8A%E5%AE%89%E8%A3%85WRF-Hydro-GIS-Pre-Processing-Tools5-2-0/</url>
    
    <content type="html"><![CDATA[<p>WRF Hydro GIS Pre-Processing Tools5.2.0版本包含与 WRF-Hydro v5.2.0 兼容的 GIS 预处理工具，并包含对上一版本的错误修复。支持的 ArcGIS 版本包括 10.3-10.8 和 ArcGIS Pro 2.3-2.8。点击查看对应版本的<a href="https://singyutang.github.io/2024/03/17/%E5%A6%82%E4%BD%95%E5%9C%A8ubuntu16-04%E4%B8%8A%E5%AE%89%E8%A3%85%E7%BC%96%E8%AF%91WRF4-5-2%E3%80%81WRF-hydro5-2-0%E5%92%8CWPS4-5-0/">WRF、WPS</a>及<a href="https://singyutang.github.io/2024/03/23/%E5%A6%82%E4%BD%95%E5%9C%A8ubuntu16-04%E4%B8%8A%E5%AE%89%E8%A3%85%E7%BC%96%E8%AF%91WRF-Hydro5-2-0/">WRF-Hydro</a>的安装。</p><h1 id="1-软件下载"><a href="#1-软件下载" class="headerlink" title="1.软件下载"></a>1.软件下载</h1><p><a href="https://github.com/NCAR/wrf_hydro_arcgis_preprocessor.git">WRF Hydro GIS Pre-Processing Tools工具包下载及教程(not the 5.2.0 release)</a><br><a href="https://malagis.com/arcgis-pro-2-8-3-full-installation-tutorial.html">ArcGIS Pro 2.8.3软件下载及安装教程</a></p><p>待更新……</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WRF-Hydro5.2.0</tag>
      
      <tag>软件安装</tag>
      
      <tag>WRF4.5.2</tag>
      
      <tag>WPS4.5.0</tag>
      
      <tag>WRF Hydro GIS Pre-Processing Tools</tag>
      
      <tag>tooklkit</tag>
      
      <tag>ArcGIS Pro</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>利用GAMMA进行InSAR处理中的一些脚本分享</title>
    <link href="/2024/04/01/%E5%88%A9%E7%94%A8GAMMA%E8%BF%9B%E8%A1%8CInSAR%E5%A4%84%E7%90%86%E4%B8%AD%E7%9A%84%E4%B8%80%E4%BA%9B%E8%84%9A%E6%9C%AC%E5%88%86%E4%BA%AB/"/>
    <url>/2024/04/01/%E5%88%A9%E7%94%A8GAMMA%E8%BF%9B%E8%A1%8CInSAR%E5%A4%84%E7%90%86%E4%B8%AD%E7%9A%84%E4%B8%80%E4%BA%9B%E8%84%9A%E6%9C%AC%E5%88%86%E4%BA%AB/</url>
    
    <content type="html"><![CDATA[<ol><li>对<a href="/downloads/杨红磊SBAS时序处理.txt" download>杨红磊SBAS时序处理</a>加入了干涉图生成步骤，包含SBAS-InSAR处理的完整脚本 <code>HL_Yang_SBASInSAR</code></li></ol><p>remk_diff_bash脚本下载链接：<a href="/downloads/HL_Yang_SBASInSAR" download>HL_Yang_SBASInSAR</a></p><ol start="2"><li>使用GAMMA运行<code>mk_diff_2d</code>命令生成干涉对时，可能会因为一些其他原因影响造成程序中断，此时又不想再从头生成，就可以使用脚本 <code>remk_diff_bash</code></li></ol><p>remk_diff_bash脚本下载链接：<a href="/downloads/remk_diff_bash" download>remk_diff_bash</a></p><ol start="3"><li>批量生成los向累计形变图脚本，<code>gen_losdef_batch</code></li></ol><p>gen_losdef_batch脚本下载链接：<a href="/downloads/gen_losdef_batch" download>gen_losdef_batch</a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>InSAR</tag>
      
      <tag>SBAS-InSAR</tag>
      
      <tag>Sentinel-1</tag>
      
      <tag>脚本</tag>
      
      <tag>Ubuntu16.04</tag>
      
      <tag>GAMMA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>GRACE文献调研</title>
    <link href="/2024/04/01/GRACE%E6%96%87%E7%8C%AE%E8%B0%83%E7%A0%94/"/>
    <url>/2024/04/01/GRACE%E6%96%87%E7%8C%AE%E8%B0%83%E7%A0%94/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>GRACE</tag>
      
      <tag>文献分享</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>洪水预报文献调研</title>
    <link href="/2024/03/31/%E6%B4%AA%E6%B0%B4%E9%A2%84%E6%8A%A5%E6%96%87%E7%8C%AE%E8%B0%83%E7%A0%94/"/>
    <url>/2024/03/31/%E6%B4%AA%E6%B0%B4%E9%A2%84%E6%8A%A5%E6%96%87%E7%8C%AE%E8%B0%83%E7%A0%94/</url>
    
    <content type="html"><![CDATA[<h1 id="1-2023-使用贝叶斯模型平均进行洪水预报的预处理和后处理"><a href="#1-2023-使用贝叶斯模型平均进行洪水预报的预处理和后处理" class="headerlink" title="*1. 2023 -  使用贝叶斯模型平均进行洪水预报的预处理和后处理"></a>*1. 2023 -  使用贝叶斯模型平均进行洪水预报的预处理和后处理</h1><p><a href="https://www.duo.uio.no/handle/10852/105095">https://www.duo.uio.no/handle/10852/105095</a></p><p>在这项研究中，对水文集合预报的预处理和后处理进行了评估，特别关注挪威 119 个流域的洪水。 ECMWF 两年的温度和降水集合预报（提前期长达 9 天）被用来迫使业务水文 HBV 模型建立<strong>径流预报</strong>。<strong>贝叶斯模型平均处理方法应用于预处理温度和降水预报以及后处理水流预报</strong>。基于原始、预处理和后处理预测的组合，为八个方案生成了集合水流预测。使用两个数据集来评估预测：(i) 所有水流预测和 (ii) 水流高于年平均洪水的洪水事件预测。基于所有径流数据的评估表明，后处理仅将预报改善了 2-3 天的提前时间，而<strong>预处理温度和降水则将 50-90% 的流域的预报改善了 3 天的提前时间</strong>。我们发现春季和秋季洪水预警的能力存在很大差异。对于许多事件和流域来说，春季洪水的预测时间长达 9 天，而预测秋季洪水超过 3 天的能力则微乎其微。</p><h1 id="2-2015-使用次季节到季节-S2S-极端降雨量预报来预测澳大利亚的长期洪水"><a href="#2-2015-使用次季节到季节-S2S-极端降雨量预报来预测澳大利亚的长期洪水" class="headerlink" title="2. 2015 - 使用次季节到季节 (S2S) 极端降雨量预报来预测澳大利亚的长期洪水"></a>2. 2015 - 使用次季节到季节 (S2S) 极端降雨量预报来预测澳大利亚的长期洪水</h1><p><a href="https://strathprints.strath.ac.uk/62247/">https://strathprints.strath.ac.uk/62247/</a></p><p>世界各地的气象和水文中心正在寻找提高其能力的方法，以便能够在一系列预测时间尺度（例如次日、日、多日）内对高影响的极端降雨和洪水事件进行熟练且可靠的预报。 -周，季节性）。改进大范围降雨和洪水预报模型，评估预报技巧和不确定性，探索如何应用洪水预报并向决策者传达其好处，是预报和水资源管理界面临的重大挑战。本文介绍了澳大利亚在扩展“次季节到季节”（S2S）预报时间尺度上的极端降雨和洪水预报的开发、应用和交流方面的一些最新科学和举措，重点是基于风险的预测决策、提高洪水风险意识和准备、捕捉不确定性、了解人类对洪水预报和预警的反应以及越来越多地采用“气候服务”。该论文还展示了对一系列预测时间尺度的洪水事件的预测如何有益于一系列部门和社会，尤其是有利于减少灾害风险（DRR）活动、应急管理和响应以及增强社区复原力。扩展范围的 S2S 极端洪水预报如果以易于获取、及时和相关的信息形式呈现，将成为帮助社会更好地准备和应对极端洪水事件的宝贵资源。</p><h1 id="3-2017-基于监督机器学习的气象集合预报成员评估和加权及其在径流模拟和洪水预警中的应用"><a href="#3-2017-基于监督机器学习的气象集合预报成员评估和加权及其在径流模拟和洪水预警中的应用" class="headerlink" title="3. 2017 - 基于监督机器学习的气象集合预报成员评估和加权及其在径流模拟和洪水预警中的应用"></a>3. 2017 - 基于监督机器学习的气象集合预报成员评估和加权及其在径流模拟和洪水预警中的应用</h1><p><a href="https://eprints.nottingham.ac.uk/38789/">https://eprints.nottingham.ac.uk/38789/</a></p><p>数值天气预报，例如降水的气象预报，本质上是不确定的。这些不确定性取决于模型物理以及初始条件和边界条件。由于降水预报是水文模型的输入，降水预报的不确定性导致洪水预报的不确定性。为了考虑这些不确定性，应用了集合预测系统。这些系统由多个成员组成，这些成员通过不同的模型进行模拟，或者在不同的初始和边界条件下使用单个模型进行模拟。然而，由于考虑到预测能力较差的成员而获得的不确定性范围过大，可能会导致低估或夸大危险事件的风险。因此，基于气象集合的模型洪水预报的不确定性范围必须受到限制。  </p><p>本文提出了一种<strong>通过根据集合成员的技能进行加权来改进洪水预报</strong>的方法。<strong>通过将与该成员相对应的预测结果与过去的观测值进行比较来评估每个集成成员的技能</strong>。由于需要进行大量预测才能可靠地评估技能，因此评估过程既耗时又乏味。此外，评估是高度主观的，因为执行评估的专家是根据他的隐性知识做出决定的。  </p><p>因此，需要自动评估此类预测的方法。在这里，我们提出了一种用于评估降水预报集合成员的半自动化方法。该方法基于监督机器学习，并在德国穆尔德河流域地区的集合降水预报中进行了测试。<strong>根据特定集合成员的评估结果，计算出与其预测技能相对应的权重。这些权重随后被成功用于减少降雨径流模拟和洪水风险预测中的不确定性。</strong></p><h1 id="4-2020-使用集合重新预测生成洪水阈值以改进全球洪水预报"><a href="#4-2020-使用集合重新预测生成洪水阈值以改进全球洪水预报" class="headerlink" title="4. 2020 - 使用集合重新预测生成洪水阈值以改进全球洪水预报"></a>4. 2020 - 使用集合重新预测生成洪水阈值以改进全球洪水预报</h1><p><a href="https://onlinelibrary.wiley.com/doi/10.1111/jfr3.12658">https://onlinelibrary.wiley.com/doi/10.1111/jfr3.12658</a></p><p>全球洪水预报系统依靠预先定义的洪水阈值来突出显示即将发生的潜在洪水事件。现有的洪水阈值定义方法通常基于在所有预测提前时间内使用单一阈值的再分析数据集，例如在全球洪水意识系统中。这导致洪水阈值和集合预报中极端洪水事件的表示方式不一致。本文探讨了使用河流流量集合重新预测来生成洪水阈值的潜在好处，该阈值可以提高可靠性和技能，从而增加人道主义和民防合作伙伴对预测的信心。用于重新分析和重新预测的阈值计算中用于采样年度最大值的数据集和方法的选择是根据阈值大小、预测可靠性以及不同洪水严重程度和提前时间的技能进行分析的。当根据不同的年度最大值样本估计时，阈值幅度的可变性可能非常大，随后对预报技能的影响也可能非常大。基于重新分析的阈值仅应在最初几天使用，之后基于集合重新预测的阈值随预报提前时间而变化，并且可以考虑预报偏差趋势，从而提供更可靠和更有技巧的洪水预报。</p><h1 id="5-2019-气象研究与降水预报驱动的分布式网格新安江模型洪水预报能力评价"><a href="#5-2019-气象研究与降水预报驱动的分布式网格新安江模型洪水预报能力评价" class="headerlink" title="5. 2019 - 气象研究与降水预报驱动的分布式网格新安江模型洪水预报能力评价"></a>5. 2019 - 气象研究与降水预报驱动的分布式网格新安江模型洪水预报能力评价</h1><p><a href="https://doi.org/10.1111/jfr3.12544" title="Open link in new tab"> https://dx.doi.org/10.1111/jfr3.12544 </a></p><p>业务洪水预报的提前时间对于洪水警报和降低洪水风险的有效性至关重要。仅仅依靠雨量计观测不可能延长洪水预报的提前时间。然而，天气研究和预报（WRF）模型具有产生定量降水预报的潜力，可以通过增加洪水预报提前时间来促进洪水风险管理。本研究分别在<strong>仪表观测和 WRF 降水预报的驱动</strong>下，研究了经过充分测试的<strong>网格新安江模型 (GXM) 在位于淮河流域上游的洪水易发地区的洪水预测能力</strong>。结果表明，GXM 能够利用 WRF 降水预报来改进洪水预报。利用仪表测量的降水量很难提前预测来洪水，特别是当提前时间大于流量集中时间时。然而，通过 WRF预报，可以在更长的时间内预测洪水事件的发生。这项研究还表明，降水预报的时间和空间模式对洪水到来的时间和强度的预测具有重要影响。</p><h1 id="6-2018-近实时同化-SAR-衍生洪水图以改进洪水预报"><a href="#6-2018-近实时同化-SAR-衍生洪水图以改进洪水预报" class="headerlink" title="*6. 2018 - 近实时同化 SAR 衍生洪水图以改进洪水预报"></a>*6. 2018 - 近实时同化 SAR 衍生洪水图以改进洪水预报</h1><p><a href="https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2017WR022205">https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2017WR022205</a></p><p>中短期洪水预报对于预测和减轻全球洪水影响至关重要。然而，进行可靠的预测并减少预测的不确定性仍然具有挑战性，特别是在测量不佳的河流流域。合成孔径雷达 (SAR) 衍生的洪水图像数据库（例如，由 Envisat 高级合成孔径雷达等 SAR 传感器生成）的可用性不断增加，为提高洪水预报质量提供了机会。这项研究有助于开发更准确的全球和近实时基于遥感的洪水预报服务，以支持洪水管理。我们利用最新的算法，<strong>使用 SAR 图像高效、自动地描绘洪水范围，并证明对 SAR 得出的洪水范围进行近实时顺序同化可以显着改善洪水预报</strong>。介绍了基于塞文河（英国）四次洪水事件的案例研究。预报系统包括SUPERFLEX水文模型和Lisflood-FP水力模型。使用粒子滤波器同化 SAR 图像。为了量化观测不确定性作为数据同化的一部分，我们使用图像处理方法，根据每个像素的反向散射值分配_被淹没的概率_。经验结果表明，SAR 得出的洪水范围图的连续同化导致水位预测的显着改善。在同化时间步长中，预测误差减少了 50%，并且在随后的 24 至 48 小时的时间步长中，改进持续存在。所提出的方法有望改善观测数据可用性有限但存在卫星覆盖的地点的洪水预报。</p><h1 id="7-2022-使用概念水文模型和机器学习技术进行短期洪水概率密度预测"><a href="#7-2022-使用概念水文模型和机器学习技术进行短期洪水概率密度预测" class="headerlink" title="*7. 2022 - 使用概念水文模型和机器学习技术进行短期洪水概率密度预测"></a>*7. 2022 - 使用概念水文模型和机器学习技术进行短期洪水概率密度预测</h1><p><a href="https://doi.org/10.1016/j.jhydrol.2021.127255" title="Persistent link using digital object identifier"> https://doi.org/10.1016/j.jhydrol.2021.127255 </a></p><p>对洪水过程进行准确可靠的概率密度预测对于机器学习技术来说是一个根本性的挑战，特别是当预测目标超出训练数据范围时。概念水文模型可以通过有效的准物理机制减少降雨径流建模误差。单调复合分位数回归神经网络（MCQRNN）首次用于洪水过程的概率密度预测并作为基准模型，但它面临着过度拟合和预测偏差的缺点。在这里，我们提出了一种集成模型（即 XAJ-MCQRNN），该模型结合了新安江概念模型（XAJ）和 MCQRNN，以克服多步提前洪水概率密度预报中遇到的误差传播和累积现象。我们将洪水预报视为降雨因素和径流数据的函数。该模型根据中国涧西河流域的长期（2009-2015）3 小时径流系列和欧洲中期天气预报中心的降雨产品进行评估。结果表明，所提出的 XAJ-MCQRNN 模型不仅优于 MCQRNN 模型，而且显着提高了洪水过程多步提前概率密度预报的准确性和可靠性。对于四个阶段测试阶段的短期预测，与 MCQRNN 模型相比，XAJ-MCQRNN 模型实现了更高的纳什-萨特克利夫效率和更低的均方根误差值，同时提高了覆盖率和相对带宽值。因此，这一改进有利于减轻与极端洪水和降雨事件的不确定性相关的影响，并提高洪水预报和预警的准确性和可靠性。</p><h2 id="强调"><a href="#强调" class="headerlink" title="强调"></a>强调</h2><ul><li><p>机器学习辅助混合模型促进洪水预报预警。</p></li><li><p>将 MCQRNN 与 XAJ 模型混合进行洪水概率密度预测。</p></li><li><p>XAJ-MCQRNN 克服了过度拟合和偏差预测瓶颈。</p></li><li><p>XAJ-MCQRNN 提高了洪水概率密度预报的准确性和可靠性。</p></li></ul><h1 id="8-2020-使用根据有限流量数据和不确定降雨情景校准的参数进行洪水预测"><a href="#8-2020-使用根据有限流量数据和不确定降雨情景校准的参数进行洪水预测" class="headerlink" title="8. 2020 - 使用根据有限流量数据和不确定降雨情景校准的参数进行洪水预测"></a>8. 2020 - 使用根据有限流量数据和不确定降雨情景校准的参数进行洪水预测</h1><p><a href="https://kau.diva-portal.org/smash/record.jsf?pid=diva2:1438259&dswid=-9544">https://kau.diva-portal.org/smash/record.jsf?pid=diva2%3A1438259&amp;dswid=-9544</a></p><p>流量观测和可靠的降雨预报对于洪水预测至关重要，但其可用性和准确性往往有限。然而，即使数据稀缺，仍然可以做出充分的洪水预报。在这里，我们探讨了使用有限的流量校准数据和不确定的强迫数据会对模拟热带盆地洪水的桶型水文模型的性能产生多大影响。校准中使用了发生频率高和低的三个高于阈值的事件，并使用 81 个具有不同不确定度的降雨情景作为输入，以评估其对洪水预测的影响。当使用基于几个高于不同阈值的事件的校准参数时，发现了相对相似的模型性能。洪水预测对降雨误差很敏感，但与雨量相关的误差影响更大。这项研究的结果表明，在降雨预报不确定的情况下，有限数量的事件可用于预测洪水。</p><h1 id="9-2023-斯里兰卡卡卢河流域开发综合洪水信息系统的多平台数据研究"><a href="#9-2023-斯里兰卡卡卢河流域开发综合洪水信息系统的多平台数据研究" class="headerlink" title="9. 2023 - 斯里兰卡卡卢河流域开发综合洪水信息系统的多平台数据研究"></a>9. 2023 - 斯里兰卡卡卢河流域开发综合洪水信息系统的多平台数据研究</h1><p><a href="https://www.mdpi.com/2073-4441/15/6/1199">https://www.mdpi.com/2073-4441/15/6/1199</a></p><p>洪水预警系统（FEWS）对于洪水风险管理至关重要；然而，发展中国家的一些流域在FEWS的各个方面仍然远远落后，由于数据、知识和技术的限制，它们经常遭受毁灭性的​​破坏。本文通过结合当今的多平台数据和技术（例如地面和卫星降雨观测、集合降雨预报和洪水模拟），提出了一个流域规模的综合洪水信息系统，并评估了其在测量不准确的原型流域中的性能。即卡卢河流域）。实时（GSMaP-NOW）和近实时（GSMaP-NRT）获得的<strong>卫星降雨产品可以很好地检测强降雨事件，偏差校正产品可以进一步改进降雨估算和洪水模拟</strong>。特别是，GSMaP-NRT 在<strong>降雨量和流量估计</strong>方面均优于 GMap-NOW，适用于近实时洪水相关应用。集合降雨预报在预测强降雨和洪峰警报信号方面表现出良好的性能，但事件的数量和时间具有不确定性。从卫星和集合预报中获得的关于强降雨、模拟洪水信号及其可能的概率范围的信息很有前景，可以帮助最大限度地减少数据差距，并提高专家和政策制定者在测量不佳的流域的知识和技术。</p><h1 id="10-2021-评估国家气象局洪水预报修正过程的技术"><a href="#10-2021-评估国家气象局洪水预报修正过程的技术" class="headerlink" title="*10. 2021 - 评估国家气象局洪水预报修正过程的技术"></a>*10. 2021 - 评估国家气象局洪水预报修正过程的技术</h1><p><a href="https://doi.org/10.1016/j.hydroa.2020.100073" title="使用数字对象标识符的持久链接"> https://doi.org/10.1016/j.Hydra.2020.100073 </a></p><h2 id="抽象的"><a href="#抽象的" class="headerlink" title="抽象的"></a>抽象的</h2><p>美国国家气象局 (NWS) 的业务水文学家制定河流预报，为面临洪水损害风险的人们提供指导，并在获得更多信息时实时更新这些洪水预报。为此，他们依靠经验和直觉来调整水文模型的输入、状态变量和参数。 NWS 水文学家使用术语“修饰符”来统指这些调整。本文展示了工具（统计和图形）的开发和应用，以帮助业务水文学家实现准确的洪水预报。<strong>方差分析 (ANOVA) 确定每个修正因素对预测不确定性的相对贡献</strong>。热图可视化为业务水文学家展示了其修改器选择的流域、提前时间和特定季节的影响。这些工具使水文学家能够<strong>深入了解三种常用的修正因子（降水量、土壤湿度和单位过程线形状）中哪一种最有可能提高洪水预报的准确性</strong>。这些工具通过使用 1990 年至 2018 年洪水事件采样数据对俄亥俄河流域四个流域进行案例研究进行了演示。这项研究的结果表明，俄亥俄河流域的业务水文学家可以很好地应用不修正的方法冬季（将水文输入变量和参数保留在基线值）。尽管夏季月份单位过程线的实时调整可能会改善预测，但无法自信地提出特定单位过程线修改水平的建议。这些发现对改性剂调整程序作为标准过程提出了质疑。在评估的案例中，修正器并没有系统地改善洪水预报。通过更好地校准水文模型或减少降水不确定性的技术，可以更有效地实现改进。</p><p>强调</p><ul><li><p>改进国家气象局实时<a href="https://www.sciencedirect.com/topics/earth-and-planetary-sciences/flood-forecast" title="从 ScienceDirect 的 AI 生成的主题页面了解有关洪水预报的更多信息">洪水预报的方法。</a></p></li><li><p>方差分析以识别主要误差源。</p></li><li><p>热图可帮助业务水文学家选择预报修正值。</p></li></ul><h1 id="11-2023-深度学习应用的最新技术、挑战和未来前景：洪水预报和管理的全面回顾"><a href="#11-2023-深度学习应用的最新技术、挑战和未来前景：洪水预报和管理的全面回顾" class="headerlink" title="11. 2023 - 深度学习应用的最新技术、挑战和未来前景：洪水预报和管理的全面回顾"></a>11. 2023 - 深度学习应用的最新技术、挑战和未来前景：洪水预报和管理的全面回顾</h1><p><a href="https://www.mdpi.com/2071-1050/15/13/10543">https://www.mdpi.com/2071-1050/15/13/10543</a></p><p>洪水是一种毁灭性的自然灾害，可能严重损害基础设施和人民。准确的洪水预报和控制对于减轻这些影响和保护民众至关重要。通过利用其处理大量数据并提供准确预测的能力，深度学习已成为改善洪水预测和控制的有力工具。这项工作全面回顾了深度学习在洪水预报和管理中应用的现状。该评论讨论了各种主题，例如所使用的数据源、所使用的深度学习模型以及判断其有效性所采用的评估措施。它批判性地评估了当前的方法并指出了它们的优点和缺点。本文还探讨了数据可访问性、深度学习模型的可解释性以及洪水预测中的伦理考虑方面的挑战。该报告还描述了深度学习研究的潜在方向，以加强洪水预测和控制。将不确定性估计纳入预测、集成许多数据源、开发将深度学习与其他方法相结合的混合模型以及增强深度学习模型的可解释性只是其中的一些。这些研究目标可以帮助深度学习模型变得更加精确和有效，从而产生更好的防洪计划和预测。总体而言，这篇综述对于从事洪水预报和管理主题的学者和专业人士来说是一个有用的资源。通过回顾当前的研究现状，强调困难，并概述未来研究的潜在领域，奠定了坚实的基础。通过实施尖端的深度学习算法，社区可以更好地准备并减轻洪水的破坏性影响，从而保护人员和基础设施。</p><h1 id="12-2018-利用-WRF-降水进行径流预测，用于热带山区洪水预警"><a href="#12-2018-利用-WRF-降水进行径流预测，用于热带山区洪水预警" class="headerlink" title="12. 2018 # 利用 WRF 降水进行径流预测，用于热带山区洪水预警"></a>12. 2018 # 利用 WRF 降水进行径流预测，用于热带山区洪水预警</h1><p><a href="https://hess.copernicus.org/articles/22/853/2018/">https://hess.copernicus.org/articles/22/853/2018/</a></p><p>数值天气预报 (NWP) 模型是将预报提前时间延长到流域集中时间之外的基础。特别是对于热带山地流域的山洪预报，需要预报降水以提供及时预警。本文旨在<strong>评估数值天气预报在热带山区洪水预警方面的潜力，以及偏差校正可能带来的改进</strong>。本文重点讨论从后处理的降水预报中获得的水流的比较，特别是集合预报的比较及其在提供熟练洪水预报方面的潜力。天气研究和预报 (WRF) 模型用于生成降水预报，这些预报经过后处理并用于驱动水文模型。从<strong>水文模型获得的流量预测用于评估 WRF 模型的技能</strong>。结果表明，与零降水预报相比，后处理的 WRF 降水为洪水预警系统增加了价值，尽管本分析中使用的降水预报与气候学相比几乎没有增加价值。然而，从后处理集合中获得的偏差的减少表明了该方法和模型在热带山区流域提供可用降水预报的潜力。强调需要对研究区域的 WRF 模型进行更详细的评估，特别是确定最合适的参数化，因为该模型无法充分代表研究区域发现的对流降水。</p><h1 id="13-2017-基于监督机器学习的气象集合预报成员评估和加权及其在径流模拟和洪水预警中的应用"><a href="#13-2017-基于监督机器学习的气象集合预报成员评估和加权及其在径流模拟和洪水预警中的应用" class="headerlink" title="*13. 2017 - 基于监督机器学习的气象集合预报成员评估和加权及其在径流模拟和洪水预警中的应用"></a>*13. 2017 - 基于监督机器学习的气象集合预报成员评估和加权及其在径流模拟和洪水预警中的应用</h1><p><a href="https://eprints.nottingham.ac.uk/38789/">https://eprints.nottingham.ac.uk/38789/</a></p><p>数值天气预报，例如降水的气象预报，本质上是不确定的。这些不确定性取决于模型物理以及初始条件和边界条件。由于降水预报是水文模型的输入，降水预报的不确定性导致洪水预报的不确定性。为了考虑这些不确定性，应用了集合预测系统。这些系统由多个成员组成，这些成员通过不同的模型进行模拟，或者在不同的初始和边界条件下使用单个模型进行模拟。然而，由于考虑到预测能力较差的成员而获得的不确定性范围过大，可能会导致低估或夸大危险事件的风险。因此，基于气象集合的模型洪水预报的不确定性范围必须受到限制。  </p><p>本文提出了一种<strong>通过根据集合成员的技能进行加权来改进洪水预报</strong>的方法。<strong>通过将与该成员相对应的预测结果与过去的观测值进行比较来评估每个集成成员的技能</strong>。由于需要进行大量预测才能可靠地评估技能，因此评估过程既耗时又乏味。此外，评估是高度主观的，因为执行评估的专家是根据他的隐性知识做出决定的。  </p><p>因此，需要自动评估此类预测的方法。在这里，我们提出了一种用于评估降水预报集合成员的半自动化方法。该方法基于监督机器学习，并在德国穆尔德河流域地区的集合降水预报中进行了测试。<strong>根据特定集合成员的评估结果，计算出与其预测技能相对应的权重。这些权重随后被成功用于减少降雨径流模拟和洪水风险预测中的不确定性。</strong></p><h1 id="14-2021-确定子流域的洪水概率和优先级：博弈论与机器学习的比较"><a href="#14-2021-确定子流域的洪水概率和优先级：博弈论与机器学习的比较" class="headerlink" title="14. 2021 - 确定子流域的洪水概率和优先级：博弈论与机器学习的比较"></a>14. 2021 - 确定子流域的洪水概率和优先级：博弈论与机器学习的比较</h1><p><a href="https://www.sciencedirect.com/science/article/abs/pii/S0301479721011026">https://www.sciencedirect.com/science/article/abs/pii/S0301479721011026</a></p><p>洪水常常严重<a href="https://www.sciencedirect.com/topics/earth-and-planetary-sciences/anthropogenic-effect" title="从 ScienceDirect 的 AI 生成的主题页面了解有关影响人类的更多信息">影响人类的</a> 生命、财产和活动。根据洪水概率确定区域内优先缓解区域对于减少损失至关重要。在这项研究中，使用了两种<a href="https://www.sciencedirect.com/topics/earth-and-planetary-sciences/game-theory" title="从 ScienceDirect 的 AI 生成的主题页面了解有关博弈论的更多信息">博弈论</a>(GT) 算法（Borda 和 Condorcet）来确定伊朗塔詹流域最有可能发生洪水的区域，以及两种机器学习模型（随机森林 (RF) 和人工<a href="https://www.sciencedirect.com/topics/social-sciences/neural-network" title="从 ScienceDirect 的 AI 生成的主题页面了解有关神经网络的更多信息">神经网络）网络</a>（ANN）——用于模拟洪水概率（洪水的概率）。十二个自变量（坡度、坡向、高程、地形位置指数 (TPI)、地形湿度指数 (TWI)、地形崎岖指数 (TRI)、土地利用、土壤、<a href="https://www.sciencedirect.com/topics/earth-and-planetary-sciences/petrography" title="从 ScienceDirect 的 AI 生成的主题页面了解有关岩性的更多信息">岩性</a>、降雨量、排水密度和距河流的距离）和 263 <a href="https://www.sciencedirect.com/topics/social-sciences/flood" title="从 ScienceDirect 的 AI 生成的主题页面了解有关洪水的更多信息">洪水</a> 的位置被用来建模和准备洪水概率图。 RF 模型（AUC &#x3D; 0.949）比<a href="https://www.sciencedirect.com/topics/engineering/artificial-neural-network-model" title="从 ScienceDirect 的 AI 生成的主题页面了解有关 ANN 模型的更多信息">ANN 模型</a>（AUC &#x3D; 0.888）更准确。计算所有因素的频率比 (FR)，以确定哪些因素对洪水概率<a href="https://www.sciencedirect.com/topics/social-sciences/influencer" title="详细了解 ScienceDirect 的 AI 生成主题页面的影响力">影响</a> 最大。对每个子流域影响洪水概率的十二个因素的值进行了估计。然后，使用博弈论算法根据洪水概率对子流域进行优先排序。<a href="https://www.sciencedirect.com/topics/engineering/pairwise-comparison" title="从 ScienceDirect 的 AI 生成的主题页面了解有关成对比较的更多信息">成对比较</a> 矩阵显示子流域最有可能发生洪水。 Condorcet 算法选择了子流域 1、2、4、5 和 11，Borda 算法选择了子流域 2、4、5、20 和 11。两种模型都预测大部分流域的洪水概率非常低，并且很小的部分发生<a href="https://www.sciencedirect.com/topics/earth-and-planetary-sciences/flood" title="从 ScienceDirect 的 AI 生成的主题页面了解有关洪水的更多信息">洪水</a> 的可能性很高。从洪水灾害角度对流域进行定量分析和表征可以为<a href="https://www.sciencedirect.com/topics/earth-and-planetary-sciences/mitigation-measure" title="从 ScienceDirect 的 AI 生成的主题页面了解有关缓解措施的更多信息">减灾措施的</a><a href="https://www.sciencedirect.com/topics/social-sciences/decision-making" title="从 ScienceDirect 的 AI 生成的主题页面了解有关决策的更多信息">决策</a>、规划和投资提供支持。</p><h2 id="强调-1"><a href="#强调-1" class="headerlink" title="强调"></a>强调</h2><ul><li><p><a href="https://www.sciencedirect.com/topics/earth-and-planetary-sciences/game-theory" title="从 ScienceDirect 的 AI 生成的主题页面了解有关博弈论的更多信息">引入了一种使用博弈论</a>算法和频率比来确定子流域优先级的新方法。</p></li><li><p>比较两种基于像素和基于子流域的方法来绘制洪水概率。</p></li><li><p><a href="https://www.sciencedirect.com/topics/social-sciences/flood" title="从 ScienceDirect 的 AI 生成的主题页面了解有关洪水的更多信息">使用博弈论对影响洪水</a>概率的每个因素最重要的类别进行排序。</p></li><li><p>确定用于绘制洪水概率的两个机器学习模型的准确性。</p></li></ul>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>文献分享</tag>
      
      <tag>洪水预报</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>关于文献【使用集成WRF-Hydro模拟预测21世纪中叶美国东北部极端水流和内陆洪水的变化】的参考文献</title>
    <link href="/2024/03/25/%E5%85%B3%E4%BA%8E%E6%96%87%E7%8C%AE%E3%80%90%E4%BD%BF%E7%94%A8%E9%9B%86%E6%88%90WRF-Hydro%E6%A8%A1%E6%8B%9F%E9%A2%84%E6%B5%8B21%E4%B8%96%E7%BA%AA%E4%B8%AD%E5%8F%B6%E7%BE%8E%E5%9B%BD%E4%B8%9C%E5%8C%97%E9%83%A8%E6%9E%81%E7%AB%AF%E6%B0%B4%E6%B5%81%E5%92%8C%E5%86%85%E9%99%86%E6%B4%AA%E6%B0%B4%E7%9A%84%E5%8F%98%E5%8C%96%E3%80%91%E7%9A%84%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE/"/>
    <url>/2024/03/25/%E5%85%B3%E4%BA%8E%E6%96%87%E7%8C%AE%E3%80%90%E4%BD%BF%E7%94%A8%E9%9B%86%E6%88%90WRF-Hydro%E6%A8%A1%E6%8B%9F%E9%A2%84%E6%B5%8B21%E4%B8%96%E7%BA%AA%E4%B8%AD%E5%8F%B6%E7%BE%8E%E5%9B%BD%E4%B8%9C%E5%8C%97%E9%83%A8%E6%9E%81%E7%AB%AF%E6%B0%B4%E6%B5%81%E5%92%8C%E5%86%85%E9%99%86%E6%B4%AA%E6%B0%B4%E7%9A%84%E5%8F%98%E5%8C%96%E3%80%91%E7%9A%84%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE/</url>
    
    <content type="html"><![CDATA[<h1 id="1-2021-印度南部前所未有的干旱和近期的水资源短缺"><a href="#1-2021-印度南部前所未有的干旱和近期的水资源短缺" class="headerlink" title="1. 2021 - 印度南部前所未有的干旱和近期的水资源短缺"></a>1. 2021 - 印度南部前所未有的干旱和近期的水资源短缺</h1><p><a href="https://iopscience.iop.org/article/10.1088/1748-9326/abf289">https://iopscience.iop.org/article/10.1088/1748-9326/abf289</a></p><p>印度半岛的农业和饮用水供应严重依赖 10 月至 12 月发生的季节性冬季降雨，与东北季风 (NEM) 相关。 2016年至2018年，中等到极低的NEM降雨量导致印度南部大部分地区出现严重干旱，加剧了水资源短缺。这次干旱的严重程度和动态仍有待探索。在这里，我们量化了这一事件的严重性，并探讨了印度南部干旱状况的因果机制。我们的研究结果表明，该事件期间NEM降雨量的3年累计降雨量面临40%以上的赤字——根据观测记录，这是~150年来最干旱的3年时期。我们证明，与整个印度南部的 NEM 相关的干旱条件与赤道印度洋和太平洋的凉爽阶段有关。这些远程连接的未来变化将增加干旱预测的挑战。</p><h1 id="2-2021-使用-GRACE-GRACE-FO-和尼罗河流域多年代际气候变量进行水文气候极端评价"><a href="#2-2021-使用-GRACE-GRACE-FO-和尼罗河流域多年代际气候变量进行水文气候极端评价" class="headerlink" title="2. 2021 - # 使用 GRACE&#x2F;GRACE-FO 和尼罗河流域多年代际气候变量进行水文气候极端评价"></a>2. 2021 - # 使用 GRACE&#x2F;GRACE-FO 和尼罗河流域多年代际气候变量进行水文气候极端评价</h1><p><a href="https://www.mdpi.com/2072-4292/13/4/651">https://www.mdpi.com/2072-4292/13/4/651</a></p><p>人为气候变化引发的干旱和洪水等极端水文气候正在对尼罗河流域（NRB）造成严重破坏。 NRB 并未采用整体方法对这些极端水文气候进行充分研究。在本研究中，计算了重力恢复和气候实验（GRACE）任务及其后续任务（GRACE-FO）衍生指数和其他标准化水文气候指数，以开发洪水和干旱的监测和评估方法。我们通过使用 GRACE&#x2F;GRACE-FO 衍生指数（例如蓄水赤字指数 (WSDI)）评估极端水文气候条件；和标准化水文气候指数（即帕尔默干旱严重度指数（PDSI）等）。本研究表明，1950 年至 2019 年期间，根据标准化指数和 GRACE&#x2F;GRACE-FO 衍生指数，确定了 8 次重大洪水和 10 次干旱事件。与 GRACE&#x2F;GRACE-FO 衍生指数相比，标准化指数大多低估了干旱和洪水的严重程度。在标准化指数中，PDSI 与 WSDI 的相关性最高（r 2 &#x3D; 0.72）。 GRACE-&#x2F;GRACE-FO衍生指数可以捕获所有重大洪水和干旱事件；因此，它可能是数据稀缺的水文气象站点的理想替代品。因此，所提出的框架可以作为洪水和干旱监测的有用工具，并更好地了解NRB和其他类似气候地区的极端水文气候条件。</p><h1 id="3-2008-使用标准化径流指数来表征水文干旱"><a href="#3-2008-使用标准化径流指数来表征水文干旱" class="headerlink" title="3. 2008 - # 使用标准化径流指数来表征水文干旱"></a>3. 2008 - # 使用标准化径流指数来表征水文干旱</h1><p><a href="https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2007GL032487">https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2007GL032487</a></p><p>目前许多干旱指标仅源自对降水和温度等气候变量的分析。干旱显然是气候异常以及人类用水行为的结果，但对社会的许多影响与这两个因素造成的水文条件更直接相关。现代水文模型可以通过模拟地表径流等水文变量，为现有基于气候的干旱指数提供有价值的对应物。我们将融雪地区干旱事件期间标准化径流指数 (SRI) 的行为与众所周知的标准化降水指数 (SPI) 的行为进行了对比。虽然 SRI 和 SPI 在基于长积累期时相似，但 SRI 纳入了水文过程，这些过程决定了气候对径流影响的季节性滞后。因此，在月度到季节时间尺度上，SRI 是 SPI 的有用补充，用于描述干旱的水文方面。</p><h1 id="4-2017-利用-GRACE-对陆地水储存不足的观测来表征印度的干旱"><a href="#4-2017-利用-GRACE-对陆地水储存不足的观测来表征印度的干旱" class="headerlink" title="4. 2017 - # 利用 GRACE 对陆地水储存不足的观测来表征印度的干旱"></a>4. 2017 - # 利用 GRACE 对陆地水储存不足的观测来表征印度的干旱</h1><p><a href="https://journals.ametsoc.org/view/journals/hydr/18/2/jhm-d-16-0047_1.xml">https://journals.ametsoc.org/view/journals/hydr/18/2/jhm-d-16-0047_1.xml</a></p><p>印度频繁发生的干旱造成了重大的社会、经济和环境影响。虽然针对特定区域的评估很丰富，但对大空间尺度的详尽评估还不够充分。这里设计并分析了一种称为储水赤字指数（WSDI）的新干旱指数，用于整体表征干旱。该方法的关键是利用重力恢复和气候实验（GRACE）中的陆地水储存（TWS）变化来量化干旱强度和严重程度。使用该方法对 2002 年 4 月至 2015 年 4 月期间印度四个均匀降雨区域的近期干旱事件进行了很好的识别和量化。在这四个区域中，2015 年 1 月在中部地区观测到的最高峰值缺水为 -158.00 毫米。印度。虽然2002-04年的干旱在印度半岛和中西部地区较为突出，但2009-10年和2012-13年的干旱在印度几乎所有四个地区都很突出。印度中部和西北部分别观察到最长的赤字期为23个月（从2009年2月到2010年12月）和最高的严重度值为-26.31。印度中西部地区的 WSDI 值呈上升趋势（0.07 yr -1），表明干旱状况已从之前的情况中恢复。相反，在印度西北部（-0.07 yr -1）和中部（-0.18 yr -1 ）观察到 WSDI 呈下降趋势。结果表明，人们对 WSDI 在大空间尺度上稳健表征干旱的潜力充满信心。</p><h1 id="5-2021-利用长期-GRACE-和再分析数据对中国南方珠江流域的干旱和洪水特征及其与气候变化的联系"><a href="#5-2021-利用长期-GRACE-和再分析数据对中国南方珠江流域的干旱和洪水特征及其与气候变化的联系" class="headerlink" title="5.2021 - # 利用长期 GRACE 和再分析数据对中国南方珠江流域的干旱和洪水特征及其与气候变化的联系"></a>5.2021 - # 利用长期 GRACE 和再分析数据对中国南方珠江流域的干旱和洪水特征及其与气候变化的联系</h1><p><a href="https://journals.ametsoc.org/view/journals/clim/34/6/JCLI-D-20-0332.1.xml">https://journals.ametsoc.org/view/journals/clim/34/6/JCLI-D-20-0332.1.xml</a></p><p>使用基于重力恢复和气候实验（GRACE）卫星测量的mascon（质量浓度）解决方案的长期陆地水储存异常（TWSA）数据对珠江流域（PRB）的干旱和洪水进行了调查（2002-19）和再分析数据（1980-2019）。 GRACE mascon 解决方案捕获了过去二十年中两个主要干旱时期（2003-06 和 2009-12），其起始时间和结束时间相似，但在量化总干旱严重程度方面显示出相当大的差异。再分析数据显着高估了 1980 年至 2000 年期间的干旱持续时间和严重程度，原因是降水量低估导致 TWSA 被高估。 GRACE mascon 解决方案确定了 2002 年 8 月、2008 年 6 月、2006 年 7 月和 2019 年 7 月的四次主要洪水事件。洪水潜力受到当月和前几个月降水量的影响。与月度和次流域尺度的降水相比，2008 年最近一次洪水的洪水潜在指数显示出相似的空间格局。 PRB降水和TWSA主要受厄尔尼诺-南方涛动（ENSO）影响。 1980 年至 2019 年期间，TWSA 对 ENSO 的响应存在 1-3 个月的滞后。本研究强调了在长期干旱和洪水特征描述之前消除新建大型水库蓄水变化的重要性。水库蓄水的纳入会延长（缩短）干旱持续时间，高估（低估）水库蓄水前（后）的干旱严重程度，高估水库蓄水后的洪水潜力。本研究强调了过去四十年来，在人类活动（水库建设和调度）更加频繁和气候系统复杂变化的情况下，PRB干旱状况日益加剧。</p><h1 id="6-2016-中国洪水和水资源供应的未来变化：与气候变化和不确定性的联系"><a href="#6-2016-中国洪水和水资源供应的未来变化：与气候变化和不确定性的联系" class="headerlink" title="6. 2016 - 中国洪水和水资源供应的未来变化：与气候变化和不确定性的联系"></a>6. 2016 - 中国洪水和水资源供应的未来变化：与气候变化和不确定性的联系</h1><p><a href="https://journals.ametsoc.org/view/journals/hydr/17/4/jhm-d-15-0074_1.xml">https://journals.ametsoc.org/view/journals/hydr/17/4/jhm-d-15-0074_1.xml</a></p><p>通过分析部门间影响模型比对项目 (ISI-MIP) 的流量模拟，并考虑全球范围内的不确定性，研究了代表性浓度路径 2.6 (RCP2.6) 和 RCP8.5 下中国洪水和可用水量的未来变化。气候模型（GCM）和水文模型。将 ISI-MIP 模拟得出的洪水和可用水量与观测结果进行比较。模型之间的不确定性通过模型一致性来量化。只有模型一致性 &gt;50% 才被认为可以生成洪水和水资源可用性及其与气候变化关系的可靠预测。结果显示了五个要点。首先，ISI-MIP 模拟在模拟洪水和水资源可用性方面具有可接受的能力。洪水和可用水量变化的空间模式在很大程度上取决于 GCM 的输出。 GCM&#x2F;水文模型的不确定性在中国东部&#x2F;西北湿润&#x2F;干燥地区的不确定性中占主导地位。其次，在 RCP8.5 条件下，2070-99 年中国各地的洪水强度相对于 1971-2000 年相同重现期的洪水强度有所增加。较大洪水的增长率高于较小洪水的增长率。第三，在RCP8.5下，中国南部&#x2F;北部的可用水量减少&#x2F;增加，但在RCP2.6下变化可以忽略不计。第四，未来更严重的洪水是由中国更强烈的极端降水造成的。平均降水量的微小变化和实际蒸散量的增加减少了中国南方的可用水量。第五，模拟洪水中的模型一致性高于可用水量，因为与平均降水量相比，不同 GCM 输出之间不断增加的极端降水量更加一致。</p><h1 id="7-2023-全球突发干旱预测显示气候变暖带来的风险增加"><a href="#7-2023-全球突发干旱预测显示气候变暖带来的风险增加" class="headerlink" title="7. 2023 - 全球突发干旱预测显示气候变暖带来的风险增加"></a>7. 2023 - 全球突发干旱预测显示气候变暖带来的风险增加</h1><p><a href="https://www.nature.com/articles/s43247-023-00826-1?fromPaywallRec=false#code-availability">https://www.nature.com/articles/s43247-023-00826-1?fromPaywallRec=false#code-availability</a></p><p>突发干旱的特点是异常快速的干燥，可能对许多社会经济部门，特别是农业产生重大影响。然而，气候变暖对突发干旱风险的潜在变化仍然未知。在这项研究中，利用全球气候模型模拟对突发干旱频率和农田突发干旱风险的预计变化进行了量化。我们发现，在所有情景中，全球范围内的突发干旱发生率预计都会增加，其中辐射强迫较高和化石燃料使用量较大的情况下增加幅度最大。全球农田骤发干旱风险预计将增加，在最极端的排放情景下，北美（年度风险从 2015 年的 32% 变化到 2100 年的 49%）和欧洲（32% 到 53%）预计增幅最大。与高端情景相比，低端和中度情景表明农田年度突发干旱风险显着降低。</p><h1 id="8-2018-利用陆地水储量亏缺度对长江流域的干旱进行评估"><a href="#8-2018-利用陆地水储量亏缺度对长江流域的干旱进行评估" class="headerlink" title="8. 2018 - 利用陆地水储量亏缺度对长江流域的干旱进行评估"></a>8. 2018 - 利用陆地水储量亏缺度对长江流域的干旱进行评估</h1><p><a href="https://doi.org/10.1016/j.scitotenv.2018.03.292" title="Persistent link using digital object identifier"> https://doi.org/10.1016/j.scitotenv.2018.03.292 </a></p><p>干旱是最严重的自然灾害之一，会带来严重的水资源短缺、经济损失和不良的社会后果。重力恢复和气候实验（GRACE）卫星数据被广泛用于描述和评估干旱。在这项工作中，我们使用 GRACE 德克萨斯空间研究中心 (CSR) 2003 年至 2015 年的 mascon（质量浓度）数据评估了长江流域 (YRB) 的干旱状况。干旱事件是通过导出的水储存赤字 (WSD) 来识别的。干旱严重程度评价基于储水赤字指数（WSDI）、标准化 WSD 时间序列和总储水赤字（TWSD）。随后将 WSDI 与帕尔默干旱严重程度指数 (PDSI)、标准化降水指数 (SPI)、标准化降水<a href="https://www.sciencedirect.com/topics/earth-and-planetary-sciences/evapotranspiration" title="从 ScienceDirect 的 AI 生成的主题页面了解有关蒸散的更多信息">蒸散</a> 指数 (SPEI) 和标准化径流指数 (SRI) 进行比较。结果表明，YRB 在研究期间经历了湿度增加，WSD 值以每年 5.20 毫米的速度增加。 2004 年、2006 年和 2011 年发生了 8 起干旱事件，其中发生了 3 起重大干旱，WSDI 分别为-2.05、-2.38 和-1.30，TWSD 分别为-620.96  mm、-616.81  mm 和-192.44  mm。我们的研究结果表明，GRACE CSR mascon 数据可以有效地用于评估 YRB 的干旱特征，并且 WSDI 有助于对大范围区域的干旱进行稳健和可靠的描述。</p><h2 id="强调"><a href="#强调" class="headerlink" title="强调"></a>强调</h2><ul><li><p>使用蓄水不足来评估整个长江流域的干旱。</p></li><li><p>储水赤字指数（WSDI）与传统的干旱指数进行比较。</p></li><li><p>WSDI 可实现稳健且可靠的干旱特征描述。</p></li><li><p>GRACE 数据为干旱评估提供了重要的见解。</p></li></ul><h1 id="9-2020-中国-GLDAS-2-0-和-2-1-版径流估算存在较大不确定性"><a href="#9-2020-中国-GLDAS-2-0-和-2-1-版径流估算存在较大不确定性" class="headerlink" title="9. 2020 - # 中国 GLDAS 2.0 和 2.1 版径流估算存在较大不确定性"></a>9. 2020 - # 中国 GLDAS 2.0 和 2.1 版径流估算存在较大不确定性</h1><p><a href="https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2019EA000829">https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2019EA000829</a></p><p>监测观测径流可以反映自然水文循环和人为干预的影响。全球陆地数据同化系统（GLDAS）2.0和2.1提供了丰富的径流，可用于未测量&#x2F;测量不良地区的水资源评估。然而，GLDAS2.0 和 GLDAS2.1 径流仅在非常有限的区域进行了验证和相互比较。在这项研究中，利用中国11个大流域的仪表观测对它们进行了评估和相互比较。结果表明，其径流存在较大的不确定性：相对偏差（|RB|）绝对值在39%以上，Nash-Sutcliffe效率平均低于0.15，但GLDAS2.1更好。两者在青藏高原都有较大的不确定性：|RB|均高于40%。 GLDAS 径流与观测值之间的差距可能归因于 GLDAS 系统的不确定性以及 GLDAS 不考虑人为干预的事实。因此，在人与自然耦合系统中使用它们时应谨慎。</p><h1 id="10-2019-人为因素导致中国出现突发干旱的风险更高"><a href="#10-2019-人为因素导致中国出现突发干旱的风险更高" class="headerlink" title="*10. 2019 - 人为因素导致中国出现突发干旱的风险更高"></a>*10. 2019 - 人为因素导致中国出现突发干旱的风险更高</h1><p><a href="https://www.nature.com/articles/s41467-019-12692-7">https://www.nature.com/articles/s41467-019-12692-7</a></p><p>突发干旱是指在没有充分预警的情况下迅速加剧的干旱类型。迄今为止，由于突发干旱定义的多样性、人为指纹的作用不明确以及社会经济发展的不确定性，在未来气候变暖的情况下，突发干旱风险将如何变化仍然未知。在这里，我们提出了一种明确表征突发干旱事件的新方法，并发现在中等挑战的社会经济情景下，本世纪中叶中国的暴露风险将增加约23%±11%。最优指纹分析表明，温室气体浓度增加引起的人为气候变化对突发干旱频率上升趋势的贡献率为77%±26%，而人口增长也是增强最南湿润地区突发干旱暴露风险的重要因素。我们的研究结果表明，由于人为导致的突发干旱风险加剧，传统的干旱易发地区将会扩大。</p><h1 id="11-2022-基于独立分量分解的华北地区地下水储量变化及驱动因素分析"><a href="#11-2022-基于独立分量分解的华北地区地下水储量变化及驱动因素分析" class="headerlink" title="11. 2022 - 基于独立分量分解的华北地区地下水储量变化及驱动因素分析"></a>11. 2022 - 基于独立分量分解的华北地区地下水储量变化及驱动因素分析</h1><p><a href="https://doi.org/10.1016/j.jhydrol.2022.127708" title="使用数字对象标识符的持久链接"> https://doi.org/10.1016/j.jHydrol.2022.127708 </a></p><p>过去几十年来，华北地区面临着地下水短缺的问题。为了解北卡罗来纳州地下水储量（GWS）变化特征，采用独立成分分析（ICA）方法，结合高分辨率时变重力场模型Tongji-RegGrace2019和水文模型，对GWS异常（GWSA）进行分析。根据独立组件(IC)的时空特征，进一步研究GWS变化的驱动因素和相应的驱动机制。结果表明，从2004年1月到2015年12月，北卡罗来纳州的GWS以-0.87±0.04cm&#x2F;年的速度下降，从2014年1月到2015年12月，速度增加到-3.71±0.49cm&#x2F;年。<strong>在前四个IC中GWSA 中，第一和第二 IC（IC1 和 IC2）共同反映了晋北和晋南地区煤炭开采和<a href="https://www.sciencedirect.com/topics/agricultural-and-biological-sciences/agricultural-irrigation" title="从 ScienceDirect 的 AI 生成的主题页面了解有关农业灌溉的更多信息">农业灌溉</a>用水引起的长期和年内的 GWS 变化</strong>，相关系数分别为 -0.91 和 -分别为 0.85。 IC3表示冀南地区农业灌溉用水量半年GWS变化信号，相关系数为-0.85。此外，IC4还表明了太行山前季风降水和蒸发的影响。因此，降水时空分布不均匀、季节性蒸发强烈、煤炭开采损失严重、灌溉枯竭等驱动因素共同制约着不同时间节点GWS的升降。</p><h1 id="12-2023-基于-GRACE-WSDI-的-2015-2016-年珠江流域特大洪水影响因素及机制"><a href="#12-2023-基于-GRACE-WSDI-的-2015-2016-年珠江流域特大洪水影响因素及机制" class="headerlink" title="12. 2023 - # 基于 GRACE WSDI 的 2015-2016 年珠江流域特大洪水影响因素及机制"></a>12. 2023 - # 基于 GRACE WSDI 的 2015-2016 年珠江流域特大洪水影响因素及机制</h1><p><a href="https://www.sciencedirect.com/science/article/pii/S2214581823000630">https://www.sciencedirect.com/science/article/pii/S2214581823000630</a></p><h3 id="研究区域"><a href="#研究区域" class="headerlink" title="研究区域"></a>研究区域</h3><p>中国珠江流域（PRB）属热带至亚热带气候。</p><h3 id="学习重点"><a href="#学习重点" class="headerlink" title="学习重点"></a>学习重点</h3><p><a href="https://www.sciencedirect.com/topics/agricultural-and-biological-sciences/el-nino" title="从 ScienceDirect 的人工智能生成的主题页面了解有关厄尔尼诺现象的更多信息">2014-2016年超强厄尔尼诺</a>期间，PRB爆发了前所未有的特大洪水。我们构建了蓄水赤字指数（WSDI）来量化这次极端洪水事件。采用主成分分析方法对PRB、厄尔尼诺南方涛动(ENSO)的WSDI和热带印度洋(TIOS)<a href="https://www.sciencedirect.com/topics/earth-and-planetary-sciences/sea-surface-temperature" title="从 ScienceDirect 的 AI 生成的主题页面了解有关海面温度的更多信息">海表温度</a>(SST)异常进行分析，找出影响因素。此外，通过相关性分析探讨了潜在的影响机制。</p><h3 id="该地区的新水文见解"><a href="#该地区的新水文见解" class="headerlink" title="该地区的新水文见解"></a>该地区的新水文见解</h3><p>特大洪涝灾害严重程度为483.11 km 3，陆地蓄水最大盈余发生在2016年2月（76.11 km 3 ）。此次特大洪水主要受超强<a href="https://www.sciencedirect.com/topics/earth-and-planetary-sciences/el-nino" title="从 ScienceDirect 的人工智能生成的主题页面了解有关厄尔尼诺现象的更多信息">厄尔尼诺影响</a>，并受TIOS增强。 WSDI与ENSO和TIOS显着相关，对于第一和第二主成分， ENSO滞后3个月后的<a href="https://www.sciencedirect.com/topics/earth-and-planetary-sciences/correlation-coefficient" title="从 ScienceDirect 的 AI 生成的主题页面了解有关相关系数的更多信息">相关系数</a>分别为0.90和0.41，TIOS滞后2个月后的相关系数分别为0.86和0.66。超强厄尔尼诺现象加剧了南海、菲律宾海和孟加拉湾的反气旋，进一步促进南海季风减弱和西太平洋副热带高压西伸，诱发极端洪水事件。更多水分向 PRB 输送。</p><h1 id="13-2014-基于-GRACE-的水文干旱表征的储水赤字方法"><a href="#13-2014-基于-GRACE-的水文干旱表征的储水赤字方法" class="headerlink" title="13. 2014 - # 基于 GRACE 的水文干旱表征的储水赤字方法"></a>13. 2014 - # 基于 GRACE 的水文干旱表征的储水赤字方法</h1><p>我们根据美国宇航局重力恢复和气候实验（GRACE）卫星任务对陆地水储存的观测，提出了一种测量水文干旱发生和严重程度的定量方法。 GRACE 测量通过计算区域每月陆地水储存异常与时间序列每月气候学的偏差大小来应用，其中负偏差代表储存赤字。每月赤字明确量化了恢复正常储水条件所需的水量。我们将存储赤字与事件持续时间结合起来来计算干旱严重程度。参考干旱数据库来识别亚马逊和赞比西河流域以及美国东南部和德克萨斯州地区的气象干旱事件。这种蓄水不足方法清楚地确定了水文干旱的开始、结束和持续时间；量化瞬时严重程度和峰值干旱程度；并与气象干旱数据库进行了很好的对比。它还揭示了气象干旱对区域水储存的水文影响的信息。</p><h1 id="14-2019-2015-2016-年厄尔尼诺事件：东部和南部非洲气候异常及其对地下水资源的影响"><a href="#14-2019-2015-2016-年厄尔尼诺事件：东部和南部非洲气候异常及其对地下水资源的影响" class="headerlink" title="14. 2019 - 2015-2016 年厄尔尼诺事件：东部和南部非洲气候异常及其对地下水资源的影响"></a>14. 2019 - 2015-2016 年厄尔尼诺事件：东部和南部非洲气候异常及其对地下水资源的影响</h1><p><a href="https://hess.copernicus.org/articles/23/1751/2019/">https://hess.copernicus.org/articles/23/1751/2019/</a></p><p>尽管饮用水、农业和工业广泛依赖地下水作为资源，但<strong>气候变化对地下水储存的影响</strong>受到的关注有限。在此，我们评估了 2015 年至 2016 年重大厄尔尼诺事件期间南部非洲 (SA) 和东非赤道以南 (EASE) 发生的气候异常及其对各尺度地下水储存的相关影响，通过原位地下水测压和重力恢复和气候实验（GRACE）卫星数据的分析。在大陆尺度上，2015-2016年的厄尔尼诺现象与EASE和南部非洲（南北纬12 °  S）上空的明显相反降雨异常偶极子有关，这是厄尔尼诺-南方涛动（ENSO）的特征模式。根据对地表水平衡异常跨尺度区域强度（以标准化降水蒸散指数 - SPEI 表示）的分析，南部非洲发生了历史记录中最严重的干旱事件，估计重现期为至少 200 年，最好估计 260 年。气候风险正在发生变化，我们估计仅人为变暖（忽略其他气候变量的变化，例如降水）就使此类极端 SPEI 干旱事件的风险增加了大约一倍。 GRACE 卫星和林波波盆地测压数据表明，这些地表水平衡赤字抑制了地下水补给，导致地下水储量大幅下降。相反，在 2015 年至 2016 年厄尔尼诺事件期间的 EASE 上空，观测到异常潮湿的条件，预计重现期约为10 年，可能是由于缺乏强正印度洋纬向模相而有所缓和。卫星 GRACE 数据和坦桑尼亚中部某个地点观测到的地下水位上升表明，强雨季但并非极端雨季增加了地下水储存量。我们注意到 GRACE 数据中将地下水与总储水量分开存在很大的不确定性，并表明当空间平均尺度具有可比性时，GRACE 和地下水储量的测压估计之间的一致性是显而易见的。这些结果对可持续和气候适应型地下水资源管理具有影响，包括采取适应性战略的潜力，例如在间歇性补给事件期间管理含水层补给。</p><h1 id="15-2021-不断变化的世界中的水文循环和水资源：综述"><a href="#15-2021-不断变化的世界中的水文循环和水资源：综述" class="headerlink" title="15. 2021 - 不断变化的世界中的水文循环和水资源：综述"></a>15. 2021 - 不断变化的世界中的水文循环和水资源：综述</h1><p><a href="https://doi.org/10.1016/j.geosus.2021.05.003" title="Persistent link using digital object identifier"> https://doi.org/10.1016/j.geosus.2021.05.00 </a></p><p>水是维持生命、生态系统和人类社会的基本自然资源。因此，研究水循环对于可持续发展具有重要意义。在全球气候变化的背景下，需要更好地了解水循环。本研究总结了当前的研究，并从四个角度强调了水科学的未来方向：（i）水循环； (ii) 水文过程； (iii) 自然与社会耦合的水系统； (iv) 流域综合管理。应重点了解气候变化和人类活动在时空尺度上对水文过程和水资源的共同影响。了解陆地和大气之间的相互作用是解决这个问题的关键。此外，应该为大盆地研究开发系统方法。重点研究领域包括：高寒地区冰冻圈水文过程的变化；人类活动对中下游水循环及相关生物地球化学过程的影响。由于水循环自然地与多个尺度的社会特征耦合，因此需要多过程和多尺度的模型。水文研究应该使用这种新范式作为水-食品-能源前沿研究的一部分。这将有助于根据联合国可持续发展目标，促进自然科学和社会科学的跨学科研究。</p><h2 id="强调-1"><a href="#强调-1" class="headerlink" title="强调"></a>强调</h2><ul><li><p>这项<a href="https://www.sciencedirect.com/topics/social-sciences/hydrological-cycle" title="从 ScienceDirect 的 AI 生成的主题页面了解有关水循环的更多信息">水循环</a>研究的重点是气候变化和人类活动的影响。</p></li><li><p><a href="https://www.sciencedirect.com/topics/earth-and-planetary-sciences/river-basin-management" title="从 ScienceDirect 的人工智能生成的主题页面了解有关流域管理的更多信息">流域管理</a>需要水文生物地球化学的综合模型。</p></li><li><p>人类-水系统的共同进化应该是未来研究的重点。</p></li></ul><h1 id="16-2020-GRACE-卫星干旱指数显示-2002-2017-年中国主要流域干旱影响加剧"><a href="#16-2020-GRACE-卫星干旱指数显示-2002-2017-年中国主要流域干旱影响加剧" class="headerlink" title="16. 2020 - # GRACE 卫星干旱指数显示 2002-2017 年中国主要流域干旱影响加剧"></a>16. 2020 - # GRACE 卫星干旱指数显示 2002-2017 年中国主要流域干旱影响加剧</h1><p><a href="https://doi.org/10.1016/j.agrformet.2020.108057" title="使用数字对象标识符的持久链接"> https://doi.org/10.1016/j.agrformet.2020.108057 </a></p><p>干旱复发的频率具有重大的社会、经济和环境影响。然而，由于当前干旱指数的不确定性，我们准确捕捉干旱状况的能力受到限制。在本研究中，我们<strong>利用去趋势的GRACE-TWS时间序列提出了基于重力恢复和气候实验（GRACE）总水储存量（TWS）的干旱严重指数（DSI），以消除非气候因素对干旱估计的影响并反映真实的干旱情况</strong>。基于改进的GRACE-DSI，我们对2002-2017年中国主要流域的干旱状况进行了表征。我们的结果表明，与现有的非去趋势的基于 GRACE 的干旱指数相比，改进的 GRACE-DSI 可以合理地捕捉干旱过程。 GRACE-DSI 时间序列的观测行为与 Palmer 干旱严重程度指数、标准化降水指数和标准化径流指数相当吻合，尽管由于干旱指标的内在差异而存在差异。从空间上看，黄河流域、淮河流域、海河流域、西南河流域、内陆河流域2013年以后干旱分布格局相似，且干旱持续时间和严重程度均有所增加。此外，基于像素的干旱评估还表明，GRACE时代中国大部分流域的干旱频率呈增加趋势，西南河流域的干旱事件从2015年4月开始到2016年5月结束，严重程度为： 25.38，影响流域总面积的39.47%。我们的分析表明，所提出的 GRACE-DSI 可以作为综合干旱监测的有用工具，并有助于更好地了解 2002-2017 年中国主要流域的干旱状况。</p><h1 id="17-2016-利用扩展-GRACE-数据对中国西南大型喀斯特高原进行旱涝监测"><a href="#17-2016-利用扩展-GRACE-数据对中国西南大型喀斯特高原进行旱涝监测" class="headerlink" title="17. 2016 - # 利用扩展 GRACE 数据对中国西南大型喀斯特高原进行旱涝监测"></a>17. 2016 - # 利用扩展 GRACE 数据对中国西南大型喀斯特高原进行旱涝监测</h1><p><a href="https://doi.org/10.1016/j.rse.2014.08.006" title="使用数字对象标识符的持久链接"> https://doi.org/10.1016/j.rse.2014.08.006 </a></p><p>中国西南地区的大片喀斯特高原（云贵高原）旱涝交替。在这里，我们通过重力恢复和气候实验（GRACE）卫星数据和<a href="https://www.sciencedirect.com/topics/earth-and-planetary-sciences/artificial-neural-network" title="从 ScienceDirect 的 AI 生成的主题页面了解有关人工神经网络的更多信息">人工神经网络</a> 产生的三个十年的总水储量异常（TWSA）表明，近十年来青藏高原干旱和洪水的频率和严重程度都在加剧。人工神经网络）模型。所开发的 ANN 模型在高原及其三个次区域（即湄公河上游、珠江和乌江流域）的 TWSA 后报中表现良好，显示决定系数（<em>R</em> 2 ）为 0.91、0.83、0.76，和 0.57，分别。极端气候的加剧预示着<a href="https://www.sciencedirect.com/topics/earth-and-planetary-sciences/hydrological-cycle" title="从 ScienceDirect 的 AI 生成的主题页面了解有关水文循环的更多信息">水文循环</a><a href="https://www.sciencedirect.com/topics/earth-and-planetary-sciences/water-resources-development" title="从 ScienceDirect 的 AI 生成的主题页面了解有关水资源管理的更多信息">的巨大变化，给水资源管理</a> 带来了巨大挑战。高原的 TWSA 在 1980 年代保持相当稳定，并在 1990 年代以 5.9 ±  0.5 毫米&#x2F;年的速度增加，其间穿插了 1991 年和 1990 年代后半期的极端<a href="https://www.sciencedirect.com/topics/earth-and-planetary-sciences/flood" title="从 ScienceDirect 的 AI 生成的主题页面了解有关洪水的更多信息">洪水。</a> 2000 年以来，TWSA 波动剧烈，2003 年至 2006 年出现严重春旱，2010 年出现有记录以来最严重的春旱，2008 年出现严重<a href="https://www.sciencedirect.com/topics/earth-and-planetary-sciences/flood" title="从 ScienceDirect 的 AI 生成的主题页面了解有关洪水的更多信息">洪涝。</a> 湄公河上游 TWSA 下降约 100 毫米（约 15 km 3））与 20 世纪 90 年代末相比。除了后播 TWSA 之外，所开发的方法还可以有效地生成未来的 TWSA，并有可能弥合当前 GRACE 卫星与预计于 2017 年发射的 GRACE 后续任务之间的差距。 </p><h2 id="强调-2"><a href="#强调-2" class="headerlink" title="强调"></a>强调</h2><ul><li><p>开发了 ANN 模型，将 GRACE 总蓄水量变化延伸至 1979 年。</p></li><li><p>研究了中国西南地区三年来总水储量变化的趋势。</p></li><li><p>对 2010 年最严重的干旱和 2008 年严重的洪水进行了研究。</p></li><li><p>所开发的方法能够事后预测和预测总水储存变化。</p></li></ul><h1 id="18-2017-2002-14-年-GRACE-干旱严重程度指数全球网格数据集：与-PDSI-和-SPEI-的比较以及澳大利亚千年干旱的案例研究"><a href="#18-2017-2002-14-年-GRACE-干旱严重程度指数全球网格数据集：与-PDSI-和-SPEI-的比较以及澳大利亚千年干旱的案例研究" class="headerlink" title="18. 2017 - 2002-14 年 GRACE 干旱严重程度指数全球网格数据集：与 PDSI 和 SPEI 的比较以及澳大利亚千年干旱的案例研究"></a>18. 2017 - 2002-14 年 GRACE 干旱严重程度指数全球网格数据集：与 PDSI 和 SPEI 的比较以及澳大利亚千年干旱的案例研究</h1><p><a href="https://journals.ametsoc.org/view/journals/hydr/18/8/jhm-d-16-0182_1.xml">https://journals.ametsoc.org/view/journals/hydr/18/8/jhm-d-16-0182_1.xml</a></p><p>提出了一个新的月度全球干旱严重程度指数 (DSI) 数据集，该数据集是根据重力恢复和气候实验 (GRACE) 卫星观测的随时间变化的陆地水储存变化而开发的。 GRACE-DSI 记录从 2002 年到 2014 年，并将随着正在进行的 GRACE 和预定的 GRACE 后续任务而延长。 GRACE-DSI 捕获了过去十年中的主要全球干旱事件，并与其他常用干旱指标（包括帕尔默干旱严重程度指数 (PDSI) 和标准化降水蒸散指数 (SPEI)）显示出总体良好的时空一致性。 GRACE-DSI 的优点是 1) 它完全基于卫星重力观测，因此提供全球一致的干旱监测，特别是在稀疏的地面观测（特别是降水）限制使用传统的基于模型的监测方法的情况下； 2）其覆盖范围大（约350公里），因此适合评估区域和全球范围的干旱； 3) 它对水文循环的整体陆地水储存部分很敏感，因此通过提供影响土壤水分补给和干旱恢复的地下水储存变化信息来补充现有的干旱监测数据集。在澳大利亚，事实证明，将 GRACE-DSI 与其他卫星环境数据集相结合可以改善浅表层和地下土层 2000 年代“千年干旱”的表征。澳大利亚西部和东部地区的植被绿度对地表和地下水供应变化的响应存在对比，这可能表明这些地区具有不同的相对植物根系深度。</p><h1 id="19-2012-21-世纪珠江流域水文过程对气候变化的响应"><a href="#19-2012-21-世纪珠江流域水文过程对气候变化的响应" class="headerlink" title="19. 2012 - # 21 世纪珠江流域水文过程对气候变化的响应"></a>19. 2012 - # 21 世纪珠江流域水文过程对气候变化的响应</h1><p><a href="https://doi.org/10.3724/SP.J.1248.2012.00084" title="使用数字对象标识符的持久链接"> https://doi.org/10.3724/SP.J.1248.2012.00084 </a></p><p>本研究利用<strong>水文模型 HBV-D 对珠江最大的流域西江出海口 1961 年至 2099 年的流量进行了模拟和预测</strong>。该模型使用三种<a href="https://www.sciencedirect.com/topics/earth-and-planetary-sciences/greenhouse-gas-emission" title="从 ScienceDirect 的 AI 生成的主题页面了解有关温室气体排放的更多信息">温室气体排放</a>情景（SRES A2、A1B、B1）下来自 CISRO&#x2F;MK3-5、MPI&#x2F;ECHAM5 和 NCAR&#x2F;CCSM3 的降水和温度数据。水资源和洪水频率的结果表明，相对于1961-1990年的参考期，2050年后年降水量和年径流量将增加。此外，预计5月至10月地区月平均降水量和径流呈增加趋势，而12月至2月则呈减少趋势。未来将会发生更频繁、更大规模的洪水。枯水期<strong>径流的潜在增加可以缓解2030年之前的用水压力，但丰水期径流增加，洪水频率更高、规模更大</strong>，预计2050年后防洪压力更大。</p><h1 id="20-2019-华南珠江流域气象水文干旱对比分析"><a href="#20-2019-华南珠江流域气象水文干旱对比分析" class="headerlink" title="20. 2019 - 华南珠江流域气象水文干旱对比分析"></a>20. 2019 - 华南珠江流域气象水文干旱对比分析</h1><p><a href="https://doi.org/10.2166/nh.2018.178">https://doi.org/10.2166/nh.2018.178</a></p><p>干旱是主要自然灾害之一，可能对区域环境、农业和水资源造成破坏性影响。以往的研究评估了不同区域尺度气象干旱的历史变化，但由于水文观测有限，很少考虑水文干旱。这里，我们利用长期（1960-2012年）水文气象资料，利用标准化降水指数（SPI）和标准化径流指数（SRI）对中国南方珠江流域（PRB）的气象和水文干旱进行了比较分析。 ）。结果表明 SPI 和 SRI 之间存在很强的正相关性，并且在较长的时间尺度上相关性往往更强。 SPI 可以可靠地替代 SRI 来代表长期尺度（如 12 个月或更长时间）的水文干旱。趋势分析表明，湿润趋势明显，主要集中在东部地区；干燥趋势主要集中在西部地区和河流下游地区。干旱频率具有空间异质性，年际尺度上略有变化。总体而言，干旱以明显的较短周期（0.75~1.8年）周期为主，其中气象干旱的周期周期主要是水文干旱的周期周期。</p><h1 id="21-2018-2015-16-年中国洪涝灾害及对强厄尔尼诺现象的响应"><a href="#21-2018-2015-16-年中国洪涝灾害及对强厄尔尼诺现象的响应" class="headerlink" title="21. 2018 - # 2015-16 年中国洪涝灾害及对强厄尔尼诺现象的响应"></a>21. 2018 - # 2015-16 年中国洪涝灾害及对强厄尔尼诺现象的响应</h1><p><a href="https://doi.org/10.1016/j.scitotenv.2018.01.280" title="使用数字对象标识符的持久链接"> https://doi.org/10.1016/j.scitotenv.2018.01.280 </a></p><p>详细分析了 2015-2016 年中国水文气候异常特征以及应对 2015-16 年超强水文气候的可能对策<a href="https://www.sciencedirect.com/topics/earth-and-planetary-sciences/el-nino" title="从 ScienceDirect 的人工智能生成的主题页面了解有关厄尔尼诺现象的更多信息">El Niño</a> 事件。 2015-16 年<a href="https://www.sciencedirect.com/topics/earth-and-planetary-sciences/el-nino" title="从 ScienceDirect 的人工智能生成的主题页面了解有关厄尔尼诺现象的更多信息">厄尔尼诺</a> 现象在持续时间、强度和变暖范围方面被定性为“强”事件<a href="https://www.sciencedirect.com/topics/earth-and-planetary-sciences/sea-surface-temperature" title="从 ScienceDirect 的 AI 生成的主题页面了解有关海面温度的更多信息">sea surface temperature</a> 与 1982-83 年和 1997-98 年的事件相比，赤道中部和中东部太平洋的海温（SST）。洪水和干旱频率分别为每年洪水和干旱的发生次数。结果表明，中国存在几个显着的异常现象：1）2015-16 年降水量变化约 9%-173%可归因于厄尔尼诺现象； 2）水文气候异常与洪涝、干旱发生存在显着不一致； 3）2016 年夏季洪水频率增加，特别是东南地区和长江流域； 4）干旱频率也有所增加，特别是 2015 年夏季东北地区、2016 年春季西北地区以及 2015 年冬季大部分地区。中国水文气候异常对 2015-16 年厄尔尼诺现象的响应显着厄尔尼诺和印度洋暖流引发了环流异常，其特点是西太平洋副热带高压更强、西伸，水汽输送异常。了解厄尔尼诺现象对极端水文气候的反应可以为改善中国的洪水和干旱预报提供有价值的信息。</p><h2 id="强调-3"><a href="#强调-3" class="headerlink" title="强调"></a>强调</h2><ul><li><p>中国的洪涝和干旱对2015-16年厄尔尼诺现象的演变非常敏感。</p></li><li><p>2015-16年厄尔尼诺现象我国不同地区水文气候异常有所不同。</p></li><li><p>重要的是水文气候异常与洪水和干旱之间的不一致。</p></li></ul><h1 id="22-2016-中国珠江流域干旱的过渡特征及气候指数的相关影响"><a href="#22-2016-中国珠江流域干旱的过渡特征及气候指数的相关影响" class="headerlink" title="22. 2016 - # 中国珠江流域干旱的过渡特征及气候指数的相关影响"></a>22. 2016 - # 中国珠江流域干旱的过渡特征及气候指数的相关影响</h1><p><a href="https://www.sciencedirect.com/science/article/abs/pii/S0022169416000299?via=ihub">https://www.sciencedirect.com/science/article/abs/pii/S0022169416000299?via%3Dihub</a></p><p>干旱是一种自然灾害，由于其背后的机制多种多样，迄今为止人们对它知之甚少。此外，干旱对人类社会造成的灾难性影响需要准确预测干旱行为。在这种情况下，为了改进珠江流域的干旱预报，开发并使用了三变量 copula 模型，其中包括<a href="https://www.sciencedirect.com/topics/agricultural-and-biological-sciences/el-nino" title="从 ScienceDirect 的人工智能生成的主题页面了解有关厄尔尼诺现象的更多信息">厄尔尼诺</a> 南方涛动（ENSO）、<a href="https://www.sciencedirect.com/topics/agricultural-and-biological-sciences/north-atlantic-oscillation" title="从 ScienceDirect 的 AI 生成的主题页面了解有关北大西洋涛动的更多信息">北大西洋涛动</a>（NAO）、<a href="https://www.sciencedirect.com/topics/earth-and-planetary-sciences/indian-ocean-dipole" title="从 ScienceDirect 的 AI 生成的主题页面了解有关印度洋偶极子的更多信息">印度洋偶极子</a>（IOD）和<a href="https://www.sciencedirect.com/topics/earth-and-planetary-sciences/pacific-decadal-oscillation" title="从 ScienceDirect 的人工智能生成的主题页面了解有关太平洋年代际振荡的更多信息">太平洋十年振荡</a><a href="https://www.sciencedirect.com/topics/earth-and-planetary-sciences/markov-chain" title="从 ScienceDirect 的 AI 生成的主题页面了解有关马尔可夫链的更多信息">（PDO）转化为马尔可夫链</a> 的模型结构。本研究使用标准化降水<a href="https://www.sciencedirect.com/topics/earth-and-planetary-sciences/evapotranspiration" title="从 ScienceDirect 的 AI 生成的主题页面了解有关蒸散量的更多信息">蒸散</a> 指数（SPEI）来监测干旱。与各月气候指数与 SPEI 序列的初步相关性分析比较表明，三变量 copula 在评估气候指数对干旱<a href="https://www.sciencedirect.com/topics/earth-and-planetary-sciences/transition-probability" title="从 ScienceDirect 的 AI 生成的主题页面了解有关转移概率的更多信息">转变概率</a> 的影响方面表现良好。认为垂直速度为负值的地区降水量较多，反之亦然。此外，与各气候指数相关的 500 hPa 垂直速度异常场型进一步证实了气候指数对干旱行为的影响。此外，本研究还调查了各气候指数不同条件下的平均极端干旱持续时间。结果表明，ENSO 正位相期间，珠江流域西部地区平均极端干旱持续时间趋于较长，NAO 正位相期间，珠江流域西部地区平均极端干旱持续时间趋于较短，反之亦然；珠江流域中部地区，ENSO、NAO、PDO 正期期间平均极端干旱持续时间趋于较短，而 IOD 正期期间平均极端干旱持续时间趋于较长，反之亦然；珠江流域东部地区，ENSO 和 PDO 正事件期间，平均极端干旱持续时间往往较短，反之亦然。这项研究为气候指数影响导致的干旱过渡行为提供了新的线索。</p><h2 id="强调-4"><a href="#强调-4" class="headerlink" title="强调"></a>强调</h2><ul><li><p>确定了气候指数对干旱的影响。</p></li><li><p>开发了三变量联结函数并获得了转移概率。</p></li><li><p>根据气候指数研究了干旱的可预测性。</p></li></ul><h1 id="23-2020-评估水文气象干旱指数以描述历史和未来干旱及其对地下水的影响"><a href="#23-2020-评估水文气象干旱指数以描述历史和未来干旱及其对地下水的影响" class="headerlink" title="23. 2020 - 评估水文气象干旱指数以描述历史和未来干旱及其对地下水的影响"></a>23. 2020 - 评估水文气象干旱指数以描述历史和未来干旱及其对地下水的影响</h1><p><a href="https://www.syncsci.com/journal/index.php/REIE/article/view/467">https://www.syncsci.com/journal/index.php/REIE/article/view/467</a></p><p>气象水文干旱的影响在干旱、半干旱地区非常重要。因此，分析这些对地下水供应的影响对于管理这些地区的水资源具有重要作用。因此，本文的目的是描述伊朗干旱地区伊斯法罕-博克哈尔盆地的几种干旱特征。观测的水文气候数据（1971-2005 年期间）用于水文气象预测（2006-2040 年期间）。<strong>采用标准化降水指数（SPI）、标准化径流指数（SRI）评价气象和地表水文干旱，采用地下水资源指数（GRI）考察水文气象干旱对地下水的影响</strong>。结果显示，根据这三个指数，该地区在最初和随后的几十年中将出现干燥和潮湿的情况。 SPI、SRI 和 GRI 在 12 个月的时间尺度上存在适当的关联。 SPI 仅使用气象变量进行估算，在气象干旱预报方面比使用流域流量、土壤湿度和地下水位计算并代表水文干旱的 SRI 和 GRI 表现更好。结果显示，整个地区的干旱轮廓时间以及预测降水、温度和指数类型变量之间的关联发生了相当大的变化。所有三个干旱指数的预测都表明未来一段时期天气将更加干燥。研究结果为沿海平原水资源管理提供合理的管理策略。</p><h1 id="24-GRACE卫星数据已广泛用于监测全球区域或流域规模的干旱和洪水事件，包括亚马逊河流域（Chen等，2009，2010）、拉普拉塔盆地（Abelen等，2015）、长江流域-Sun等，2017，2018；Z-Zhang等，2015；Zhou等，2017-、辽河流域-X-Chen等，2018-、西南喀斯特高原-Long等，2017-2014）在中国。"><a href="#24-GRACE卫星数据已广泛用于监测全球区域或流域规模的干旱和洪水事件，包括亚马逊河流域（Chen等，2009，2010）、拉普拉塔盆地（Abelen等，2015）、长江流域-Sun等，2017，2018；Z-Zhang等，2015；Zhou等，2017-、辽河流域-X-Chen等，2018-、西南喀斯特高原-Long等，2017-2014）在中国。" class="headerlink" title="24. GRACE卫星数据已广泛用于监测全球区域或流域规模的干旱和洪水事件，包括亚马逊河流域（Chen等，2009，2010）、拉普拉塔盆地（Abelen等，2015）、长江流域( Sun等，2017，2018；Z.Zhang等，2015；Zhou等，2017 )、辽河流域( X.Chen等，2018 )、西南喀斯特高原( Long等，2017 ) 2014）在中国。"></a>24. GRACE卫星数据已广泛用于监测全球区域或流域规模的干旱和洪水事件，包括亚马逊河流域（Chen等，2009，2010）、拉普拉塔盆地（Abelen等，2015）、长江流域( Sun等，2017，2018；Z.Zhang等，2015；Zhou等，2017 )、辽河流域( X.Chen等，2018 )、西南喀斯特高原( Long等，2017 ) 2014）在中国。</h1><h1 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h1><p>文献——2023_使用集成 WRF-Hydro 模拟预测 21 世纪中叶美国东北部极端水流和内陆洪水的变化</p><p><a href="https://doi.org/10.1016/j.ejrh.2023.101371" title="使用数字对象标识符的持久链接"> https://doi.org/10.1016/j.ejrh.2023.101371 </a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>文献分享</tag>
      
      <tag>WRF-Hydro</tag>
      
      <tag>洪水</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>如何在ubuntu16.04上安装编译WRF-Hydro5.2.0</title>
    <link href="/2024/03/23/%E5%A6%82%E4%BD%95%E5%9C%A8ubuntu16-04%E4%B8%8A%E5%AE%89%E8%A3%85%E7%BC%96%E8%AF%91WRF-Hydro5-2-0/"/>
    <url>/2024/03/23/%E5%A6%82%E4%BD%95%E5%9C%A8ubuntu16-04%E4%B8%8A%E5%AE%89%E8%A3%85%E7%BC%96%E8%AF%91WRF-Hydro5-2-0/</url>
    
    <content type="html"><![CDATA[<p>如何在ubuntu16.04上安装WRF-Hydro</p><h1 id="1-安装包下载"><a href="#1-安装包下载" class="headerlink" title="1. 安装包下载"></a>1. 安装包下载</h1><p>WRF-Hydro使用单独从<a href="https://ral.ucar.edu/projects/wrf_hydro/model-code">WRF-Hydro官网</a>的进行安装，不使用WRF目录下的hydro模块进行处理，原因是后者相比之下会少一些提供的模板和数据等。</p><p>软件下载地址</p><ol><li><p>github下载：<a href="https://github.com/NCAR/wrf_hydro_nwm_public/releases/v5.2.0">https://github.com/NCAR/wrf_hydro_nwm_public&#x2F;releases&#x2F;v5.2.0</a></p></li><li><p>官网下载：<a href="https://github.com/NCAR/wrf_hydro_nwm_public/archive/refs/tags/v5.2.0.tar.gz">https://github.com/NCAR/wrf_hydro_nwm_public&#x2F;archive&#x2F;refs&#x2F;tags&#x2F;v5.2.0.tar.gz</a></p></li></ol><p>提示：在安装WRF-Hydro5.2.0之前，需要先<a href="https://singyutang.github.io/2024/03/17/%E5%A6%82%E4%BD%95%E5%9C%A8ubuntu16-04%E4%B8%8A%E5%AE%89%E8%A3%85%E7%BC%96%E8%AF%91WRF4-5-2%E3%80%81WRF-hydro5-2-0%E5%92%8CWPS4-5-0/">安装WRF4.5.0和WPS4.5.2</a>。此外这里为了方便安装，这里已经打包整理好了教程中所有可能使用到的数据、软件和所需库，可点击百度网盘分享链接进行下载，这里下载完成后教程后面提到的下载可无需进行再次下载。<br>百度网盘分享链接：<a href="https://pan.baidu.com/s/1PMmrUYXGhvfm8jhYl4SJ1Q">https://pan.baidu.com/s/1PMmrUYXGhvfm8jhYl4SJ1Q</a><br>提取码：6zwu</p><h1 id="2-所需库下载"><a href="#2-所需库下载" class="headerlink" title="2. 所需库下载"></a>2. 所需库下载</h1><p>在教程<a href="https://singyutang.github.io/2024/03/17/%E5%A6%82%E4%BD%95%E5%9C%A8ubuntu16-04%E4%B8%8A%E5%AE%89%E8%A3%85%E7%BC%96%E8%AF%91WRF4-5-2%E3%80%81WRF-hydro5-2-0%E5%92%8CWPS4-5-0/">如何在ubuntu16.04上安装编译WRF4.5.2和WPS4.5.0</a> 中netcdf安装版本为v4.1.3，该版本可通过一个安装包netcdf就将两者同时安装。安装更高版本的netcdf需要将c和fortran分开，先装netcdf-c才能装netcdf-fortran。所需安装库如下。</p><p><a href="https://github.com/madler/zlib/releases/download/v1.2.13/zlib-1.2.13.tar.gz">zlib-1.2.13</a></p><p><a href="https://hdf-wordpress-1.s3.amazonaws.com/wp-content/uploads/manual/HDF5/HDF5_1_14_3/src/hdf5-1.14.3.tar.gz">hdf5-1.14.3</a></p><p><a href="https://curl.se/download/curl-7.77.0.tar.gz">curl-7.77.0</a></p><p><a href="https://github.com/Unidata/netcdf-c/archive/refs/tags/v4.9.2.tar.gz">netcdf-c-4.9.2</a></p><p><a href="https://github.com/Unidata/netcdf-fortran/archive/refs/tags/v4.6.1.tar.gz">netcdf-fortran-4.6.1</a></p><h1 id="3-安装及环境配置"><a href="#3-安装及环境配置" class="headerlink" title="3. 安装及环境配置"></a>3. 安装及环境配置</h1><h2 id="3-1-环境预配置及说明"><a href="#3-1-环境预配置及说明" class="headerlink" title="3.1 环境预配置及说明"></a>3.1 环境预配置及说明</h2><p>运用教程<a href="https://singyutang.github.io/2024/03/17/%E5%A6%82%E4%BD%95%E5%9C%A8ubuntu16-04%E4%B8%8A%E5%AE%89%E8%A3%85%E7%BC%96%E8%AF%91WRF4-5-2%E3%80%81WRF-hydro5-2-0%E5%92%8CWPS4-5-0/">如何在ubuntu16.04上安装编译WRF4.5.2和WPS4.5.0</a>中的netcdf环境版本为v4.1.3太低，不能运行WRF-Hydro，因此需要新建另一个netcdf环境。这里列出<a href="https://singyutang.github.io/2024/03/17/%E5%A6%82%E4%BD%95%E5%9C%A8ubuntu16-04%E4%B8%8A%E5%AE%89%E8%A3%85%E7%BC%96%E8%AF%91WRF4-5-2%E3%80%81WRF-hydro5-2-0%E5%92%8CWPS4-5-0/">教程</a>安装WRF后设置的有关WRF的环境,，作为参照。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">############################################################## WRF BEGIN ################################</span><br><span class="hljs-built_in">export</span> DIR=/home/root123/coding/WRF/Build_WRF/LIBRARIES<br><span class="hljs-built_in">export</span> CC=gcc<br><span class="hljs-built_in">export</span> CXX=g++<br><span class="hljs-built_in">export</span> FC=gfortran<br><span class="hljs-built_in">export</span> FCFLAGS=-m64<br><span class="hljs-built_in">export</span> F77=gfortran<br><span class="hljs-built_in">export</span> FFLAGS=-m64<br><span class="hljs-built_in">export</span> CFLAGS=-m64<br><br><span class="hljs-comment">## --------------- grib2 ----------------------------------------</span><br><span class="hljs-comment"># 安装WRF库时设置变量LDFLAGS和CPPFLAGS如下两行，安装完成后可注释</span><br><span class="hljs-comment">#export LDFLAGS=-L$DIR/grib2/lib</span><br><span class="hljs-comment">#export CPPFLAGS=-I$DIR/grib2/include</span><br><span class="hljs-built_in">export</span> JASPERLIB=<span class="hljs-variable">$DIR</span>/grib2/lib<br><span class="hljs-built_in">export</span> JASPERINC=<span class="hljs-variable">$DIR</span>/grib2/include<br><br><span class="hljs-comment">##  -------------- MPICH 3.0.4--------------------------------------</span><br><span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$DIR</span>/mpich/bin:<span class="hljs-variable">$DIR</span>/mpich/lib:<span class="hljs-variable">$DIR</span>/mpich/include:<span class="hljs-variable">$PATH</span><br><br><span class="hljs-comment">## --------------  NETCDF BEGIN  -----------------------</span><br><span class="hljs-comment">## ------------WRF 4.5.2 | WPS -----&amp;&amp; -----netcdf 4.1.3---------</span><br><span class="hljs-built_in">export</span> NETCDF=<span class="hljs-variable">$DIR</span>/netcdf<br><span class="hljs-comment"># 安装WRF库时设置变量LDFLAGS和CPPFLAGS如上设置，安装完成后注释，这里设置的变量</span><br><span class="hljs-comment"># LDFLAGS和CPPFLAGS主要用于运行WRF脚本使用，在安装库时请注释</span><br><span class="hljs-built_in">export</span> LDFLAGS=-L<span class="hljs-variable">$NETCDF</span>/lib<br><span class="hljs-built_in">export</span> CPPFLAGS=-I<span class="hljs-variable">$NETCDF</span>/include<br><br><span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$DIR</span>/netcdf/bin:<span class="hljs-variable">$PATH</span><br><span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$NETCDF</span>:<span class="hljs-variable">$NETCDF</span>/bin:<span class="hljs-variable">$PATH</span><br><span class="hljs-built_in">export</span> LIBS=<span class="hljs-string">&quot;-lnetcdf -lz&quot;</span><br><span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$NETCDF</span>/lib/:<span class="hljs-variable">$PATH</span><br><span class="hljs-built_in">export</span> LD_LIBRARY_PATH=<span class="hljs-variable">$NETCDF</span>/lib:<span class="hljs-variable">$&#123;LD_LIBRARY_PATH&#125;</span><br><span class="hljs-built_in">export</span> NETCDF_INC=<span class="hljs-string">&quot;<span class="hljs-variable">$NETCDF</span>/include&quot;</span><br><span class="hljs-built_in">export</span> NETCDF_LIB=<span class="hljs-string">&quot;<span class="hljs-variable">$NETCDF</span>/lib&quot;</span><br><span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$NETCDF_LIB</span>:<span class="hljs-variable">$NETCDF_INC</span>:<span class="hljs-variable">$PATH</span><br><br><span class="hljs-comment">## ------------NETCDF END  --------------------------------</span><br><br><span class="hljs-built_in">export</span> HDF5PATH=<span class="hljs-variable">$NETCDF</span><br><span class="hljs-built_in">export</span> WRF_DIR=~/coding/WRF/Build_WRF/WRFV4.5.2<br><span class="hljs-built_in">export</span> WRFIO_NCD_NO_LARGE_FILE_SUPPORT=1<br><br><br><span class="hljs-comment">################################################  WRF END #########################################</span><br></code></pre></td></tr></table></figure><p>本教程仅针对WRF-Hydro的安装教程和环境配置，所对应的netcdf版本为v4.9.2。</p><p>mpich库在教程<a href="https://singyutang.github.io/2024/03/17/%E5%A6%82%E4%BD%95%E5%9C%A8ubuntu16-04%E4%B8%8A%E5%AE%89%E8%A3%85%E7%BC%96%E8%AF%91WRF4-5-2%E3%80%81WRF-hydro5-2-0%E5%92%8CWPS4-5-0/">如何在ubuntu16.04上安装编译WRF4.5.2和WPS4.5.0</a>中已经安装并设置好环境变量，环境变量CC、CXX、FC、FCFLAGS、F77、FFLAGS、CFLAGS已经设置完成。其他相关变量也保持不变。因此<strong>仅需针对环境变量中的netcdf部分</strong>进行修改更新即可，安装库和配置环境变量前请将环境变量中的netcdf4.1.3部分注释，也就是将下面所示部分注释掉。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">## ------------WRF 4.5.2 | WPS -----&amp;&amp; -----netcdf 4.1.3---------</span><br><span class="hljs-built_in">export</span> NETCDF=<span class="hljs-variable">$DIR</span>/netcdf<br><span class="hljs-comment"># 安装WRF库时设置变量LDFLAGS和CPPFLAGS如上设置，安装完成后注释，这里设置的变量</span><br><span class="hljs-comment"># LDFLAGS和CPPFLAGS主要用于运行WRF脚本使用，在安装库时请注释</span><br><span class="hljs-built_in">export</span> LDFLAGS=-L<span class="hljs-variable">$NETCDF</span>/lib<br><span class="hljs-built_in">export</span> CPPFLAGS=-I<span class="hljs-variable">$NETCDF</span>/include<br><br><span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$DIR</span>/netcdf/bin:<span class="hljs-variable">$PATH</span><br><span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$NETCDF</span>:<span class="hljs-variable">$NETCDF</span>/bin:<span class="hljs-variable">$PATH</span><br><span class="hljs-built_in">export</span> LIBS=<span class="hljs-string">&quot;-lnetcdf -lz&quot;</span><br><span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$NETCDF</span>/lib/:<span class="hljs-variable">$PATH</span><br><span class="hljs-built_in">export</span> LD_LIBRARY_PATH=<span class="hljs-variable">$NETCDF</span>/lib:<span class="hljs-variable">$&#123;LD_LIBRARY_PATH&#125;</span><br><span class="hljs-built_in">export</span> NETCDF_INC=<span class="hljs-string">&quot;<span class="hljs-variable">$NETCDF</span>/include&quot;</span><br><span class="hljs-built_in">export</span> NETCDF_LIB=<span class="hljs-string">&quot;<span class="hljs-variable">$NETCDF</span>/lib&quot;</span><br><span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$NETCDF_LIB</span>:<span class="hljs-variable">$NETCDF_INC</span>:<span class="hljs-variable">$PATH</span><br></code></pre></td></tr></table></figure><p>将WRF部分的netcdf4.1.3部分的环境变量设置完成后，即可开始安装。本次安装netcdf安装路径为<code>/usr/local/netcdf4</code>。</p><h2 id="3-2-安装zlib"><a href="#3-2-安装zlib" class="headerlink" title="3.2 安装zlib"></a>3.2 安装zlib</h2><p>将下载好的zlib压缩包拖入<code>/usr/local/netcdf4/</code>中进行解压，进入解压后的zlib文件夹，打开终端，输入以下命令进行安装。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">./configure --prefix=/usr/local/netcdf4<br>make<br>make check<br>make install<br></code></pre></td></tr></table></figure><p>安装完成后会在<code>/usr/local/netcdf4</code>这个目录下生成三个文件夹，lib，include，share</p><h2 id="3-3-安装hdf5"><a href="#3-3-安装hdf5" class="headerlink" title="3.3 安装hdf5"></a>3.3 安装hdf5</h2><p>将下载好的hdf5压缩包拖入<code>/usr/local/netcdf4/</code>中进行解压，进入解压后的hdf5文件夹，打开终端，输入以下命令进行安装。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">./configure --prefix=/usr/local/netcdf4<br>make<br>make check<br>make install<br></code></pre></td></tr></table></figure><h2 id="3-4-安装curl"><a href="#3-4-安装curl" class="headerlink" title="3.4 安装curl"></a>3.4 安装curl</h2><p>打开文件<code>~/.bashrc</code>，设置环境变量信息。设置以下两个环境变量前请将前面出现过的这两个变量注释掉。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 设置以下两个环境变量前请将前面出现过的这两个变量注释掉</span><br><span class="hljs-built_in">export</span> LDFLAGS=-L/usr/local/netcdf4/lib<br><span class="hljs-built_in">export</span> CPPFLAGS=-I/usr/local/netcdf4/include<br></code></pre></td></tr></table></figure><p>将下载好的curl压缩包拖入<code>/usr/local/netcdf4/</code>中进行解压，进入解压后的curl文件夹，打开终端，输入以下命令进行安装。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">./configure --prefix=/usr/local/netcdf4<br>make<br>make check<br>make install<br></code></pre></td></tr></table></figure><h2 id="3-5-安装netcdf-c"><a href="#3-5-安装netcdf-c" class="headerlink" title="3.5 安装netcdf-c"></a>3.5 安装netcdf-c</h2><p>将下载好的netcdf-c压缩包拖入<code>/usr/local/netcdf4/</code>中进行解压，进入解压后的netcdf-c文件夹，打开终端，输入以下命令进行安装。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">./configure --prefix=/usr/local/netcdf4 --disable-dap<br>make<br>make check<br>make install<br></code></pre></td></tr></table></figure><h2 id="3-6-安装netcdf-fortran"><a href="#3-6-安装netcdf-fortran" class="headerlink" title="3.6 安装netcdf-fortran"></a>3.6 安装netcdf-fortran</h2><p>打开文件<code>~/.bashrc</code>，设置环境变量信息。设置以下环境变量前请将前面出现过的该变量注释掉。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 设置以下两个环境变量前请将前面出现过的这两个变量注释掉</span><br><span class="hljs-built_in">export</span> LD_LIBRARY_PATH=/usr/local/netcdf4/lib:<span class="hljs-variable">$&#123;LD_LIBRARY_PATH&#125;</span><br></code></pre></td></tr></table></figure><p>将</p><p>将下载好的netcdf-fortran压缩包拖入<code>/usr/local/netcdf4/</code>中进行解压，进入解压后的netcdf-fortran文件夹，打开终端，输入以下命令进行安装。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">./configure --prefix=/usr/local/netcdf4 --disable-dap<br>make<br>make check<br>make install<br></code></pre></td></tr></table></figure><h2 id="3-7-环境变量设置"><a href="#3-7-环境变量设置" class="headerlink" title="3.7 环境变量设置"></a>3.7 环境变量设置</h2><p>添加环境变量如下。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">export</span> NETCDF=/usr/local/netcdf4<br><span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$NETCDF</span>:<span class="hljs-variable">$NETCDF</span>/bin:<span class="hljs-variable">$PATH</span><br></code></pre></td></tr></table></figure><p>此时netcdf v4.9.2安装完毕。通过<code>source ～/.bashrc</code>命令更新环境变量。通过<code>nc-config --all</code>查看安装信息和netcdf版本。该环境可支持WRF-Hydro的运行，也似乎支持WRF的运行。</p><h2 id="3-8环境变量代码优化"><a href="#3-8环境变量代码优化" class="headerlink" title="*3.8环境变量代码优化"></a>*3.8环境变量代码优化</h2><p>通过本教程安装了netcdf4.9.2用以编译运行WRF-Hydro，但是通过教程<a href="https://singyutang.github.io/2024/03/17/%E5%A6%82%E4%BD%95%E5%9C%A8ubuntu16-04%E4%B8%8A%E5%AE%89%E8%A3%85%E7%BC%96%E8%AF%91WRF4-5-2%E3%80%81WRF-hydro5-2-0%E5%92%8CWPS4-5-0/">如何在ubuntu16.04上安装编译WRF4.5.2和WPS4.5.0</a>可以知道系统中还存在netcdf4.1.3用于WRF的运行，为了方便两者的切换而不是频繁注释，特此定义了一个bool变量<code>NETCDF_TYPE</code>用以切换。<code>NETCDF_TYPE</code>变量控制netcdf版本，如果NETCDF_TYPE&#x3D;1,则对应netcdf4.1.3；如果<code>NETCDF_TYPE=2</code>,则对应netcdf4.9.2。</p><p>*注意1：但是好像NETCDF_TYPE&#x3D;1时，系统中的netcdf会指向<code>/usr/include</code>，netcdf v4.4，原因尚不清楚，但不影响使用。</p><p>*注意2：在编译运行WRF和WRF-Hydro时，可直接设置<code>NETCDF_TYPE=2</code>，也能保证二者运行。</p><p>完整WRF环境变量设置如下，与上面用以参照的环境变量相比，只更改了<strong>NETCDF</strong>部分的环境变量。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">############################################################## WRF BEGIN ################################</span><br><span class="hljs-built_in">export</span> DIR=/home/root123/coding/WRF/Build_WRF/LIBRARIES<br><span class="hljs-built_in">export</span> CC=gcc<br><span class="hljs-built_in">export</span> CXX=g++<br><span class="hljs-built_in">export</span> FC=gfortran<br><span class="hljs-built_in">export</span> FCFLAGS=-m64<br><span class="hljs-built_in">export</span> F77=gfortran<br><span class="hljs-built_in">export</span> FFLAGS=-m64<br><span class="hljs-built_in">export</span> CFLAGS=-m64<br><br><span class="hljs-comment">## --------------- grib2 ----------------------------------------</span><br><span class="hljs-built_in">export</span> LDFLAGS=-L<span class="hljs-variable">$DIR</span>/grib2/lib<br><span class="hljs-built_in">export</span> CPPFLAGS=-I<span class="hljs-variable">$DIR</span>/grib2/include<br><span class="hljs-built_in">export</span> JASPERLIB=<span class="hljs-variable">$DIR</span>/grib2/lib<br><span class="hljs-built_in">export</span> JASPERINC=<span class="hljs-variable">$DIR</span>/grib2/include<br><br><span class="hljs-comment">##  -------------- MPICH 3.0.4--------------------------------------</span><br><span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$DIR</span>/mpich/bin:<span class="hljs-variable">$DIR</span>/mpich/lib:<span class="hljs-variable">$DIR</span>/mpich/include:<span class="hljs-variable">$PATH</span><br><br><span class="hljs-comment">## --------------  NETCDF BEGIN  -----------------------</span><br><span class="hljs-comment">## 运行WRF和WPS时使用netcdf 4.1.3，运行WRF_Hydro时使用netcdf4.9.2。 ！！！！！！只需要更改NETCDF_TYPE变量即可。</span><br><span class="hljs-comment"># 定义NETCDF_TYPE变量控制netcdf版本，如果NETCDF_TYPE=1,则对应netcdf4.1.3；如果NETCDF_TYPE=2,则对应netcdf4.9.2。</span><br>NETCDF_TYPE=1<br><span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$NETCDF_TYPE</span>&quot;</span> -eq 1 ]; <span class="hljs-keyword">then</span><br>    <span class="hljs-comment">## ------------WRF 4.5.2 | WPS -----&amp;&amp; -----netcdf 4.1.3---------</span><br>    <span class="hljs-built_in">export</span> NETCDF=<span class="hljs-variable">$DIR</span>/netcdf<br>    <span class="hljs-built_in">export</span> LDFLAGS=-L<span class="hljs-variable">$NETCDF</span>/lib<br>    <span class="hljs-built_in">export</span> CPPFLAGS=-I<span class="hljs-variable">$NETCDF</span>/include<br>    <span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$DIR</span>/netcdf/bin:<span class="hljs-variable">$PATH</span><br>    <span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$NETCDF</span>:<span class="hljs-variable">$NETCDF</span>/bin:<span class="hljs-variable">$PATH</span><br>    <span class="hljs-built_in">export</span> LIBS=<span class="hljs-string">&quot;-lnetcdf -lz&quot;</span><br>    <span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$NETCDF</span>/lib/:<span class="hljs-variable">$PATH</span><br>    <span class="hljs-built_in">export</span> LD_LIBRARY_PATH=<span class="hljs-variable">$NETCDF</span>/lib:<span class="hljs-variable">$&#123;LD_LIBRARY_PATH&#125;</span><br>    <span class="hljs-built_in">export</span> NETCDF_INC=<span class="hljs-string">&quot;<span class="hljs-variable">$NETCDF</span>/include&quot;</span><br>    <span class="hljs-built_in">export</span> NETCDF_LIB=<span class="hljs-string">&quot;<span class="hljs-variable">$NETCDF</span>/lib&quot;</span><br>    <span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$NETCDF_LIB</span>:<span class="hljs-variable">$NETCDF_INC</span>:<span class="hljs-variable">$PATH</span><br><span class="hljs-keyword">fi</span><br><span class="hljs-keyword">if</span> [ <span class="hljs-string">&quot;<span class="hljs-variable">$NETCDF_TYPE</span>&quot;</span> -eq 2 ]; <span class="hljs-keyword">then</span><br>    <span class="hljs-comment">## ------------WRF-Hydro 5.2.0 ------&amp;&amp; ----netcdf 4.9.2---------</span><br>    <span class="hljs-built_in">export</span> LDFLAGS=-L/usr/local/netcdf4/lib<br>    <span class="hljs-built_in">export</span> CPPFLAGS=-I/usr/local/netcdf4/include<br>    <span class="hljs-built_in">export</span> LD_LIBRARY_PATH=/usr/local/netcdf4/lib:<span class="hljs-variable">$&#123;LD_LIBRARY_PATH&#125;</span><br>    <span class="hljs-built_in">export</span> NETCDF=/usr/local/netcdf4<br>    <span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$NETCDF</span>:<span class="hljs-variable">$NETCDF</span>/bin:<span class="hljs-variable">$PATH</span><br>    <span class="hljs-built_in">export</span> NETCDF_INC=<span class="hljs-string">&quot;<span class="hljs-variable">$NETCDF</span>/include&quot;</span><br>    <span class="hljs-built_in">export</span> NETCDF_LIB=<span class="hljs-string">&quot;<span class="hljs-variable">$NETCDF</span>/lib&quot;</span><br><span class="hljs-keyword">fi</span><br><br><span class="hljs-comment">## ------------NETCDF END  --------------------------------</span><br><span class="hljs-comment"># ---------------------------------------------------------------------------------</span><br><br><span class="hljs-built_in">export</span> HDF5PATH=<span class="hljs-variable">$NETCDF</span><br><span class="hljs-built_in">export</span> WRF_DIR=~/coding/WRF/Build_WRF/WRFV4.5.2<br><span class="hljs-built_in">export</span> WRFIO_NCD_NO_LARGE_FILE_SUPPORT=1<br><span class="hljs-comment">################################################  WRF END #########################################</span><br></code></pre></td></tr></table></figure><h1 id="4-构建、编译WRF-Hydro"><a href="#4-构建、编译WRF-Hydro" class="headerlink" title="4. 构建、编译WRF-Hydro"></a>4. 构建、编译WRF-Hydro</h1><p><em>根据下载安装包下中<code>/wrf_hydro_nwm_public/trunk/NDHMS</code>下的README.build.txt文件进行编译。</em></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">./configure<br>./compile_offline_Noah.sh setEnvar.sh<br>OR<br>./compile_offline_NoahMP.sh setEnvar.sh<br></code></pre></td></tr></table></figure><p>输出结果包含<code>Make was successful</code>则说明编译运行成功。</p><h1 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h1><p><a href="https://blog.csdn.net/weixin_43727319/article/details/119491592">ubuntu学习_2：ubuntu中安装netcdf4教程</a></p><h1 id="附加网址推荐"><a href="#附加网址推荐" class="headerlink" title="附加网址推荐"></a>附加网址推荐</h1><p><a href="https://www.zlib.net/">zlib官网</a><br><a href="https://github.com/madler/zlib/releases">zlib github下载</a><br><a href="https://curl.se/download/">curl官网下载</a><br><a href="https://www.unidata.ucar.edu/software/netcdf/">netcdf官网</a><br><a href="https://github.com/Unidata/netcdf-c/releases">netcdf-c github下载</a><br><a href="https://github.com/Unidata/netcdf-fortran/releases">netcdf-fortran github下载</a><br><a href="https://portal.hdfgroup.org/downloads/index.html">hdf5官网下载</a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WRF-Hydro5.2.0</tag>
      
      <tag>软件安装</tag>
      
      <tag>WRF4.5.2</tag>
      
      <tag>tooklkit</tag>
      
      <tag>ubuntu16.04</tag>
      
      <tag>netCDF</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>如何在ubuntu16.04上安装编译WRF4.5.2和WPS4.5.0</title>
    <link href="/2024/03/17/%E5%A6%82%E4%BD%95%E5%9C%A8ubuntu16-04%E4%B8%8A%E5%AE%89%E8%A3%85%E7%BC%96%E8%AF%91WRF4-5-2%E3%80%81WRF-hydro5-2-0%E5%92%8CWPS4-5-0/"/>
    <url>/2024/03/17/%E5%A6%82%E4%BD%95%E5%9C%A8ubuntu16-04%E4%B8%8A%E5%AE%89%E8%A3%85%E7%BC%96%E8%AF%91WRF4-5-2%E3%80%81WRF-hydro5-2-0%E5%92%8CWPS4-5-0/</url>
    
    <content type="html"><![CDATA[<p>为了方便安装，这里已经搜集了所有教程中可能使用到的数据、软件和所需库，可点击百度网盘分享链接进行下载，这里下载完成后教程后面提到的下载可无需进行再次下载。<br>百度网盘分享链接：<a href="https://pan.baidu.com/s/1gdu_VTehi5VX6XXknZMCLw">https://pan.baidu.com/s/1gdu_VTehi5VX6XXknZMCLw</a><br>提取码：rbpn</p><h1 id="1-环境测试"><a href="#1-环境测试" class="headerlink" title="1. 环境测试"></a>1. 环境测试</h1><p>在<code>~/coding</code>文件夹下创建文件夹<code>WRF</code>,进入该文件夹创建两个文件夹，分别为<code>Build_WRF</code>、<code>TESTS</code>。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> ~/coding/WRF<br><span class="hljs-built_in">mkdir</span> Build_WRF TESTS<br><span class="hljs-built_in">cd</span> TESTS<br></code></pre></td></tr></table></figure><p>运行一些测试来验证Fortran编译器和C编译器是否可用。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> apt-get install csh gfortran m4 build-essential<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">which</span> gfortran<br><span class="hljs-built_in">which</span> cpp<br><span class="hljs-built_in">which</span> gcc<br>gcc --version<br></code></pre></td></tr></table></figure><p>下载测试包<a href="https://www2.mmm.ucar.edu/wrf/OnLineTutorial/compile_tutorial/tar_files/Fortran_C_tests.tar">Fortran and C Tests Tar File</a></p><p>将测试包解压</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">tar -xf Fortran_C_tests.tar<br></code></pre></td></tr></table></figure><p>共有7项测试，请一次一次完成</p><p><strong>Test #1:</strong>  TEST_1_fortran_only_fixed.f  </p><p><em>在命令行输入以下内容:</em>  </p><blockquote><p>gfortran TEST_1_fortran_only_fixed.f</p></blockquote><p><em>现在输入:</em></p><blockquote><p>.&#x2F;a.out</p></blockquote><p><em>以下内容将出现在屏幕上:</em></p><blockquote><p>SUCCESS test 1 fortran only fixed format</p></blockquote><p><strong>Test #2:</strong> TEST_2_fortran_only_free.f90  </p><p><em>在命令行输入以下内容:</em></p><blockquote><p>gfortran TEST_2_fortran_only_free.f90</p></blockquote><p><em>然后输入:</em></p><blockquote><p>.&#x2F;a.out</p></blockquote><p><em>以下内容将出现在屏幕上:</em></p><blockquote><p>Assume Fortran 2003: has FLUSH, ALLOCATABLE, derived type, and ISO C Binding<br>SUCCESS test 2 fortran only free format</p></blockquote><p><strong>Test #3:</strong> <u>C</u>: TEST_3_c_only.c  </p><p><em>在命令行输入以下内容:</em></p><blockquote><p>gcc TEST_3_c_only.c</p></blockquote><p><em>然后输入:</em></p><blockquote><p>.&#x2F;a.out</p></blockquote><p><em>以下内容将出现在屏幕上:</em></p><blockquote><p>SUCCESS test 3 c only</p></blockquote><p><strong>Test #4:</strong> : TEST_4_fortran+c_c.c, and TEST_4_fortran+x_f.f90  </p><p><em>在命令行输入以下内容:</em></p><blockquote><p>gcc -c -m64 TEST_4_fortran+c_c.c</p></blockquote><p><em>然后输入:</em></p><blockquote><p>gfortran -c -m64 TEST_4_fortran+c_f.f90</p></blockquote><p>*<em>然后输入:</em></p><blockquote><p>gfortran -m64 TEST_4_fortran+c_f.o TEST_4_fortran+c_c.o</p></blockquote><p><em>然后输入:</em></p><blockquote><p>.&#x2F;a.out</p></blockquote><p><em>以下内容将出现在屏幕上:</em></p><blockquote><p>C function called by Fortran<br>Values are xx &#x3D; 2.00 and ii &#x3D; 1<br>SUCCESS test 4 fortran calling c</p></blockquote><p><strong>Test #5:</strong> csh </p><p><em>在命令行输入以下内容:</em></p><blockquote><p>.&#x2F;TEST_csh.csh</p></blockquote><p><em>以下内容将出现在屏幕上:</em></p><blockquote><p>SUCCESS csh test</p></blockquote><p><strong>Test #6:</strong> perl</p><p><em>在命令行输入以下内容:</em></p><blockquote><p>.&#x2F;TEST_perl.pl</p></blockquote><p><em>以下内容将出现在屏幕上:</em></p><blockquote><p>SUCCESS perl test</p></blockquote><p><strong>Test #7:</strong> sh</p><p> <em>在命令行输入以下内容:</em></p><blockquote><p>.&#x2F;TEST_sh.sh</p></blockquote><p><em>以下内容将出现在屏幕上:</em></p><blockquote><p>SUCCESS sh test</p></blockquote><h1 id="2-环境设置"><a href="#2-环境设置" class="headerlink" title="2. 环境设置"></a>2. 环境设置</h1><p>在~&#x2F;.bashrc中添加以下内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment">###################  WRF 4.5.2 + WPS 4.5.0  ############################</span><br><br><span class="hljs-built_in">export</span> DIR=/home/root123/coding/WRF/Build_WRF/LIBRARIES<br><span class="hljs-built_in">export</span> CC=gcc<br><span class="hljs-built_in">export</span> CXX=g++<br><span class="hljs-built_in">export</span> FC=gfortran<br><span class="hljs-built_in">export</span> FCFLAGS=-m64<br><span class="hljs-built_in">export</span> F77=gfortran<br><span class="hljs-built_in">export</span> FFLAGS=-m64<br><span class="hljs-built_in">export</span> LDFLAGS=-L<span class="hljs-variable">$DIR</span>/grib2/lib<br><span class="hljs-built_in">export</span> CPPFLAGS=-I<span class="hljs-variable">$DIR</span>/grib2/include<br><span class="hljs-built_in">export</span> CFLAGS=-m64<br><span class="hljs-built_in">export</span> JASPERLIB=<span class="hljs-variable">$DIR</span>/grib2/lib<br><span class="hljs-built_in">export</span> JASPERINC=<span class="hljs-variable">$DIR</span>/grib2/include<br><br><span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$DIR</span>/netcdf/bin:<span class="hljs-variable">$PATH</span><br><span class="hljs-built_in">export</span> NETCDF=<span class="hljs-variable">$DIR</span>/netcdf/<br><span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$DIR</span>/mpich/bin:<span class="hljs-variable">$DIR</span>/mpich/lib:<span class="hljs-variable">$DIR</span>/mpich/include:<span class="hljs-variable">$PATH</span><br><br><span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$NETCDF</span>:<span class="hljs-variable">$NETCDF</span>/bin:<span class="hljs-variable">$PATH</span><br><span class="hljs-built_in">export</span> LIBS=<span class="hljs-string">&quot;-lnetcdf -lz&quot;</span><br><span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$NETCDF</span>/lib/:<span class="hljs-variable">$PATH</span><br><span class="hljs-built_in">export</span> LD_LIBRARY_PATH=<span class="hljs-variable">$NETCDF</span>/lib:<span class="hljs-variable">$&#123;LD_LIBRARY_PATH&#125;</span><br><span class="hljs-built_in">export</span> NETCDF_INC=<span class="hljs-string">&quot;<span class="hljs-variable">$NETCDF</span>/include&quot;</span><br><span class="hljs-built_in">export</span> NETCDF_LIB=<span class="hljs-string">&quot;<span class="hljs-variable">$NETCDF</span>/lib&quot;</span><br><span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$NETCDF_LIB</span>:<span class="hljs-variable">$NETCDF_INC</span>:<span class="hljs-variable">$PATH</span><br><br><span class="hljs-built_in">export</span> WRF_DIR=~/coding/WRF/Build_WRF/WRFV4.5.2<br><span class="hljs-built_in">export</span> WRFIO_NCD_NO_LARGE_FILE_SUPPORT=1<br><span class="hljs-built_in">export</span> HDF5PATH=<span class="hljs-variable">$NETCDF</span><br></code></pre></td></tr></table></figure><p>更改完成后，打开终端输入<code>source ~/.bashrc</code></p><h1 id="3-构建库"><a href="#3-构建库" class="headerlink" title="3. 构建库"></a>3. 构建库</h1><h2 id="3-0-下载所需库"><a href="#3-0-下载所需库" class="headerlink" title="3.0 下载所需库"></a>3.0 下载所需库</h2><p>下载地址：<a href="https://www2.mmm.ucar.edu/wrf/OnLineTutorial/compile_tutorial/tar_files/">Index of &#x2F;wrf&#x2F;OnLineTutorial&#x2F;compile_tutorial&#x2F;tar_files</a></p><p>需要下载的库如下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">netcdf-4.1.3.tar.gz<br>mpich-3.0.4.tar.gz<br>zlib-1.2.7.tar.gz<br>libpng-1.2.50.tar.gz<br>jasper-1.900.1.tar.gz<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> Build_WRF<br><span class="hljs-built_in">mkdir</span> LIBRARIES<br>LIBRARIES<br></code></pre></td></tr></table></figure><h2 id="3-1-NetCDF"><a href="#3-1-NetCDF" class="headerlink" title="3.1 NetCDF"></a>3.1 NetCDF</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 安装netcdf-c</span><br>tar xzvf netcdf-4.1.3.tar.gz     <span class="hljs-comment">#or just .tar if no .gz present</span><br><span class="hljs-built_in">cd</span> netcdf-4.1.3<br>./configure --prefix=<span class="hljs-variable">$DIR</span>/netcdf --disable-dap --disable-netcdf-4 --disable-shared<br>make<br>make install<br><span class="hljs-built_in">cd</span> ..<br></code></pre></td></tr></table></figure><h2 id="3-2-MPICH"><a href="#3-2-MPICH" class="headerlink" title="3.2 MPICH"></a>3.2 MPICH</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">tar xzvf mpich-3.0.4.tar.gz     <span class="hljs-comment">#or just .tar if no .gz present</span><br><span class="hljs-built_in">cd</span> mpich-3.0.4<br>./configure --prefix=<span class="hljs-variable">$DIR</span>/mpich<br>make<br>make install<br><span class="hljs-built_in">cd</span> ..<br></code></pre></td></tr></table></figure><h2 id="3-3-zlib"><a href="#3-3-zlib" class="headerlink" title="3.3 zlib"></a>3.3 zlib</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">tar xzvf zlib-1.2.11.tar.gz     <span class="hljs-comment">#or just .tar if no .gz present</span><br><span class="hljs-built_in">cd</span> zlib-1.2.11<br>./configure --prefix=<span class="hljs-variable">$DIR</span>/grib2<br>make<br>make install<br><span class="hljs-built_in">cd</span> ..<br></code></pre></td></tr></table></figure><h2 id="3-4-libpng"><a href="#3-4-libpng" class="headerlink" title="3.4 libpng"></a>3.4 libpng</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">tar xzvf libpng-1.2.50.tar.gz     <span class="hljs-comment">#or just .tar if no .gz present</span><br><span class="hljs-built_in">cd</span> libpng-1.2.50<br>./configure --prefix=<span class="hljs-variable">$DIR</span>/grib2<br>make<br>make install<br><span class="hljs-built_in">cd</span> ..<br></code></pre></td></tr></table></figure><h2 id="3-5-Jasper"><a href="#3-5-Jasper" class="headerlink" title="3.5 Jasper"></a>3.5 Jasper</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">tar xzvf jasper-1.900.1.tar.gz     <span class="hljs-comment">#or just .tar if no .gz present</span><br><span class="hljs-built_in">cd</span> jasper-1.900.1<br>./configure --prefix=<span class="hljs-variable">$DIR</span>/grib2<br>make<br>make install<br><span class="hljs-built_in">cd</span> ..<br></code></pre></td></tr></table></figure><h1 id="4-库兼容性测试"><a href="#4-库兼容性测试" class="headerlink" title="4. 库兼容性测试"></a>4. 库兼容性测试</h1><p>下载测试包<a href="https://www2.mmm.ucar.edu/wrf/OnLineTutorial/compile_tutorial/tar_files/Fortran_C_NETCDF_MPI_tests.tar">Fortran_C_NETCDF_MPI_tests.tar</a></p><p><strong><u>Test #1</u></strong>: Fortran + C + NetCDF</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cp</span> <span class="hljs-variable">$&#123;NETCDF&#125;</span>/include/netcdf.inc .<br><br>gfortran -c 01_fortran+c+netcdf_f.f<br>gcc -c 01_fortran+c+netcdf_c.c<br>gfortran 01_fortran+c+netcdf_f.o 01_fortran+c+netcdf_c.o -L<span class="hljs-variable">$&#123;NETCDF&#125;</span>/lib -lnetcdff -lnetcdf<br>./a.out<br></code></pre></td></tr></table></figure><p><em>以下内容将出现在屏幕上:</em></p><blockquote><p>C function called by Fortran<br>Values are xx &#x3D; 2.00 and ii &#x3D; 1<br>SUCCESS test 1 fortran + c + netcdf</p></blockquote><p><strong><u>Test #2</u></strong>: Fortran + C + NetCDF + MPI</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cp</span> <span class="hljs-variable">$&#123;NETCDF&#125;</span>/include/netcdf.inc .<br><br>mpif90 -c 02_fortran+c+netcdf+mpi_f.f<br>mpicc -c 02_fortran+c+netcdf+mpi_c.c<br>mpif90 02_fortran+c+netcdf+mpi_f.o 02_fortran+c+netcdf+mpi_c.o -L<span class="hljs-variable">$&#123;NETCDF&#125;</span>/lib -lnetcdff -lnetcdf<br>mpirun ./a.out<br></code></pre></td></tr></table></figure><p><em>以下内容将出现在屏幕上:</em></p><blockquote><p>C function called by Fortran<br>Values are xx &#x3D; 2.00 and ii &#x3D; 1<br>status &#x3D; 2<br>SUCCESS test 2 fortran + c + netcdf + mpi</p></blockquote><h1 id="5-构建WRF"><a href="#5-构建WRF" class="headerlink" title="5. 构建WRF"></a>5. 构建WRF</h1><p>在<code>Build_WRF</code>文件夹中解压<code>WRFv4.5.2.tar.gz</code>，解压后文件夹名为<code>WRFV4.5.2</code>，进入该文件夹。</p><p>编译前使用命令<code>uname -a</code>查看电脑详细信息。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> WRFV4.5.2<br>./configure<br></code></pre></td></tr></table></figure><p>这里注意使用<code>./configure</code>命令编译WRF时，从以下32、33、34中选择，推荐34；</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-number">32</span>. (serial) <span class="hljs-number">33</span>. (smpar) <span class="hljs-number">34</span>. (dmpar) <span class="hljs-number">35</span>. (dm+sm) GNU (gfortran/gcc)<br></code></pre></td></tr></table></figure><p><code>Compile for nesting?</code>选择<code>1=basic</code></p><p>出现如下则说明安装成功。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">Configuration successful! <br>------------------------------------------------------------------------<br></code></pre></td></tr></table></figure><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs subunit"><span class="hljs-keyword">Testing </span>for NetCDF, C and Fortran compiler<br><br>This installation of NetCDF is 64-bit<br>                 C compiler is 64-bit<br>           Fortran compiler is 64-bit<br>              It will build in 64-bit<br></code></pre></td></tr></table></figure><p>编译 <code>em_real</code> 。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">./compile em_real &gt;&amp; log.compile<br><span class="hljs-built_in">cd</span> ..<br></code></pre></td></tr></table></figure><p>编译成功<code>log.compile</code>会出现如下类似内容。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bansh">---&gt;                  Executables successfully built                  &lt;---<br> <br>-rwxrwxr-x 1 root123 root123 45400664 3月  21 10:49 main/ndown.exe<br>-rwxrwxr-x 1 root123 root123 45286000 3月  21 10:49 main/real.exe<br>-rwxrwxr-x 1 root123 root123 44823216 3月  21 10:49 main/tc.exe<br>-rwxrwxr-x 1 root123 root123 49968288 3月  21 10:48 main/wrf.exe<br> <br>==========================================================================<br></code></pre></td></tr></table></figure><p> 编译成功后会在<code>main</code>文件夹内出现以下文件，同时也可根据是否生成exe文件来检查是否编译成功。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">wrf.exe<br>real.exe<br>ndown.exe<br>tc.exe<br></code></pre></td></tr></table></figure><h1 id="6-构建WPS"><a href="#6-构建WPS" class="headerlink" title="6. 构建WPS"></a>6. 构建WPS</h1><p>在<code>Build_WRF</code>文件夹中解压<code>WPS-master.zip</code>，解压后文件夹更改为<code>WPSV4.5.0</code>，进入该文件夹。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> WPSV4.5.0<br>./clean<br>./configure --prefix=<span class="hljs-variable">$DIR</span>/netcdf CC=mpicc CXX=mpicxx FC=mpif90<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">^M: Command not found.<br>^M: Command not found.<br><span class="hljs-keyword">then</span>^M: Command not found.<br>endif^M: Command not found.<br>^M: Command not found.<br><span class="hljs-built_in">set</span>: Syntax Error.<br></code></pre></td></tr></table></figure><p>或执行<code>./configure</code>出现错误<code>bash: ./configure: /bin/sh^M: 解释器错误: 没有那个文件或目录</code>。</p><p>解决办法</p><p>进入WPSV4.5.0文件夹内输入以下命令即可。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sed -i <span class="hljs-string">&#x27;s/\r$//&#x27;</span> clean<br>sed -i <span class="hljs-string">&#x27;s/\r$//&#x27;</span> configure<br></code></pre></td></tr></table></figure><p>再输入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">./clean<br>./configure --prefix=<span class="hljs-variable">$DIR</span>/netcdf CC=mpicc CXX=mpicxx FC=mpif90<br></code></pre></td></tr></table></figure><p>编译WPS</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">sed -i <span class="hljs-string">&#x27;s/\r$//&#x27;</span> compile<br>./compile &gt;&amp; log.compile<br></code></pre></td></tr></table></figure><p>如果构建成功，<code>WPSV4.5.0</code>目录下应该存在3个可执行文件，链接到相应的<code>src/</code>目录。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">geogrid.exe -&gt; geogrid/src/geogrid.exe<br>ungrib.exe -&gt; ungrib/src/ungrib.exe<br>metgrid.exe -&gt; metgrid/src/metgrid.exe<br></code></pre></td></tr></table></figure><h1 id="7-静态地理数据"><a href="#7-静态地理数据" class="headerlink" title="7. 静态地理数据"></a>7. 静态地理数据</h1><ol><li><p>选择 <a href="https://www2.mmm.ucar.edu/wrf/src/wps_files/geog_high_res_mandatory.tar.gz">Download Highest Resolution of each Mandatory Field</a> 下载静态地理数据，这些是运行WPS和WRF所需的所有强制字段，包含每个必填字段的最高分辨率这是最常用的字段，建议用于大多数应用。如对其他字段感兴趣，可以直接访问<a href="https://www2.mmm.ucar.edu/wrf/users/download/get_sources_wps_geog.html">WPS V4地理静态数据下载页面</a>进行查看和下载。</p></li><li><p>下载完成后，解压完成后的文件名也许为<code>geog</code>。将文件重命名为<code>WPS_GEOG</code>。</p></li><li><p>在<code>Build_WRF</code>文件夹下新建文件夹<code>WPS_Data</code>，将解压后的文件夹<code>WPS_GEOG</code>移动到<code>./WPS_Data/WPS_Geographical_Static_Data/</code>目录下。</p></li><li><p>修改<code>namelist.wps</code>文件中<code>&amp;geogrid</code>部分的<code>geog_data_path</code>变量，<code>geog_data_path=&#39;/home/root123/coding/WRF/Build_WRF/WPS_Data/WPS_Geographical_Static_Data/WPS_GEOG&#39;</code>。</p><p>*<em>为了确保不出错，最好将高分辨率（<a href="https://www2.mmm.ucar.edu/wrf/src/wps_files/geog_high_res_mandatory.tar.gz">Highest Resolution</a>）数据和全部数据（<a href="https://www2.mmm.ucar.edu/wrf/src/wps_files/geog_complete.tar.gz">geog_complete</a>)都下载好的数据放入上面创建的<code>WPS_GEOG</code>文件夹中。</em></p></li></ol><h1 id="8-实时气象数据"><a href="#8-实时气象数据" class="headerlink" title="8. 实时气象数据"></a>8. 实时气象数据</h1><p>数据下载地址：<a href="https://www.ftp.ncep.noaa.gov/data/nccf/com/gfs/prod/">https://www.ftp.ncep.noaa.gov/data/nccf/com/gfs/prod/</a></p><p>也可使用wget命令下载GFS数据，以2024-03-12: 00时数据为例，该数据时间分辨率为6h（21600s）。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">wget https://www.ftp.ncep.noaa.gov/data/nccf/com/gfs/prod/gfs.20240312/00/atmos/gfs.t00z.pgrb2.0p25.f000<br><br>wget https://www.ftp.ncep.noaa.gov/data/nccf/com/gfs/prod/gfs.20230312/00/atmos/gfs.t00z.pgrb2.0p25.f003<br><br>wget https://www.ftp.ncep.noaa.gov/data/nccf/com/gfs/prod/gfs.20230312/00/atmos/gfs.t00z.pgrb2.0p25.f006<br></code></pre></td></tr></table></figure><p>在<code>Build_WRF</code>文件夹下创建文件夹<code>DATA</code>，将下载的GFS数据移动到<code>DATA</code>文件夹下。</p><h1 id="9-运行WPS和WRF"><a href="#9-运行WPS和WRF" class="headerlink" title="9. 运行WPS和WRF"></a>9. 运行WPS和WRF</h1><h2 id="9-1-运行WPS"><a href="#9-1-运行WPS" class="headerlink" title="9.1 运行WPS"></a>9.1 运行WPS</h2><p>进入<code>WPSV4.5.0</code>文件夹内，运行WPS。在运行之前，修改namelist.wps中的<code>geog-data_path</code>变量，注意一定要是绝对路径，不包含<code>~</code>。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">geog_data_path=<span class="hljs-string">&#x27;/home/root123/coding/WRF/Build_WRF/WPS_Data/WPS_Geographical_Static_Data/WPS_GEOG</span><br></code></pre></td></tr></table></figure><p>另外将namelist.wps文件中的内容替换为以下内容，以GFS文件<code>gfs.t00z.pgrb2.0p25.f000</code>为例。该文件为2024-03-12: 00时间点的<a href="https://www.ftp.ncep.noaa.gov/data/nccf/com/gfs/prod/">气象数据</a>，时间分辨率为6h（21600s）。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs textile">&amp;share<br> wrf_core = &#x27;ARW&#x27;,<br> max_dom = 2,<br> start_date = &#x27;2024-03-12_00:00:00&#x27;,&#x27;2024-03-12_00:00:00&#x27;,<br> end_date   = &#x27;2024-03-12_00:00:00&#x27;,&#x27;2024-03-12_00:00:00&#x27;,<br> interval_seconds = 21600,<br> io_form_geogrid = 2<br>/<br><br>&amp;geogrid<br> parent_id         =   1,   1,<br> parent_grid_ratio =   1,   3,<br> i_parent_start    =   1,  10,<br> j_parent_start    =   1,  20,<br> e_we              =  150, 220,<br> e_sn              =  130, 214,<br> geog_data_res = &#x27;default&#x27;,&#x27;default&#x27;,<br> dx = 15000,<br> dy = 15000,<br> map_proj = &#x27;lambert&#x27;,<br> ref_lat   =  28.00,<br> ref_lon   =  104.00,<br> truelat1  =  28.0,<br> truelat2  =  28.0,<br> stand_lon =  104.0,<br> geog_data_path = &#x27;/home/root123/coding/WRF/Build_WRF/WPS_Data/WPS_Geographical_Static_Data/WPS_GEOG&#x27;<br>/<br><br>&amp;ungrib<br> out_format = &#x27;WPS&#x27;,<br> prefix = &#x27;FILE&#x27;,<br>/<br><br>&amp;metgrid<br> fg_name = &#x27;FILE&#x27;<br>/<br></code></pre></td></tr></table></figure><p>修改完成后，开始运行程序。</p><ol><li><p>执行<code>geogrid.exe</code>, 这一步将生成<code>geo_em</code>文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> WPSV4.5.0<br><br>./geogrid.exe &gt;&amp; log.geogrid<br></code></pre></td></tr></table></figure></li></ol><p> <code>geogrid.exe</code>执行成功后，会在<code>geogrid.log</code> 文件末尾出现以下内容。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs textile">2024-03-21 16:58:31.070 ---  *** Successful completion of program geogrid.exe ***<br></code></pre></td></tr></table></figure><ol start="2"><li><p>执行ungrib.exe，这一步将生成前缀为’FILE’的文件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">./link_grib.csh ../DATA/gfs.t00z.pgrb2.0p25.f000<br><span class="hljs-built_in">ln</span> -sf ungrib/Variable_Tables/Vtable.GFS Vtable<br>./ungrib.exe &gt;&amp; log.ungrib<br></code></pre></td></tr></table></figure><p><code>ungrib.exe</code>执行成功后，会在<code>ungrib.log</code>文件末尾出现以下内容。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs textile">2024-03-21 17:13:42.605 --- ****  Deleting temporary files created by ungrib...<br>2024-03-21 17:13:42.605 ---  Deleting file: ./PFILE:2024-03-12_00<br>2024-03-21 17:13:42.756 --- ****  Done deleting temporary files.<br>2024-03-21 17:13:42.756 ---  *** Successful completion of program ungrib.exe ***<br></code></pre></td></tr></table></figure></li><li><p>执行metgrid.exe，这一步将生成每个时间段的前缀为<code>met_em*</code>的文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">./metgrid.exe &gt;&amp; log.metgrid<br></code></pre></td></tr></table></figure></li></ol><p><code>metgrid.exe</code>执行成功后，会在<code>metgrid.log</code>文件末尾出现以下内容。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs textile">2024-03-21 17:24:05.809 ---  *** Successful completion of program metgrid.exe ***<br></code></pre></td></tr></table></figure><h2 id="9-2-运行WRF"><a href="#9-2-运行WRF" class="headerlink" title="9.2 运行WRF"></a>9.2 运行WRF</h2><p>进入<code>WRFV4.5.2/test/em_real/</code>目录下。首先将刚才<code>WPSV4.5.0</code>目录下生成的前缀为<code>met_em*</code>的文件拷贝到<code>WRFV4.5.2/test/em_real/</code>目录下。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cp</span> met_em* ../WRFV4.5.2/test/em_real/<br><span class="hljs-built_in">cd</span> ../WRFV4.5.2/test/em_real/<br>mpirun -np 1 ./real.exe<br></code></pre></td></tr></table></figure><p>这将生成两个文件，分别为<code>rsl.error.0000</code>和<code>rsl.out.0000</code>。如果在<code>rsl.error.0000</code>文件中看到<code>SUCCESS</code>，并且生成<code>wrfbdy_d01</code>和<code>wrfinput_d0*</code>文件，证明运行成功，继续执行</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">mpirun -np 8 ./wrf.exe<br></code></pre></td></tr></table></figure><p>再次检查<code>rsl</code>文件是否<code>SUCCESS</code>，并确保拥有预期所有的<code>wrfout*</code>文件。如果有，则运行成功。</p><h1 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h1><ol><li><p><a href="https://zhuanlan.zhihu.com/p/350005982">知乎-Ubuntu中配置WRF</a></p></li><li><p><a href="https://www2.mmm.ucar.edu/wrf/OnLineTutorial/compilation_tutorial.php">WRF-How to Compile WRF: The Complete Process</a></p></li></ol>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>toolkit</tag>
      
      <tag>软件安装</tag>
      
      <tag>WRF4.5.2</tag>
      
      <tag>WPS4.5.0</tag>
      
      <tag>ubuntu16.04</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>如何理解序贯平差、卡尔曼滤波和集合卡尔曼滤波</title>
    <link href="/2024/03/11/%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3%E5%BA%8F%E8%B4%AF%E5%B9%B3%E5%B7%AE%E3%80%81%E5%8D%A1%E5%B0%94%E6%9B%BC%E6%BB%A4%E6%B3%A2%E5%92%8C%E9%9B%86%E5%90%88%E5%8D%A1%E5%B0%94%E6%9B%BC%E6%BB%A4%E6%B3%A2/"/>
    <url>/2024/03/11/%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3%E5%BA%8F%E8%B4%AF%E5%B9%B3%E5%B7%AE%E3%80%81%E5%8D%A1%E5%B0%94%E6%9B%BC%E6%BB%A4%E6%B3%A2%E5%92%8C%E9%9B%86%E5%90%88%E5%8D%A1%E5%B0%94%E6%9B%BC%E6%BB%A4%E6%B3%A2/</url>
    
    <content type="html"><![CDATA[<h1 id="序贯平差"><a href="#序贯平差" class="headerlink" title="序贯平差"></a>序贯平差</h1><h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><p>序贯平差也叫逐次相关间接平差，它是将观测值分成两组或多组，按组的顺序分别做相关间接平差，从而使其达到与两期或多期网一起做整体平差同样的结果。</p><h2 id="公式推导"><a href="#公式推导" class="headerlink" title="公式推导"></a>公式推导</h2><p>将观测值 L 分为两组，记 $\overset{L_{k-1}}{\tiny n_{k-1}}$ 和 $\overset{L_{k}}{\tiny n_{k}}$, 它们的权阵分别记为 $P_{k-1}$ 和 $P_{k}$，设这两组观测值不相关，有<br>$$<br>\overset{L}{\tiny n \ 1} &#x3D; [\ \begin{matrix} L_{k-1} \ L_{k} \end{matrix}\ ]<br>$$<br>$$<br>\overset{P}{\tiny n \ n} &#x3D; \begin{equation} \left[ \begin{matrix} P_{k-1} &amp; 0 \ 0 &amp; P_{k} \end{matrix} \right] \end{equation}<br>$$<br>当参数间不存在约束条件时，其误差方程为<br>$$<br>\begin{equation} V_{k-1} &#x3D; B_{k-1}  \hat{x} - l_{k-1}<br>\tag{1}\end{equation}<br>$$<br>$$<br>\begin{equation} V_{k} &#x3D; B_{k}  \hat{x} - l_{k}<br>\tag{2}\end{equation}<br>$$<br>式中<br>$$<br>\hat{X} &#x3D; X^0 + \hat{x}, \quad l_{i}&#x3D;L_{i}-L_{i}^0(i&#x3D;k,k-1)<br>$$<br>将 （1）式单独平差，得<br>$$<br>\hat{x}<em>{k-1} &#x3D; Q</em>{\hat{x}<em>{k-1}}B</em>{k-1}^TP_{k-1}l_{k-1} \tag{3}<br>$$<br>式中，$Q_{\hat{x}<em>{k-1}}$ 为 $\hat{X}</em>{k-1}$ (即 $\hat{x}<em>{k-1}$) 的协因数阵，故有<br>$$<br>Q</em>{\hat{X}<em>{k-1}} &#x3D; (B</em>{k-1}^T P_{k-1}B_{k-1})^{-1} \tag{4}<br>$$<br>或<br>$$<br>Q_{\hat{X}<em>{k-1}} ^{-1}&#x3D; (B</em>{k-1}^T P_{k-1}B_{k-1}) \tag{5}<br>$$<br>$\hat{x}<em>{k-1}$ 表示由第一组观测值 $L</em>{k-1}$ 平差所得 $\hat{x}$ 的值<br>将（1）和（2）联合解算，即由两组观测值作整体平差，可组成法方程为<br>$$<br>(Q_{\hat{X}<em>{k-1}} ^{-1}+ B</em>{k}^T P_{k}B_{k}) \hat{x}-(B_{k-1}^TP_{k-1}B_{k-1}+B_{k}^TP_{k}l_{k})&#x3D;0 \tag{6}<br>$$<br>其解为<br>$$<br>\hat{x}&#x3D;(Q_{\hat{X}<em>{k-1}} ^{-1}+ B</em>{k}^T P_{k}B_{k})^{-1}(B_{k-1}^TP_{k-1}B_{k-1}+B_{k}^TP_{k}l_{k})<br>$$<br>它是两组观测值整体平差的结果，按间接平差知，其法方程系数的逆阵就是\ $\hat{X}$ 的协因数阵，故有<br>$$<br>Q_{\hat{X}}&#x3D;(Q_{\hat{X}<em>{k-1}} ^{-1}+ B</em>{k}^T P_{k}B_{k})^{-1} \tag{7}<br>$$<br>于是上式为<br>$$<br>\hat{x}&#x3D;Q_{\hat{X}}B_{k-1}^TP_{k-1}B_{k-1}+Q_{\hat{X}}B_{k}^TP_{k}l_{k} \tag{8}<br>$$<br>考虑（3）和（7）式，<br>$$<br>B_{k-1}^TP_{k-1}l_{k-1}&#x3D;Q_{\hat{X}<em>{k-1}}^{-1}\hat{x}</em>{k-1} \tag{9}<br>$$<br>$$<br>Q_{\hat{X}<em>{k-1}}^{-1}&#x3D;Q</em>{\hat{X}<em>{k}}^{-1}-B</em>{k}^T P_{k} B_{k} \tag{10}<br>$$<br>则（8）式为<br>$$<br>\hat{x}&#x3D;\hat{x}<em>{k-1}+Q</em>{\hat{X}} B_{k}^T P_{k}(l_{k}-B_{k}\hat{x}<em>{k-1}) \tag{11}<br>$$<br>令<br>$$<br>J&#x3D;Q</em>{\hat{X}}B_{k}^T P_{k} \tag{12}<br>$$<br>$$<br>\bar{l}<em>{k} &#x3D; l</em>{k} - B_{k}\hat{x}<em>{k-1} \tag{13}<br>$$<br>则上式为<br>$$<br>\hat{x}&#x3D;\hat{x}</em>{k-1}+J \bar{l}<em>{k} \tag{14}<br>$$<br>将（10）式两边左乘 $Q</em>{\hat{X}}$,，顾及（12）得<br>$$<br>Q_{\hat{X}}Q_{\hat{X}<em>{k-1}}^{-1} &#x3D; I-JB</em>{k}<br>$$<br>再对两边右乘 $Q_{\hat{X}<em>{k-1}}$，得<br>$$<br>Q</em>{\hat{X}}&#x3D;Q_{\hat{X}<em>{k-1}} - JB</em>{k}Q_{\hat{X}<em>{k-1}} \tag{15}<br>$$<br>由矩阵反演公式知<br>$$<br>\begin{equation}<br>Q</em>{\hat{X}} &#x3D; (Q_{\hat{X}<em>{k-1}}^{-1}+B</em>{k}^T P_{k}B_{k})^{-1}<br>&#x3D;Q_{\hat{X}<em>{k-1}}-Q</em>{\hat{X}<em>{k-1}}B</em>{k}^T(P_{k}^{-1}+B_{k}Q_{\hat{X}<em>{k-1}}B</em>{k}^T)^{-1}B_{k}Q_{\hat{X}<em>{k-1}}<br>\end{equation} \tag{16}<br>$$<br>比较（15）与（16）式知：<br>$$<br>J &#x3D; Q</em>{\hat{X}<em>{k-1}}B</em>{k}^T (P_{k}^{-1}+B_{k}Q_{\hat{X}<em>{k-1}}B</em>{k}^T)^{-1} \tag{17}<br>$$<br>J 阵称为卡尔曼滤波增益矩阵或称序贯平差的增益矩阵。<br>将（17）式代入（14）式即得序贯平差的递推计算式。</p><h2 id="结论-序贯平差算法"><a href="#结论-序贯平差算法" class="headerlink" title="结论 (序贯平差算法)"></a>结论 (序贯平差算法)</h2><ol><li><p>使用参数平差改正值 $\hat{x}$ 计算<br>状态递推<br>$$<br>\hat{x}<em>{k} &#x3D; \hat{x}</em>{k-1} + J_{k} \bar{l}<em>{k}<br>$$<br>$$<br>\bar{l}</em>{k} &#x3D; l_{k} - B_{k}\hat{x}<em>{k-1}<br>$$<br>方差递推<br>$$<br>\begin{equation}<br>Q</em>{\hat{X}} &#x3D;Q_{\hat{X}<em>{k-1}}-Q</em>{\hat{X}<em>{k-1}}B</em>{k}^T(P_{k}^{-1}+B_{k}Q_{\hat{X}<em>{k-1}}B</em>{k}^T)^{-1}B_{k}Q_{\hat{X}<em>{k-1}}<br>\end{equation}<br>$$<br>增益矩阵<br>$$<br>J &#x3D; Q</em>{\hat{X}<em>{k-1}}B</em>{k}^T (P_{k}^{-1}+B_{k}Q_{\hat{X}<em>{k-1}}B</em>{k}^T)^{-1}<br>$$</p></li><li><p>使用参数平差值（待估状态/参数量）$\hat{X}$ 计算<br>状态递推<br>$$<br>\hat{X}<em>{k} &#x3D; \hat{X}</em>{k-1} + J_{k} \bar{L}<em>{k}<br>$$<br>$$<br>\bar{L}</em>{k} &#x3D; L_{k} - B_{k}\hat{X}<em>{k-1}<br>$$<br>方差递推<br>$$<br>\begin{equation}<br>Q</em>{\hat{X}<em>{k}} &#x3D;Q</em>{\hat{X}<em>{k-1}}-Q</em>{\hat{X}<em>{k-1}}B</em>{k}^T(P_{k}^{-1}+B_{k}Q_{\hat{X}<em>{k-1}}B</em>{k}^T)^{-1}B_{k}Q_{\hat{X}<em>{k-1}}<br>\end{equation}<br>$$<br>增益矩阵<br>$$<br>J</em>{k} &#x3D; Q_{\hat{X}<em>{k-1}}B</em>{k}^T (P_{k}^{-1}+B_{k}Q_{\hat{X}<em>{k-1}}B</em>{k}^T)^{-1}<br>$$</p></li></ol><h2 id="推导流程"><a href="#推导流程" class="headerlink" title="推导流程"></a>推导流程</h2><p>使用参数平差值（待估状态/参数量）$\hat{X}$ 计算</p><h1 id="卡尔曼滤波"><a href="#卡尔曼滤波" class="headerlink" title="卡尔曼滤波"></a>卡尔曼滤波</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>卡尔曼滤波是一种线性最小方差估计，采用动力学方程即状态方程描述被估计量的动态变化规律，被估计量的动态统计信息由激励白噪声的统计信息和动力学方程确定。其计算过程是一个不断地预测、修正的过程。在求解时不需要存储大量的观测数据，并且当得到新的观测数据时，可随时估算得新的滤波值，便于实时处理观测结果。<br>1.基于前一时间点的系统状态的概率分布给出当前时间点的系统状态的概率分布预测 P1<br>2.基于当前时间点的观测量的概率分布 Q 给出另一组对当前时间点系统状态的概率分布预测 P2 (这里需要注意，如果传感器能直接把系统状态都观测了，那么我们直接用观测量的概率分布 Q 作为 P2 就好了，但是有可能传感器观测的物理量量并不是直接的系统状态，而是其他物理量，这时我们需要通过做一个线性变换来获得 P2)<br>3.现在，我们有两个关于当前时间点系统状态的概率分布的预测 P1 和 P2，我们于是可以计算它们的联合概率分布，这个联合概率分布就是我们最终想要的更正过后的当前时间点的系统状态概率分布，有了它我们就可以进入下一个时间点继续迭代我们交替的预测-更正步骤了。<br>注意：系统状态和测量值都服从线性高斯分布。</p><h2 id="卡尔曼滤波算法"><a href="#卡尔曼滤波算法" class="headerlink" title="卡尔曼滤波算法"></a>卡尔曼滤波算法</h2><p>状态递推<br>$$<br>x_{k}’&#x3D;x_{k}+K’(\overrightarrow z_{k} - H_{k}X_{k})<br>$$<br>方差递推<br>$$<br>P_{k}’&#x3D;P_{k}-K’H_{k}P_{k}<br>$$<br>增益矩阵<br>$$<br>K’&#x3D;P_{k}H_{k}^T(H_{k}P_{k}H_{k}^T+R_{k})^{-1}<br>$$</p><p>变量解释<br>$$<br>x_{K}’: 最佳估计<br>$$<br>$$<br>x_{k}: 当前状态<br>$$<br>$$<br>P_{k}: 当前状态x_{k}的协方差阵<br>$$<br>$$<br>\overrightarrow z_{k}: 观测值平均值<br>$$</p><p>$H_{k}$: 由于单位、比例等不同对传感器加上一个映射矩阵（尺度变换），从而保证每个传感器输出读数尺度相同，处于同一空间<br>$$<br>R_{k}: 传感器噪声<br>$$<br>$$<br>K’ : 卡尔曼增益<br>$$</p><h1 id="集合卡尔曼滤波"><a href="#集合卡尔曼滤波" class="headerlink" title="集合卡尔曼滤波"></a>集合卡尔曼滤波</h1><h1 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h1><p><a href="https://blog.csdn.net/Gou_Hailong/article/details/122926813">序贯最小二乘平差 &#x2F; 递推最小二乘平差公式推导</a><br><a href="https://blog.csdn.net/Gou_Hailong/article/details/131031339">序贯最小二乘平差 VS 卡尔曼滤波</a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>卡尔曼滤波</tag>
      
      <tag>序贯平差</tag>
      
      <tag>公式推导</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SWOT介绍、研究现状及应用</title>
    <link href="/2023/12/07/SWOT%E4%BB%8B%E7%BB%8D%E3%80%81%E7%A0%94%E7%A9%B6%E7%8E%B0%E7%8A%B6%E5%8F%8A%E5%BA%94%E7%94%A8/"/>
    <url>/2023/12/07/SWOT%E4%BB%8B%E7%BB%8D%E3%80%81%E7%A0%94%E7%A9%B6%E7%8E%B0%E7%8A%B6%E5%8F%8A%E5%BA%94%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h3 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h3><p>[Bates2014] Bates, P. D., Neal, J. C., Alsdorf, D., &amp; Schumann, G. J.-P. (2014). Observing Global Surface Water Flood Dynamics. Surveys in Geophysics, 35(3), 839–852. <a href="https://doi.org/10.1007/s10712-013-9269-4">https://doi.org/10.1007/s10712-013-9269-4</a><br>[Bernardi2021]: Bernardi, M. S., Africa, P. C., de Falco, C., Formaggia, L., Menafoglio, A., &amp; Vantini, S. (2021). On the Use of Interferometric Synthetic Aperture Radar Data for Monitoring and Forecasting Natural Hazards. Mathematical Geosciences, 53(8), 1781–1812. <a href="https://doi.org/10.1007/s11004-021-09948-8">https://doi.org/10.1007/s11004-021-09948-8</a><br>[Biancamaria2016] Biancamaria, S., Lettenmaier, D. P., &amp; Pavelsky, T. M. (2016). The SWOT Mission and Its Capabilities for Land Hydrology. Surveys in Geophysics, 37(2), 307–337. <a href="https://doi.org/10.1007/s10712-015-9346-y">https://doi.org/10.1007/s10712-015-9346-y</a><br>[Morrow2019] Morrow, R., Fu, L.-L., Ardhuin, F., Benkiran, M., Chapron, B., Cosme, E., d’Ovidio, F., Farrar, J. T., Gille, S. T., Lapeyre, G., Le Traon, P.-Y., Pascual, A., Ponte, A., Qiu, B., Rascle, N., Ubelmann, C., Wang, J., &amp; Zaron, E. D. (2019). Global Observations of Fine-Scale Ocean Surface Topography With the Surface Water and Ocean Topography (SWOT) Mission. Frontiers in Marine Science, 6, 232. <a href="https://doi.org/10.3389/fmars.2019.00232">https://doi.org/10.3389/fmars.2019.00232</a><br>[Gleason2020] Gleason, C., &amp; Durand, M. (2020). Remote Sensing of River Discharge: A Review and a Framing for the Discipline. Remote Sensing, 12(7), 1107. <a href="https://doi.org/10.3390/rs12071107">https://doi.org/10.3390/rs12071107</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>文献分享</tag>
      
      <tag>SWOT</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SBAS-InSAR脚本分享-杨红磊InSAR技术原理及实践</title>
    <link href="/2023/11/09/SBAS-InSAR%E8%84%9A%E6%9C%AC%E5%88%86%E4%BA%AB-%E6%9D%A8%E7%BA%A2%E7%A3%8AInSAR%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%8F%8A%E5%AE%9E%E8%B7%B5/"/>
    <url>/2023/11/09/SBAS-InSAR%E8%84%9A%E6%9C%AC%E5%88%86%E4%BA%AB-%E6%9D%A8%E7%BA%A2%E7%A3%8AInSAR%E6%8A%80%E6%9C%AF%E5%8E%9F%E7%90%86%E5%8F%8A%E5%AE%9E%E8%B7%B5/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉, 这个密码看着不太对, 请再试试." data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容.">  <script id="hbeData" type="hbeData" data-hmacdigest="2bf82e17f8ef67a10c53268144976fb8d21b58c41bbfbaa01d01d96cf6dea476">44eaead48cb14defec622705ebe9c77ef6ac9b82f5e24069bd1fd6247bba49762ea395fd031549ebc06d64c69f67095e30fd28af6d09d60a9b2c95e1d9f700924cf45b49ad5c6ab2e6c6fdf3a2d17bfab57434eb8af214b38b64d0a7b8152b6d7221676f8838044437cfeca654804b1e6a101f00f08639cf6edb66ffba859ef48fe7c8d3343df6c14861f7006d60c6e8</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-xray">      <input class="hbe hbe-input-field hbe-input-field-xray" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-xray" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-xray">您好, 这里需要密码.</span>      </label>      <svg class="hbe hbe-graphic hbe-graphic-xray" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>        <path d="M0,2.5c0,0,298.666,0,399.333,0C448.336,2.5,513.994,13,597,13c77.327,0,135-10.5,200.999-10.5c95.996,0,402.001,0,402.001,0"></path>      </svg>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    
    <tags>
      
      <tag>InSAR</tag>
      
      <tag>SBAS-InSAR</tag>
      
      <tag>Sentinel-1</tag>
      
      <tag>脚本</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>matlab提取tif中的z值数据并保存为txt</title>
    <link href="/2023/11/01/%E6%8F%90%E5%8F%96tif%E4%B8%AD%E7%9A%84z%E5%80%BC%E6%95%B0%E6%8D%AE%E5%B9%B6%E4%BF%9D%E5%AD%98%E4%B8%BAtxt/"/>
    <url>/2023/11/01/%E6%8F%90%E5%8F%96tif%E4%B8%AD%E7%9A%84z%E5%80%BC%E6%95%B0%E6%8D%AE%E5%B9%B6%E4%BF%9D%E5%AD%98%E4%B8%BAtxt/</url>
    
    <content type="html"><![CDATA[<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-keyword">function</span> tif2grd(input_abspath, output_abspath)<br>%&#123;<br>读取tif数据并转化为txt文件，主要用于读取InSAR处理后的形变数据。<br>input_abspath: str<br>    输入的tif文件的绝对/相对路径，<span class="hljs-string">&#x27;E:\tif2txt\disp.tiff&#x27;</span>;<br>output_abspath：str<br>    输出txt文件的绝对/相对路径，<span class="hljs-string">&#x27;E:\tif2txt\outputdata.txt&#x27;</span>;<br>example:<br>    tif2grd(<span class="hljs-string">&#x27;.\disp.tiff&#x27;</span>, <span class="hljs-string">&#x27;.\outputdata.txt&#x27;</span>)<br>%&#125;<br><br>[value_m, geoinfo]= geotiffread(input_abspath);<br>[m_row, m_col] = size(value_m);<br>ngrid = m_row * m_col;<br>disp_value = reshape(value_m, ngrid,<span class="hljs-number">1</span>);<br>lonlat_spacing = geoinfo.SampleSpacingInLatitude;<br>lon_lim = geoinfo.LongitudeLimits;<br>lat_lim = geoinfo.LatitudeLimits;<br><br>lon = lon_lim(<span class="hljs-number">1</span>):lonlat_spacing:lon_lim(<span class="hljs-number">2</span>);<br>lat = lat_lim(<span class="hljs-number">1</span>):lonlat_spacing:lat_lim(<span class="hljs-number">2</span>);<br><br><span class="hljs-keyword">if</span> length(lon) ~= m_col || length(lat) ~= m_row<br>    disp(<span class="hljs-string">&#x27;number of lon or lat error.&#x27;</span>);<br>    <span class="hljs-keyword">exit</span>;<br>end<br><br>[glon,glat] = meshgrid(lon,lat);<br>glon_l = reshape(glon, ngrid, <span class="hljs-number">1</span>);<br>glat_l = reshape(glat, ngrid, <span class="hljs-number">1</span>);<br><br>output_m = [glon_l, glat_l, disp_value];<br>dlmwrite(output_abspath, output_m, <span class="hljs-string">&#x27;delimiter&#x27;</span>, <span class="hljs-string">&#x27;\t&#x27;</span>);<br>disp(<span class="hljs-string">&#x27;save .txt data successfule&#x27;</span>)<br>end<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>InSAR</tag>
      
      <tag>脚本</tag>
      
      <tag>Matlab</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>如何利用GACOS数据去除Sentinel-1干涉图中的大气</title>
    <link href="/2023/10/01/%E5%A6%82%E4%BD%95%E5%88%A9%E7%94%A8GACOS%E6%95%B0%E6%8D%AE%E5%8E%BB%E9%99%A4Sentinel-1%E5%B9%B2%E6%B6%89%E5%9B%BE%E4%B8%AD%E7%9A%84%E5%A4%A7%E6%B0%94/"/>
    <url>/2023/10/01/%E5%A6%82%E4%BD%95%E5%88%A9%E7%94%A8GACOS%E6%95%B0%E6%8D%AE%E5%8E%BB%E9%99%A4Sentinel-1%E5%B9%B2%E6%B6%89%E5%9B%BE%E4%B8%AD%E7%9A%84%E5%A4%A7%E6%B0%94/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉, 这个密码看着不太对, 请再试试." data-whm="抱歉, 这个文章不能被校验, 不过您还是能看看解密后的内容.">  <script id="hbeData" type="hbeData" data-hmacdigest="def4af5be3c5adf5655a9c6b9f0b2a509722852ea34429002b0c54aea631c4b9">44eaead48cb14defec622705ebe9c77ee718930665510050f1813792022ffa96347e1c50b0c0bfb335a61b1f7de1a1da93cd5e430402739d7780f9b03c6bb4333b2db2e261f59786adf6593503af4a886f78a0c9844eddb9b931ad7c98d9271242918a201486db243c889ae428f12d22bc6d7a884d6988fb880e110d15f5a61a8c35b1d2cd14d7d6c3100969c4ea4b6a94367eb63730ed9f0cbc4e53be1ca9713c5560afb0edb162dbaff2e8c3949414cd58be459819314c8a113f34e3f8587826660d5f1a9030c7022a38d6f2446a3efe27b8b9df30f93a729df2af6d6a9716ddfd4a0001b17a14a8b6137afd90b2f814c83beb649b7a2aa31dd2977495d1b6bea6f3171bf9431518fada872b44e7093e95a5a686faa1912942949ca7418deb3c2ff9adcfd7dc3dac4f8fd1592eb67eaaa4009a906462bd625fb2209fc5dd67082351d61b8f3aa240cb07390f19d0a5</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-xray">      <input class="hbe hbe-input-field hbe-input-field-xray" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-xray" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-xray">您好, 这里需要密码.</span>      </label>      <svg class="hbe hbe-graphic hbe-graphic-xray" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>        <path d="M0,2.5c0,0,298.666,0,399.333,0C448.336,2.5,513.994,13,597,13c77.327,0,135-10.5,200.999-10.5c95.996,0,402.001,0,402.001,0"></path>      </svg>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>InSAR</tag>
      
      <tag>Sentinel-1</tag>
      
      <tag>GACOS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>在ubuntu16.04中使用conda安装gdal/osgeo</title>
    <link href="/2023/09/30/%E5%9C%A8ubuntu16.04%E4%B8%AD%E4%BD%BF%E7%94%A8conda%E5%AE%89%E8%A3%85gdal-osgeo/"/>
    <url>/2023/09/30/%E5%9C%A8ubuntu16.04%E4%B8%AD%E4%BD%BF%E7%94%A8conda%E5%AE%89%E8%A3%85gdal-osgeo/</url>
    
    <content type="html"><![CDATA[<h1 id="ubuntu16-04"><a href="#ubuntu16-04" class="headerlink" title="ubuntu16.04"></a>ubuntu16.04</h1><h2 id="ubuntu安装gdal程序"><a href="#ubuntu安装gdal程序" class="headerlink" title="ubuntu安装gdal程序"></a>ubuntu安装gdal程序</h2><p>打开终端，输入</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">sudo apt-get <span class="hljs-keyword">install </span>gdal-<span class="hljs-keyword">bin </span>libgdal-dev<br></code></pre></td></tr></table></figure><p>检测是否安装成功，输入</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lua">gdal-<span class="hljs-built_in">config</span> <span class="hljs-comment">--version</span><br></code></pre></td></tr></table></figure><p>打印版本号表示安装成功。</p><h2 id="conda-安装GDAL"><a href="#conda-安装GDAL" class="headerlink" title="conda 安装GDAL"></a>conda 安装GDAL</h2><h3 id="方法一：命令安装"><a href="#方法一：命令安装" class="headerlink" title="方法一：命令安装"></a>方法一：命令安装</h3><p> (1) 更新源<br>参考<a href="https://blog.csdn.net/weixin_43287414/article/details/108791177">Ubuntu20.04中关于conda下载包速度慢或者失败的问题</a>更新conda源。</p><p> (2) 激活conda环境，查找可用GDAL包<br> <figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">source</span> activate licsbas<br>conda <span class="hljs-built_in">search</span> gdal<br></code></pre></td></tr></table></figure><br> 我的conda环境名为licsbas，python&#x3D;3.6，因此可选择安装gdal&#x3D;3.0.2的包。</p> <p>使用安装命令进行安装。</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">conda</span> install gdal=<span class="hljs-number">3</span>.<span class="hljs-number">0</span>.<span class="hljs-number">2</span><br></code></pre></td></tr></table></figure><p> (3)查看是否安装成功<br> 打开终端，激活环境，输入以下内容<br> <figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs stylus">python<br><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(gdal)</span></span><br></code></pre></td></tr></table></figure><br> 显示gdal路径则表示安装成功。</p> <p>（4）查看库所在安装路径<br>通常存放在 <code>/home/root123/anaconda3/envs/licsbas/lib/python3.6/site-package</code> 路径下，路径中的 <code>licsbas</code>为虚拟环境名，<code>python3.6</code> 因为你安装的python版本不同而不同，<code>root123</code> 为用户名。采用 <a href="https://singyutang.github.io/2023/09/26/ubuntu16.04%E5%AE%89%E8%A3%85Pycharm%E5%92%8CAnaconda3/">ubuntu16.04安装Pycharm和Anaconda3</a> 中的方法默认安装anaconda在 <code>/home</code> 目录下。</p><h3 id="方法二：下载安装包-命令进行安装"><a href="#方法二：下载安装包-命令进行安装" class="headerlink" title="方法二：下载安装包+命令进行安装"></a>方法二：下载安装包+命令进行安装</h3><p> (1) 激活conda环境，查找可用GDAL包<br> <figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">source</span> activate licsbas<br>conda <span class="hljs-built_in">search</span> gdal<br></code></pre></td></tr></table></figure><br> 我的conda环境名为licsbas，python&#x3D;3.6，因此可选择安装gdal&#x3D;3.0.2的包。</p><p> (2)使用<a href="https://pypi.tuna.tsinghua.edu.cn/simple/GDAL/">python第三方库清华镜像网站</a>下载适合版本的安装包。<br> </p><p>（3）解压后，文件夹内有一个<code>README.rst</code>，按照该文件中的安装教程进行安装（我使用第一种方法成功了，就没有采用第二种方法）。</p><h3 id="方法三：直接下载包文件-复制到指定文件夹"><a href="#方法三：直接下载包文件-复制到指定文件夹" class="headerlink" title="方法三：直接下载包文件+复制到指定文件夹"></a>方法三：直接下载包文件+复制到指定文件夹</h3><p> （1）直接下载<a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/linux-64/">清华大学开源软件站</a>中的GDAL包，以GDAL3.0.2+python3.6为例，下载<code>gdal-3.0.2-py36hbb2a789_0.tar.bz2</code>包。注意最后一个数字为0的 tar.bz2 包，这个包和方法一中使用命令安装的包完全一样。</p><p>（2）解压后，将文件目录 <code>.\gdal-3.0.2-py36hbb2a789_0\lib\python3.6\site-packages\</code> 下的所有文件复制到 conda虚拟环境下的 <code>site-packages</code> 下即可。如不知道 <code>site-packages</code> 的具体位置，可参照方法一（4）。</p><p>（3）复制完成后，即可使用。</p><h1 id="Windows10"><a href="#Windows10" class="headerlink" title="Windows10"></a>Windows10</h1><p>参考博客：<a href="https://blog.csdn.net/weixin_44467482/article/details/123851372">python01_第三方库安装gdal&#x2F;osgeo</a></p><h1 id="参考博客和网站"><a href="#参考博客和网站" class="headerlink" title="参考博客和网站"></a>参考博客和网站</h1><p><a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/linux-64/">清华大学开源软件站</a><br><a href="http://download.osgeo.org/gdal/">osgeo.ogr</a><br><a href="https://pypi.tuna.tsinghua.edu.cn/simple/">python第三方库清华镜像网站</a><br><a href="https://www.lfd.uci.edu/~gohlke/pythonlibs/#gdal">非官方python第三方扩展包-Windows</a></p><p><a href="https://blog.csdn.net/qq_43542987/article/details/115455043">Ubuntu系统osgeo+gdal安装集合贴</a><br><a href="https://zhuanlan.zhihu.com/p/61696526">pip 或 conda 安装第三方库超时（Read timed out）问题</a><br><a href="https://blog.csdn.net/weixin_44467482/article/details/123851372">python01_第三方库安装gdal&#x2F;osgeo</a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Ubuntu16.04</tag>
      
      <tag>Anaconda</tag>
      
      <tag>gdal</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ubuntu16.04安装一些常用软件一</title>
    <link href="/2023/09/26/ubuntu16.04%E5%AE%89%E8%A3%85%E4%B8%80%E4%BA%9B%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6%E4%B8%80/"/>
    <url>/2023/09/26/ubuntu16.04%E5%AE%89%E8%A3%85%E4%B8%80%E4%BA%9B%E5%B8%B8%E7%94%A8%E8%BD%AF%E4%BB%B6%E4%B8%80/</url>
    
    <content type="html"><![CDATA[<h1 id="1-ubuntu16-04-安装-markText："><a href="#1-ubuntu16-04-安装-markText：" class="headerlink" title="1. ubuntu16.04 安装 markText："></a>1. ubuntu16.04 安装 markText：</h1><p>1.1 下载<br>marktext <a href="https://github.com/marktext/marktext/releases">官网下载</a> AppImage 文件；<br>1.2.1 启动方法一<br>在终端通过 .&#x2F;marktext-86_64. AppImage 直接运行<br>1.2.2 启动方法二<br>通过在&#x2F;usr&#x2F;share&#x2F;applications 文件夹中创建 marktext.desktop 图标文件双击启动。具体图标创建方法如下。</p><ul><li>移动下载的<code>marktext-x86_64.AppImage</code>文件到<code>/opt</code>文件夹下，并赋予可执行权限。<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 进入下载的AppImage文件的上级目录，打开终端执行以下命令。</span><br><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">mkdir</span> /opt/marktext<br><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">mv</span> marktext-x86_64.AppImage /opt/marktext<br><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">chmod</span> +x /opt/marktext/marktext-x86_64.AppImage<br></code></pre></td></tr></table></figure></li><li>创建图标文件<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> /opt/marktext<br><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">touch</span> marktext.desktop<br>gedit marktext.desktop<br></code></pre></td></tr></table></figure></li></ul><p>文件内容如下,Exec&#x3D;AppImage文件所在的绝对路径，后面的%F务必加上，为关联文件，跟后面的右键添加打开方式有关<br>Icon&#x3D;软件logo所在的绝对路径，软件的<a href="https://github.com/marktext/marktext/tree/develop/static">图标下载</a>可在其 github 官网下载，</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[Desktop Entry]</span><br><span class="hljs-attr">Name</span>=MarkText<br><span class="hljs-attr">Comment</span>=Next generation markdown editor<br><span class="hljs-attr">Exec</span>=/opt/marktext/marktext-x<span class="hljs-number">86_64</span>.AppImage %F<br><span class="hljs-attr">Terminal</span>=<span class="hljs-literal">false</span><br><span class="hljs-attr">Type</span>=Application<br><span class="hljs-attr">Icon</span>=/opt/marktext/marktext.png<br><span class="hljs-attr">Categories</span>=<span class="hljs-literal">Off</span>ice<span class="hljs-comment">;TextEditor;Utility</span><br><span class="hljs-attr">MimeType</span>=text/markdown<span class="hljs-comment">;</span><br><span class="hljs-attr">Keywords</span>=marktext<span class="hljs-comment">;</span><br><span class="hljs-attr">StartupWMClass</span>=marktext<br><span class="hljs-attr">Actions</span>=NewWindows<br><span class="hljs-attr">StartupNotify</span>=<span class="hljs-literal">true</span><br><br><span class="hljs-section">[Desktop Action NewWindows]</span><br><span class="hljs-attr">Name</span>=New Window<br><span class="hljs-attr">Exec</span>=/opt/marktext/marktext-x<span class="hljs-number">86_64</span>.AppImage %F<br><span class="hljs-attr">Icon</span>=/opt/marktext/marktext.png<br></code></pre></td></tr></table></figure><ul><li>添加桌面快捷方式<br>如果想要在菜单中显示快捷方式，可以将这个文件复制到**&#x2F;usr&#x2F;share&#x2F;applications**目录下<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">cp</span> marktext.destop /usr/share/applications<br></code></pre></td></tr></table></figure>进入defaults.list，添加一行代码<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> /usr/share/applications<br><span class="hljs-built_in">sudo</span> gedit defaults.list<br>在最后一行添加：text/markdown=marktext.desktop<br></code></pre></td></tr></table></figure>就可以搜索到marktext快捷方式了。<br>参考博客：<a href="https://blog.csdn.net/m0_46825740/article/details/129861437">ubuntu篇—下载安装开源markdown编辑器MarkText</a></li></ul><h1 id="2-ubuntu16-04-安装Chrome"><a href="#2-ubuntu16-04-安装Chrome" class="headerlink" title="2. ubuntu16.04 安装Chrome"></a>2. ubuntu16.04 安装Chrome</h1><p>参考博客：<a href="https://www.itcoder.tech/posts/how-to-install-google-chrome-web-browser-on-ubuntu-20-04/">如何在 Ubuntu 20.04 上安装 Google Chrome 网络浏览器</a></p><h1 id="3-ubuntu16-04-安装matlab"><a href="#3-ubuntu16-04-安装matlab" class="headerlink" title="3. ubuntu16.04 安装matlab"></a>3. ubuntu16.04 安装matlab</h1><p>参考博客：<a href="https://blog.csdn.net/flyfrommath/article/details/53148455">Ubuntu Linux下安装matlab及创建快捷方式</a><br><a href="https://blog.csdn.net/qq_36477562/article/details/95103549?utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-2.no_search_link&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~default-2.no_search_link">ubuntu下安装matlab</a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Ubuntu16.04</tag>
      
      <tag>软件安装</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ubuntu16.04安装Pycharm和Anaconda3</title>
    <link href="/2023/09/26/ubuntu16.04%E5%AE%89%E8%A3%85Pycharm%E5%92%8CAnaconda3/"/>
    <url>/2023/09/26/ubuntu16.04%E5%AE%89%E8%A3%85Pycharm%E5%92%8CAnaconda3/</url>
    
    <content type="html"><![CDATA[<h1 id="1-安装Anaconda"><a href="#1-安装Anaconda" class="headerlink" title="1. 安装Anaconda"></a>1. 安装Anaconda</h1><h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><p>官网网址： <a href="https://repo.anaconda.com/archive/">https://repo.anaconda.com/archive/</a></p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>查看<a href="https://blog.csdn.net/wyf2017/article/details/118676765">如何在Linux服务器上安装Anaconda（超详细）</a>中的1.3 安装Anaconda进行安装即可。</p><h2 id="配置虚拟环境"><a href="#配置虚拟环境" class="headerlink" title="配置虚拟环境"></a>配置虚拟环境</h2><p><a href="https://blog.csdn.net/yrwang_xd/article/details/105821002">anaconda 创建虚拟环境、激活及使用的基本方法</a></p><h2 id="将虚拟环境名填入环境变量以便快捷启动"><a href="#将虚拟环境名填入环境变量以便快捷启动" class="headerlink" title="将虚拟环境名填入环境变量以便快捷启动"></a>将虚拟环境名填入环境变量以便快捷启动</h2><p>例如我的conda虚拟环境名为licsbas，打开终端，输入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> gedit ~/.bashrc<br><span class="hljs-built_in">alias</span> licsbas=<span class="hljs-string">&quot;source activate licsbas&quot;</span><br></code></pre></td></tr></table></figure><p>完成后保存文件并退出。<br>打开另一个终端，输入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">source</span> ~/.bashrc<br></code></pre></td></tr></table></figure><p>测试是否生效，打开终端输入<code>licsbas</code>，即可激活该conda虚拟环境。</p><h1 id="2-安装Pycharm"><a href="#2-安装Pycharm" class="headerlink" title="2. 安装Pycharm"></a>2. 安装Pycharm</h1><h2 id="下载-1"><a href="#下载-1" class="headerlink" title="下载"></a>下载</h2><p>官网网址：<a href="https://www.jetbrains.com/pycharm/download/other.html">https://www.jetbrains.com/pycharm/download/other.html</a><br>社区版本的已经够用，同时建议不要安装太新的版本。<br>使用<code>uname -m</code>查看自己电脑的系统架构，如果输出为 <code>x86_64</code>，那么你的系统是 64 位的 x86 架构（通常我们称之为 x64）。如果输出是 <code>armv7l</code>或者以 arm 开头的其他值，那么你的系统是 ARM 架构。再根据不同的系统架构选择对应的版本进行下载。如下图所示，如果为x64架构，则下载 2023.2 - Linux (tar.gz)版本，如果是ARM架构，下载 2023.2 - Linux ARM64 (tar.gz) 版本。</p><h2 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h2><p>下载完成后将 tar.gz包复制到 <code>/opt</code> 目录下，右键【提取到此处】即完成安装。</p><h2 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h2><p>进入解压后的文件夹下的<code>bin</code>目录下，运行pycharm.sh文件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> /opt/pycharm-community-2022.2.3/bin<br><span class="hljs-built_in">sudo</span> ./pycharm.sh<br></code></pre></td></tr></table></figure><h2 id="创建桌面快捷方式"><a href="#创建桌面快捷方式" class="headerlink" title="创建桌面快捷方式"></a>创建桌面快捷方式</h2><p>最简单有效的方式为按照上一步启动pycharm，依次选择上方导航栏中的【Tools】，【Create Desktop Entry…】，【OK】，再重启即可。</p><h1 id="参考博客"><a href="#参考博客" class="headerlink" title="参考博客"></a>参考博客</h1><p><a href="https://blog.csdn.net/weixin_44312186/article/details/98443374">Ubuntu创建pycharm的快捷方式两种方法（安装pycharm后启动方式）</a><br><a href="https://blog.csdn.net/wyf2017/article/details/118676765">如何在Linux服务器上安装Anaconda（超详细）</a><br><a href="https://blog.csdn.net/wyf2017/article/details/118676765">anaconda 创建虚拟环境、激活及使用的基本方法</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>Ubuntu16.04</tag>
      
      <tag>Pycharm</tag>
      
      <tag>Anaconda3</tag>
      
      <tag>软件安装</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ubuntu16.04安装jdk和panoply</title>
    <link href="/2023/09/26/ubuntu16.04%E5%AE%89%E8%A3%85jdk%E5%92%8Cpanoply/"/>
    <url>/2023/09/26/ubuntu16.04%E5%AE%89%E8%A3%85jdk%E5%92%8Cpanoply/</url>
    
    <content type="html"><![CDATA[<h1 id="安装Panoply"><a href="#安装Panoply" class="headerlink" title="安装Panoply"></a>安装Panoply</h1><p>安装包网址： <a href="https://www.giss.nasa.gov/tools/panoply/download/">https://www.giss.nasa.gov/tools/panoply/download/</a> </p><p>自行选择对应版本（windows，macOS，Linux，这里是 linux . tgz 格式），也可点击<a href="https://www.giss.nasa.gov/tools/panoply/download/PanoplyJ-5.2.7.tgz">这里</a>直接下载tgz格式。</p><p>下载完成后，复制到 ubuntu 系统下 <code>/opt</code> 文件夹下提取即可，但是此时不能直接运行，需要 安装大于 11 版本的 JDK 才行，JDK下载安装参见下文。<br>JDK安装完成后，进入 panoply 文件夹下，打开终端输入 .&#x2F;Panoply.sh 运行。</p><h1 id="手动安装-JDK20"><a href="#手动安装-JDK20" class="headerlink" title="手动安装 JDK20"></a>手动安装 JDK20</h1><p>下载 JDK20 安装包：<a href="https://jdk.java.net/20/">JDK20 下载链接</a>，选择适合电脑的版本，ubuntu16.04系统 点击<a href="https://download.java.net/java/GA/jdk20.0.1/b4887098932d415489976708ad6d1a4b/9/GPL/openjdk-20.0.1_linux-x64_bin.tar.gz">下载链接</a>直接下载。<br>提示：若进入JDK20下载网页显示JDK20版本已被取代，则下载最新的JDK版本，可输入其官网网址进行下载，网址链接样式如 <code>https://jdk.java.net/xx/ </code>，其中 <code>xx</code> 表示你要下载的 JDK 版本，如下载 JDK21 则其链接为 <a href="https://jdk.java.net/21/">https://jdk.java.net/21/</a> 。对于x64操作系统的电脑，下载下图所示的 tar.gz 格式安装包。</p><ul><li>下载完成后，使用【提取到此处】解压；</li><li>将解压后的文件夹移动到&#x2F;usr 文件夹下</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> <span class="hljs-built_in">mv</span> jdk* /usr<br></code></pre></td></tr></table></figure><ul><li>使用 <code>update-alternatives</code> 命令把 Java 安装到系统上，此时就不用再设置环境了。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">sudo</span> update-alternatives --install /usr/bin/java java /usr/jdk-20.*/bin/java 2<br></code></pre></td></tr></table></figure><ul><li>设置默认的 Java</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">sudo <span class="hljs-keyword">update</span><span class="hljs-operator">-</span>alternatives <span class="hljs-comment">--config java</span><br></code></pre></td></tr></table></figure><p>上述命令会显示目前在系统里存在的所有版本的 Java，然后你选择一个你想要的版本就可以了。</p><ul><li>最后查看当前的 java 版本</li></ul><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs applescript">java -<span class="hljs-built_in">version</span><br></code></pre></td></tr></table></figure><p>本文参考博客： <a href="https://www.cnblogs.com/powerwu/articles/12095326.html">如何在Linux Ubuntu16&#x2F;18上安装Java JDK11&#x2F;8</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>Ubuntu16.04</tag>
      
      <tag>软件安装</tag>
      
      <tag>Panoply</tag>
      
      <tag>JDK20</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>如何在DELL工作站T7820上安装ubuntu16.04操作系统</title>
    <link href="/2023/09/18/%E5%A6%82%E4%BD%95%E5%9C%A8DELL%E5%B7%A5%E4%BD%9C%E7%AB%99T7820%E4%B8%8A%E5%AE%89%E8%A3%85ubuntu16-04%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"/>
    <url>/2023/09/18/%E5%A6%82%E4%BD%95%E5%9C%A8DELL%E5%B7%A5%E4%BD%9C%E7%AB%99T7820%E4%B8%8A%E5%AE%89%E8%A3%85ubuntu16-04%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/</url>
    
    <content type="html"><![CDATA[<h1 id="一、准备"><a href="#一、准备" class="headerlink" title="一、准备"></a>一、准备</h1><p>硬件：<br>一台 DELL 工作站 T7820；<br>一个 U 盘镜像文件<br>软件：<br>软碟通（UltraISO）；<br>ubuntu 16.04.7 LTS 版本；</p><h1 id="二、制作系统盘"><a href="#二、制作系统盘" class="headerlink" title="二、制作系统盘"></a>二、制作系统盘</h1><p>ubuntu16.04.7 LTS 版本可前往 <a href="https://releases.ubuntu.com/16.04/">ubuntu官网</a>进行下载。</p><p>利用 u 盘制作系统盘可参考# <a href="https://www.cnblogs.com/masbay/p/10844857.html">Windows10安装ubuntu16.04双系统教程</a></p><h1 id="三、在-Windows10-下创建空白分区"><a href="#三、在-Windows10-下创建空白分区" class="headerlink" title="三、在 Windows10 下创建空白分区"></a>三、在 Windows10 下创建空白分区</h1><p>此处使用的工作站为双硬盘。在 C 盘分出 1G（我的为 2G） 的空白分区用来安装 ubuntu 的启动项，然后再在另一块硬盘选择最后一个盘（比如 CD 两个盘的最后一个是 D 盘，CDE 盘的最后一个是 E 盘，CDEF 盘的最后一个是 F 盘，以此类推），在该盘点击右键，选择压缩卷，如下，输入压缩空间量，单位为 M, 如果空间充足，工作站一般空间较多，建议分 400G 以上，我分了 1000G。以下是我的分区结果。</p><h1 id="四、设置工作站的-BIOS-启动项设置"><a href="#四、设置工作站的-BIOS-启动项设置" class="headerlink" title="四、设置工作站的 BIOS 启动项设置"></a>四、设置工作站的 BIOS 启动项设置</h1><p>插好系统盘，重启电脑，按【F2】进行 BIOS 启动项设置。设置如下：</p><ol><li>修改启动模式，把 UEFI 改为 Legacy；</li><li>检查 SATA Operation 模式为：AHCI;</li><li>设置 Secure Boot 为 Disable。当然如果 Boot Mode 是 UEFI 我们就将下面的 Secure Boot 设置 Disable。如果 Boot Mode 是 Legacy 那么我们就跳过这步。（设置了更保险。）</li><li>BIOS 启动项设置完成后，按 exit 退出。</li></ol><h1 id="五、用做好的系统盘安装系统"><a href="#五、用做好的系统盘安装系统" class="headerlink" title="五、用做好的系统盘安装系统"></a>五、用做好的系统盘安装系统</h1><ol><li>重新开机，长按【F12】，进入以下界面。</li><li>选择【UEFI：KingstonDataTraveler 3.0】，出现以下界面。选择【Install Ubuntu】。</li><li>选择【中文（简体）】，【继续】。</li><li>选择【我现在不想连接这个无线 wifi 网络】，【继续】。</li><li>选择第二项【为图形或无线硬件，以及 MP3 和其它媒体安装第三方软件】，【继续】。</li><li>安装类型选择最后一个【其它选项】，因为需要手动分区，【继续】。进行分区设置，这是最关键的一步，这里按照总空间 1000G 来进行分区演示。<br>分区之前我先介绍一下 Linux 的文件系统 ：<br>swap：用作虚拟内存，这个一般和自己电脑的物理内存一般大即可，一般是 8G。<br>&#x2F;：主要用来存放Linux系统文件<br>&#x2F;boot : 存放linux内核，用来引导系统的，如果是Legacy启动就要设置引导，UEFI就不用设置这个（UEFI要设置EFI文件）<br>&#x2F;home:存放用户文件</li><li>进行分区设置<br>我们在看磁盘信息的时候可以发现自己当初没有分配盘符的那个空闲磁盘，选中那个空闲磁盘，然后点击+ 号，开始分配，如下。<br>分配前分区设置如下所示，我们可以看到一个 2148 MB 和 1048577MB 大小的空闲区域。分别用于设置引导和其它分区。DELL T7820 采用 Legacy 启动方式启动，因此下列分区也是按照 Legacy 启动进行分区设置。（注意，这是因为在设置引导向时没有 efi 分区才设置为 Legacy 启动）<br>1）设置【BIOS 保留区域】<br>在设置引导之前，需要设置【BIOS 保留区域】，选项选择逻辑分区，空间起始位置，保留 BIOS 启动区域，大小 20MB，设置如图。在每个分区之间都需要设置【BIOS 保留区域】，否则会出错，下同。2）设置引导<br>设置 Boot 引导，我们选择逻辑分区，空间起始位置，用于 Ext4 日志文件，挂载点：&#x2F;boot，大小设置 2G（最少 500MB），也就是之前在 Windows 中预留的 2G 空间。这个分区必不可少，用于安装 ubuntu 启动项。</li></ol><p>3）下面的分区就在另一个空闲的盘（大小 1048577MB）进行。同样需要首先设置【BIOS 保留区域】，选项选择逻辑分区，空间起始位置，保留 BIOS 启动区域，大小 200MB，设置如图。</p><p>4）设置【交换空间（swap）】，充当 ubuntu 的虚拟内存，一般的大小为电脑物理内存的 2 倍左右，如我的工作站内存为 32G，则可以将其分为 64G，选择逻辑分区，空间起始位置，用于”swap”或”交换空间”。</p><p>5）同 3）的设置进行【BIOS 保留区域】的设置。<br>6）&#x2F;: 这是 ubuntu 的根目录, 用于安装系统和软件，相当于 windows 的 C 盘，我们将其分为 500G，主分区，空间起始位置，用于”ext4 日志文件系统”，挂载点为”&#x2F;“（根据你的磁盘空间调整，可以大一点，毕竟 ubuntu 装软件都是默认装在根目录的）</p><p>7）同 3）的设置进行【BIOS 保留区域】的设置。<br>8）&#x2F;home: 相当于 windows 的其他盘，剩下的全分给它，逻辑分区，空间起始位置，用于”ext4 日志文件系统”，挂载点为”&#x2F;home”。<br>9）设置安装启动项的位置，我们刚刚不是创建了 2G 的 &#x2F;boot 分区吗，现在你看看这个区前面的编号是多少，比如是&#x2F;dev&#x2F;sda1, 不同的机子会有不同的编号，下拉列表选择这个 efi 分区编号，之后点击【现在安装】。<br>上述设置完成后，如图所示。</p><p>10）分区设置完成，设置地区【Shanghai】。</p><p>11）键盘布局默认是英语的，建议不改（默认中文也行）。</p><p>12）这里设置用户，自己输入就可以了，例如英文字母，尽量简单点，密码也简单点。</p><p>13）系统开始安装，耐心等待安装完毕就可以了。</p><p>14）全部完成之后，会提醒你重启，把 U 盘拔了，点”现在重启”，如果卡死就强制关机再重启就好。</p><h1 id="参考教程"><a href="#参考教程" class="headerlink" title="参考教程"></a>参考教程</h1><p><a href="https://blog.51cto.com/u_1037119/2332920">如何在DELL工作站T5820上安装ubuntu 16.04操作系统?安装的硬盘为M.2 SSD硬盘</a><br><a href="https://blog.csdn.net/weixin_38621214/article/details/93657889">win10下Ubuntu 双系统安装（解决关机卡死问题和WiFi问题）</a><br><a href="https://www.cnblogs.com/masbay/p/10844857.html">Windows10安装ubuntu16.04双系统教程</a></p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Ubuntu16.04</tag>
      
      <tag>系统安装</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>如何下载GACOS数据</title>
    <link href="/2023/09/06/%E5%A6%82%E4%BD%95%E4%B8%8B%E8%BD%BDGACOS%E6%95%B0%E6%8D%AE/"/>
    <url>/2023/09/06/%E5%A6%82%E4%BD%95%E4%B8%8B%E8%BD%BDGACOS%E6%95%B0%E6%8D%AE/</url>
    
    <content type="html"><![CDATA[<p>以下是结合下载的 <a href="https://search.asf.alaska.edu/#/">Sentinel-1 数据</a>下载 <a href="http://www.gacos.net/">GACOS</a> 数据。</p><h3 id="查看影像覆盖范围以确定-GACOS-下载数据范围"><a href="#查看影像覆盖范围以确定-GACOS-下载数据范围" class="headerlink" title="查看影像覆盖范围以确定 GACOS 下载数据范围"></a>查看影像覆盖范围以确定 GACOS 下载数据范围</h3><p>Sentinel-1 数据下载的为 SLC 影像，解压后找到【preview】文件夹，使用编辑模式打开【map-overlay. kml】文件夹查看影像覆盖范围。</p><p>从文件中查看经纬度分别为 (107.394173, 34.161789 ), (110.125618, 34.564285), (110.448387, 32.942715), (107.769920, 32.538162)。</p><p>因此选择 GACOS 下载四个方向上的边界经&#x2F;纬度为（34.8N, 32.3N, 107.1E, 110.7E）。</p><h3 id="查看影像具体观测时间"><a href="#查看影像具体观测时间" class="headerlink" title="查看影像具体观测时间"></a>查看影像具体观测时间</h3><p>这里下载 20210827 和 20210904 两个日期的 GACOS 文件。参考<a href="%5B%E5%93%A8%E5%85%B5%E5%BD%B1%E5%83%8F%E5%91%BD%E5%90%8D%E8%A7%84%E5%88%99_%E5%A4%A7%E6%BC%A0%E5%BE%81%E8%93%AC%E7%9A%84%E5%8D%9A%E5%AE%A2-CSDN%E5%8D%9A%E5%AE%A2%5D(https://blog.csdn.net/u013622978/article/details/131418781?spm=1001.2101.3001.6650.2&utm_medium=distribute.pc_relevant.none-task-blog-2~default~YuanLiJiHua~Position-2-131418781-blog-88868173.235%5Ev38%5Epc_relevant_sort_base3&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~YuanLiJiHua~Position-2-131418781-blog-88868173.235%5Ev38%5Epc_relevant_sort_base3&utm_relevant_index=3)">哨兵影像命名规则</a> 或 [Sentinel-1 文件名命名规则](<a href="https://blog.csdn.net/XinemaChen/article/details/88868173">Sentinel 1文件名命名规则_sentinel-1命名_就是一只白的博客-CSDN博客</a>)，以 20210827 为例查看其观测具体时间为 2021-08-27-10：45。</p><h3 id="GACOS-数据下载"><a href="#GACOS-数据下载" class="headerlink" title="GACOS 数据下载"></a>GACOS 数据下载</h3><p>设置 GACOS 数据下载范围及观测具体时间及日期，进行下载，可选择 Geotiff 或 Binary grid 格式数据，填写邮箱并提交完成后会发送到指定邮箱。</p><p>提交完成后如图</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>InSAR</tag>
      
      <tag>Sentinel-1</tag>
      
      <tag>GACOS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>如何利用Sentinel-1数据制作轨道覆盖范围文件Shapefile（Line）</title>
    <link href="/2023/09/05/%E5%A6%82%E4%BD%95%E5%88%A9%E7%94%A8Sentinel-1%E6%95%B0%E6%8D%AE%E5%88%B6%E4%BD%9C%E8%BD%A8%E9%81%93%E8%A6%86%E7%9B%96%E8%8C%83%E5%9B%B4%E6%96%87%E4%BB%B6Shapefile%EF%BC%88Line%EF%BC%89/"/>
    <url>/2023/09/05/%E5%A6%82%E4%BD%95%E5%88%A9%E7%94%A8Sentinel-1%E6%95%B0%E6%8D%AE%E5%88%B6%E4%BD%9C%E8%BD%A8%E9%81%93%E8%A6%86%E7%9B%96%E8%8C%83%E5%9B%B4%E6%96%87%E4%BB%B6Shapefile%EF%BC%88Line%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<p>1将sentinel-1中的kml文件导入Global Mapper</p><p>2在Global Mapper中，’File’ -&gt; ‘Export’ -&gt;’Export raster&#x2F;image format’</p><p>3 导出，选择’GeoTIFF’格式，导入文件为142_116.tif</p><p>4 将142_126.tif 导入arcgis中，发现有白色背景色，看到背景色对应的白色像素值为255</p><p>5 将白色像素值更改为 ‘NoData’, 右键142_126.tif，’数据‘ -&gt; ‘导出数据’，将NoData设置为255，设置导出格式为TIFF，设置导出位置，文件命名为142_121.tif</p><p>6 导出后的142_1261.tif可以看到没有白色背景</p><p>7 导出影像范围，3D Analyst工具 -&gt; 转换 -&gt;由栅格转出 -&gt;栅格范围，保存文件为142_1261RasterDomain.shp</p><p>8 此时导入142_1261RasterDomain.shp就为影像覆盖范围</p>]]></content>
    
    
    <categories>
      
      <category>学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>InSAR</tag>
      
      <tag>Sentinel-1</tag>
      
      <tag>Global Mapper</tag>
      
      <tag>ArcGIS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>GRACE数据处理中可能用到的一些网站</title>
    <link href="/2023/07/24/GRCE%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E4%B8%AD%E5%8F%AF%E8%83%BD%E7%94%A8%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E7%BD%91%E7%AB%99/"/>
    <url>/2023/07/24/GRCE%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E4%B8%AD%E5%8F%AF%E8%83%BD%E7%94%A8%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E7%BD%91%E7%AB%99/</url>
    
    <content type="html"><![CDATA[<h3 id="Degree-1"><a href="#Degree-1" class="headerlink" title="Degree 1"></a>Degree 1</h3><h4 id="Tellus"><a href="#Tellus" class="headerlink" title="Tellus"></a>Tellus</h4><p><a href="https://podaac.jpl.nasa.gov/gravity/grace-documentation#TechnicalNotes">https://podaac.jpl.nasa.gov/gravity/grace-documentation#TechnicalNotes</a></p><h5 id="CSR"><a href="#CSR" class="headerlink" title="CSR"></a>CSR</h5><p><a href="https://archive.podaac.earthdata.nasa.gov/podaac-ops-cumulus-docs/grace/open/docs/TN-13_GEOC_CSR_RL06.txt">GRACE Technical Note #13a: degree-1 (geocenter) gravity coefficients from CSR RL06</a> (recommend)</p><p><a href="https://archive.podaac.earthdata.nasa.gov/podaac-ops-cumulus-docs/grace/open/docs/TN-13_GEOC_CSR_RL0601.txt">GRACE Technical Note #13a: degree-1 (geocenter) gravity coefficients from CSR RL06.1</a></p><h5 id="GFZ"><a href="#GFZ" class="headerlink" title="GFZ"></a>GFZ</h5><p><a href="https://archive.podaac.earthdata.nasa.gov/podaac-ops-cumulus-docs/grace/open/docs/TN-13_GEOC_GFZ_RL06.txt">GRACE Technical Note #13b: degree-1 (geocenter) gravity coefficients from GFZ RL06</a></p><p><a href="https://archive.podaac.earthdata.nasa.gov/podaac-ops-cumulus-docs/grace/open/docs/TN-13_GEOC_GFZ_RL0601.txt">GRACE Technical Note #13b: degree-1 (geocenter) gravity coefficients from GFZ RL06.1</a></p><h5 id="JPL"><a href="#JPL" class="headerlink" title="JPL"></a>JPL</h5><p><a href="https://archive.podaac.earthdata.nasa.gov/podaac-ops-cumulus-docs/grace/open/docs/TN-13_GEOC_JPL_RL06.txt">GRACE Technical Note #13c: degree-1 (geocenter) gravity coefficients from JPL RL06</a></p><p><a href="https://archive.podaac.earthdata.nasa.gov/podaac-ops-cumulus-docs/grace/open/docs/TN-13_GEOC_JPL_RL0601.txt">GRACE Technical Note #13c: degree-1 (geocenter) gravity coefficients from JPL RL06.1</a></p><h4 id="SLR（暂不可用）"><a href="#SLR（暂不可用）" class="headerlink" title="SLR（暂不可用）"></a>SLR（暂不可用）</h4><p><a href="https://filedrop.csr.utexas.edu/pub/slr/geocenter/">https://filedrop.csr.utexas.edu/pub/slr/geocenter/</a></p><p><a href="ftp://ftp.csr.utexas.edu/pub/slr/geocenter/">ftp://ftp.csr.utexas.edu/pub/slr/geocenter/</a></p><h3 id="C20"><a href="#C20" class="headerlink" title="C20"></a>C20</h3><h4 id="NASA-PO-DAAC（暂不可用，下同）"><a href="#NASA-PO-DAAC（暂不可用，下同）" class="headerlink" title="NASA PO.DAAC（暂不可用，下同）"></a>NASA PO.DAAC（暂不可用，下同）</h4><p><a href="https://podaac-tools.jpl.nasa.gov/drive/files/GeodeticsGravity/grace/docs">https://podaac-tools.jpl.nasa.gov/drive/files/GeodeticsGravity/grace/docs</a><br>        TN-05_C20_SLR.txt<br>        TN-07_C20_SLR.txt<br>        TN-11_C20_SLR.txt<br>        TN-14_C30_C30_GSFC_SLR.txt</p><h4 id="UTCSR"><a href="#UTCSR" class="headerlink" title="UTCSR"></a>UTCSR</h4><p><a href="http://download.csr.utexas.edu/pub/slr/degree_2/">http://download.csr.utexas.edu/pub/slr/degree_2/</a></p><p>    C20_RL06.txt</p><p><a href="ftp://ftp.csr.utexas.edu/pub/slr/degree_2/">ftp://ftp.csr.utexas.edu/pub/slr/degree_2/</a> （該链接暂无法访问，下同）</p><p>    C20_RL05.txt</p><h4 id="GFZ-1"><a href="#GFZ-1" class="headerlink" title="GFZ"></a>GFZ</h4><p><a href="ftp://isdcftp.gfz-potsdam.de/grace/Level-2/GFZ/RL06_SLR_C20/">ftp://isdcftp.gfz-potsdam.de/grace/Level-2/GFZ/RL06_SLR_C20/</a><br>    GFZ_RL06_C20_SLR.dat<br><a href="ftp://isdcftp.gfz-potsdam.de/grace/GravIS/GFZ/Level-2B/aux_data/">ftp://isdcftp.gfz-potsdam.de/grace/GravIS/GFZ/Level-2B/aux_data/</a><br>    GRAVIS-2B_GFZOP_GRACE+SLR_LOW_DEGREES_0002.dat</p><h3 id="CS21-or-CS22"><a href="#CS21-or-CS22" class="headerlink" title="CS21 or CS22"></a>CS21 or CS22</h3><h4 id="CSR-1"><a href="#CSR-1" class="headerlink" title="CSR"></a>CSR</h4><p><a href="http://download.csr.utexas.edu/pub/slr/degree_2/">http://download.csr.utexas.edu/pub/slr/degree_2/</a></p><p>    C21_S21_RL06.txt</p><h4 id="GFZ-2"><a href="#GFZ-2" class="headerlink" title="GFZ"></a>GFZ</h4><p><a href="ftp://isdcftp.gfz-potsdam.de/grace/GravIS/GFZ/Level-2B/aux_data/">ftp://isdcftp.gfz-potsdam.de/grace/GravIS/GFZ/Level-2B/aux_data/</a></p><p>    GRAVIS-2B_GFZOP_GRACE+SLR_LOW_DEGREES_0002.dat</p><h4 id="GSFC"><a href="#GSFC" class="headerlink" title="GSFC"></a>GSFC</h4><p><a href="https://earth.gsfc.nasa.gov/geo/data/slr">https://earth.gsfc.nasa.gov/geo/data/slr</a></p><p>    gsfc_slr_5x5c61s61.txt</p><h3 id="C30"><a href="#C30" class="headerlink" title="C30"></a>C30</h3><h4 id="NASA-PO-DAAC（暂不可用）"><a href="#NASA-PO-DAAC（暂不可用）" class="headerlink" title="NASA PO.DAAC（暂不可用）"></a>NASA PO.DAAC（暂不可用）</h4><p><a href="https://podaac-tools.jpl.nasa.gov/drive/files/GeodeticsGravity/gracefo/docs/">https://podaac-tools.jpl.nasa.gov/drive/files/GeodeticsGravity/gracefo/docs/</a></p><p>    TN-14_C30_C30_GSFC_SLR.txt</p><h4 id="CSR-2"><a href="#CSR-2" class="headerlink" title="CSR"></a>CSR</h4><p><a href="ftp://ftp.csr.utexas.edu/pub/slr/degree_5/">ftp://ftp.csr.utexas.edu/pub/slr/degree_5/</a></p><p>    CSR_Monthly_5x5_Gravity_Harmonics.txt</p><p><a href="https://filedrop.csr.utexas.edu/pub/slr/degree_5/">https://filedrop.csr.utexas.edu/pub/slr/degree_5/</a></p><p>    CSR_Monthly_5x5_Gravity_Harmonics.txt</p><h4 id="GFZ-3"><a href="#GFZ-3" class="headerlink" title="GFZ"></a>GFZ</h4><p><a href="ftp://isdcftp.gfz-potsdam.de/grace/GravIS/GFZ/Level-2B/aux_data/">ftp://isdcftp.gfz-potsdam.de/grace/GravIS/GFZ/Level-2B/aux_data/</a><br>    GRAVIS-2B_GFZOP_GRACE+SLR_LOW_DEGREES_0002.dat</p><h4 id="GSFC-1"><a href="#GSFC-1" class="headerlink" title="GSFC"></a>GSFC</h4><p><a href="https://earth.gsfc.nasa.gov/geo/data/slr">https://earth.gsfc.nasa.gov/geo/data/slr</a> （暂不可用）</p><p>    TN-14_C30_C30_GSFC_SLR.txt</p><h3 id="C40"><a href="#C40" class="headerlink" title="C40"></a>C40</h3><h4 id="CSR-3"><a href="#CSR-3" class="headerlink" title="CSR"></a>CSR</h4><p><a href="ftp://ftp.csr.utexas.edu/pub/slr/degree_5/">ftp://ftp.csr.utexas.edu/pub/slr/degree_5/</a><br>    CSR_Monthly_5x5_Gravity_Harmonics.txt</p><p><a href="https://filedrop.csr.utexas.edu/pub/slr/degree_5/">https://filedrop.csr.utexas.edu/pub/slr/degree_5/</a></p><p>    CSR_Monthly_5x5_Gravity_Harmonics.txt</p><h4 id="GSFC-2"><a href="#GSFC-2" class="headerlink" title="GSFC"></a>GSFC</h4><p><a href="https://earth.gsfc.nasa.gov/geo/data/slr">https://earth.gsfc.nasa.gov/geo/data/slr</a><br>    gsfc_slr_5x5c61s61.txt</p><h3 id="C50"><a href="#C50" class="headerlink" title="C50"></a>C50</h3><h4 id="CSR-4"><a href="#CSR-4" class="headerlink" title="CSR"></a>CSR</h4><p><a href="ftp://ftp.csr.utexas.edu/pub/slr/degree_5/">ftp://ftp.csr.utexas.edu/pub/slr/degree_5&#x2F;</a><br>    CSR_Monthly_5x5_Gravity_Harmonics.txt</p><h4 id="GSFC-3"><a href="#GSFC-3" class="headerlink" title="GSFC"></a>GSFC</h4><p><a href="https://earth.gsfc.nasa.gov/geo/data/slr">https://earth.gsfc.nasa.gov/geo/data/slr</a><br>    gsfc_slr_5x5c61s61.txt</p><h3 id="GIA-model"><a href="#GIA-model" class="headerlink" title="GIA model"></a>GIA model</h3><p><a href="https://www.atmosp.physics.utoronto.ca/~peltier/data.php">https://www.atmosp.physics.utoronto.ca/~peltier/data.php</a></p><p>    <a href="https://www.atmosp.physics.utoronto.ca/~peltier/datasets/Ice6G_C_VM5a/ICE-6G_High_Res_Stokes_trend.txt.gz">https://www.atmosp.physics.utoronto.ca/~peltier/datasets/Ice6G_C_VM5a/ICE-6G_High_Res_Stokes_trend.txt.gz</a></p><h3 id="Landsea-Mask"><a href="#Landsea-Mask" class="headerlink" title="Landsea Mask"></a>Landsea Mask</h3><h4 id="UCAR"><a href="#UCAR" class="headerlink" title="UCAR"></a>UCAR</h4><p> Mask file to use as input following Sutterley et al. (2020)<br>    1x1 degree mask distributed from UCAR as part of NCL        <a href="https://www.ncl.ucar.edu/Applications/Data/cdf/landsea.nc">https://www.ncl.ucar.edu/Applications/Data/cdf/landsea.nc</a>   </p><h4 id="ORNL"><a href="#ORNL" class="headerlink" title="ORNL"></a>ORNL</h4><p>1,0.5 and 0.25 degree masks distributed from ORNL as part of ISLSCP        <a href="https://daac.ornl.gov/ISLSCP_II/guides/combined_ancillary_xdeg.html">https://daac.ornl.gov/ISLSCP_II/guides/combined_ancillary_xdeg.html</a></p>]]></content>
    
    
    
    <tags>
      
      <tag>GRACE</tag>
      
      <tag>websites</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>测试文章</title>
    <link href="/2023/07/23/%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0/"/>
    <url>/2023/07/23/%E6%B5%8B%E8%AF%95%E6%96%87%E7%AB%A0/</url>
    
    <content type="html"><![CDATA[<p>这是一篇测试文章</p>]]></content>
    
    
    <categories>
      
      <category>测试</category>
      
    </categories>
    
    
    <tags>
      
      <tag>原创</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>gravity-toolkit安装和使用笔记整理一</title>
    <link href="/2023/06/03/gravity-toolkit%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8%E7%AC%94%E8%AE%B0%E6%95%B4%E7%90%86%E4%B8%80/"/>
    <url>/2023/06/03/gravity-toolkit%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8%E7%AC%94%E8%AE%B0%E6%95%B4%E7%90%86%E4%B8%80/</url>
    
    <content type="html"><![CDATA[<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><h2 id="软件"><a href="#软件" class="headerlink" title="软件"></a>软件</h2><p>安装anaconda和jupyter notebook，并在conda中创建虚拟环境，命名为grace，创建虚拟环境见[[Anaconda安装与环境配置]]</p><h2 id="工具包"><a href="#工具包" class="headerlink" title="工具包"></a>工具包</h2><p><a href="https://github.com/tsutterley/gravity-toolkit">https://github.com/tsutterley/gravity-toolkit</a></p><p><a href="https://github.com/tsutterley/geoid-toolkit/">https://github.com/tsutterley/geoid-toolkit/</a></p><p><a href="https://github.com/tsutterley/read-GRACE-geocenter">https://github.com/tsutterley/read-GRACE-geocenter</a></p><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><p>ubuntu16.04</p><h2 id="依赖"><a href="#依赖" class="headerlink" title="依赖"></a>依赖</h2><p>conda激活grace环境，安装依赖。</p><p>激活：conda activate grace</p><p>安装：conda install -c conda-forge package_name</p><h3 id="根目录-gravity-toolkit"><a href="#根目录-gravity-toolkit" class="headerlink" title="根目录(gravity-toolkit)"></a>根目录(gravity-toolkit)</h3><ol><li><p>参照github作者中的<a href="https://github.com/tsutterley/gravity-toolkit/tree/main#dependencies">gravity-toolkit&#x2F;README.rst#dependencies</a>安装依赖，包括</p><ul><li><a href="https://www.numpy.org/">numpy: Scientific Computing Tools For Python</a></li><li><a href="https://docs.scipy.org/doc/">scipy: Scientific Tools for Python</a></li><li><a href="https://dateutil.readthedocs.io/en/stable/">dateutil: powerful extensions to datetime</a></li><li><a href="https://github.com/yaml/pyyaml">PyYAML: YAML parser and emitter for Python</a></li><li><a href="https://pypi.python.org/pypi/lxml">lxml: processing XML and HTML in Python</a></li><li><a href="https://python-future.org/">future: Compatibility layer between Python 2 and Python 3</a></li><li><a href="https://matplotlib.org/">matplotlib: Python 2D plotting library</a></li><li><a href="https://scitools.org.uk/cartopy/docs/latest/">cartopy: Python package designed for geospatial data processing</a></li><li><a href="https://unidata.github.io/netcdf4-python/">netCDF4: Python interface to the netCDF C library</a></li><li><a href="https://www.h5py.org/">h5py: Python interface for Hierarchal Data Format 5 (HDF5)</a></li><li><a href="https://github.com/tsutterley/geoid-toolkit/">geoid-toolkit: Python utilities for calculating geoid heights from static gravity field coefficients</a></li></ul></li><li><p>参照github作者中的<a href="https://github.com/tsutterley/gravity-toolkit/blob/main/requirements.txt">gravity-toolkit&#x2F;requirements.txt</a>安装第三方库，包括</p><ul><li>boto3</li><li>future</li><li>lxml</li><li>matplotlib</li><li>numpy</li><li>python-dateutil</li><li>pyyaml</li><li>scipy</li></ul></li></ol><h3 id="binder文件夹"><a href="#binder文件夹" class="headerlink" title=".binder文件夹"></a>.binder文件夹</h3><p>github中作者中的<a href="https://github.com/tsutterley/gravity-toolkit/blob/main/.binder/environment.yml">gravity-toolkit&#x2F;.binder&#x2F;environment.yml</a>中的依赖，详细信息如下。</p><p>name: gravity_toolkit<br>channels:</p><ul><li>conda-forge</li></ul><p>dependencies:</p><ul><li>boto3</li><li>cartopy</li><li>future</li><li>h5py</li><li><a href="https://pypi.org/project/ipywidgets/#history">ipywidgets&gt;&#x3D;7.6,&lt;8.0</a>(&#x3D;7.7.5)</li><li>ipympl</li><li>jupyter</li><li>jupyterlab&#x3D;3</li><li>jupyterlab_widgets</li><li>lxml</li><li>markupsafe&#x3D;&#x3D;2.0.1</li><li>matplotlib</li><li>netCDF4</li><li>notebook</li><li>numpy</li><li>python&gt;&#x3D;3.6</li><li>python-dateutil</li><li>pyyaml</li><li>scipy</li><li>tk</li><li>pip</li><li>pip:<ul><li>git+<a href="https://github.com/tsutterley/geoid-toolkit.git">https://github.com/tsutterley/geoid-toolkit.git</a></li></ul></li></ul><h3 id="github-workflows"><a href="#github-workflows" class="headerlink" title=".github&#x2F;workflows"></a>.github&#x2F;workflows</h3><ol><li><p>github中作者中的<a href="https://github.com/tsutterley/gravity-toolkit/blob/main/.github/workflows/python-request.yml">gravity-toolkit&#x2F;.github&#x2F;workflows&#x2F;python-request.yml</a>中的安装依赖，详细信息如下。</p><p>此工作流将安装 Python 依赖项、运行测试并使用各种 Python 版本进行 lint。</p><p>name: Python on pull request</p><p>on:<br>  pull_request:</p><p>jobs:<br>  build:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">runs-on: $&#123;&#123; matrix.os &#125;&#125;</span><br><span class="line">strategy:</span><br><span class="line">  matrix:</span><br><span class="line">    os: [ubuntu-latest, macos-latest, windows-latest]</span><br><span class="line">    python-version: [<span class="number">3.8</span>]</span><br><span class="line">env:</span><br><span class="line">  OS: $&#123;&#123; matrix.os &#125;&#125;</span><br><span class="line">  PYTHON: $&#123;&#123; matrix.python-version &#125;&#125;</span><br><span class="line">defaults:</span><br><span class="line">  run:</span><br><span class="line">    shell: bash -l &#123;<span class="number">0</span>&#125;</span><br><span class="line"></span><br><span class="line">steps:</span><br><span class="line">- uses: actions/checkout@v2</span><br><span class="line">- name: <span class="type">Set</span> up conda $&#123;&#123; matrix.python-version &#125;&#125;</span><br><span class="line">  uses: conda-incubator/setup-miniconda@v2</span><br><span class="line">  <span class="keyword">with</span>:</span><br><span class="line">    auto-update-conda: true</span><br><span class="line">    python-version: $&#123;&#123; matrix.python-version &#125;&#125;</span><br><span class="line">    activate-environment: gravity_toolkit</span><br><span class="line">    environment-file: .binder/environment.yml</span><br><span class="line">- name: Create conda Test Environment</span><br><span class="line">  run: |</span><br><span class="line">    conda install flake8 pytest pytest-cov cython</span><br><span class="line">    pip install git+https://github.com/tsutterley/read-GRACE-geocenter.git</span><br><span class="line">- name: Lint <span class="keyword">with</span> flake8</span><br><span class="line">  run: |</span><br><span class="line">    <span class="comment"># stop the build if there are Python syntax errors or undefined names</span></span><br><span class="line">    flake8 . --count --select=E9,F63,F7,F82 --show-source --statistics</span><br><span class="line">    <span class="comment"># exit-zero treats all errors as warnings. The GitHub editor is 127 chars wide</span></span><br><span class="line">    flake8 . --count --exit-zero --<span class="built_in">max</span>-complexity=<span class="number">10</span> --<span class="built_in">max</span>-line-length=<span class="number">127</span> --statistics</span><br><span class="line">- name: Test <span class="keyword">with</span> pytest</span><br><span class="line">  run: |</span><br><span class="line">    pip install --no-deps .</span><br><span class="line">    pytest --verbose --capture=no --cov=./ --cov-report=xml \</span><br><span class="line">        --username=$&#123;&#123; secrets.EARTHDATA_USERNAME &#125;&#125; \</span><br><span class="line">        --password=$&#123;&#123; secrets.EARTHDATA_PASSWORD &#125;&#125; \</span><br><span class="line">        --webdav=$&#123;&#123; secrets.PODAAC_PASSWORD &#125;&#125;</span><br><span class="line">- name: Archive code coverage results</span><br><span class="line">  uses: actions/upload-artifact@v2</span><br><span class="line">  <span class="keyword">with</span>:</span><br><span class="line">    name: code-coverage-report</span><br><span class="line">    path: ./coverage.xml</span><br></pre></td></tr></table></figure></li></ol><h3 id="doc文件夹"><a href="#doc文件夹" class="headerlink" title=".doc文件夹"></a>.doc文件夹</h3><ol><li><p>github中作者中的<a href="https://github.com/tsutterley/gravity-toolkit/blob/main/doc/environment.yml">gravity-toolkit&#x2F;doc&#x2F;environment.yml</a>安装doc 环境，包括下列库。安装命令：<code>conda install -c conda-forge package_name</code></p><p>name: gravity-docs<br>channels:</p><ul><li>conda-forge<br>dependencies:</li><li>docutils&lt;0.18</li><li>fontconfig</li><li>fonttools</li><li>freetype</li><li>future</li><li>graphviz</li><li>lxml</li><li>markupsafe&#x3D;&#x3D;2.0.1</li><li>numpy</li><li>numpydoc</li><li>pip</li><li>python&gt;&#x3D;3.6</li><li>python-dateutil</li><li>pyyaml</li><li>scipy</li><li>sphinx</li><li>sphinx_rtd_theme</li><li>pip:<ul><li>sphinx-argparse&gt;&#x3D;0.4</li><li>..</li></ul></li></ul></li><li><p>github中作者中的<a href="https://github.com/tsutterley/gravity-toolkit/blob/main/doc/source/getting_started/Citations.rst">gravity-toolkit&#x2F;doc&#x2F;source&#x2F;getting_started&#x2F;Citations.rst</a>中的依赖，包括下列库。</p><ul><li><a href="https://scitools.org.uk/cartopy/docs/latest/">cartopy: Python package designed for geospatial data processing</a></li><li><a href="https://python-future.org/">future: Compatibility layer between Python 2 and Python 3</a></li><li><a href="https://www.h5py.org/">h5py: Python interface for Hierarchal Data Format 5 (HDF5)</a></li><li><a href="https://ipywidgets.readthedocs.io/en/latest/">ipywidgets: interactive HTML widgets for Jupyter notebooks and IPython</a></li><li><a href="https://pypi.python.org/pypi/lxml">lxml: processing XML and HTML in Python</a></li><li><a href="https://matplotlib.org/">matplotlib: Python 2D plotting library</a></li><li><a href="https://unidata.github.io/netcdf4-python/">netCDF4: Python interface to the netCDF C library</a></li><li><a href="https://numpy.org/">numpy: Scientific Computing Tools For Python</a></li><li><a href="https://dateutil.readthedocs.io/en/stable/">python-dateutil: powerful extensions to datetime</a></li><li><a href="https://github.com/yaml/pyyaml">PyYAML: YAML parser and emitter for Python</a></li><li><a href="https://docs.scipy.org/doc/">scipy: Scientific Tools for Python</a></li><li><a href="https://docs.python.org/3/library/tkinter.html">tkinter: Python interface to the Tcl&#x2F;Tk GUI toolkit</a></li></ul></li></ol><h2 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h2><h3 id="pip-安装-或选择下面的setup安装"><a href="#pip-安装-或选择下面的setup安装" class="headerlink" title="pip 安装(或选择下面的setup安装)"></a>pip 安装(或选择下面的setup安装)</h3><p>python3 -m pip install –user git+<a href="https://github.com/tsutterley/read-GRACE-geocenter.git">https://github.com/tsutterley/read-GRACE-geocenter.git</a></p><p>python3 -m pip install –user git+<a href="https://github.com/tsutterley/geoid-toolkit.git">https://github.com/tsutterley/geoid-toolkit.git</a></p><p>python3 -m pip install –user git+<a href="https://github.com/tsutterley/gravity-toolkit">https://github.com/tsutterley/gravity-toolkit</a></p><h3 id="setup安装"><a href="#setup安装" class="headerlink" title="setup安装"></a>setup安装</h3><p>进入gravity-toolkit文件夹（setup.py）同级目录，运行<em>python setup.py install</em></p><p>同理，将read-GRACE-geocenter和geoid-toolkit拷贝入gravity-toolkit文件夹，运行<em>python setup.py install</em></p><h3 id="拷贝"><a href="#拷贝" class="headerlink" title="拷贝"></a>拷贝</h3><p>将github上下载的文件夹中的script文件夹拷贝到~&#x2F;anaconda3&#x2F;envs&#x2F;grace&#x2F;lib&#x2F;python3.8&#x2F;site-packages&#x2F;gravity_toolkit-1.2.0-py3.8.egg&#x2F;gravity_toolkit 文件夹下便于直接访问script下的函数。</p><h3 id="环境变量设置"><a href="#环境变量设置" class="headerlink" title="环境变量设置"></a>环境变量设置</h3><p>将gravity_toolkit、gravity_toolkit&#x2F;scripts和geoid_toolkit添加到环境变量(<del>&#x2F;.bashrc)</del>中。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">&lt;&lt;&lt; <span class="string">GRACE conda initialize &lt;&lt;&lt;</span></span></span><br><span class="line">alias grace=&quot;source activate grace&quot;</span><br><span class="line">export PATH=&quot;~/anaconda3/envs/grace/lib/python3.8/site-packages/gravity_toolkit-1.2.0-py3.8.egg/gravity_toolkit:$PATH&quot;</span><br><span class="line">export PATH=&quot;~/anaconda3/envs/grace/lib/python3.8/site-packages/gravity_toolkit-1.2.0-py3.8.egg/gravity_toolkit/scripts:$PATH&quot;</span><br><span class="line">export PATH=&quot;~/anaconda3/envs/grace/lib/python3.8/site-packages/geoid_toolkit-1.1.1-py3.8.egg/geoid_toolkit:$PATH&quot;</span><br></pre></td></tr></table></figure><p>添加完成后，终端执行<code>source ~/.bashrc</code></p><h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><p>终端执行<code>cnes_grace_sync.py --help</code>和<code>podaac_cumulus.py --help</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">podaac_cumulus.py --directory=&quot;/home/manasakura/draft&quot; --release RL06</span><br></pre></td></tr></table></figure><h3 id="备注"><a href="#备注" class="headerlink" title="备注"></a>备注</h3><p>setup安装后，在conda虚拟环境中就已存在該工具包，路径为<code>~/anaconda3/envs/grace/lib/python3.8/site-packages</code>，在调用工具包中的函数时实际上是调用site-packages中的函数，而不是从github上下载的文件夹中的函数，所以如果按照github文件夹的路径进行函数访问将不会访问到。</p><h1 id="学习笔记"><a href="#学习笔记" class="headerlink" title="学习笔记"></a>学习笔记</h1><h2 id="文档学习"><a href="#文档学习" class="headerlink" title="文档学习"></a>文档学习</h2><h3 id="doc文件夹-1"><a href="#doc文件夹-1" class="headerlink" title="doc文件夹"></a>doc文件夹</h3><p>doc学习顺序可按照该<a href="https://github.com/tsutterley/gravity-toolkit/blob/main/doc/source/index.rst">文档</a>进行</p><p>函数用法可查看<a href="https://gravity-toolkit.readthedocs.io/en/latest/">readdocs.io</a>和<a href="https://github.com/tsutterley/gravity-toolkit/tree/main/doc/source/api_reference">api_reference</a></p><h3 id="gravity-toolkit文件夹"><a href="#gravity-toolkit文件夹" class="headerlink" title="gravity_toolkit文件夹"></a>gravity_toolkit文件夹</h3><h4 id="SLR文件夹"><a href="#SLR文件夹" class="headerlink" title="SLR文件夹"></a>SLR文件夹</h4><p>将C20.py, CS2.py, C30.py, C40.py, C50.py计算出的球协系数值（去除AOD）与matlab中计算出的进行对比，二者答案一致（只校对了GRACE_months 1～4月，对应2002年1月～2002年4月），matlab的计算值保存为<code>~/coding/gravity_workspace/myworkspace/cs2m_c30_c40_c50_gracemonth_1_4_check.mat</code></p><h5 id="C20-py"><a href="#C20-py" class="headerlink" title="C20.py"></a>C20.py</h5><h6 id="C20-RL06-txt-PROC-CSR"><a href="#C20-RL06-txt-PROC-CSR" class="headerlink" title="C20_RL06.txt(PROC&#x3D;CSR)"></a>C20_RL06.txt(PROC&#x3D;CSR)</h6><p>SLR.C20中的data变量不是直接读取的C20_RL06.txt中的Column 2中的C20，而是将第二列的C20数据减去Column 5中的AOD产品，详细信息查看原文件中的comment如下。</p><p>The RL-06 background gravity model includes solid earth and ocean tides, solid earth and ocean pole tides, and the Atmosphere-Ocean De-aliasing (AOD1B) product. However, the monthly mean of the AOD model has been restored; subtract Column 5 to remove it.</p><p>源代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">dinput[<span class="string">&#x27;time&#x27;</span>] = file_input[<span class="string">&#x27;time&#x27;</span>]</span><br><span class="line">dinput[<span class="string">&#x27;month&#x27;</span>] = gravity_toolkit.time.calendar_to_grace(dinput[<span class="string">&#x27;time&#x27;</span>])</span><br><span class="line"><span class="comment"># monthly spherical harmonic replacement solutions</span></span><br><span class="line">dinput[<span class="string">&#x27;data&#x27;</span>] = file_input[<span class="string">&#x27;C20&#x27;</span>].copy()</span><br><span class="line"><span class="comment"># monthly spherical harmonic formal standard deviations</span></span><br><span class="line">dinput[<span class="string">&#x27;error&#x27;</span>] = file_input[<span class="string">&#x27;sigma&#x27;</span>]*<span class="number">1e-10</span></span><br><span class="line"><span class="comment"># Background gravity model includes solid earth and ocean tides, solid</span></span><br><span class="line"><span class="comment"># earth and ocean pole tides, and the Atmosphere-Ocean De-aliasing</span></span><br><span class="line"><span class="comment"># product. The monthly mean of the AOD model has been restored.</span></span><br><span class="line"><span class="keyword">if</span> AOD:</span><br><span class="line">    <span class="comment"># Removing AOD product that was restored in the solution</span></span><br><span class="line">    dinput[<span class="string">&#x27;data&#x27;</span>] -= file_input[<span class="string">&#x27;AOD&#x27;</span>]*<span class="number">1e-10</span></span><br></pre></td></tr></table></figure><h5 id="CS2-py"><a href="#CS2-py" class="headerlink" title="CS2.py"></a>CS2.py</h5><h6 id="C21-22-S21-22-RL06-txt-PROC-CSR"><a href="#C21-22-S21-22-RL06-txt-PROC-CSR" class="headerlink" title="C21(22)_S21(22)_RL06.txt(PROC&#x3D;CSR)&#96;"></a>C21(22)_S21(22)_RL06.txt(PROC&#x3D;CSR)&#96;</h6><p>读取的CS21&#x2F;CS22是文件中SLR CS21&#x2F;CS22（Column 2,3）减去AOD(大气-海洋去混叠,Column 6,7）之后的CS21&#x2F;CS22,AOD简述可查看<a href="https://ui.adsabs.harvard.edu/abs/2019AGUFM.G51B0583C/abstract#:~:text=The%20Atmosphere-Ocean%20De-aliasing%20%28AOD%29%20product%20is%20a%20set,attraction%20due%20to%20the%20changing%20atmosphere-ocean%20mass%20distribution.">Atmosphere-Ocean De-aliasing For GRACE-FO - NASA&#x2F;ADS</a> 和  <a href="http://dx.doi.org/10.1029/2011GL048881">Evaluation of high-frequency oceanographic signal in GRACE data: Implications for de-aliasing</a></p><p>大气-海洋去锯齿 (AOD) 产品是一组 Stokes 系数，表示由于大气-海洋质量分布变化引起的非潮汐引力的时间效应。它被用作处理数据流的力模型，以防止高频大气和海洋运动的影响混叠到月解中。</p><p>源代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">dinput[<span class="string">&#x27;time&#x27;</span>] = content[<span class="string">&#x27;time&#x27;</span>].copy()</span><br><span class="line">dinput[<span class="string">&#x27;month&#x27;</span>] = gravity_toolkit.time.calendar_to_grace(dinput[<span class="string">&#x27;time&#x27;</span>])</span><br><span class="line"><span class="comment"># remove the monthly mean of the AOD model</span></span><br><span class="line">dinput[<span class="string">&#x27;C2m&#x27;</span>] = content[<span class="string">&#x27;C2&#x27;</span>] - content[<span class="string">&#x27;C2aod&#x27;</span>]*<span class="number">10</span>**-<span class="number">10</span></span><br><span class="line">dinput[<span class="string">&#x27;S2m&#x27;</span>] = content[<span class="string">&#x27;S2&#x27;</span>] - content[<span class="string">&#x27;S2aod&#x27;</span>]*<span class="number">10</span>**-<span class="number">10</span></span><br><span class="line"><span class="comment"># scale SLR solution sigmas</span></span><br><span class="line">dinput[<span class="string">&#x27;eC2m&#x27;</span>] = content[<span class="string">&#x27;eC2&#x27;</span>]*<span class="number">10</span>**-<span class="number">10</span></span><br><span class="line">dinput[<span class="string">&#x27;eS2m&#x27;</span>] = content[<span class="string">&#x27;eS2&#x27;</span>]*<span class="number">10</span>**-<span class="number">10</span></span><br></pre></td></tr></table></figure><h5 id="C30-py"><a href="#C30-py" class="headerlink" title="C30.py"></a>C30.py</h5><h6 id="CSR-Monthly-5x5-Gravity-Harmonics-txt-PROC-CSR"><a href="#CSR-Monthly-5x5-Gravity-Harmonics-txt-PROC-CSR" class="headerlink" title="CSR_Monthly_5x5_Gravity_Harmonics.txt(PROC&#x3D;CSR)"></a>CSR_Monthly_5x5_Gravity_Harmonics.txt(PROC&#x3D;CSR)</h6><p>利用read_SLR_harmonics.py计算C30完整球协系数，并返回C30完整球协系数，GRACE_month为从2002.0起算的月份（见time.py中的calendar_to_grace函数）。从GGMO5C平均重力场模型（头文件中）和SLR观测值（正文，系数以相对于平均重力场的变化形式给出，已经去除AOD）相加求C30完整球协系数，并将求得的C30完整球协系数作为返回值。</p><p>核心代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#### CSR_Monthly_5x5_Gravity_Harmonics.txt</span></span><br><span class="line"><span class="comment"># GGM05C重力场表头（头文件）</span></span><br><span class="line">    L    M         C                  S               sigma C      sigma S</span><br><span class="line"><span class="comment"># SLR观测值（正文内容，球协系数异常值）表头及单位</span></span><br><span class="line">n, m, Cnm, Snm, Cnm+AOD, Snm+AOD, C-sigma, S-sigma, MJD_mid_point, Year_mid_point</span><br><span class="line">Units <span class="number">1.0e-10</span></span><br><span class="line"><span class="comment">#### read_GRACE_harmonics.py</span></span><br><span class="line"><span class="comment"># fill mean field Ylms（头文件中GGMO5C平均重力场模型）</span></span><br><span class="line">mean_Ylms[<span class="string">&#x27;clm&#x27;</span>][l1,m1] = np.float64(line[<span class="number">2</span>].replace(<span class="string">&#x27;D&#x27;</span>,<span class="string">&#x27;E&#x27;</span>))</span><br><span class="line">mean_Ylms[<span class="string">&#x27;slm&#x27;</span>][l1,m1] = np.float64(line[<span class="number">3</span>].replace(<span class="string">&#x27;D&#x27;</span>,<span class="string">&#x27;E&#x27;</span>))</span><br><span class="line">mean_Ylm_error[<span class="string">&#x27;clm&#x27;</span>][l1,m1] = np.float64(line[<span class="number">4</span>].replace(<span class="string">&#x27;D&#x27;</span>,<span class="string">&#x27;E&#x27;</span>))</span><br><span class="line">mean_Ylm_error[<span class="string">&#x27;slm&#x27;</span>][l1,m1] = np.float64(line[<span class="number">5</span>].replace(<span class="string">&#x27;D&#x27;</span>,<span class="string">&#x27;E&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># fill anomaly field Ylms and rescale to output（SLR观测的cs_lm异常值和cs_lm_error）</span></span><br><span class="line">Ylm_anomalies[<span class="string">&#x27;clm&#x27;</span>][l1,m1,d] = np.float64(line[<span class="number">2</span>])*SCALE</span><br><span class="line">Ylm_anomalies[<span class="string">&#x27;slm&#x27;</span>][l1,m1,d] = np.float64(line[<span class="number">3</span>])*SCALE</span><br><span class="line">Ylm_anomaly_error[<span class="string">&#x27;clm&#x27;</span>][l1,m1,d] = np.float64(line[<span class="number">6</span>])*SCALE</span><br><span class="line">Ylm_anomaly_error[<span class="string">&#x27;slm&#x27;</span>][l1,m1,d] = np.float64(line[<span class="number">7</span>])*SCALE</span><br><span class="line"></span><br><span class="line"><span class="comment"># calculate full coefficients and full errors（C30完整球协系数）</span></span><br><span class="line">Ylms[<span class="string">&#x27;clm&#x27;</span>][:,:,d] = Ylm_anomalies[<span class="string">&#x27;clm&#x27;</span>][:,:,d] + mean_Ylms[<span class="string">&#x27;clm&#x27;</span>][:,:]</span><br><span class="line">Ylms[<span class="string">&#x27;slm&#x27;</span>][:,:,d] = Ylm_anomalies[<span class="string">&#x27;slm&#x27;</span>][:,:,d] + mean_Ylms[<span class="string">&#x27;slm&#x27;</span>][:,:]</span><br><span class="line">Ylms[<span class="string">&#x27;error&#x27;</span>][<span class="string">&#x27;clm&#x27;</span>][:,:,d]=np.sqrt(Ylm_anomaly_error[<span class="string">&#x27;clm&#x27;</span>][:,:,d]**<span class="number">2</span> +</span><br><span class="line">    mean_Ylm_error[<span class="string">&#x27;clm&#x27;</span>][:,:]**<span class="number">2</span>)</span><br><span class="line">Ylms[<span class="string">&#x27;error&#x27;</span>][<span class="string">&#x27;slm&#x27;</span>][:,:,d]=np.sqrt(Ylm_anomaly_error[<span class="string">&#x27;slm&#x27;</span>][:,:,d]**<span class="number">2</span> +</span><br><span class="line">    mean_Ylm_error[<span class="string">&#x27;slm&#x27;</span>][:,:]**<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#### C30.py</span></span><br><span class="line"><span class="comment"># CSR 5x5 + 6,1 file from CSR and extract C3,0 coefficients</span></span><br><span class="line">Ylms = gravity_toolkit.read_SLR_harmonics(SLR_file, HEADER=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># extract dates, C30 harmonics and errors</span></span><br><span class="line">dinput[<span class="string">&#x27;time&#x27;</span>] = Ylms[<span class="string">&#x27;time&#x27;</span>].copy()</span><br><span class="line">dinput[<span class="string">&#x27;data&#x27;</span>] = Ylms[<span class="string">&#x27;clm&#x27;</span>][<span class="number">3</span>,<span class="number">0</span>,:].copy()</span><br><span class="line">dinput[<span class="string">&#x27;error&#x27;</span>] = Ylms[<span class="string">&#x27;error&#x27;</span>][<span class="string">&#x27;clm&#x27;</span>][<span class="number">3</span>,<span class="number">0</span>,:].copy()</span><br></pre></td></tr></table></figure><h5 id="C40-py"><a href="#C40-py" class="headerlink" title="C40.py"></a>C40.py</h5><h6 id="CSR-Monthly-5x5-Gravity-Harmonics-txt-PROC-CSR-1"><a href="#CSR-Monthly-5x5-Gravity-Harmonics-txt-PROC-CSR-1" class="headerlink" title="CSR_Monthly_5x5_Gravity_Harmonics.txt(PROC&#x3D;CSR)"></a>CSR_Monthly_5x5_Gravity_Harmonics.txt(PROC&#x3D;CSR)</h6><p>同C30.py的方法计算C40完整球协系数。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#### CSR_Monthly_5x5_Gravity_Harmonics.txt 同上C30.py</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#### read_GRACE_harmonics.py 同上C30.py</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#### C30.py</span></span><br><span class="line"><span class="comment"># read 5x5 + 6,1 file from CSR and extract C4,0 coefficients</span></span><br><span class="line">Ylms = gravity_toolkit.read_SLR_harmonics(SLR_file, HEADER=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># extract dates, C40 harmonics and errors</span></span><br><span class="line">dinput[<span class="string">&#x27;time&#x27;</span>] = Ylms[<span class="string">&#x27;time&#x27;</span>].copy()</span><br><span class="line">dinput[<span class="string">&#x27;data&#x27;</span>] = Ylms[<span class="string">&#x27;clm&#x27;</span>][<span class="number">4</span>,<span class="number">0</span>,:].copy()</span><br><span class="line">dinput[<span class="string">&#x27;error&#x27;</span>] = Ylms[<span class="string">&#x27;error&#x27;</span>][<span class="string">&#x27;clm&#x27;</span>][<span class="number">4</span>,<span class="number">0</span>,:].copy()</span><br></pre></td></tr></table></figure><h5 id="C50-py"><a href="#C50-py" class="headerlink" title="C50.py"></a>C50.py</h5><h6 id="CSR-Monthly-5x5-Gravity-Harmonics-txt-PROC-CSR-2"><a href="#CSR-Monthly-5x5-Gravity-Harmonics-txt-PROC-CSR-2" class="headerlink" title="CSR_Monthly_5x5_Gravity_Harmonics.txt(PROC&#x3D;CSR)"></a>CSR_Monthly_5x5_Gravity_Harmonics.txt(PROC&#x3D;CSR)</h6><p>同C30.py的方法计算C50完整球协系数。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#### CSR_Monthly_5x5_Gravity_Harmonics.txt 同上C30.py</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#### read_GRACE_harmonics.py 同上C30.py#### C50.py</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># read 5x5 + 6,1 file from GSFC and extract coefficients</span></span><br><span class="line">Ylms = gravity_toolkit.read_SLR_harmonics(SLR_file, HEADER=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># calculate 28-day moving-average solution from 7-day arcs</span></span><br><span class="line">dinput.update(gravity_toolkit.convert_weekly(Ylms[<span class="string">&#x27;time&#x27;</span>],Ylms[<span class="string">&#x27;clm&#x27;</span>][<span class="number">5</span>,<span class="number">0</span>,:], DATE=DATE, NEIGHBORS=<span class="number">28</span>))</span><br><span class="line"><span class="comment"># no estimated spherical harmonic errors</span></span><br><span class="line">dinput[<span class="string">&#x27;error&#x27;</span>] = np.zeros_like(DATE,dtype=<span class="string">&#x27;f8&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="gen-averaging-kernel-py"><a href="#gen-averaging-kernel-py" class="headerlink" title="gen_averaging_kernel.py"></a>gen_averaging_kernel.py</h4><p>生成平均核系数，从而最大限度地减少总误差。</p><p>其中输入参数为</p><p>INPUTS:<br>    gclm: cosine spherical harmonics of exact averaging kernel    </p><p>    gslm: sine spherical harmonics of exact averaging kernel    </p><p>    eclm: measurement error in the cosine harmonics    </p><p>    eslm: measurement error in the sine harmonics    </p><p>    sigma: variance of the surface mass signal    </p><p>    hw: Gaussian radius of the kernel in kilometers</p><p>需要用到的计算公式如下：</p><p>区域核函数（exact averaging kernel）</p><p>$$<br>\vartheta(\theta, \phi)&#x3D;0 \quad outside \quad the \quad basin\<br>\vartheta(\theta, \phi)&#x3D;1 \quad inside \quad the \quad basin<br>$$</p><p>求gclm&#x2F;gslm</p><p>$$<br>\begin{Bmatrix}<br>\Delta{\vartheta}<em>{lm}^c \ \Delta\hat{\vartheta}</em>{lm}^s<br>\end{Bmatrix}&#x3D;<br>\int \vartheta(\theta,\phi) \widetilde{P}_{lm}(cos\theta)<br>\begin{Bmatrix}<br>cosm\phi \ sinm\phi<br>\end{Bmatrix}d\Omega<br>$$</p><p>离散形式为</p><p>$$<br>\begin{Bmatrix}<br>\Delta{\vartheta}<em>{lm}^c \ \Delta\hat{\vartheta}</em>{lm}^s<br>\end{Bmatrix}&#x3D;<br>\sum_{i&#x3D;1}^{180} \sum_{j&#x3D;1}^{360} \vartheta(\theta_i,\lambda_j)\widetilde P_{lm}(cos\theta_i)sin(m \lambda_j)</p><p>\begin{Bmatrix}<br>cosm\phi \ sinm\phi<br>\end{Bmatrix}<br>sin \theta_i \Delta \theta_i \Delta \lambda_j<br>$$</p><p>附上$\vartheta(\theta, \phi)$的球谐展开形式</p><p>$$<br>\vartheta(\theta,\phi) &#x3D; \frac{1}{4\pi}</p><p>\sum_{l&#x3D;0}^{\infty}\sum_{m&#x3D;0}^l \widetilde{P}<em>{lm}(cos\theta)(\vartheta</em>{lm}^c \Delta C+\vartheta_{lm}^s \Delta S)<br>$$</p><p>计算Wlms：</p><h4 id="gen-disc-load-py"><a href="#gen-disc-load-py" class="headerlink" title="gen_disc_load.py"></a>gen_disc_load.py</h4><p>计算均匀 disc load（负荷，与mass含义相近）的重力（gravitational）球谐系数。</p><h4 id="gen-harmonics-py"><a href="#gen-harmonics-py" class="headerlink" title="gen_harmonics.py"></a>gen_harmonics.py</h4><p>gen_harmonics.py函数进行球谐系数展开主要是利用下列公式：</p><p>$$<br>\Delta C_{lm}&#x3D;\frac{1}{4\pi} \sum_{i&#x3D;1}^{180} \sum_{j&#x3D;1}^{360}\Delta \sigma(\theta_i,\lambda_j)P_{lm}(cos\theta_i)cos(m \lambda_j)sin \theta_i \Delta \theta_i \Delta \lambda_j<br>$$</p><p>$$<br>\Delta S_{lm}&#x3D;\frac{1}{4\pi} \sum_{i&#x3D;1}^{180} \sum_{j&#x3D;1}^{360}\Delta \sigma(\theta_i,\lambda_j)P_{lm}(cos\theta_i)sin(m \lambda_j)sin \theta_i \Delta \theta_i \Delta \lambda_j<br>$$</p><p>其中，</p><p>$$<br>\Delta \theta &#x3D; \Delta \lambda &#x3D; \pi&#x2F;180<br>$$</p><p>上面公式与<a href="https://link.springer.com/article/10.1007/s00190-015-0824-2">Chen（2015）</a>中公式有所不同，<a href="https://link.springer.com/article/10.1007/s00190-015-0824-2">Chen（2015）</a>公式如下：</p><p>$$<br>\Delta C_{lm}&#x3D;\frac{3}{4\pi \rho_E a} \frac{k_l + 1}{2l+1} \sum_{i&#x3D;1}^{180} \sum_{j&#x3D;1}^{360}\Delta \sigma(\theta_i,\lambda_j)P_{lm}(cos\theta_i)cos(m \lambda_j)sin \theta_i \Delta \theta_i \Delta \lambda_j<br>$$</p><p>$$<br>\Delta S_{lm}&#x3D;\frac{3}{4\pi \rho_E a} \frac{k_l + 1}{2l+1} \sum_{i&#x3D;1}^{180} \sum_{j&#x3D;1}^{360}\Delta \sigma(\theta_i,\lambda_j)P_{lm}(cos\theta_i)sin(m \lambda_j)sin \theta_i \Delta \theta_i \Delta \lambda_j<br>$$</p><p>将空间域的数据转化为球协系数.</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">demo2</span>():</span><br><span class="line">    grid_dir = <span class="string">&#x27;~/coding/gravity_workspace/gwrks0628/CSR_RL06_GSM_ICE6G-D_High_Res_wCSR_C20_wCSR_21_wCSR_22_wCSR_C30_wCSR_C40_wCSR_C50_wTellus_DEG1_cmwe_L60M60_r300km_FL_004-248.nc&#x27;</span></span><br><span class="line">    grid = spatial().from_netCDF4(grid_dir)</span><br><span class="line">    grid_data = grid.data[:, :, <span class="number">0</span>]</span><br><span class="line">    lon = grid.lon</span><br><span class="line">    lat = grid.lat</span><br><span class="line">    Ylms = gen_harmonics(grid_data, lon, lat, METHOD=<span class="string">&#x27;integration&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Finished!&quot;</span>)</span><br></pre></td></tr></table></figure><p>在上述代码中，grid_dir路径指向的文件是由<code>[GRACE-Spatial-Maps.ipynb]</code>文件生成的grid对象，包含计算出的等效水高格网。gen_stokes函数可将該格网（二维）展开为球谐系数，其计算结果与matlab包中的<code>grid2cs.m</code>计算结果相同。matlab代码如下：</p><figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">grid_dir = <span class="string">&#x27;~/coding/gravity_workspace/gwrks0628/CSR_RL06_GSM_ICE6G-D_High_Res_wCSR_C20_wCSR_21_wCSR_22_wCSR_C30_wCSR_C40_wCSR_C50_wTellus_DEG1_cmwe_L60M60_r300km_FL_004-248.nc&#x27;</span>;;</span><br><span class="line">info = ncinfo(grid_dir);</span><br><span class="line">variables = info.Variables;</span><br><span class="line">grid_data = ncread(grid_dir, <span class="string">&#x27;z&#x27;</span>);    <span class="comment">% n_lon * n_lat * n_month</span></span><br><span class="line">lon = ncread(grid_dir, <span class="string">&#x27;lon&#x27;</span>);        <span class="comment">% 西经（-180-0）：东经（0-180）</span></span><br><span class="line">lat = ncread(grid_dir, <span class="string">&#x27;lat&#x27;</span>);        <span class="comment">% 北纬（90-0）：南纬（0：-90）</span></span><br><span class="line">time = ncread(grid_dir, <span class="string">&#x27;time&#x27;</span>);</span><br><span class="line"><span class="comment">% matlab包要求grid_data格网数据呈东经：西经（0：180：-180/0）、北纬：南纬（90：-90）分布。</span></span><br><span class="line">clear grid_data_temp;</span><br><span class="line">grid_data_temp(:,:) = grid_data(<span class="number">1</span>,:,:);</span><br><span class="line">grid_data_temp2 = grid_data_temp&#x27;;</span><br><span class="line">grid_data_temp3 = [grid_data_temp2(:,<span class="number">721</span>:<span class="number">1440</span>) grid_data_temp2(:,<span class="number">1</span>:<span class="number">720</span>)];        <span class="comment">% n_lat * n_lon, 呈东经：西经（0：180：-180/0）、北纬：南纬（90：-90）分布</span></span><br><span class="line">cs2 = gmt_grid2cs(grid_data_temp3/<span class="number">100</span>, <span class="number">60</span>);</span><br></pre></td></tr></table></figure><p>需要注意的是，在利用matlab包进行计算时，grid单位换算成了m（grid_data_temp3&#x2F;100），上面两个计算结果相同，结果如下。</p><p>备注：该函数不涉及units类的引入和factor的计算。</p><h4 id="gen-stokes-py"><a href="#gen-stokes-py" class="headerlink" title="gen_stokes.py"></a>gen_stokes.py</h4><p>将空间域的数据转化为球协系数，可在ocean_stokes.py中查看其如何使用。</p><p>公式引用自<a href="https://link.springer.com/article/10.1007/s00190-015-0824-2">Chen（2015）</a> ，计算公式如下，</p><p>$$<br>\Delta C_{lm}&#x3D;\frac{3}{4\pi \rho_E a} \frac{k_l + 1}{2l+1} \sum_{i&#x3D;1}^{180} \sum_{j&#x3D;1}^{360}\Delta \sigma(\theta_i,\lambda_j)P_{lm}(cos\theta_i)cos(m \lambda_j)sin \theta_i \Delta \theta_i \Delta \lambda_j<br>$$</p><p>$$<br>\Delta S_{lm}&#x3D;\frac{3}{4\pi \rho_E a} \frac{k_l + 1}{2l+1} \sum_{i&#x3D;1}^{180} \sum_{j&#x3D;1}^{360}\Delta \sigma(\theta_i,\lambda_j)P_{lm}(cos\theta_i)sin(m \lambda_j)sin \theta_i \Delta \theta_i \Delta \lambda_j<br>$$</p><p>因为</p><p>$$<br>M_e &#x3D; \rho_e V &#x3D; \frac{4 \pi a^3 \rho_e}{3}<br>$$</p><p>上面公式等价于下式，</p><p>$$<br>\Delta C_{lm}&#x3D;\frac{a^2}{M_e} \frac{k_l + 1}{2l+1} \sum_{i&#x3D;1}^{180} \sum_{j&#x3D;1}^{360}\Delta \sigma(\theta_i,\lambda_j)P_{lm}(cos\theta_i)cos(m \lambda_j)sin \theta_i \Delta \theta_i \Delta \lambda_j<br>$$</p><p>$$<br>\Delta S_{lm}&#x3D;\frac{a^2}{M_e} \frac{k_l + 1}{2l+1} \sum_{i&#x3D;1}^{180} \sum_{j&#x3D;1}^{360}\Delta \sigma(\theta_i,\lambda_j)P_{lm}(cos\theta_i)sin(m \lambda_j)sin \theta_i \Delta \theta_i \Delta \lambda_j<br>$$</p><p>核心实现代码如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">#### gen_stokes.py</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># longitude degree spacing in radians</span></span><br><span class="line">    dphi = dlon*np.pi/<span class="number">180.0</span></span><br><span class="line">    <span class="comment"># colatitude degree spacing in radians</span></span><br><span class="line">    dth = dlat*np.pi/<span class="number">180.0</span></span><br><span class="line">    factors = gravity_toolkit.units(lmax=LMAX)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># reforming data to lonXlat if input latXlon</span></span><br><span class="line">    sz = np.shape(data)</span><br><span class="line">    data = data.T <span class="keyword">if</span> (sz[<span class="number">0</span>] == nlat) <span class="keyword">else</span> np.copy(data)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">elif</span> (UNITS == <span class="number">1</span>):</span><br><span class="line">    <span class="comment"># Default Parameter: Input in cm w.e. (g/cm^2)</span></span><br><span class="line">    dfactor = factors.spatial(*LOVE).cmwe</span><br><span class="line">    int_fact[:] = np.sin(th)*dphi*dth</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Calculating cos/sin of phi arrays</span></span><br><span class="line"><span class="comment"># output [m,phi]</span></span><br><span class="line">m = np.arange(MMAX+<span class="number">1</span>)</span><br><span class="line">ccos = np.cos(np.dot(m[:,np.newaxis],phi))</span><br><span class="line">ssin = np.sin(np.dot(m[:,np.newaxis],phi))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Calculating fully-normalized Legendre Polynomials</span></span><br><span class="line"><span class="comment"># Output is plm[l,m,th]</span></span><br><span class="line">plm = np.zeros((LMAX+<span class="number">1</span>, MMAX+<span class="number">1</span>, nlat))</span><br><span class="line"><span class="comment"># added option to precompute plms to improve computational speed</span></span><br><span class="line"><span class="keyword">if</span> PLM <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="comment"># if plms are not pre-computed: calculate Legendre polynomials</span></span><br><span class="line">    PLM, dPLM = plm_holmes(LMAX, np.cos(th))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Multiplying by integration factors [sin(theta)*dtheta*dphi]</span></span><br><span class="line"><span class="comment"># truncate legendre polynomials to spherical harmonic order MMAX</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,nlat):</span><br><span class="line">    plm[:,m,j] = PLM[:,m,j]*int_fact[j]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Initializing preliminary spherical harmonic matrices</span></span><br><span class="line">yclm = np.zeros((LMAX+<span class="number">1</span>, MMAX+<span class="number">1</span>))</span><br><span class="line">yslm = np.zeros((LMAX+<span class="number">1</span>, MMAX+<span class="number">1</span>))</span><br><span class="line"><span class="comment"># Initializing output spherical harmonic matrices</span></span><br><span class="line">Ylms = gravity_toolkit.harmonics(lmax=LMAX, mmax=MMAX)</span><br><span class="line">Ylms.clm = np.zeros((LMAX+<span class="number">1</span>, MMAX+<span class="number">1</span>))</span><br><span class="line">Ylms.slm = np.zeros((LMAX+<span class="number">1</span>, MMAX+<span class="number">1</span>))</span><br><span class="line"><span class="comment"># Multiplying gridded data with sin/cos of m#phis</span></span><br><span class="line"><span class="comment"># This will sum through all phis in the dot product</span></span><br><span class="line"><span class="comment"># output [m,theta]</span></span><br><span class="line">dcos = np.dot(ccos,data)</span><br><span class="line">dsin = np.dot(ssin,data)</span><br><span class="line"><span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(LMIN,LMAX+<span class="number">1</span>):<span class="comment"># equivalent to LMIN:LMAX</span></span><br><span class="line">    mm = np.<span class="built_in">min</span>([MMAX,l])<span class="comment"># truncate to MMAX if specified (if l &gt; MMAX)</span></span><br><span class="line">    m = np.arange(<span class="number">0</span>,mm+<span class="number">1</span>)<span class="comment"># mm+1 elements between 0 and mm</span></span><br><span class="line">    <span class="comment"># Summing product of plms and data over all latitudes</span></span><br><span class="line">    <span class="comment"># axis=1 signifies the direction of the summation</span></span><br><span class="line">    yclm[l,m] = np.<span class="built_in">sum</span>(plm[l,m,:]*dcos[m,:], axis=<span class="number">1</span>)</span><br><span class="line">    yslm[l,m] = np.<span class="built_in">sum</span>(plm[l,m,:]*dsin[m,:], axis=<span class="number">1</span>)</span><br><span class="line">    <span class="comment"># Multiplying by factors to convert to fully normalized coefficients</span></span><br><span class="line">    Ylms.clm[l,m] = dfactor[l]*yclm[l,m]</span><br><span class="line">    Ylms.slm[l,m] = dfactor[l]*yslm[l,m]</span><br><span class="line"></span><br><span class="line"><span class="comment"># return the output spherical harmonics object</span></span><br><span class="line"><span class="keyword">return</span> Ylms</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#### units.py</span></span><br><span class="line">        <span class="comment"># set default keyword arguments</span></span><br><span class="line">        kwargs.setdefault(<span class="string">&#x27;include_elastic&#x27;</span>, <span class="literal">True</span>)</span><br><span class="line">        fraction = np.ones((<span class="variable language_">self</span>.lmax+<span class="number">1</span>))</span><br><span class="line">        <span class="comment"># compensate for elastic deformation within the solid earth</span></span><br><span class="line">        <span class="keyword">if</span> kwargs[<span class="string">&#x27;include_elastic&#x27;</span>]:</span><br><span class="line">            fraction += kl[<span class="variable language_">self</span>.l]</span><br><span class="line">        <span class="comment"># degree dependent coefficients</span></span><br><span class="line">        <span class="comment"># norm, fully normalized spherical harmonics</span></span><br><span class="line">        <span class="variable language_">self</span>.norm = np.ones((<span class="variable language_">self</span>.lmax+<span class="number">1</span>))</span><br><span class="line">        <span class="comment"># cmwe, centimeters water equivalent [g/cm^2]</span></span><br><span class="line">        <span class="variable language_">self</span>.cmwe = <span class="variable language_">self</span>.rho_e*<span class="variable language_">self</span>.rad_e*(<span class="number">2.0</span>*<span class="variable language_">self</span>.l+<span class="number">1.0</span>)/fraction/<span class="number">3.0</span></span><br><span class="line">        <span class="comment"># mmwe, millimeters water equivalent [kg/m^2]</span></span><br><span class="line">        <span class="variable language_">self</span>.mmwe = <span class="number">10.0</span>*<span class="variable language_">self</span>.rho_e*<span class="variable language_">self</span>.rad_e*(<span class="number">2.0</span>*<span class="variable language_">self</span>.l+<span class="number">1.0</span>)/fraction/<span class="number">3.0</span></span><br></pre></td></tr></table></figure><p>使用 gen_harmonics.py中使用过的同种grid格网数据，进行球谐系数展开，代码如下。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">load_lovenumbers</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    read love numbers</span></span><br><span class="line"><span class="string">    Returns</span></span><br><span class="line"><span class="string">    -------</span></span><br><span class="line"><span class="string">    hl, kl, ll: tuple</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    love_numbers_file = utilities.get_data_path([<span class="string">&#x27;data&#x27;</span>, <span class="string">&#x27;love_numbers&#x27;</span>])</span><br><span class="line">    header = <span class="number">2</span></span><br><span class="line">    columns = [<span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;hl&#x27;</span>, <span class="string">&#x27;kl&#x27;</span>, <span class="string">&#x27;ll&#x27;</span>]</span><br><span class="line">    hl, kl, ll = read_love_numbers(love_numbers_file, LMAX=<span class="number">60</span>,</span><br><span class="line">                                   HEADER=header, COLUMNS=columns, REFERENCE=<span class="string">&#x27;CF&#x27;</span>, FORMAT=<span class="string">&#x27;tuple&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> hl, kl, ll</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">demo</span>():</span><br><span class="line">    grid_dir = <span class="string">&#x27;~/coding/gravity_workspace/gwrks0628/CSR_RL06_GSM_ICE6G-D_High_Res_wCSR_C20_wCSR_21_wCSR_22_wCSR_C30_wCSR_C40_wCSR_C50_wTellus_DEG1_cmwe_L60M60_r300km_FL_004-248.nc&#x27;</span></span><br><span class="line">    love_number = load_lovenumbers()</span><br><span class="line">    grid = spatial().from_netCDF4(grid_dir)</span><br><span class="line"></span><br><span class="line">    grid_data = grid.data[:,:,<span class="number">0</span>]</span><br><span class="line">    lon = grid.lon</span><br><span class="line">    lat = grid.lat</span><br><span class="line">    Ylms = gen_stokes(grid_data, lon, lat, LOVE=love_number)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Finished!&quot;</span>)</span><br></pre></td></tr></table></figure><p>运行结果如下</p><h4 id="grace-date-py"><a href="#grace-date-py" class="headerlink" title="grace_date.py"></a>grace_date.py</h4><p>相关介绍查看test_gravity_notebook.ipynb。</p><h4 id="grace-find-months-py"><a href="#grace-find-months-py" class="headerlink" title="grace_find_months.py"></a>grace_find_months.py</h4><p>相关介绍查看test_gravity_notebook.ipynb。</p><h4 id="grace-months-index-py"><a href="#grace-months-index-py" class="headerlink" title="grace_months_index.py"></a>grace_months_index.py</h4><p>相关介绍查看test_gravity_notebook.ipynb。</p><h4 id="grace-input-months-py"><a href="#grace-input-months-py" class="headerlink" title="grace_input_months.py"></a>grace_input_months.py</h4><p>读取GRACE&#x2F;GRACE- fo文件中指定的球谐l（阶数）和m（次数）以及指定的日期范围。</p><p>改正包括：</p><p>    一阶项替换(如果指定)。</p><p>    用单反值替换C20(如果指定)。</p><p>    用179+月份的单反值替换C21&#x2F;S21&#x2F;C22&#x2F;S22&#x2F;C30&#x2F;C50(如果指定)。</p><p>    更正使用GAE, GAF和GAG文件的ECMWF大气“跳跃”。</p><p>    Wahr et al.(2015)对极潮漂移的修正。</p><p>疑问：該函数中CS21&#x2F;CS22&#x2F;C30&#x2F;C40&#x2F;C50项为什么要设置当grace_month大于179（源码中为 grace_month &gt; 176）时才能用SLR观测值替换GRACE观测值，请问是否在哪篇文献中有所提及，是否可以解答或者提供一下文献链接呢？代码如下（此处仅展示C21项的替换代码，S21&#x2F;CS22&#x2F;C30&#x2F;C40&#x2F;C50代码基本相同）。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i,grace_month <span class="keyword">in</span> <span class="built_in">enumerate</span>(months):</span><br><span class="line">    count = np.count_nonzero(C21_input[<span class="string">&#x27;month&#x27;</span>] == grace_month)</span><br><span class="line">    <span class="keyword">if</span> (count != <span class="number">0</span>) <span class="keyword">and</span> (grace_month &gt; <span class="number">176</span>):</span><br><span class="line">        k, = np.nonzero(C21_input[<span class="string">&#x27;month&#x27;</span>] == grace_month)</span><br><span class="line">        grace_Ylms[<span class="string">&#x27;clm&#x27;</span>][<span class="number">2</span>,<span class="number">1</span>,i] = np.copy(C21_input[<span class="string">&#x27;C2m&#x27;</span>][k])</span><br><span class="line">        grace_Ylms[<span class="string">&#x27;slm&#x27;</span>][<span class="number">2</span>,<span class="number">1</span>,i] = np.copy(C21_input[<span class="string">&#x27;S2m&#x27;</span>][k])</span><br><span class="line">        grace_Ylms[<span class="string">&#x27;eclm&#x27;</span>][<span class="number">2</span>,<span class="number">1</span>,i] = np.copy(C21_input[<span class="string">&#x27;eC2m&#x27;</span>][k])</span><br><span class="line">        grace_Ylms[<span class="string">&#x27;eslm&#x27;</span>][<span class="number">2</span>,<span class="number">1</span>,i] = np.copy(C21_input[<span class="string">&#x27;eS2m&#x27;</span>][k])</span><br></pre></td></tr></table></figure><h4 id="geocenter-py"><a href="#geocenter-py" class="headerlink" title="geocenter.py"></a>geocenter.py</h4><h5 id="from-tellus"><a href="#from-tellus" class="headerlink" title="from_tellus()"></a>from_tellus()</h5><p>读取一阶项文件TN-13_GEOC_CSR_RL06.txt，不做处理，详细用法见test_gravity_notebook.ipynb.</p><h4 id="harmonics-py"><a href="#harmonics-py" class="headerlink" title="harmonics.py"></a>harmonics.py</h4><h5 id="drift-self-t-epoch-2003-3"><a href="#drift-self-t-epoch-2003-3" class="headerlink" title="drift(self, t, epoch&#x3D;2003.3)"></a>drift(self, t, epoch&#x3D;2003.3)</h5><p>将球协系数速度场按照时间积分计算漂移。</p><p>核心代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># # gravity_test_substep.py</span></span><br><span class="line">GRACE_Ylms = harmonics().from_dict(Ylms)</span><br><span class="line">GIA_Ylms_rate = gia(lmax=LMAX).from_GIA(filename=GIA_file,</span><br><span class="line">    GIA=GIA, mmax=MMAX)</span><br><span class="line">GIA_Ylms = GIA_Ylms_rate.drift(GRACE_Ylms.time, epoch=<span class="number">2003.3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># # drift(self, t, epoch=2003.3)</span></span><br><span class="line"><span class="comment"># calculate drift</span></span><br><span class="line"><span class="keyword">for</span> i,ti <span class="keyword">in</span> <span class="built_in">enumerate</span>(t):</span><br><span class="line">    temp.clm[:,:,i] = <span class="variable language_">self</span>.clm*(ti - epoch)</span><br><span class="line">    temp.slm[:,:,i] = <span class="variable language_">self</span>.slm*(ti - epoch)</span><br><span class="line"><span class="comment"># assign degree and order fields</span></span><br><span class="line">temp.update_dimensions()</span><br><span class="line"><span class="keyword">return</span> temp</span><br></pre></td></tr></table></figure><h5 id="from-dict-self-d-kwargs"><a href="#from-dict-self-d-kwargs" class="headerlink" title="from_dict(self, d, **kwargs)"></a>from_dict(self, d, **kwargs)</h5><p>将字典转化为harmonics类型。</p><p>用法</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Ylms = grace_input_months(base_dir, PROC=PROC, DREL=DREL, DSET=DREL, LMAX=<span class="number">60</span>, start_mon=<span class="number">4</span>, end_mon=<span class="number">24</span>,</span><br><span class="line">                                 missing=[<span class="number">6</span>, <span class="number">7</span>, <span class="number">18</span>], SLR_C20=SLR_C20, DEG1=DEG1, SLR_21=SLR_21, SLR_22=SLR_22,</span><br><span class="line">                                 SLR_C30=SLR_C30, SLR_C40=SLR_C40, SLR_C50=SLR_C50)</span><br><span class="line">GRACE_Ylms = harmonics().from_dict(Ylms)</span><br></pre></td></tr></table></figure><h5 id="mean-self-apply-False-indices-Ellipsis"><a href="#mean-self-apply-False-indices-Ellipsis" class="headerlink" title="mean(self, apply&#x3D;False, indices&#x3D;Ellipsis)"></a>mean(self, apply&#x3D;False, indices&#x3D;Ellipsis)</h5><p>执行后就会更新GRACE_Ylms内的变量，返回值为球协系数均值。</p><p>用法</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GRACE_Ylms.mean(apply=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><h4 id="ocean-stokes-py"><a href="#ocean-stokes-py" class="headerlink" title="ocean_stokes.py"></a>ocean_stokes.py</h4><p>读取land-sea mask文件并转化为球协系数。</p><h5 id="ocean-stokes-LANDMASK-LMAX-MMAX-None-LOVE-None-VARNAME-’LSMASK’-SIMPLIFY-False"><a href="#ocean-stokes-LANDMASK-LMAX-MMAX-None-LOVE-None-VARNAME-’LSMASK’-SIMPLIFY-False" class="headerlink" title="ocean_stokes(LANDMASK, LMAX, MMAX&#x3D;None, LOVE&#x3D;None, VARNAME&#x3D;’LSMASK’,       SIMPLIFY&#x3D;False)"></a>ocean_stokes(LANDMASK, LMAX, MMAX&#x3D;None, LOVE&#x3D;None, VARNAME&#x3D;’LSMASK’,       SIMPLIFY&#x3D;False)</h5><h6 id="读取landsea-nc文件"><a href="#读取landsea-nc文件" class="headerlink" title="读取landsea.nc文件"></a>读取landsea.nc文件</h6><p>下载源：<a href="https://www.ncl.ucar.edu/Applications/Data/cdf/landsea.nc">https://www.ncl.ucar.edu/Applications/Data/cdf/landsea.nc</a> 。</p><p>1x1 degree mask distributed from UCAR as part of NCL。<br>landsea.nc文件中的变量名包括lon,lat和LSMASK三类，可使用ncview landsea.nc进行查看。<br>landsea.nc中各值的含义：<br>    0： ocean<br>    1：land<br>    2：lake<br>    3：small island<br>    4：ice shelf</p><p>ocean_stokes代码使用如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gravity_toolkit <span class="keyword">import</span> ocean_stokes</span><br><span class="line">landsea_mask_file = <span class="string">&quot;/home/manasakura/coding/gravity_workspace/Data/LANDSEA_MASK/landsea.nc&quot;</span></span><br><span class="line"><span class="keyword">from</span> gravity_toolkit.utilities <span class="keyword">import</span> get_data_path</span><br><span class="line"><span class="keyword">from</span> gravity_toolkit.read_love_numbers <span class="keyword">import</span> read_love_numbers</span><br><span class="line">love_numbers_file = get_data_path([<span class="string">&#x27;data&#x27;</span>,<span class="string">&#x27;love_numbers&#x27;</span>])</span><br><span class="line">hl,kl,ll = read_love_numbers(love_numbers_file, HEADER=<span class="number">2</span>, FORMAT=<span class="string">&#x27;tuple&#x27;</span>, REFERENCE=<span class="string">&#x27;CF&#x27;</span>)</span><br><span class="line">ocean_Ylms = ocean_stokes(LANDMASK=landsea_mask_file, LMAX=<span class="number">60</span>, MMAX=<span class="number">60</span>, LOVE=(hl,kl,ll), VARNAME=<span class="string">&#x27;LSMASK&#x27;</span>,</span><br><span class="line">    SIMPLIFY=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(ocean_Ylms)</span><br></pre></td></tr></table></figure><p>ocean_stokes函数会调用spatial.py中的spatial.from_netCDF4()函数，主要用于读取landsea.nc文件，代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># # ocean_stokes.py</span></span><br><span class="line">landsea = spatial().from_netCDF4(LANDMASK,</span><br><span class="line">        date=<span class="literal">False</span>, varname=VARNAME)</span><br></pre></td></tr></table></figure><p>ocean_stokes函数还会调用gen_stokes.py中的gen_stokes()函数，用于将空间域的数据转化为球协系数，代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># # ocean_stokes.py</span></span><br><span class="line"><span class="comment"># create land function</span></span><br><span class="line">nth,nphi = landsea.shape</span><br><span class="line">land_function = np.zeros((nth,nphi), dtype=np.float64)</span><br><span class="line"><span class="comment"># combine land and island levels for land function</span></span><br><span class="line">indx,indy = np.nonzero((landsea.data &gt;= <span class="number">1</span>) &amp; (landsea.data &lt;= <span class="number">3</span>))</span><br><span class="line">land_function[indx,indy] = <span class="number">1.0</span></span><br><span class="line"><span class="comment"># remove isolated points if specified</span></span><br><span class="line"><span class="keyword">if</span> SIMPLIFY:</span><br><span class="line">    land_function -= find_isolated_points(land_function)</span><br><span class="line"><span class="comment"># ocean function reciprocal of land function</span></span><br><span class="line">ocean_function = <span class="number">1.0</span> - land_function</span><br><span class="line"><span class="comment"># convert to spherical harmonics (1 cm w.e.)</span></span><br><span class="line">Ylms = gen_stokes(ocean_function.T, landsea.lon, landsea.lat,</span><br><span class="line">    UNITS=<span class="number">1</span>, LMIN=<span class="number">0</span>, LMAX=LMAX, MMAX=MMAX, LOVE=LOVE)</span><br></pre></td></tr></table></figure><p>上一段代码可简单表达为制作海洋掩膜（海洋部分的值为1），并转化为球协系数。</p><h4 id="read-GRACE-harmonics-py"><a href="#read-GRACE-harmonics-py" class="headerlink" title="read_GRACE_harmonics.py"></a>read_GRACE_harmonics.py</h4><p>读取GRACE&#x2F;GRACE-FO Level-2 数据。用法见test_gravity_notebook.ipynb。</p><h4 id="read-love-numbers-py"><a href="#read-love-numbers-py" class="headerlink" title="read_love_numbers.py"></a>read_love_numbers.py</h4><h5 id="load-love-numbers"><a href="#load-love-numbers" class="headerlink" title="load love_numbers"></a>load love_numbers</h5><p>Load Love Numbers match expected for reference frame。用法见test_gravity_notebook.ipynb。</p><h5 id="load-Load-Love2-CE-dat"><a href="#load-Load-Love2-CE-dat" class="headerlink" title="load Load_Love2_CE.dat"></a>load Load_Love2_CE.dat</h5><p>Gegout (2005) Load Love Numbers。用法见test_gravity_notebook.ipynb。</p><h5 id="load-PREM-LLNs-truncated-dat"><a href="#load-PREM-LLNs-truncated-dat" class="headerlink" title="load PREM-LLNs-truncated.dat"></a>load PREM-LLNs-truncated.dat</h5><p>Wang et al. (2012) Load Love Numbers。用法见test_gravity_notebook.ipynb。</p><h4 id="read-GIA-model-py"><a href="#read-GIA-model-py" class="headerlink" title="read_GIA_model.py"></a>read_GIA_model.py</h4><p>读取GIA文件（球协系数）。</p><h5 id="read-GIA-model-input-file-GIA-None-MMAX-None-DATAFORM-None-kwargs"><a href="#read-GIA-model-input-file-GIA-None-MMAX-None-DATAFORM-None-kwargs" class="headerlink" title="read_GIA_model(input_file, GIA&#x3D;None, MMAX&#x3D;None, DATAFORM&#x3D;None, **kwargs)"></a>read_GIA_model(input_file, GIA&#x3D;None, MMAX&#x3D;None, DATAFORM&#x3D;None, **kwargs)</h5><p>从文件中（ICE-6G_High_Res_Stokes_trend.txt）直接读取GIA球协系数值（GRACE Approximation）。用法见test_gravity_notebook.ipynb。</p><h5 id="gia-from-GIA-self-filename-kwargs"><a href="#gia-from-GIA-self-filename-kwargs" class="headerlink" title="gia.from_GIA(self, filename, **kwargs)"></a>gia.from_GIA(self, filename, **kwargs)</h5><p>从文件中（ICE-6G_High_Res_Stokes_trend.txt）直接读取GIA球协系数值（GRACE Approximation）。用法见test_gravity_notebook.ipynb。</p><h4 id="spatial-py"><a href="#spatial-py" class="headerlink" title="spatial.py"></a>spatial.py</h4><p>对空间数据进行读、写等操作。</p><h5 id="spatial-from-netCDF4-self-filename-kwargs"><a href="#spatial-from-netCDF4-self-filename-kwargs" class="headerlink" title="spatial.from_netCDF4(self, filename, **kwargs)"></a>spatial.from_netCDF4(self, filename, **kwargs)</h5><p>读取nc文件。</p><h6 id="landsea-nc"><a href="#landsea-nc" class="headerlink" title="landsea.nc"></a>landsea.nc</h6><p>下载：<a href="https://www.ncl.ucar.edu/Applications/Data/cdf/landsea.nc">https://www.ncl.ucar.edu/Applications/Data/cdf/landsea.nc</a></p><p>landsea.nc文件中包含lon, lat, LSMASK三个变量，该文件可利用ncview可视化查看，查看命令<code>ncview landsea.nc</code>。</p><p>核心代码：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># # ocean_stokes.py</span></span><br><span class="line"><span class="comment"># VARNAME = &quot;LSMASK&quot;</span></span><br><span class="line"><span class="comment"># LANDMASK = &quot;/home/manasakura/coding/gravity_workspace/Data/LANDSEA_MASK/landsea.nc&quot;</span></span><br><span class="line">landsea = spatial().from_netCDF4(LANDMASK,</span><br><span class="line">        date=<span class="literal">False</span>, varname=VARNAME)</span><br></pre></td></tr></table></figure><p>from_netCDF4()函数返回值为landsea（spatial类型），包含attributes, data, extent, filename, lon, lat, spacing等成员变量。data变量中包含的即是landsea.nc文件中的”LSMASK”变量值，下面需要对data变量多加以说明。</p><p>data：180×360的ndarray类型的矩阵，上半矩阵为南半球，下半矩阵为北半球，左半矩阵为东半球，右半矩阵为西半球。即是以0度经线和南纬90度纬线的交叉点为坐标原点建立坐标系，横坐标为i，纵坐标为j，i越往东值越大，j越往北值越大，用numpy读取該矩阵也是同理，按照此坐标系可确定矩阵每个坐标（i，j）所对应的地理坐标。</p><h3 id="scripts文件夹"><a href="#scripts文件夹" class="headerlink" title="scripts文件夹"></a>scripts文件夹</h3><h4 id="time-py"><a href="#time-py" class="headerlink" title="time.py"></a>time.py</h4><h5 id="calendar-to-grace-year-month-1-around-np-floor"><a href="#calendar-to-grace-year-month-1-around-np-floor" class="headerlink" title="calendar_to_grace(year,month&#x3D;1,around&#x3D;np.floor)"></a>calendar_to_grace(year,month&#x3D;1,around&#x3D;np.floor)</h5><p>**comments:**convert calendar dates to GRACE&#x2F;GRACE-FO months</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grace_month = around(12.0*(year - 2002.0)) + month</span><br></pre></td></tr></table></figure>]]></content>
    
    
    
    <tags>
      
      <tag>GRACE</tag>
      
      <tag>toolkit</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>利用Clash科学上网</title>
    <link href="/2023/04/22/%E5%88%A9%E7%94%A8Clash%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/"/>
    <url>/2023/04/22/%E5%88%A9%E7%94%A8Clash%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/</url>
    
    <content type="html"><![CDATA[<h1 id="1-Windows"><a href="#1-Windows" class="headerlink" title="1. Windows"></a>1. Windows</h1><h2 id="1-1-Clash下载与安装"><a href="#1-1-Clash下载与安装" class="headerlink" title="1.1 Clash下载与安装"></a>1.1 Clash下载与安装</h2><ol><li><p>下载安装包<br>github 项目（windows）: <a href="https://github.com/Fndroid/clash_for_windows_pkg/releases">Clash</a></p></li><li><p>解压下载好的安装包，打开. exe 文件可用</p></li><li><p>【Generral】设置，如图</p></li></ol><p><em>提示：该应用会使用代理，如不使用该应用后需要重新关闭代理才能联网。通过【设置】-【网络和 Internet】-【代理】-【手动设置代理】进行关闭。</em></p><h2 id="1-2-节点购买"><a href="#1-2-节点购买" class="headerlink" title="1.2 节点购买"></a>1.2 节点购买</h2><p>链接：<a href="https://giegie.cloud/#/register?code=emwkY5R6">https://giegie.cloud/#/register?code=emwkY5R6</a></p><ol><li>创建账号</li><li>注册成功后，购买节点。</li><li>点击【购买订阅】，选择合适产品，【下单】。</li><li>导入订阅并设置代理。可通过购买网址中【使用文档】-【Windows 使用指南】查看如何将购买的订阅导入 Clash。</li><li>如果未使用上述提供的网址购买节点而是使用其他店家进行购买的订阅，也可同样通过使用订阅地址的方式导入节点。方法如下：<br>（1）打开【Clash】；<br>（2）点击侧边栏的【Profiles】选项，如图所示（我这里为已经导入后的结果）；（3）将订阅地址复制到Clash窗口顶部的【Download from a URL】，点击【Download】即可导入。</li><li>导入订阅完成，进入【Proxies】自行选择节点。</li></ol><h1 id="2-Ubuntu16-04"><a href="#2-Ubuntu16-04" class="headerlink" title="2. Ubuntu16.04"></a>2. Ubuntu16.04</h1><ol><li>【下载】安装包下载：github 项目（windows）: <a href="https://github.com/Fndroid/clash_for_windows_pkg/releases">Clash</a>：下载<em>Clash. for. Windows-0.20.24-x64-linux. tar. gz</em></li><li>【提取】将安装包拷入&#x2F;opt 文件夹下（我一般把软件都放在<code>/opt </code>文件夹下），右键【提取到此处】</li><li>【权限管理】将解压后的文件夹命名为Clash，进入Clash文件夹后，打开终端，输入 <code>*./cfw </code> 进行启动，这里注意不要用 root 权限（也不要用 sudo），如果出现一个权限问题，属于正常情况，查看错误后进入该文件夹中，使用 <code>sudo chmod -R 777 ./*</code> 即可（这里没有截图），然后回到Clash 文件夹中，使用 <code>*./cfw</code>命令即可，便已安装 Clash 完成，但未打开代理。</li><li>【设置系统代理】：参照<a href="%5Bubuntu%E9%85%8D%E7%BD%AE%E5%85%A8%E5%B1%80%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%90%86_kan2016%E7%9A%84%E5%8D%9A%E5%AE%A2-CSDN%E5%8D%9A%E5%AE%A2%5D(https://blog.csdn.net/kan2016/article/details/90411137)%E4%B8%AD%E7%9A%84%E9%85%8D%E7%BD%AE%E7%B3%BB%E7%BB%9F%E4%BB%A3%E7%90%86">链接</a> 中的配置系统代理进行代理设置，设置如图：<em>【网络设置】设置完代理后可能仍然面临无法上网的问题，参照[此链接](<a href="https://zhuanlan.zhihu.com/p/545229582">解决ubuntu虚拟机突然无法上网 - 知乎 (zhihu.com)</a>) 即可解决</em></li><li>【节点导入】导入与 Windows 操作相同<br><strong>【可能错误】</strong>解决办法：不要使用 sudo 或者 root 用户</li></ol>]]></content>
    
    
    
    <tags>
      
      <tag>Ubuntu16.04</tag>
      
      <tag>软件安装</tag>
      
      <tag>Clash</tag>
      
      <tag>Windows10</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2023/03/05/hello-world/"/>
    <url>/2023/03/05/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
